"use strict";(self.webpackChunktag_project=self.webpackChunktag_project||[]).push([[860],{860:(o,s,l)=>{l.d(s,{follow:()=>y,getFollowersCount:()=>u,getFollowersList:()=>h,getFollowingList:()=>w,getFollowingListPaginated:()=>m,unfollow:()=>M});var e=l(560),r=l(420);const t="tag_artist_follows",n=()=>{try{const o=localStorage.getItem(t);return o?JSON.parse(o):{}}catch(o){return console.warn("Failed to get stored follow data:",o),{}}},c=o=>{try{localStorage.setItem(t,JSON.stringify(o))}catch(s){console.warn("Failed to save follow data:",s)}},a=()=>{const o=n();if(Object.keys(o).length>0)return;c({bryan:{followers:["alice","alex"],followersCount:2},alice:{followers:["bryan"],followersCount:1},alex:{followers:[],followersCount:0}}),console.log("[MockFollow] Initialized follow baseline data")},i=async(o,s)=>{try{if(!o||!s)return{success:!1,error:"Missing followerId or artistId"};if(o===s)return{success:!1,error:"Cannot follow yourself"};if(!r.o1[o]||!r.o1[s])return{success:!1,error:"User not found"};const l=n();l[s]||(l[s]={followers:[],followersCount:0});const e=l[s],t=e.followers.indexOf(o);let a=!1;return-1===t?(e.followers.push(o),e.followersCount++,a=!0,console.log("[MockFollow] User ".concat(o," followed artist ").concat(s))):(e.followers.splice(t,1),e.followersCount--,a=!1,console.log("[MockFollow] User ".concat(o," unfollowed artist ").concat(s))),c(l),console.log("[MockFollow] Artist ".concat(s," followers count: ").concat(e.followersCount)),{success:!0,data:{isFollowing:a,followersCount:e.followersCount}}}catch(l){return console.error("[MockFollow] Error toggling follow:",l),{success:!1,error:l.message}}},u=async o=>{try{if(!o)return{success:!1,error:"Missing artistId"};const s=n()[o];return{success:!0,data:{followersCount:s?s.followersCount:0}}}catch(s){return console.error("[MockFollow] Error getting followers count:",s),{success:!1,error:s.message}}},w=async o=>{try{if(!o)return{success:!1,error:"Missing userId"};const s=n(),l=[];return Object.keys(s).forEach(e=>{s[e].followers.includes(o)&&l.push(e)}),{success:!0,data:{following:l,followingCount:l.length}}}catch(s){return console.error("[MockFollow] Error getting following list:",s),{success:!1,error:s.message}}},f=o=>btoa("cursor_".concat(o)).replace(/=/g,""),d=o=>{try{const s=atob(o).match(/cursor_(\d+)/);return s?parseInt(s[1]):0}catch(s){return 0}},g=(o,s)=>{if(!s.trim())return o;const l=s.toLowerCase();return o.filter(o=>{const s=r.o1[o];if(!s)return!1;return[s.displayName,s.name,s.school,...s.skills||[],...s.majors||[]].join(" ").toLowerCase().includes(l)})},h=async function(o){let{limit:s=20,cursor:l=null,q:r="",currentUserId:t="alice"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!o)return{success:!1,error:"Missing artistId"};a();const c=n(),i=c[o];if(!i||!i.followers.length)return{success:!0,data:{items:[],hasMore:!1,cursor:null}};let u=[...i.followers];r.trim()&&(u=g(u,r));const w=l?d(l):0,h=w+s,m=u.slice(w,h),y=(await Promise.all(m.map(async o=>{var s;const l=await(0,e.Cs)(o);if(!l)return console.warn("[MockFollow] Artist data not found: ".concat(o)),null;const r=(null===(s=c[o])||void 0===s?void 0:s.followers.includes(t))||!1;return{id:l.id,displayName:l.name,avatar:l.avatar,role:l.title||l.discipline,school:l.school,skills:l.skills||[],isFollowedByMe:r,isMutual:!1}}))).filter(Boolean),M=h<u.length;return{success:!0,data:{items:y,hasMore:M,cursor:M?f(h):null}}}catch(c){return console.error("[MockFollow] Error getting followers list:",c),{success:!1,error:c.message}}},m=async function(o){let{limit:s=20,cursor:l=null,q:r=""}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!o)return{success:!1,error:"Missing userId"};a();const t=n(),c=[];if(Object.keys(t).forEach(s=>{t[s].followers.includes(o)&&c.push(s)}),!c.length)return{success:!0,data:{items:[],hasMore:!1,cursor:null}};let i=c;r.trim()&&(i=g(c,r));const u=l?d(l):0,w=u+s,h=i.slice(u,w),m=(await Promise.all(h.map(async o=>{const s=await(0,e.Cs)(o);return s?{id:s.id,displayName:s.name,avatar:s.avatar,role:s.title||s.discipline,school:s.school,skills:s.skills||[],isFollowedByMe:!0,isMutual:!1}:(console.warn("[MockFollow] Artist data not found: ".concat(o)),null)}))).filter(Boolean),y=w<i.length;return{success:!0,data:{items:m,hasMore:y,cursor:y?f(w):null}}}catch(t){return console.error("[MockFollow] Error getting following list:",t),{success:!1,error:t.message}}},y=async function(o){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"alice";const l=await i(s,o);return l.success&&window.dispatchEvent(new CustomEvent("follow:changed",{detail:{followerId:s,artistId:o,isFollowing:!0,operation:"follow"}})),l},M=async function(o){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"alice";const l=await i(s,o);return l.success&&window.dispatchEvent(new CustomEvent("follow:changed",{detail:{followerId:s,artistId:o,isFollowing:!1,operation:"unfollow"}})),l}}}]);
//# sourceMappingURL=860.251c7885.chunk.js.map
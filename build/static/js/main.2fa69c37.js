/*! For license information please see main.2fa69c37.js.LICENSE.txt */
(()=>{var e={8:(e,t,r)=>{"use strict";r.d(t,{Gr:()=>d,HW:()=>c,QU:()=>h,WR:()=>l,ou:()=>u});var o=r(51),a=r(179),s=r(915),n=r(420);const i="tag.currentUserId";const l=async()=>{try{if("undefined"===typeof window)return null;let a=window.localStorage.getItem(i);if(!a){const e=["tag_current_user_id","currentUserId","user_id","tag.userId"];for(const t of e){const e=window.localStorage.getItem(t);if(e){console.log("[currentUser] Migrating from old key: ".concat(t," = ").concat(e)),a=e,window.localStorage.setItem(i,e),window.localStorage.removeItem(t);break}}}if(!a&&"undefined"!==typeof window)try{if(window.supabase)try{var e;const{data:{session:t}}=window.supabase.auth.getSession();null!==t&&void 0!==t&&null!==(e=t.user)&&void 0!==e&&e.id&&(console.log("[currentUser] Got user ID from global Supabase session:",t.user.id),a=t.user.id,window.localStorage.setItem(i,a))}catch(o){console.warn("[currentUser] Failed to get Supabase session:",o)}if(!a)try{var t;const{supabase:e}=await Promise.resolve().then(r.bind(r,32)),{data:{session:o}}=await e.auth.getSession();null!==o&&void 0!==o&&null!==(t=o.user)&&void 0!==t&&t.id&&(console.log("[currentUser] Got user ID from imported Supabase client:",o.user.id),a=o.user.id,window.localStorage.setItem(i,a))}catch(o){console.warn("[currentUser] Failed to get Supabase session from imported client:",o)}}catch(o){console.warn("[currentUser] Failed to get global Supabase session:",o)}return a||console.log("[currentUser] No user ID found, returning null"),a}catch(o){return console.warn("Failed to get current user ID:",o),null}},c=async()=>{if("undefined"!==typeof window&&window.__authContextUser)return console.log("[getCurrentUser] Using AuthContext user"),window.__authContextUser;try{const{supabase:o}=await Promise.resolve().then(r.bind(r,32)),{data:{user:s},error:n}=await o.auth.getUser();if(n)console.warn("[getCurrentUser] Supabase auth error:",n.message);else if(s){var e,t,a;return console.log("[getCurrentUser] Using Supabase user"),{id:s.id,email:s.email,name:(null===(e=s.user_metadata)||void 0===e?void 0:e.name)||(null===(t=s.email)||void 0===t?void 0:t.split("@")[0]),avatar:null===(a=s.user_metadata)||void 0===a?void 0:a.avatar_url,role:"artist",isVerified:!!s.email_confirmed_at}}}catch(u){console.warn("[getCurrentUser] Failed to get Supabase user:",u)}const i=await l();if(!i)return console.log("[getCurrentUser] No userId found, returning null"),null;const c=(0,n.ug)(i);if(!c)return console.log("[getCurrentUser] No user info found for userId: ".concat(i,", returning null")),null;if("undefined"!==typeof window)try{const e=window.localStorage.getItem("tag.avatars.".concat(i));if(e){const t=JSON.parse(e);if(t&&t.avatarUrl)return(0,o.A)((0,o.A)({},c),{},{avatar:t.avatarUrl})}}catch(u){console.warn("[getCurrentUser] Failed to read avatar data:",u)}const d=(0,s.EP)(i);return d?(0,o.A)((0,o.A)({},c),{},{avatar:d}):(c.avatar&&(0,s.Ih)(i,c.avatar),c)},d=async e=>{await async function(e){try{if("undefined"===typeof window)return;await a.IG.setItem(i,e)}catch(t){console.warn("Failed to write current user ID:",t)}}(e),"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("user:changed",{detail:{userId:e}}))},u=async()=>{try{const{getUnifiedAvatar:e}=await Promise.resolve().then(r.bind(r,313)),t=await l();if(t){const r=await e(t);if(r)return console.log("[getCurrentUserAvatar] Got avatar from unified service: ".concat(t)),r}const o=await c();return(null===o||void 0===o?void 0:o.avatar)||null}catch(e){console.warn("[getCurrentUserAvatar] Error getting unified avatar:",e);const t=await c();return(null===t||void 0===t?void 0:t.avatar)||null}},h=async()=>{try{if("undefined"!==typeof window)try{var e;const{supabase:t}=await Promise.resolve().then(r.bind(r,32)),{data:{session:o}}=await t.auth.getSession();if(null!==o&&void 0!==o&&null!==(e=o.user)&&void 0!==e&&e.id)return console.log("[currentUser] Got user ID from Supabase session:",o.user.id),await d(o.user.id),o.user.id}catch(t){console.warn("[currentUser] Failed to get Supabase session:",t)}return l()}catch(t){return console.warn("Failed to get current user ID async:",t),null}}},32:(e,t,r)=>{"use strict";r.d(t,{B:()=>tr,supabase:()=>er});class o extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",r=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=r}}class a extends o{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class s extends o{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class n extends o{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var i;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(i||(i={}));var l=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};class c{constructor(e){let{headers:t={},customFetch:o,region:a=i.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=a,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}})(o)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;return l(this,void 0,void 0,function*(){try{const{headers:o,method:i,body:l}=t;let c={},{region:d}=t;d||(d=this.region);const u=new URL("".concat(this.url,"/").concat(e));let h;d&&"any"!==d&&(c["x-region"]=d,u.searchParams.set("forceFunctionRegion",d)),l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",h=l):"string"===typeof l?(c["Content-Type"]="text/plain",h=l):"undefined"!==typeof FormData&&l instanceof FormData?h=l:(c["Content-Type"]="application/json",h=JSON.stringify(l)));const m=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),o),body:h}).catch(e=>{throw new a(e)}),p=m.headers.get("x-relay-error");if(p&&"true"===p)throw new s(m);if(!m.ok)throw new n(m);let g,f=(null!==(r=m.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return g="application/json"===f?yield m.json():"application/octet-stream"===f?yield m.blob():"text/event-stream"===f?m:"multipart/form-data"===f?yield m.formData():yield m.text(),{data:g,error:null,response:m}}catch(o){return{data:null,error:o,response:o instanceof n||o instanceof s?o.context:void 0}}})}}var d=r(980);const{PostgrestClient:u,PostgrestQueryBuilder:h,PostgrestFilterBuilder:m,PostgrestTransformBuilder:p,PostgrestBuilder:g,PostgrestError:f}=d;const v=class{static detectEnvironment(){var e;if("undefined"!==typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!==typeof r.g&&"undefined"!==typeof r.g.WebSocket)return{type:"native",constructor:r.g.WebSocket};if("undefined"!==typeof globalThis&&"undefined"!==typeof globalThis.WebSocketPair&&"undefined"===typeof globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!==typeof globalThis&&globalThis.EdgeRuntime||"undefined"!==typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!==typeof process&&process.versions&&process.versions.node){const e=parseInt(process.versions.node.split(".")[0]);return e>=22?"undefined"!==typeof globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:"Node.js ".concat(e," detected but native WebSocket not found."),workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:"Node.js ".concat(e," detected without native WebSocket support."),workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+="\n\nSuggested solution: ".concat(e.workaround)),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}},x="realtime-js/".concat("2.15.4"),b=1e4;var y,w,j,k,S,N;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(y||(y={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(w||(w={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(j||(j={})),function(e){e.websocket="websocket"}(k||(k={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(S||(S={}));class C{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const o=t.getUint8(1),a=t.getUint8(2);let s=this.HEADER_LENGTH+2;const n=r.decode(e.slice(s,s+o));s+=o;const i=r.decode(e.slice(s,s+a));s+=a;return{ref:null,topic:n,event:i,payload:JSON.parse(r.decode(e.slice(s,e.byteLength)))}}}class _{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(N||(N={}));const A=function(e,t){var r;const o=null!==(r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((r,a)=>(r[a]=I(a,e,t,o),r),{})},I=(e,t,r,o)=>{const a=t.find(t=>t.name===e),s=null===a||void 0===a?void 0:a.type,n=r[e];return s&&!o.includes(s)?P(s,n):E(n)},P=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return M(t,r)}switch(e){case N.bool:return D(t);case N.float4:case N.float8:case N.int2:case N.int4:case N.int8:case N.numeric:case N.oid:return L(t);case N.json:case N.jsonb:return T(t);case N.timestamp:return F(t);case N.abstime:case N.date:case N.daterange:case N.int4range:case N.int8range:case N.money:case N.reltime:case N.text:case N.time:case N.timestamptz:case N.timetz:case N.tsrange:case N.tstzrange:default:return E(t)}},E=e=>e,D=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},L=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},T=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},M=(e,t)=>{if("string"!==typeof e)return e;const r=e.length-1,o=e[r];if("{"===e[0]&&"}"===o){let o;const s=e.slice(1,r);try{o=JSON.parse("["+s+"]")}catch(a){o=s?s.split(","):[]}return o.map(e=>P(t,e))}return e},F=e=>"string"===typeof e?e.replace(" ","T"):e,R=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class O{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b;this.channel=e,this.event=t,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:r}=e;this.recHooks.filter(e=>e.status===t).forEach(e=>e.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var U,z,W,B;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(U||(U={}));class G{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=G.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=G.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=G.syncDiff(this.state,e,t,r),o())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,o){const a=this.cloneDeep(e),s=this.transformState(t),n={},i={};return this.map(a,(e,t)=>{s[e]||(i[e]=t)}),this.map(s,(e,t)=>{const r=a[e];if(r){const o=t.map(e=>e.presence_ref),a=r.map(e=>e.presence_ref),s=t.filter(e=>a.indexOf(e.presence_ref)<0),l=r.filter(e=>o.indexOf(e.presence_ref)<0);s.length>0&&(n[e]=s),l.length>0&&(i[e]=l)}else n[e]=t}),this.syncDiff(a,{joins:n,leaves:i},r,o)}static syncDiff(e,t,r,o){const{joins:a,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(a,(t,o)=>{var a;const s=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(o),s.length>0){const r=e[t].map(e=>e.presence_ref),o=s.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...o)}r(t,s,o)}),this.map(s,(t,r)=>{let a=e[t];if(!a)return;const s=r.map(e=>e.presence_ref);a=a.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=a,o(t,a,r),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const o=e[r];return t[r]="metas"in o?o.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(z||(z={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(W||(W={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(B||(B={}));class H{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},r=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=w.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new O(this,j.join,this.params,this.timeout),this.rejoinTimer=new _(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=w.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=w.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=w.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=w.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=w.errored,this.rejoinTimer.scheduleTimeout())}),this._on(j.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new G(this),this.broadcastEndpointURL=R(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var r,o,a;if(this.socket.isConnected()||this.socket.connect(),this.state==w.closed){const{config:{broadcast:s,presence:n,private:i}}=this.params,l=null!==(o=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==o?o:[],c=!!this.bindings[W.PRESENCE]&&this.bindings[W.PRESENCE].length>0||!0===(null===(a=this.params.config.presence)||void 0===a?void 0:a.enabled),d={},u={broadcast:s,presence:Object.assign(Object.assign({},n),{enabled:c}),postgres_changes:l,private:i};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(t=>null===e||void 0===e?void 0:e(B.CHANNEL_ERROR,t)),this._onClose(()=>null===e||void 0===e?void 0:e(B.CLOSED)),this.updateJoinPayload(Object.assign({config:u},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async t=>{let{postgres_changes:r}=t;var o;if(this.socket.setAuth(),void 0!==r){const t=this.bindings.postgres_changes,a=null!==(o=null===t||void 0===t?void 0:t.length)&&void 0!==o?o:0,s=[];for(let o=0;o<a;o++){const a=t[o],{filter:{event:n,schema:i,table:l,filter:c}}=a,d=r&&r[o];if(!d||d.event!==n||d.schema!==i||d.table!==l||d.filter!==c)return this.unsubscribe(),this.state=w.errored,void(null===e||void 0===e||e(B.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=s,void(e&&e(B.SUBSCRIBED))}null===e||void 0===e||e(B.SUBSCRIBED)}).receive("error",t=>{this.state=w.errored,null===e||void 0===e||e(B.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null===e||void 0===e||e(B.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===w.joined&&e===W.PRESENCE&&(this.socket.log("channel","resubscribe to ".concat(this.topic," due to change in presence callbacks on joined channel")),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r,o;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var o,a,s;const n=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(a=null===(o=this.params)||void 0===o?void 0:o.config)||void 0===a?void 0:a.broadcast)||void 0===s?void 0:s.ack)||r("ok"),n.receive("ok",()=>r("ok")),n.receive("error",()=>r("error")),n.receive("timeout",()=>r("timed out"))});{const{event:s,payload:n}=e,i={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:n,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(o=e.body)||void 0===o?void 0:o.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=w.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(j.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new O(this,j.leave,{},e),r.receive("ok",()=>{t(),o("ok")}).receive("timeout",()=>{t(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null===r||void 0===r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=w.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const o=new AbortController,a=setTimeout(()=>o.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(a),s}_push(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let o=new O(this,e,t,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel","discarded push due to buffer overflow: ".concat(e.event),e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var o,a;const s=e.toLocaleLowerCase(),{close:n,error:i,leave:l,join:c}=j;if(r&&[n,i,l,c].indexOf(s)>=0&&r!==this._joinRef())return;let d=this._onMessage(s,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(o=this.bindings.postgres_changes)||void 0===o||o.filter(e=>{var t,r,o;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(o=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===o?void 0:o.toLocaleLowerCase())===s}).map(e=>e.callback(d,r)):null===(a=this.bindings[s])||void 0===a||a.filter(e=>{var r,o,a,n,i,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,n=null===(r=e.filter)||void 0===r?void 0:r.event;return s&&(null===(o=t.ids)||void 0===o?void 0:o.includes(s))&&("*"===n||(null===n||void 0===n?void 0:n.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const r=null===(i=null===(n=null===e||void 0===e?void 0:e.filter)||void 0===n?void 0:n.event)||void 0===i?void 0:i.toLocaleLowerCase();return"*"===r||r===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:r,commit_timestamp:o,type:a,errors:s}=e,n={schema:t,table:r,commit_timestamp:o,eventType:a,new:{},old:{},errors:s};d=Object.assign(Object.assign({},n),this._getPayloadRecords(e))}e.callback(d,r)})}_isClosed(){return this.state===w.closed}_isJoined(){return this.state===w.joined}_isJoining(){return this.state===w.joining}_isLeaving(){return this.state===w.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,r){const o=e.toLocaleLowerCase(),a={type:o,filter:t,callback:r};return this.bindings[o]?this.bindings[o].push(a):this.bindings[o]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var o;return!((null===(o=e.type)||void 0===o?void 0:o.toLocaleLowerCase())===r&&H.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(j.close,{},e)}_onError(e){this._on(j.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=w.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=A(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=A(e.columns,e.old_record)),t}}const q=()=>{},V=25e3,J=10,Z=100,K=[1e3,2e3,5e3,1e4];class Y{constructor(e,t){var o;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=b,this.transport=null,this.heartbeatIntervalMs=V,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=q,this.ref=0,this.reconnectTimer=null,this.logger=q,this.conn=null,this.sendBuffer=[],this.serializer=new C,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)}).catch(e=>{throw new Error("Failed to load @supabase/node-fetch: ".concat(e.message,". ")+"This is required for HTTP requests in Node.js environments without native fetch.")})}:fetch),function(){return t(...arguments)}},!(null===(o=null===t||void 0===t?void 0:t.params)||void 0===o?void 0:o.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint="".concat(e,"/").concat(k.websocket),this.httpEndpoint=R(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=v.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;if(t.includes("Node.js"))throw new Error("".concat(t,"\n\n")+'To use Realtime in Node.js, you need to provide a WebSocket implementation:\n\nOption 1: Use Node.js 22+ which has native WebSocket support\nOption 2: Install and provide the "ws" package:\n\n  npm install ws\n\n  import ws from "ws"\n  const client = new RealtimeClient(url, {\n    ...options,\n    transport: ws\n  })');throw new Error("WebSocket not available: ".concat(t))}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case y.connecting:return S.Connecting;case y.open:return S.Open;case y.closing:return S.Closing;default:return S.Closed}}isConnected(){return this.connectionState()===S.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const r="realtime:".concat(e),o=this.getChannels().find(e=>e.topic===r);if(o)return o;{const r=new H("realtime:".concat(e),t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:o,ref:a}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push","".concat(t," ").concat(r," (").concat(a,")"),o),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}return this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},Z)}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}else try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event)try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error")}catch(i){this.log("error","error in heartbeat callback",i)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:o,ref:a}=e,s=a?"(".concat(a,")"):"",n=o.status||"";this.log("receive","".concat(n," ").concat(t," ").concat(r," ").concat(s).trim(),o),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,o,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport","".concat(e)),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(j.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return"".concat(e).concat(r).concat(o)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e=t||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(t=>{const r={access_token:e,version:x};e&&t.updateJoinPayload(r),t.joinedOnce&&t._isJoined()&&t._push(j.access_token,{access_token:e})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general";this.setAuth().catch(t=>{this.log("error","error setting auth in ".concat(e),t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(o){this.log("error","error in ".concat(e," callback"),o)}})}catch(r){this.log("error","error triggering ".concat(e," callbacks"),r)}}_setupReconnectionTimer(){this.reconnectTimer=new _(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},J)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,o,a,s,n,i,l,c;if(this.transport=null!==(t=null===e||void 0===e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null===e||void 0===e?void 0:e.timeout)&&void 0!==r?r:b,this.heartbeatIntervalMs=null!==(o=null===e||void 0===e?void 0:e.heartbeatIntervalMs)&&void 0!==o?o:V,this.worker=null!==(a=null===e||void 0===e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(s=null===e||void 0===e?void 0:e.accessToken)&&void 0!==s?s:null,this.heartbeatCallback=null!==(n=null===e||void 0===e?void 0:e.heartbeatCallback)&&void 0!==n?n:q,(null===e||void 0===e?void 0:e.params)&&(this.params=e.params),(null===e||void 0===e?void 0:e.logger)&&(this.logger=e.logger),((null===e||void 0===e?void 0:e.logLevel)||(null===e||void 0===e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(i=null===e||void 0===e?void 0:e.reconnectAfterMs)&&void 0!==i?i:e=>K[e-1]||1e4,this.encode=null!==(l=null===e||void 0===e?void 0:e.encode)&&void 0!==l?l:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(c=null===e||void 0===e?void 0:e.decode)&&void 0!==c?c:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null===e||void 0===e?void 0:e.workerUrl}}}class Q extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function $(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class X extends Q{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ee extends Q{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var te=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};const re=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}},oe=e=>{if(Array.isArray(e))return e.map(e=>oe(e));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(e=>{let[r,o]=e;const a=r.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[a]=oe(o)}),t};var ae=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};const se=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ne=(e,t,o)=>ae(void 0,void 0,void 0,function*(){const a=yield te(void 0,void 0,void 0,function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(r.bind(r,630))).Response:Response});e instanceof a&&!(null===o||void 0===o?void 0:o.noResolveJson)?e.json().then(r=>{const o=e.status||500,a=(null===r||void 0===r?void 0:r.statusCode)||o+"";t(new X(se(r),o,a))}).catch(e=>{t(new ee(se(e),e))}):t(new ee(se(e),e))}),ie=(e,t,r,o)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"!==e&&o?((e=>{if("object"!==typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)})(o)?(a.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(o)):a.body=o,(null===t||void 0===t?void 0:t.duplex)&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r)):a};function le(e,t,r,o,a,s){return ae(this,void 0,void 0,function*(){return new Promise((n,i)=>{e(r,ie(t,o,a,s)).then(e=>{if(!e.ok)throw e;return(null===o||void 0===o?void 0:o.noResolveJson)?e:e.json()}).then(e=>n(e)).catch(e=>ne(e,i,o))})})}function ce(e,t,r,o){return ae(this,void 0,void 0,function*(){return le(e,"GET",t,r,o)})}function de(e,t,r,o,a){return ae(this,void 0,void 0,function*(){return le(e,"POST",t,o,a,r)})}function ue(e,t,r,o,a){return ae(this,void 0,void 0,function*(){return le(e,"PUT",t,o,a,r)})}function he(e,t,r,o,a){return ae(this,void 0,void 0,function*(){return le(e,"DELETE",t,o,a,r)})}var me=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};const pe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ge={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class fe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=r,this.fetch=re(o)}uploadOrUpdate(e,t,r,o){return me(this,void 0,void 0,function*(){try{let a;const s=Object.assign(Object.assign({},ge),o);let n=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const i=s.metadata;"undefined"!==typeof Blob&&r instanceof Blob?(a=new FormData,a.append("cacheControl",s.cacheControl),i&&a.append("metadata",this.encodeMetadata(i)),a.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(a=r,a.append("cacheControl",s.cacheControl),i&&a.append("metadata",this.encodeMetadata(i))):(a=r,n["cache-control"]="max-age=".concat(s.cacheControl),n["content-type"]=s.contentType,i&&(n["x-metadata"]=this.toBase64(this.encodeMetadata(i)))),(null===o||void 0===o?void 0:o.headers)&&(n=Object.assign(Object.assign({},n),o.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield("PUT"==e?ue:de)(this.fetch,"".concat(this.url,"/object/").concat(c),a,Object.assign({headers:n},(null===s||void 0===s?void 0:s.duplex)?{duplex:s.duplex}:{}));return{data:{path:l,id:d.Id,fullPath:d.Key},error:null}}catch(a){if($(a))return{data:null,error:a};throw a}})}upload(e,t,r){return me(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,o){return me(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),s=this._getFinalPath(a),n=new URL(this.url+"/object/upload/sign/".concat(s));n.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ge.upsert},o),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!==typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,s["cache-control"]="max-age=".concat(t.cacheControl),s["content-type"]=t.contentType);return{data:{path:a,fullPath:(yield ue(this.fetch,n.toString(),e,{headers:s})).Key},error:null}}catch(i){if($(i))return{data:null,error:i};throw i}})}createSignedUploadUrl(e,t){return me(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(o["x-upsert"]="true");const a=yield de(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(r),{},{headers:o}),s=new URL(this.url+a.url),n=s.searchParams.get("token");if(!n)throw new Q("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:n},error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}update(e,t,r){return me(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return me(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if($(o))return{data:null,error:o};throw o}})}copy(e,t,r){return me(this,void 0,void 0,function*(){try{return{data:{path:(yield de(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===r||void 0===r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if($(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,r){return me(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),a=yield de(this.fetch,"".concat(this.url,"/object/sign/").concat(o),Object.assign({expiresIn:t},(null===r||void 0===r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const s=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return a={signedUrl:encodeURI("".concat(this.url).concat(a.signedURL).concat(s))},{data:a,error:null}}catch(o){if($(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,r){return me(this,void 0,void 0,function*(){try{const o=yield de(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),a=(null===r||void 0===r?void 0:r.download)?"&download=".concat(!0===r.download?"":r.download):"";return{data:o.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(a)):null})),error:null}}catch(o){if($(o))return{data:null,error:o};throw o}})}download(e,t){return me(this,void 0,void 0,function*(){const r="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",o=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),a=o?"?".concat(o):"";try{const t=this._getFinalPath(e),o=yield ce(this.fetch,"".concat(this.url,"/").concat(r,"/").concat(t).concat(a),{headers:this.headers,noResolveJson:!0});return{data:yield o.blob(),error:null}}catch(s){if($(s))return{data:null,error:s};throw s}})}info(e){return me(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield ce(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:oe(e),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}exists(e){return me(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,o){return ae(this,void 0,void 0,function*(){return le(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),o)})}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(r){if($(r)&&r instanceof ee){const e=r.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),o=[],a=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==a&&o.push(a);const s="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",n=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==n&&o.push(n);let i=o.join("&");return""!==i&&(i="?".concat(i)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(s,"/public/").concat(r).concat(i))}}}remove(e){return me(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}list(e,t,r){return me(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},pe),t),{prefix:e||""});return{data:yield de(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),o,{headers:this.headers},r),error:null}}catch(o){if($(o))return{data:null,error:o};throw o}})}listV2(e,t){return me(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield de(this.fetch,"".concat(this.url,"/object/list-v2/").concat(this.bucketId),r,{headers:this.headers},t),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e.replace(/^\/+/,""))}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const ve={"X-Client-Info":"storage-js/".concat("2.11.0")};var xe=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};class be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;const a=new URL(e);if(null===o||void 0===o?void 0:o.useNewHostname){/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."))}this.url=a.href,this.headers=Object.assign(Object.assign({},ve),t),this.fetch=re(r)}listBuckets(){return xe(this,void 0,void 0,function*(){try{return{data:yield ce(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if($(e))return{data:null,error:e};throw e}})}getBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield ce(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return xe(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return xe(this,void 0,void 0,function*(){try{return{data:yield ue(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if($(r))return{data:null,error:r};throw r}})}emptyBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield de(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}deleteBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield he(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if($(t))return{data:null,error:t};throw t}})}}class ye extends be{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0,arguments.length>3?arguments[3]:void 0)}from(e){return new fe(this.url,this.headers,e,this.fetch)}}let we="";we="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const je={headers:{"X-Client-Info":"supabase-js-".concat(we,"/").concat("2.56.1")}},ke={schema:"public"},Se={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ne={};var Ce=r(630),_e=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};const Ae=e=>{let t;return t=e||("undefined"===typeof fetch?Ce.default:fetch),function(){return t(...arguments)}},Ie=(e,t,r)=>{const o=Ae(r),a="undefined"===typeof Headers?Ce.Headers:Headers;return(r,s)=>_e(void 0,void 0,void 0,function*(){var n;const i=null!==(n=yield t())&&void 0!==n?n:e;let l=new a(null===s||void 0===s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(i)),o(r,Object.assign(Object.assign({},s),{headers:l}))})};var Pe=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};const Ee="2.71.1",De=3e4,Le=9e4,Te={"X-Client-Info":"gotrue-js/".concat(Ee)},Me="X-Supabase-Api-Version",Fe={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Re=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Oe extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Ue(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class ze extends Oe{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class We extends Oe{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Be extends Oe{constructor(e,t,r,o){super(e,r,o),this.name=t,this.status=r}}class Ge extends Be{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class He extends Be{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qe extends Be{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ve extends Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Je extends Be{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ze extends Be{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ke(e){return Ue(e)&&"AuthRetryableFetchError"===e.name}class Ye extends Be{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class Qe extends Be{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const $e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xe=" \t\n\r=".split(""),et=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Xe.length;t+=1)e[Xe[t].charCodeAt(0)]=-2;for(let t=0;t<$e.length;t+=1)e[$e[t].charCodeAt(0)]=t;return e})();function tt(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r($e[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r($e[e]),t.queuedBits-=6}}function rt(e,t,r){const o=et[e];if(!(o>-1)){if(-2===o)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|o,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function ot(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},o={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(0===(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,o,r)};for(let n=0;n<e.length;n+=1)rt(e.charCodeAt(n),a,s);return t.join("")}function at(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function st(e,t){for(let r=0;r<e.length;r+=1){let o=e.charCodeAt(r);if(o>55295&&o<=56319){const t=1024*(o-55296)&65535;o=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}at(o,t)}}function nt(e){const t=[],r={queue:0,queuedBits:0},o=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)rt(e.charCodeAt(a),r,o);return new Uint8Array(t)}function it(e){const t=[],r={queue:0,queuedBits:0},o=e=>{t.push(e)};return e.forEach(e=>tt(e,r,o)),tt(null,r,o),t.join("")}const lt=()=>"undefined"!==typeof window&&"undefined"!==typeof document,ct={tested:!1,writable:!1},dt=()=>{if(!lt())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(ct.tested)return ct.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ct.tested=!0,ct.writable=!0}catch(t){ct.tested=!0,ct.writable=!1}return ct.writable};const ut=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return Promise.resolve().then(r.bind(r,630)).then(e=>{let{default:r}=e;return r(...t)})}:fetch),function(){return t(...arguments)}},ht=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},mt=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(o){return r}},pt=async(e,t)=>{await e.removeItem(t)};class gt{constructor(){this.promise=new gt.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function ft(e){const t=e.split(".");if(3!==t.length)throw new Qe("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Re.test(t[r]))throw new Qe("JWT not in base64url format");return{header:JSON.parse(ot(t[0])),payload:JSON.parse(ot(t[1])),signature:nt(t[2]),raw:{header:t[0],payload:t[1]}}}function vt(e){return("0"+e.toString(16)).substr(-2)}async function xt(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(r);return Array.from(o).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function bt(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const o=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let o=0;o<56;o++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,vt).join("")}();let a=o;r&&(a+="/PASSWORD_RECOVERY"),await ht(e,"".concat(t,"-code-verifier"),a);const s=await xt(o);return[s,o===s?"plain":"s256"]}gt.promiseConstructor=Promise;const yt=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const wt=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function jt(e){if(!wt.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function kt(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"===typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "'.concat(t,'" property of the session object is not supported. Please use getUser() instead.'))},set:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))},deleteProperty:(e,t)=>{throw new Error('@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "'.concat(t,'" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.'))}})}function St(e){return JSON.parse(JSON.stringify(e))}var Nt=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(r[o[a]]=e[o[a]])}return r};const Ct=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),_t=[502,503,504];async function At(e){var t,r;if(!("object"===typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"===typeof r.json))throw new Ze(Ct(e),0);if(_t.includes(e.status))throw new Ze(Ct(e),e.status);let o,a;try{o=await e.json()}catch(n){throw new We(Ct(n),n)}const s=function(e){const t=e.headers.get(Me);if(!t)return null;if(!t.match(yt))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(n){return null}}(e);if(s&&s.getTime()>=Fe.timestamp&&"object"===typeof o&&o&&"string"===typeof o.code?a=o.code:"object"===typeof o&&o&&"string"===typeof o.error_code&&(a=o.error_code),a){if("weak_password"===a)throw new Ye(Ct(o),e.status,(null===(t=o.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Ge}else if("object"===typeof o&&o&&"object"===typeof o.weak_password&&o.weak_password&&Array.isArray(o.weak_password.reasons)&&o.weak_password.reasons.length&&o.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0))throw new Ye(Ct(o),e.status,o.weak_password.reasons);throw new ze(Ct(o),e.status||500,a)}async function It(e,t,r,o){var a;const s=Object.assign({},null===o||void 0===o?void 0:o.headers);s[Me]||(s[Me]=Fe.name),(null===o||void 0===o?void 0:o.jwt)&&(s.Authorization="Bearer ".concat(o.jwt));const n=null!==(a=null===o||void 0===o?void 0:o.query)&&void 0!==a?a:{};(null===o||void 0===o?void 0:o.redirectTo)&&(n.redirect_to=o.redirectTo);const i=Object.keys(n).length?"?"+new URLSearchParams(n).toString():"",l=await async function(e,t,r,o,a,s){const n=((e,t,r,o)=>{const a={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),a.body=JSON.stringify(o),Object.assign(Object.assign({},a),r))})(t,o,a,s);let i;try{i=await e(r,Object.assign({},n))}catch(l){throw console.error(l),new Ze(Ct(l),0)}i.ok||await At(i);if(null===o||void 0===o?void 0:o.noResolveJson)return i;try{return await i.json()}catch(l){await At(l)}}(e,t,r+i,{headers:s,noResolveJson:null===o||void 0===o?void 0:o.noResolveJson},{},null===o||void 0===o?void 0:o.body);return(null===o||void 0===o?void 0:o.xform)?null===o||void 0===o?void 0:o.xform(l):{data:Object.assign({},l),error:null}}function Pt(e){var t;let r=null;var o;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(o=e.expires_in,Math.round(Date.now()/1e3)+o)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Et(e){const t=Pt(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"===typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Dt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Lt(e){return{data:e,error:null}}function Tt(e){const{action_link:t,email_otp:r,hashed_token:o,redirect_to:a,verification_type:s}=e,n=Nt(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:o,redirect_to:a,verification_type:s},user:Object.assign({},n)},error:null}}function Mt(e){return e}const Ft=["global","local","others"];var Rt=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(r[o[a]]=e[o[a]])}return r};class Ot{constructor(e){let{url:t="",headers:r={},fetch:o}=e;this.url=t,this.headers=r,this.fetch=ut(o),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ft[0];if(Ft.indexOf(t)<0)throw new Error("@supabase/auth-js: Parameter scope must be one of ".concat(Ft.join(", ")));try{return await It(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ue(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await It(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Dt})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Rt(e,["options"]),o=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(o.new_email=null===r||void 0===r?void 0:r.newEmail,delete o.newEmail),await It(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:o,headers:this.headers,xform:Tt,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Ue(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await It(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:Dt})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,o,a,s,n,i;try{const l={nextPage:null,lastPage:0,total:0},c=await It(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(o=null===e||void 0===e?void 0:e.perPage)||void 0===o?void 0:o.toString())&&void 0!==a?a:""},xform:Mt});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(i=null===(n=c.headers.get("link"))||void 0===n?void 0:n.split(","))&&void 0!==i?i:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(r,"Page")]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ue(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){jt(e);try{return await It(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:Dt})}catch(t){if(Ue(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){jt(e);try{return await It(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:Dt})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];jt(e);try{return await It(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:Dt})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){jt(e.userId);try{const{data:t,error:r}=await It(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _deleteFactor(e){jt(e.userId),jt(e.id);try{return{data:await It(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}}function Ut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const zt=!!(globalThis&&dt()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Wt extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Bt extends Wt{}async function Gt(e,t,r){zt&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const o=new globalThis.AbortController;return t>0&&setTimeout(()=>{o.abort(),zt&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:o.signal},async o=>{if(!o){if(0===t)throw zt&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Bt('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(zt)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}zt&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,o.name);try{return await r()}finally{zt&&console.log("@supabase/gotrue-js: navigatorLock: released",e,o.name)}}))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Ht={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Te,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function qt(e,t,r){return await r()}const Vt={};class Jt{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Jt.nextInstanceID,Jt.nextInstanceID+=1,this.instanceID>0&&lt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},Ht),e);if(this.logDebugMessages=!!o.debug,"function"===typeof o.debug&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Ot({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=ut(o.fetch),this.lock=o.lock||qt,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:lt()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Gt:this.lock=qt,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:dt()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ut(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Ut(this.memoryStorage)),lt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=Vt[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Vt[this.storageKey]=Object.assign(Object.assign({},Vt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Vt[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Vt[this.storageKey]=Object.assign(Object.assign({},Vt[this.storageKey]),{cachedAt:e})}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(Ee,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(o){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),lt()&&this.detectSessionInUrl&&"none"!==r){const{data:o,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return Ue(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:s,redirectType:n}=o;return this._debug("#_initialize()","detected session in URL",s,"redirect type",n),await this._saveSession(s),setTimeout(async()=>{"recovery"===n?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ue(t)?{error:t}:{error:new We("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,o;try{const a=await It(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(r=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(o=null===e||void 0===e?void 0:e.options)||void 0===o?void 0:o.captchaToken}},xform:Pt}),{data:s,error:n}=a;if(n||!s)return{data:{user:null,session:null},error:n};const i=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(a){if(Ue(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,r,o;try{let a;if("email"in e){const{email:r,password:o,options:s}=e;let n=null,i=null;"pkce"===this.flowType&&([n,i]=await bt(this.storage,this.storageKey)),a=await It(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo,body:{email:r,password:o,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:n,code_challenge_method:i},xform:Pt})}else{if(!("phone"in e))throw new qe("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:n}=e;a=await It(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:s,data:null!==(r=null===n||void 0===n?void 0:n.data)&&void 0!==r?r:{},channel:null!==(o=null===n||void 0===n?void 0:n.channel)&&void 0!==o?o:"sms",gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken}},xform:Pt})}}const{data:s,error:n}=a;if(n||!s)return{data:{user:null,session:null},error:n};const i=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(a){if(Ue(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:o,options:a}=e;t=await It(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:r,password:o,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:Et})}else{if(!("phone"in e))throw new qe("You must provide either an email or phone number and a password");{const{phone:r,password:o,options:a}=e;t=await It(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:r,password:o,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},xform:Et})}}const{data:r,error:o}=t;return o?{data:{user:null,session:null},error:o}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o}):{data:{user:null,session:null},error:new He}}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,o,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(o=e.options)||void 0===o?void 0:o.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error('@supabase/auth-js: Unsupported chain "'.concat(t,'"'))}async signInWithSolana(e){var t,r,o,a,s,n,i,l,c,d,u,h;let m,p;if("message"in e)m=e.message,p=e.signature;else{const{chain:u,wallet:h,statement:g,options:f}=e;let v;if(lt())if("object"===typeof h)v=h;else{const e=window;if(!("solana"in e)||"object"!==typeof e.solana||!("signIn"in e.solana&&"function"===typeof e.solana.signIn||"signMessage"in e.solana&&"function"===typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");v=e.solana}else{if("object"!==typeof h||!(null===f||void 0===f?void 0:f.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=h}const x=new URL(null!==(t=null===f||void 0===f?void 0:f.url)&&void 0!==t?t:window.location.href);if("signIn"in v&&v.signIn){const e=await v.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null===f||void 0===f?void 0:f.signInWithSolana),{version:"1",domain:x.host,uri:x.href}),g?{statement:g}:null));let t;if(Array.isArray(e)&&e[0]&&"object"===typeof e[0])t=e[0];else{if(!(e&&"object"===typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"===typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");m="string"===typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),p=t.signature}else{if(!("signMessage"in v)||"function"!==typeof v.signMessage||!("publicKey"in v)||"object"!==typeof v||!v.publicKey||!("toBase58"in v.publicKey)||"function"!==typeof v.publicKey.toBase58)throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=["".concat(x.host," wants you to sign in with your Solana account:"),v.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1","URI: ".concat(x.href),"Issued At: ".concat(null!==(o=null===(r=null===f||void 0===f?void 0:f.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==o?o:(new Date).toISOString()),...(null===(a=null===f||void 0===f?void 0:f.signInWithSolana)||void 0===a?void 0:a.notBefore)?["Not Before: ".concat(f.signInWithSolana.notBefore)]:[],...(null===(s=null===f||void 0===f?void 0:f.signInWithSolana)||void 0===s?void 0:s.expirationTime)?["Expiration Time: ".concat(f.signInWithSolana.expirationTime)]:[],...(null===(n=null===f||void 0===f?void 0:f.signInWithSolana)||void 0===n?void 0:n.chainId)?["Chain ID: ".concat(f.signInWithSolana.chainId)]:[],...(null===(i=null===f||void 0===f?void 0:f.signInWithSolana)||void 0===i?void 0:i.nonce)?["Nonce: ".concat(f.signInWithSolana.nonce)]:[],...(null===(l=null===f||void 0===f?void 0:f.signInWithSolana)||void 0===l?void 0:l.requestId)?["Request ID: ".concat(f.signInWithSolana.requestId)]:[],...(null===(d=null===(c=null===f||void 0===f?void 0:f.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...f.signInWithSolana.resources.map(e=>"- ".concat(e))]:[]].join("\n");const e=await v.signMessage((new TextEncoder).encode(m),"utf8");if(!e||!(e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=e}}try{const{data:t,error:r}=await It(this.fetch,"POST","".concat(this.url,"/token?grant_type=web3"),{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:it(p)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:Pt});if(r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}):{data:{user:null,session:null},error:new He}}catch(g){if(Ue(g))return{data:{user:null,session:null},error:g};throw g}}async _exchangeCodeForSession(e){const t=await mt(this.storage,"".concat(this.storageKey,"-code-verifier")),[r,o]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:a}=await It(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Pt});if(await pt(this.storage,"".concat(this.storageKey,"-code-verifier")),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==o&&void 0!==o?o:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new He}}catch(a){if(Ue(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:o,access_token:a,nonce:s}=e,n=await It(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:r,id_token:o,access_token:a,nonce:s,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:Pt}),{data:i,error:l}=n;return l?{data:{user:null,session:null},error:l}:i&&i.session&&i.user?(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:i,error:l}):{data:{user:null,session:null},error:new He}}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,o,a,s;try{if("email"in e){const{email:o,options:a}=e;let s=null,n=null;"pkce"===this.flowType&&([s,n]=await bt(this.storage,this.storageKey));const{error:i}=await It(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:o,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(r=null===a||void 0===a?void 0:a.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:s,code_challenge_method:n},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:t,options:r}=e,{data:n,error:i}=await It(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(o=null===r||void 0===r?void 0:r.data)&&void 0!==o?o:{},create_user:null===(a=null===r||void 0===r?void 0:r.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null===r||void 0===r?void 0:r.captchaToken},channel:null!==(s=null===r||void 0===r?void 0:r.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null===n||void 0===n?void 0:n.message_id},error:i}}throw new qe("You must provide either an email or phone number.")}catch(n){if(Ue(n))return{data:{user:null,session:null},error:n};throw n}}async verifyOtp(e){var t,r;try{let o,a;"options"in e&&(o=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:s,error:n}=await It(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:o,xform:Pt});if(n)throw n;if(!s)throw new Error("An error occurred on token verification.");const i=s.session,l=s.user;return(null===i||void 0===i?void 0:i.access_token)&&(await this._saveSession(i),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",i)),{data:{user:l,session:i},error:null}}catch(o){if(Ue(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,r,o;try{let a=null,s=null;return"pkce"===this.flowType&&([a,s]=await bt(this.storage,this.storageKey)),await It(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(o=null===e||void 0===e?void 0:e.options)||void 0===o?void 0:o.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:s}),headers:this.headers,xform:Lt})}catch(a){if(Ue(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Ge;const{error:o}=await It(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(Ue(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:r,type:o,options:a}=e,{error:s}=await It(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}},redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:r,type:o,options:a}=e,{data:s,error:n}=await It(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null===s||void 0===s?void 0:s.message_id},error:n}}throw new qe("You must provide either an email or phone number and a type")}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock("lock:".concat(this.storageKey),e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await mt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<Le;if(this._debug("#__loadSession()","session has".concat(r?"":" not"," expired"),"expires_at",e.expires_at),!r){if(this.userStorage){const t=await mt(this.userStorage,this.storageKey+"-user");(null===t||void 0===t?void 0:t.user)?e.user=t.user:e.user=kt()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,o)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,o))})}return{data:{session:e},error:null}}const{session:o,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await It(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:Dt}):await this._useSession(async e=>{var t,r,o;const{data:a,error:s}=e;if(s)throw s;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await It(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(o=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==o?o:void 0,xform:Dt}):{data:{user:null},error:new Ge}})}catch(t){if(Ue(t))return function(e){return Ue(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await pt(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession(async r=>{const{data:o,error:a}=r;if(a)throw a;if(!o.session)throw new Ge;const s=o.session;let n=null,i=null;"pkce"===this.flowType&&null!=e.email&&([n,i]=await bt(this.storage,this.storageKey));const{data:l,error:c}=await It(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:n,code_challenge_method:i}),jwt:s.access_token,xform:Dt});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(r){if(Ue(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ge;const t=Date.now()/1e3;let r=t,o=!0,a=null;const{payload:s}=ft(e.access_token);if(s.exp&&(r=s.exp,o=r<=t),o){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:o,error:s}=await this._getUser(e.access_token);if(s)throw s;a={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Ue(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:a}=t;if(a)throw a;e=null!==(r=o.session)&&void 0!==r?r:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Ge;const{session:o,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ue(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!lt())throw new Ve("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ve(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Je("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Ve("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Je("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const o=new URL(window.location.href);return o.searchParams.delete("code"),window.history.replaceState(window.history.state,"",o.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:a,refresh_token:s,expires_in:n,expires_at:i,token_type:l}=e;if(!a||!n||!s||!l)throw new Ve("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(n);let u=c+d;i&&(u=parseInt(i));const h=u-c;1e3*h<=De&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(d,"s"));const m=u-d;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,u,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,u,c);const{data:p,error:g}=await this._getUser(a);if(g)throw g;const f={provider_token:r,provider_refresh_token:o,access_token:a,expires_in:d,expires_at:u,refresh_token:s,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:f,redirectType:e.type},error:null}}catch(r){if(Ue(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await mt(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession(async t=>{var r;const{data:o,error:a}=t;if(a)return{error:a};const s=null===(r=o.session)||void 0===r?void 0:r.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return Ue(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await pt(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,o;try{const{data:{session:o},error:a}=t;if(a)throw a;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(a){await(null===(o=this.stateChangeEmitters.get(e))||void 0===o?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null;"pkce"===this.flowType&&([r,o]=await bt(this.storage,this.storageKey,!0));try{return await It(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Ue(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:o}=await this._useSession(async t=>{var r,o,a,s,n;const{data:i,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(o=e.options)||void 0===o?void 0:o.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await It(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(n=null===(s=i.session)||void 0===s?void 0:s.access_token)&&void 0!==n?n:void 0})});if(o)throw o;return lt()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===r||void 0===r?void 0:r.url),{data:{provider:e.provider,url:null===r||void 0===r?void 0:r.url},error:null}}catch(r){if(Ue(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,o;const{data:a,error:s}=t;if(s)throw s;return await It(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(o=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==o?o:void 0})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const a=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await It(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:Pt})),o=(e,t)=>{const r=200*Math.pow(2,e);return t&&Ke(t)&&Date.now()+r-a<De},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await r(s);if(!o(s,null,t))return void e(t)}catch(a){if(!o(s,a))return void t(a)}})()}))}catch(a){if(this._debug(t,"error",a),Ue(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var r,o}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),lt()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await mt(this.storage,this.storageKey);if(a&&this.userStorage){let t=await mt(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await ht(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:kt()}else if(a&&!a.user&&!a.user){const e=await mt(this.storage,this.storageKey+"-user");e&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await pt(this.storage,this.storageKey+"-user"),await ht(this.storage,this.storageKey,a)):a.user=kt()}if(this._debug(r,"session from storage",a),!this._isValidSession(a))return this._debug(r,"session is not valid"),void(null!==a&&await this._removeSession());const s=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<Le;if(this._debug(r,"session has".concat(s?"":" not"," expired with margin of ").concat(Le,"s")),s){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(console.error(e),Ke(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null===e||void 0===e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return this._debug(r,"error",a),void console.error(a)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Ge;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(o,"begin");try{this.refreshingDeferred=new gt;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Ge;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const o={session:t.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(o,"error",a),Ue(a)){const e={session:null,error:a};return Ke(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o="#_notifyAllSubscribers(".concat(e,")");this._debug(o,"begin",t,"broadcast = ".concat(r));try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],a=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(a){o.push(a)}});if(await Promise.all(a),o.length>0){for(let e=0;e<o.length;e+=1)console.error(o[e]);throw o[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await ht(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const o=St(e);await ht(this.storage,this.storageKey,o)}else{const e=St(t);await ht(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await pt(this.storage,this.storageKey),await pt(this.storage,this.storageKey+"-code-verifier"),await pt(this.storage,this.storageKey+"-user"),this.userStorage&&await pt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&lt()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),De);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const o=Math.floor((1e3*r.expires_at-t)/De);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(o," ticks, a tick lasts ").concat(De,"ms, refresh threshold is ").concat(3," ticks")),o<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof Wt))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!lt()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const o=["provider=".concat(encodeURIComponent(t))];if((null===r||void 0===r?void 0:r.redirectTo)&&o.push("redirect_to=".concat(encodeURIComponent(r.redirectTo))),(null===r||void 0===r?void 0:r.scopes)&&o.push("scopes=".concat(encodeURIComponent(r.scopes))),"pkce"===this.flowType){const[e,t]=await bt(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});o.push(r.toString())}if(null===r||void 0===r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);o.push(e.toString())}return(null===r||void 0===r?void 0:r.skipBrowserRedirect)&&o.push("skip_http_redirect=".concat(r.skipBrowserRedirect)),"".concat(e,"?").concat(o.join("&"))}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:o,error:a}=t;return a?{data:null,error:a}:await It(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(r=null===o||void 0===o?void 0:o.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,o;const{data:a,error:s}=t;if(s)return{data:null,error:s};const n=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:i,error:l}=await It(this.fetch,"POST","".concat(this.url,"/factors"),{body:n,headers:this.headers,jwt:null===(r=null===a||void 0===a?void 0:a.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(o=null===i||void 0===i?void 0:i.totp)||void 0===o?void 0:o.qr_code)&&(i.totp.qr_code="data:image/svg+xml;utf-8,".concat(i.totp.qr_code)),{data:i,error:null})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:a}=t;if(a)return{data:null,error:a};const{data:s,error:n}=await It(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null===o||void 0===o?void 0:o.session)||void 0===r?void 0:r.access_token});return n?{data:null,error:n}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:n})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:a}=t;return a?{data:null,error:a}:await It(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null===o||void 0===o?void 0:o.session)||void 0===r?void 0:r.access_token})})}catch(t){if(Ue(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null===e||void 0===e?void 0:e.factors)||[],o=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),a=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:o,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:o},error:a}=e;if(a)return{data:null,error:a};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=ft(o.access_token);let n=null;s.aal&&(n=s.aal);let i=n;(null!==(r=null===(t=o.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(i="aal2");return{data:{currentLevel:n,nextLevel:i,currentAuthenticationMethods:s.amr||[]},error:null}}))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find(t=>t.kid===e);if(t)return t;const r=Date.now();if(t=this.jwks.keys.find(t=>t.kid===e),t&&this.jwks_cached_at+6e5>r)return t;const{data:o,error:a}=await It(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(a)throw a;return o.keys&&0!==o.keys.length?(this.jwks=o,this.jwks_cached_at=r,t=o.keys.find(t=>t.kid===e),t||null):null}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:o,payload:a,signature:s,raw:{header:n,payload:i}}=ft(r);(null===t||void 0===t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const l=o.alg&&!o.alg.startsWith("HS")&&o.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(o.kid,(null===t||void 0===t?void 0:t.keys)?{keys:t.keys}:null===t||void 0===t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:a,header:o,signature:s},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(o.alg),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,s,function(e){const t=[];return st(e,e=>t.push(e)),new Uint8Array(t)}("".concat(n,".").concat(i))))throw new Qe("Invalid JWT signature");return{data:{claims:a,header:o,signature:s},error:null}}catch(r){if(Ue(r))return{data:null,error:r};throw r}}}Jt.nextInstanceID=0;const Zt=Jt;class Kt extends Zt{constructor(e){super(e)}}var Yt=function(e,t,r,o){return new(r||(r=Promise))(function(a,s){function n(e){try{l(o.next(e))}catch(t){s(t)}}function i(e){try{l(o.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,i)}l((o=o.apply(e,t||[])).next())})};class Qt{constructor(e,t,r){var o,a,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const n=(i=e).endsWith("/")?i:i+"/";var i;const l=new URL(n);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c="sb-".concat(l.hostname.split(".")[0],"-auth-token"),d=function(e,t){var r,o;const{db:a,auth:s,realtime:n,global:i}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},d),n),storage:{},global:Object.assign(Object.assign(Object.assign({},u),i),{headers:Object.assign(Object.assign({},null!==(r=null===u||void 0===u?void 0:u.headers)&&void 0!==r?r:{}),null!==(o=null===i||void 0===i?void 0:i.headers)&&void 0!==o?o:{})}),accessToken:()=>Pe(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!==r&&void 0!==r?r:{},{db:ke,realtime:Ne,auth:Object.assign(Object.assign({},Se),{storageKey:c}),global:je});this.storageKey=null!==(o=d.auth.storageKey)&&void 0!==o?o:"",this.headers=null!==(a=d.global.headers)&&void 0!==a?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(s=d.auth)&&void 0!==s?s:{},this.headers,d.global.fetch),this.fetch=Ie(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new u(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new ye(this.storageUrl.href,this.headers,this.fetch,null===r||void 0===r?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,r)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Yt(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient(e,t,r){let{autoRefreshToken:o,persistSession:a,detectSessionInUrl:s,storage:n,storageKey:i,flowType:l,lock:c,debug:d}=e;const u={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Kt({url:this.authUrl.href,headers:Object.assign(Object.assign({},u),t),storageKey:i,autoRefreshToken:o,persistSession:a,detectSessionInUrl:s,storage:n,flowType:l,lock:c,debug:d,fetch:r,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new Y(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}(function(){if("undefined"!==typeof window)return!1;if("undefined"===typeof process)return!1;const e=process.version;if(void 0===e||null===e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("\u26a0\ufe0f  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const $t="https://ooaicpvsjmmxuccqlzuh.supabase.co",Xt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9vYWljcHZzam1teHVjY3FsenVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3NjIyNjQsImV4cCI6MjA3MjMzODI2NH0.-YXCVgkGIpu0eTDGCoiSgnF5IHhyIYMITaB-oMjFt7s";const er=((e,t,r)=>new Qt(e,t,r))($t||"https://placeholder.supabase.co",Xt||"placeholder-key"),tr=async()=>{try{const{data:{session:e},error:t}=await er.auth.getSession();return t?(console.warn("\u26a0\ufe0f Supabase\u8fde\u63a5\u5931\u8d25\uff0c\u5c06\u4f7f\u7528mock\u6570\u636e:",t.message),!1):(console.log("\u2705 Supabase\u8fde\u63a5\u6210\u529f"),console.log("\u2139\ufe0f \u5f53\u524d\u4f1a\u8bdd\u72b6\u6001:",e?"\u5df2\u8ba4\u8bc1":"\u672a\u8ba4\u8bc1"),!0)}catch(e){return console.warn("\u26a0\ufe0f Supabase\u8fde\u63a5\u68c0\u67e5\u5931\u8d25\uff0c\u5c06\u4f7f\u7528mock\u6570\u636e:",e.message),!1}}},43:(e,t,r)=>{"use strict";e.exports=r(202)},51:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var o=r(526);function a(e,t,r){return(t=(0,o.A)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}},77:(e,t,r)=>{"use strict";r.d(t,{isMock:()=>o,qm:()=>a});const o=()=>{var e,t;return"true"===({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9vYWljcHZzam1teHVjY3FsenVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY3NjIyNjQsImV4cCI6MjA3MjMzODI2NH0.-YXCVgkGIpu0eTDGCoiSgnF5IHhyIYMITaB-oMjFt7s",REACT_APP_SUPABASE_ENABLE_MOCK_DATA:"false",REACT_APP_SUPABASE_ENABLE_SUPABASE:"true",REACT_APP_SUPABASE_URL:"https://ooaicpvsjmmxuccqlzuh.supabase.co"}.REACT_APP_USE_MOCK_API||(null===(e={})||void 0===e||null===(t=e.env)||void 0===t?void 0:t.VITE_USE_MOCK_API))},a=()=>(o()?(console.log("\ud83d\udd27 \u5f53\u524d\u4f7f\u7528 Mock API \u6a21\u5f0f"),console.log("\ud83d\udca1 \u4f7f\u7528 localStorage \u6a21\u62df\u540e\u7aef\u529f\u80fd"),console.log("\ud83d\udcdd \u4e0a\u4f20\u548c\u5c55\u793a\u6d41\u7a0b\u5df2\u5b8c\u5168\u8dd1\u901a")):(console.log("\ud83d\udd27 \u5f53\u524d\u4f7f\u7528 Supabase \u540e\u7aef"),console.log("\ud83d\udca1 \u4f7f\u7528\u771f\u5b9e\u6570\u636e\u5e93\u548c\u5b58\u50a8")),!0)},106:(e,t,r)=>{"use strict";r.d(t,{localStorageAdapter:()=>n});const o="tag_artwork_likes",a=()=>{try{const e=localStorage.getItem(o);return e?JSON.parse(e):{}}catch(e){return console.warn("Failed to get stored like data:",e),{}}},s=async(e,t)=>{try{if(!e||!t)return{success:!1,error:"Missing artworkId or userId"};const r=a();r[e]||(r[e]={totalLikes:0,userLikes:[]});const s=r[e],n=s.userLikes.indexOf(t);let i=!1;return-1===n?(s.userLikes.push(t),s.totalLikes++,i=!0,console.log("[MockLike] User ".concat(t," liked artwork ").concat(e))):(s.userLikes.splice(n,1),s.totalLikes--,i=!1,console.log("[MockLike] User ".concat(t," unliked artwork ").concat(e))),(e=>{try{localStorage.setItem(o,JSON.stringify(e))}catch(t){console.warn("Failed to save like data:",t)}})(r),console.log("[MockLike] Artwork ".concat(e," total likes: ").concat(s.totalLikes)),{success:!0,data:{liked:i,likes:s.totalLikes}}}catch(r){return console.error("[MockLike] Error toggling like:",r),{success:!1,error:r.message}}},n={toggleArtworkLike:async(e,t)=>{try{const r=await s(e,t);return console.log("[localStorageAdapter] Toggled like for artwork ".concat(e)),r}catch(r){return console.error("[localStorageAdapter] Error toggling like:",r),{success:!1,error:r.message}}},checkUserLikeStatus:async(e,t)=>{try{const r=await(async(e,t)=>{try{if(!e||!t)return{success:!1,error:"Missing artworkId or userId"};const r=a()[e];return r?{success:!0,data:{liked:r.userLikes.includes(t),likes:r.totalLikes}}:{success:!0,data:{liked:!1,likes:0}}}catch(r){return console.error("[MockLike] Error checking like status:",r),{success:!1,error:r.message}}})(e,t);return console.log("[localStorageAdapter] Checked like status for artwork ".concat(e)),r}catch(r){return console.error("[localStorageAdapter] Error checking like status:",r),{success:!1,error:r.message}}},getArtworkLikeCount:async e=>{try{const t=await(async e=>{try{if(!e)return{success:!1,error:"Missing artworkId"};const t=a()[e];return{success:!0,data:{likes:t?t.totalLikes:0}}}catch(t){return console.error("[MockLike] Error getting like count:",t),{success:!1,error:t.message}}})(e);return console.log("[localStorageAdapter] Got like count for artwork ".concat(e)),t}catch(t){return console.error("[localStorageAdapter] Error getting like count:",t),{success:!1,error:t.message}}}}},153:(e,t,r)=>{"use strict";var o=r(43),a=Symbol.for("react.element"),s=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var o,s={},c=null,d=null;for(o in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)n.call(t,o)&&!l.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===s[o]&&(s[o]=t[o]);return{$$typeof:a,type:e,key:c,ref:d,props:s,_owner:i.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},179:(e,t,r)=>{"use strict";r.d(t,{IG:()=>d});var o=r(77),a=r(337),s=r(32);class n{async getItem(e){try{return localStorage.getItem(e)}catch(t){return console.warn("[LocalStorageAdapter] Failed to get ".concat(e,":"),t),null}}async setItem(e,t){try{return localStorage.setItem(e,t),!0}catch(r){return console.warn("[LocalStorageAdapter] Failed to set ".concat(e,":"),r),!1}}async removeItem(e){try{return localStorage.removeItem(e),!0}catch(t){return console.warn("[LocalStorageAdapter] Failed to remove ".concat(e,":"),t),!1}}async keys(){try{const e=[];for(let t=0;t<localStorage.length;t++){const r=localStorage.key(t);r&&e.push(r)}return e}catch(e){return console.warn("[LocalStorageAdapter] Failed to get keys:",e),[]}}async clear(){try{return localStorage.clear(),!0}catch(e){return console.warn("[LocalStorageAdapter] Failed to clear:",e),!1}}async init(){try{const e="__storage_test__";localStorage.setItem(e,"test");const t="test"===localStorage.getItem(e);return localStorage.removeItem(e),t}catch(e){return console.warn("[LocalStorageAdapter] Failed to initialize:",e),!1}}}class i{constructor(){this.bucketName="portfolio"}async init(){try{const{data:e,error:t}=await s.supabase.storage.listBuckets();return t?(console.warn("[SupabaseStorageAdapter] Failed to connect to Supabase:",t),!1):(console.log("[SupabaseStorageAdapter] Successfully connected to Supabase Storage"),!0)}catch(e){return console.warn("[SupabaseStorageAdapter] Failed to initialize:",e),!1}}async getItem(e){try{const{data:t,error:r}=await s.supabase.storage.from(this.bucketName).createSignedUrl(e,3600);return r?(console.warn("[SupabaseStorageAdapter] Failed to get ".concat(e,":"),r),null):t.signedUrl}catch(t){return console.warn("[SupabaseStorageAdapter] Failed to get ".concat(e,":"),t),null}}async setItem(e,t){try{return console.log("[SupabaseStorageAdapter] setItem called for ".concat(e,", but file upload should use uploadFile method")),!0}catch(r){return console.warn("[SupabaseStorageAdapter] Failed to set ".concat(e,":"),r),!1}}async removeItem(e){try{const{error:t}=await s.supabase.storage.from(this.bucketName).remove([e]);return!t||(console.warn("[SupabaseStorageAdapter] Failed to remove ".concat(e,":"),t),!1)}catch(t){return console.warn("[SupabaseStorageAdapter] Failed to remove ".concat(e,":"),t),!1}}async keys(){try{const{data:e,error:t}=await s.supabase.storage.from(this.bucketName).list("",{limit:1e3});return t?(console.warn("[SupabaseStorageAdapter] Failed to get keys:",t),[]):e.map(e=>e.name)}catch(e){return console.warn("[SupabaseStorageAdapter] Failed to get keys:",e),[]}}async clear(){try{const e=await this.keys();if(0===e.length)return!0;const{error:t}=await s.supabase.storage.from(this.bucketName).remove(e);return!t||(console.warn("[SupabaseStorageAdapter] Failed to clear:",t),!1)}catch(e){return console.warn("[SupabaseStorageAdapter] Failed to clear:",e),!1}}async uploadFile(e,t){try{const{data:r,error:o}=await s.supabase.storage.from(this.bucketName).upload(e,t,{cacheControl:"3600",upsert:!0});return o?(console.warn("[SupabaseStorageAdapter] Failed to upload ".concat(e,":"),o),{success:!1,error:o.message}):(console.log("[SupabaseStorageAdapter] Successfully uploaded ".concat(e)),{success:!0,data:r})}catch(r){return console.warn("[SupabaseStorageAdapter] Failed to upload ".concat(e,":"),r),{success:!1,error:r.message}}}async getPublicUrl(e){try{const{data:t}=s.supabase.storage.from(this.bucketName).getPublicUrl(e);return t.publicUrl}catch(t){return console.warn("[SupabaseStorageAdapter] Failed to get public URL for ".concat(e,":"),t),null}}}class l{static async getAdapter(){if(this.instance)return this.instance;if((0,o.isMock)()){console.log("[StorageFactory] Mock mode: using LocalStorageAdapter");const e=new n;if(await e.init())return this.instance=e,e;console.warn("[StorageFactory] LocalStorage not available, falling back to MemoryStorageAdapter")}console.log("[StorageFactory] Non-Mock mode: using SupabaseStorageAdapter");try{const e=new i;if(await e.init())return console.log("[StorageFactory] Successfully initialized SupabaseStorageAdapter"),this.instance=e,e;throw new Error("Supabase Storage initialization failed")}catch(e){throw console.error("[StorageFactory] Failed to initialize SupabaseStorageAdapter:",e),console.error("[StorageFactory] This is a critical error - Supabase Storage must be available in production mode"),new Error("Supabase Storage is required but not available")}}static reset(){this.instance=null}}l.instance=null;const c=l.getAdapter.bind(l),d={getItem:async e=>(await c()).getItem(e),setItem:async(e,t)=>(await c()).setItem(e,t),removeItem:async e=>(await c()).removeItem(e),keys:async()=>(await c()).keys(),clear:async()=>(await c()).clear(),init:async()=>(await c()).init()};a.default},185:(e,t,r)=>{e.exports=r(392)},200:(e,t,r)=>{"use strict";r.d(t,{BD:()=>n,S5:()=>l,ep:()=>i,getPortfolioImageUrl:()=>s,jp:()=>h,qo:()=>c,updatePortfolioItem:()=>d,zB:()=>u});var o=r(51),a=(r(337),r(32));const s=async e=>{if(console.log("[Portfolio] Supabase: Getting image URL for ".concat(e)),!e)return console.warn("[Portfolio] filePath is empty or undefined"),{success:!1,error:"Invalid file path"};try{console.log("[Portfolio] Getting public URL from Supabase Storage: ".concat(e));const{data:t}=a.supabase.storage.from("portfolio").getPublicUrl(e);return t&&t.publicUrl?(console.log("[Portfolio] Successfully got public URL: ".concat(e)),{success:!0,data:{url:t.publicUrl,path:e}}):(console.log("[Portfolio] Image not found in Supabase Storage: ".concat(e)),{success:!1,error:"Image not found in Supabase Storage"})}catch(t){return console.error("[Portfolio] Error getting image URL:",t),{success:!1,error:t.message}}},n=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;console.log("[Portfolio] Supabase: Reading portfolio from database");try{if(!e){const{data:{user:t}}=await a.supabase.auth.getUser();if(!t)return console.error("[Portfolio] No authenticated user found"),{success:!1,error:"User not authenticated"};e=t.id}console.log("[Portfolio] Reading portfolio for user: ".concat(e));const{data:t,error:r}=await a.supabase.from("portfolio").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(r)return console.error("[Portfolio] Supabase select error:",r),{success:!1,error:r.message};console.log("[Portfolio] Found ".concat(t.length," items for user ").concat(e));return{success:!0,data:t.map(e=>({id:e.id,title:e.title,description:e.description,category:e.category,tags:e.tags,imagePaths:e.image_paths,thumbnailPath:e.thumbnail_path,isPublic:e.is_public,createdAt:e.created_at,updatedAt:e.updated_at}))}}catch(t){return console.error("[Portfolio] Error reading portfolio:",t),{success:!1,error:t.message}}},i=async e=>{console.log("[Portfolio] Supabase: Reading public portfolio for user ".concat(e));try{if(!e)return console.error("[Portfolio] No userId provided"),{success:!1,error:"User ID is required"};const{data:t,error:r}=await a.supabase.from("portfolio").select("*").eq("user_id",e).eq("is_public",!0).order("created_at",{ascending:!1});if(r)return console.error("[Portfolio] Supabase select error:",r),{success:!1,error:r.message};console.log("[Portfolio] Found ".concat(t.length," public items for user ").concat(e," from database"));return{success:!0,data:t.map(e=>({id:e.id,title:e.title,description:e.description,category:e.category,tags:e.tags,imagePaths:e.image_paths,thumbnailPath:e.thumbnail_path,isPublic:e.is_public,createdAt:e.created_at,updatedAt:e.updated_at}))}}catch(t){return console.error("[Portfolio] Error reading public portfolio:",t),{success:!1,error:t.message}}},l=async()=>{console.log("[Portfolio] Supabase: Reading all public portfolios from database");try{const{data:e,error:t}=await a.supabase.from("portfolio_with_artist").select("*").order("created_at",{ascending:!1});if(t)return console.error("[Portfolio] Supabase select error:",t),{success:!1,error:t.message};console.log("[Portfolio] Found ".concat(e.length," total public items from database"));return{success:!0,data:e.map(e=>({id:e.id,title:e.title,description:e.description,category:e.category,tags:e.tags,imagePaths:e.image_paths,thumbnailPath:e.thumbnail_path,isPublic:e.is_public,createdAt:e.created_at,updatedAt:e.updated_at,profiles:{id:e.user_id,full_name:e.artist_name||"Unknown Artist",avatar_url:e.artist_avatar||"",role:e.artist_role||"Artist"}}))}}catch(e){return console.error("[Portfolio] Error reading all public portfolios:",e),{success:!1,error:e.message}}},c=async e=>{console.log("[Portfolio] Supabase: Creating new portfolio item");try{const t=e.userId;if(!t)return console.error("[Portfolio] No userId provided in portfolioData"),{success:!1,error:"User ID is required"};const r={user_id:t,title:e.title||"Untitled",description:e.description||"",category:e.category||"",tags:e.tags||[],image_paths:e.imagePaths||[],thumbnail_path:e.thumbnailPath||"",is_public:!1!==e.isPublic};console.log("[Portfolio] Inserting data:",r);const{data:o,error:s}=await a.supabase.from("portfolio").insert(r).select().single();return s?(console.error("[Portfolio] Supabase insert error:",s),{success:!1,error:s.message}):(console.log("[Portfolio] Successfully created item:",o),{success:!0,data:{id:o.id,title:o.title,description:o.description,category:o.category,tags:o.tags,imagePaths:o.image_paths,thumbnailPath:o.thumbnail_path,isPublic:o.is_public,createdAt:o.created_at,updatedAt:o.updated_at}})}catch(t){return console.error("[Portfolio] Error creating portfolio item:",t),{success:!1,error:t.message}}},d=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("[Portfolio] Supabase: Updating item ".concat(e));try{if(!r){const{data:{user:e}}=await a.supabase.auth.getUser();if(!e)return console.error("[Portfolio] No authenticated user found"),{success:!1,error:"User not authenticated"};r=e.id}const s=(0,o.A)((0,o.A)({},t),{},{updated_at:(new Date).toISOString()});console.log("[Portfolio] Updating data:",s);const{data:n,error:i}=await a.supabase.from("portfolio").update(s).eq("id",e).eq("user_id",r).select().single();return i?(console.error("[Portfolio] Supabase update error:",i),{success:!1,error:i.message}):(console.log("[Portfolio] Successfully updated item:",n),{success:!0,data:{id:n.id,title:n.title,description:n.description,category:n.category,tags:n.tags,imagePaths:n.image_paths,thumbnailPath:n.thumbnail_path,isPublic:n.is_public,createdAt:n.created_at,updatedAt:n.updated_at}})}catch(s){return console.error("[Portfolio] Error updating portfolio item:",s),{success:!1,error:s.message}}},u=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;console.log("[Portfolio] Supabase: Deleting item ".concat(e));try{if(!t){const{data:{user:e}}=await a.supabase.auth.getUser();if(!e)return console.error("[Portfolio] No authenticated user found"),{success:!1,error:"User not authenticated"};t=e.id}console.log("[Portfolio] Deleting item:",e,"for user:",t);const{error:r}=await a.supabase.from("portfolio").delete().eq("id",e).eq("user_id",t);return r?(console.error("[Portfolio] Supabase delete error:",r),{success:!1,error:r.message}):(console.log("[Portfolio] Successfully deleted item:",e),{success:!0,data:{id:e}})}catch(r){return console.error("[Portfolio] Error deleting portfolio item:",r),{success:!1,error:r.message}}},h=async(e,t)=>{console.log("[Portfolio] Supabase: Uploading image ".concat(e.name," for user ").concat(t));try{const r=e.name.split(".").pop().toLowerCase(),o="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2),".").concat(r),s="".concat(t,"/").concat(o);console.log("[Portfolio] Supabase: Uploading to path: ".concat(s));const{data:n,error:i}=await a.supabase.storage.from("portfolio").upload(s,e,{cacheControl:"3600",upsert:!0});if(i)return console.error("[Portfolio] Supabase: Upload failed:",i),{success:!1,error:i.message};console.log("[Portfolio] Supabase: Successfully uploaded ".concat(s));const{data:l}=a.supabase.storage.from("portfolio").getPublicUrl(s);return{success:!0,data:{path:s,url:l.publicUrl}}}catch(r){return console.error("[Portfolio] Supabase: Error uploading image:",r),{success:!1,error:r.message}}}},202:(e,t)=>{"use strict";var r=Symbol.for("react.element"),o=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,f={};function v(e,t,r){this.props=e,this.context=t,this.refs=f,this.updater=r||p}function x(){}function b(e,t,r){this.props=e,this.context=t,this.refs=f,this.updater=r||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},x.prototype=v.prototype;var y=b.prototype=new x;y.constructor=b,g(y,v.prototype),y.isPureReactComponent=!0;var w=Array.isArray,j=Object.prototype.hasOwnProperty,k={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function N(e,t,o){var a,s={},n=null,i=null;if(null!=t)for(a in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(n=""+t.key),t)j.call(t,a)&&!S.hasOwnProperty(a)&&(s[a]=t[a]);var l=arguments.length-2;if(1===l)s.children=o;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(a in l=e.defaultProps)void 0===s[a]&&(s[a]=l[a]);return{$$typeof:r,type:e,key:n,ref:i,props:s,_owner:k.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var _=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,a,s,n){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var l=!1;if(null===e)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case o:l=!0}}if(l)return n=n(l=e),e=""===s?"."+A(l,0):s,w(n)?(a="",null!=e&&(a=e.replace(_,"$&/")+"/"),I(n,t,a,"",function(e){return e})):null!=n&&(C(n)&&(n=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(n,a+(!n.key||l&&l.key===n.key?"":(""+n.key).replace(_,"$&/")+"/")+e)),t.push(n)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var d=s+A(i=e[c],c);l+=I(i,t,a,d,n)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(i=e.next()).done;)l+=I(i=i.value,t,a,d=s+A(i,c++),n);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function P(e,t,r){if(null==e)return e;var o=[],a=0;return I(e,o,"","",function(e){return t.call(r,e,a++)}),o}function E(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},L={transition:null},T={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:L,ReactCurrentOwner:k};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:P,forEach:function(e,t,r){P(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=a,t.Profiler=n,t.PureComponent=b,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T,t.act=M,t.cloneElement=function(e,t,o){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=g({},e.props),s=e.key,n=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(n=t.ref,i=k.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)j.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=o;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];a.children=l}return{$$typeof:r,type:e.type,key:s,ref:n,props:a,_owner:i}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=N,t.createFactory=function(e){var t=N.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:E}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=L.transition;L.transition={};try{e()}finally{L.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,r){return D.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,r){return D.current.useReducer(e,t,r)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return D.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},210:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=o(r(829)),s=o(r(736));class n{constructor(e){let{headers:t={},schema:r,fetch:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=o}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new a.default(t,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new n(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:r=!1,get:o=!1,count:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var n;let i;const l=new URL("".concat(this.url,"/rpc/").concat(e));let c;r||o?(i=r?"HEAD":"GET",Object.entries(t).filter(e=>{let[t,r]=e;return void 0!==r}).map(e=>{let[t,r]=e;return[t,Array.isArray(r)?"{".concat(r.join(","),"}"):"".concat(r)]}).forEach(e=>{let[t,r]=e;l.searchParams.append(t,r)})):(i="POST",c=t);const d=new Headers(this.headers);return a&&d.set("Prefer","count=".concat(a)),new s.default({method:i,url:l,headers:d,schema:this.schemaName,body:c,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}}t.default=n},218:e=>{var t,r,o,a,s,n,i,l,c,d,u,h,m,p,g,f=!1;function v(){if(!f){f=!0;var e=navigator.userAgent,v=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),x=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(h=/\b(iPhone|iP[ao]d)/.exec(e),m=/\b(iP[ao]d)/.exec(e),d=/Android/i.exec(e),p=/FBAN\/\w+;/i.exec(e),g=/Mobile/i.exec(e),u=!!/Win64/.exec(e),v){(t=v[1]?parseFloat(v[1]):v[5]?parseFloat(v[5]):NaN)&&document&&document.documentMode&&(t=document.documentMode);var b=/(?:Trident\/(\d+.\d+))/.exec(e);n=b?parseFloat(b[1])+4:t,r=v[2]?parseFloat(v[2]):NaN,o=v[3]?parseFloat(v[3]):NaN,(a=v[4]?parseFloat(v[4]):NaN)?(v=/(?:Chrome\/(\d+\.\d+))/.exec(e),s=v&&v[1]?parseFloat(v[1]):NaN):s=NaN}else t=r=o=s=a=NaN;if(x){if(x[1]){var y=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);i=!y||parseFloat(y[1].replace("_","."))}else i=!1;l=!!x[2],c=!!x[3]}else i=l=c=!1}}var x={ie:function(){return v()||t},ieCompatibilityMode:function(){return v()||n>t},ie64:function(){return x.ie()&&u},firefox:function(){return v()||r},opera:function(){return v()||o},webkit:function(){return v()||a},safari:function(){return x.webkit()},chrome:function(){return v()||s},windows:function(){return v()||l},osx:function(){return v()||i},linux:function(){return v()||c},iphone:function(){return v()||h},mobile:function(){return v()||h||m||d||g},nativeApp:function(){return v()||p},android:function(){return v()||d},ipad:function(){return v()||m}};e.exports=x},234:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var o=r-1>>>1,a=e[o];if(!(0<s(a,t)))break e;e[o]=t,e[r]=a,r=o}}function o(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var o=0,a=e.length,n=a>>>1;o<n;){var i=2*(o+1)-1,l=e[i],c=i+1,d=e[c];if(0>s(l,r))c<a&&0>s(d,l)?(e[o]=d,e[c]=r,o=c):(e[o]=l,e[i]=r,o=i);else{if(!(c<a&&0>s(d,r)))break e;e[o]=d,e[c]=r,o=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var n=performance;t.unstable_now=function(){return n.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,h=null,m=3,p=!1,g=!1,f=!1,v="function"===typeof setTimeout?setTimeout:null,x="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function y(e){for(var t=o(d);null!==t;){if(null===t.callback)a(d);else{if(!(t.startTime<=e))break;a(d),t.sortIndex=t.expirationTime,r(c,t)}t=o(d)}}function w(e){if(f=!1,y(e),!g)if(null!==o(c))g=!0,L(j);else{var t=o(d);null!==t&&T(w,t.startTime-e)}}function j(e,r){g=!1,f&&(f=!1,x(C),C=-1),p=!0;var s=m;try{for(y(r),h=o(c);null!==h&&(!(h.expirationTime>r)||e&&!I());){var n=h.callback;if("function"===typeof n){h.callback=null,m=h.priorityLevel;var i=n(h.expirationTime<=r);r=t.unstable_now(),"function"===typeof i?h.callback=i:h===o(c)&&a(c),y(r)}else a(c);h=o(c)}if(null!==h)var l=!0;else{var u=o(d);null!==u&&T(w,u.startTime-r),l=!1}return l}finally{h=null,m=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,S=!1,N=null,C=-1,_=5,A=-1;function I(){return!(t.unstable_now()-A<_)}function P(){if(null!==N){var e=t.unstable_now();A=e;var r=!0;try{r=N(!0,e)}finally{r?k():(S=!1,N=null)}}else S=!1}if("function"===typeof b)k=function(){b(P)};else if("undefined"!==typeof MessageChannel){var E=new MessageChannel,D=E.port2;E.port1.onmessage=P,k=function(){D.postMessage(null)}}else k=function(){v(P,0)};function L(e){N=e,S||(S=!0,k())}function T(e,r){C=v(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,L(j))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return o(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var r=m;m=t;try{return e()}finally{m=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=m;m=e;try{return t()}finally{m=r}},t.unstable_scheduleCallback=function(e,a,s){var n=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?n+s:n:s=n,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:u++,callback:a,priorityLevel:e,startTime:s,expirationTime:i=s+i,sortIndex:-1},s>n?(e.sortIndex=s,r(d,e),null===o(c)&&e===o(d)&&(f?(x(C),C=-1):f=!0,T(w,s-n))):(e.sortIndex=i,r(c,e),g||p||(g=!0,L(j))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=m;return function(){var r=m;m=t;try{return e.apply(this,arguments)}finally{m=r}}}},240:(e,t,r)=>{"use strict";r.d(t,{followUser:()=>s,getFollowers:()=>l,getFollowing:()=>c,getUserProfile:()=>a,isFollowing:()=>i,unfollowUser:()=>n});var o=r(32);const a=async e=>{try{const{data:t,error:r}=await o.supabase.from("profiles").select("*").eq("id",e).single();if(r)return{success:!1,error:r.message};if(!t)return{success:!1,error:"User not found"};const[a,s]=await Promise.all([o.supabase.from("follows").select("id",{count:"exact"}).eq("following_id",e),o.supabase.from("follows").select("id",{count:"exact"}).eq("follower_id",e)]),n=a.count||0,i=s.count||0;return{success:!0,data:{id:t.id,name:t.full_name||"Unknown User",username:t.full_name||"unknown",avatar_url:t.avatar_url||null,created_at:t.created_at,updated_at:t.updated_at,followers_count:n,following_count:i}}}catch(t){return{success:!1,error:t.message}}},s=async(e,t)=>{try{const{data:r,error:a}=await o.supabase.from("follows").insert({follower_id:e,following_id:t}).select().single();return a?{success:!1,error:a.message}:{success:!0,data:r}}catch(r){return{success:!1,error:r.message}}},n=async(e,t)=>{try{const{error:r}=await o.supabase.from("follows").delete().eq("follower_id",e).eq("following_id",t);return r?{success:!1,error:r.message}:{success:!0}}catch(r){return{success:!1,error:r.message}}},i=async(e,t)=>{try{const{data:r,error:a}=await o.supabase.from("follows").select("id").eq("follower_id",e).eq("following_id",t).maybeSingle();return a?{success:!1,error:a.message}:{success:!0,isFollowing:!!r}}catch(r){return{success:!1,error:r.message}}},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{page:r=1,limit:a=20}=t,{data:s,error:n}=await o.supabase.from("follows").select("follower_id").eq("following_id",e).order("created_at",{ascending:!1}).range((r-1)*a,r*a-1);return n?{success:!1,error:n.message}:{success:!0,data:s.map(e=>({id:e.follower_id}))}}catch(r){return{success:!1,error:r.message}}},c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{page:r=1,limit:a=20}=t,{data:s,error:n}=await o.supabase.from("follows").select("following_id").eq("follower_id",e).order("created_at",{ascending:!1}).range((r-1)*a,r*a-1);return n?{success:!1,error:n.message}:{success:!0,data:s.map(e=>({id:e.following_id}))}}catch(r){return{success:!1,error:r.message}}}},255:(e,t,r)=>{"use strict";r.d(t,{userService:()=>g});var o=r(51),a=r(179),s=r(915),n=r(8);const i={getCurrentUser:async()=>{try{const t=(0,n.WR)();if(!t)return console.warn("[localStorageAdapter] No current user ID found"),null;const r=await a.IG.getItem("user_".concat(t));if(!r)return console.log("[localStorageAdapter] No user data found for ".concat(t)),null;const o=JSON.parse(r),i=(0,s.EP)(t);i&&(o.avatar=i);const l=await a.IG.getItem("tag.avatars.".concat(t));if(l)try{const e=JSON.parse(l);e&&e.avatarUrl&&((0,s.Ih)(t,e.avatarUrl),o.avatar=e.avatarUrl)}catch(e){console.warn("[localStorageAdapter] Failed to parse avatar data:",e)}return console.log("[localStorageAdapter] Retrieved user data for ".concat(t)),o}catch(e){return console.error("[localStorageAdapter] Error getting current user:",e),null}},getUserById:async e=>{try{if(!e)return console.warn("[localStorageAdapter] No user ID provided"),null;const r=await a.IG.getItem("user_".concat(e));if(!r)return console.log("[localStorageAdapter] No user data found for ".concat(e)),null;const o=JSON.parse(r),n=(0,s.EP)(e);n&&(o.avatar=n);const i=await a.IG.getItem("tag.avatars.".concat(e));if(i)try{const t=JSON.parse(i);t&&t.avatarUrl&&((0,s.Ih)(e,t.avatarUrl),o.avatar=t.avatarUrl)}catch(t){console.warn("[localStorageAdapter] Failed to parse avatar data:",t)}return console.log("[localStorageAdapter] Retrieved user data for ".concat(e)),o}catch(t){return console.error("[localStorageAdapter] Error getting user ".concat(e,":"),t),null}},createUser:async(e,t)=>{try{if(!e||!t)return{success:!1,error:"Missing userId or userData"};const r=await i.getUserById(e);if(r)return console.log("[localStorageAdapter] User ".concat(e," already exists")),{success:!0,data:r};const s=(0,o.A)((0,o.A)({id:e},t),{},{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});return await a.IG.setItem("user_".concat(e),JSON.stringify(s)),console.log("[localStorageAdapter] Created user ".concat(e)),{success:!0,data:s}}catch(r){return console.error("[localStorageAdapter] Error creating user ".concat(e,":"),r),{success:!1,error:r.message}}},updateUser:async(e,t)=>{try{if(!e||!t)return{success:!1,error:"Missing userId or userData"};const r=await i.getUserById(e);if(!r)return console.warn("[localStorageAdapter] User ".concat(e," not found for update")),{success:!1,error:"User not found"};const s=(0,o.A)((0,o.A)((0,o.A)({},r),t),{},{updatedAt:(new Date).toISOString()});return await a.IG.setItem("user_".concat(e),JSON.stringify(s)),console.log("[localStorageAdapter] Updated user ".concat(e)),{success:!0,data:s}}catch(r){return console.error("[localStorageAdapter] Error updating user ".concat(e,":"),r),{success:!1,error:r.message}}},getAllUsers:async()=>{try{const t=[],r=await a.IG.keys();for(const o of r)if(o&&o.startsWith("user_"))try{const e=await a.IG.getItem(o);if(e){const r=JSON.parse(e);t.push(r)}}catch(e){console.warn("[localStorageAdapter] Failed to parse user data for key ".concat(o,":"),e)}return console.log("[localStorageAdapter] Retrieved ".concat(t.length," users")),t}catch(e){return console.error("[localStorageAdapter] Error getting all users:",e),[]}},deleteUser:async e=>{try{return e?(await a.IG.removeItem("user_".concat(e)),await a.IG.removeItem("tag.avatars.".concat(e)),console.log("[localStorageAdapter] Deleted user ".concat(e)),{success:!0}):{success:!1,error:"Missing userId"}}catch(t){return console.error("[localStorageAdapter] Error deleting user ".concat(e,":"),t),{success:!1,error:t.message}}}};var l=r(420);const c=async()=>{try{const e=(0,n.WR)();if(!e)return console.warn("[mockUsersAdapter] No current user ID found"),null;const t=(0,l.ug)(e);return console.log("[mockUsersAdapter] Retrieved current user ".concat(e," (fallback)")),t}catch(e){return console.error("[mockUsersAdapter] Error getting current user:",e),null}},d=async e=>{try{if(!e)return console.warn("[mockUsersAdapter] No user ID provided"),null;const t=(0,l.ug)(e);return console.log("[mockUsersAdapter] Retrieved user ".concat(e," (fallback)")),t}catch(t){return console.error("[mockUsersAdapter] Error getting user ".concat(e,":"),t),null}},u=async()=>{try{const e=(0,l.CF)();return console.log("[mockUsersAdapter] Retrieved ".concat(e.length," users (fallback)")),e}catch(e){return console.error("[mockUsersAdapter] Error getting all users:",e),[]}},h=async()=>(console.log("[supabaseAdapter] getCurrentUser not implemented yet"),null),m=async e=>(console.log("[supabaseAdapter] getUserById not implemented yet for ".concat(e)),null),p=async(e,t)=>(console.log("[supabaseAdapter] updateUser not implemented yet for ".concat(e)),{success:!1,error:"Supabase adapter not implemented yet"}),g={getCurrentUser:async()=>{try{const e=await i.getCurrentUser();if(e)return console.log("[userService] Using LocalStorage user data"),e;const t=await h();return t?(console.log("[userService] Using Supabase user data"),t):(console.log("[userService] Using MockUsers fallback"),await c())}catch(e){return console.error("[userService] Error getting current user:",e),await c()}},getUserById:async e=>{try{const t=await i.getUserById(e);if(t)return console.log("[userService] Using LocalStorage user data for ".concat(e)),t;const r=await m(e);return r?(console.log("[userService] Using Supabase user data for ".concat(e)),r):(console.log("[userService] Using MockUsers fallback for ".concat(e)),await d(e))}catch(t){return console.error("[userService] Error getting user ".concat(e,":"),t),await d(e)}},updateUser:async(e,t)=>{try{const r=await i.updateUser(e,t);if(r.success)return console.log("[userService] Updated user ".concat(e," in LocalStorage")),r;const o=await p(e,t);return o.success?(console.log("[userService] Updated user ".concat(e," in Supabase")),o):(console.warn("[userService] Failed to update user ".concat(e)),{success:!1,error:"Failed to update user"})}catch(r){return console.error("[userService] Error updating user ".concat(e,":"),r),{success:!1,error:r.message}}},ensureUserIndexed:async e=>{try{const t=await g.getUserById(e);if(t)return console.log("[userService] User ".concat(e," already indexed")),{success:!0,data:t};const r=await d(e);if(r){const t=await i.createUser(e,r);return console.log("[userService] Created user index for ".concat(e)),t}return console.warn("[userService] No base data found for user ".concat(e)),{success:!1,error:"No base data found"}}catch(t){return console.error("[userService] Error ensuring user indexed ".concat(e,":"),t),{success:!1,error:t.message}}},getAllUsers:async()=>{try{const e=await i.getAllUsers();return e&&e.length>0?(console.log("[userService] Using LocalStorage users list"),e):(console.log("[userService] Using MockUsers users list"),await u())}catch(e){return console.error("[userService] Error getting all users:",e),await u()}}}},286:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=o(r(630)),s=o(r(611));t.default=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=a.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,o,a;let n=null,i=null,l=null,c=e.status,d=e.statusText;if(e.ok){if("HEAD"!==this.method){const r=await e.text();""===r||(i="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(t=this.headers.get("Accept"))||void 0===t?void 0:t.includes("application/vnd.pgrst.plan+text"))?r:JSON.parse(r))}const a=null===(r=this.headers.get("Prefer"))||void 0===r?void 0:r.match(/count=(exact|planned|estimated)/),s=null===(o=e.headers.get("content-range"))||void 0===o?void 0:o.split("/");a&&s&&s.length>1&&(l=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(n={code:"PGRST116",details:"Results contain ".concat(i.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,l=null,c=406,d="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(i=[],n=null,c=200,d="OK")}catch(u){404===e.status&&""===t?(c=204,d="No Content"):n={message:t}}if(n&&this.isMaybeSingle&&(null===(a=null===n||void 0===n?void 0:n.details)||void 0===a?void 0:a.includes("0 rows"))&&(n=null,c=200,d="OK"),n&&this.shouldThrowOnError)throw new s.default(n)}return{error:n,data:i,count:l,status:c,statusText:d}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,o;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(r=null===e||void 0===e?void 0:e.stack)&&void 0!==r?r:""),hint:"",code:"".concat(null!==(o=null===e||void 0===e?void 0:e.code)&&void 0!==o?o:"")},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}}},313:(e,t,r)=>{"use strict";r.d(t,{$u:()=>i,getUnifiedAvatar:()=>n});var o=r(915),a=r(792),s=r(8);const n=async e=>{if(!e)return console.warn("[avatarService] No userId provided"),null;try{if(console.log("[avatarService] Getting unified avatar for user: ".concat(e)),"undefined"!==typeof window){const t=window.localStorage.getItem("tag.avatars.".concat(e));if(t)try{const r=JSON.parse(t);if(r&&r.avatarUrl){const t=r.avatarUrl;if((e=>{if(!e||"string"!==typeof e)return!1;if(e.startsWith("http"))try{const t=new URL(e);return t.hostname.length>0&&t.protocol.startsWith("http")}catch(t){return!1}return!!e.startsWith("data:image/")&&e.length>100})(t))return console.log("[avatarService] Found valid avatar in localStorage for ".concat(e,":"),null===t||void 0===t?void 0:t.substring(0,30)),t;console.warn("[avatarService] Found invalid avatar URL in localStorage for ".concat(e,":"),null===t||void 0===t?void 0:t.substring(0,30)),window.localStorage.removeItem("tag.avatars.".concat(e))}}catch(s){console.warn("[avatarService] Failed to parse localStorage avatar data for ".concat(e,":"),s),window.localStorage.removeItem("tag.avatars.".concat(e))}}const i=await a.A.getAvatarUrl(e);if(i)return console.log("[avatarService] Found avatar in IndexedDB for ".concat(e,":"),null===i||void 0===i?void 0:i.substring(0,30)),i;try{var t;const{getProfile:a}=await Promise.resolve().then(r.bind(r,405)),s=await a(e);var o;if(null!==s&&void 0!==s&&s.success&&null!==s&&void 0!==s&&null!==(t=s.data)&&void 0!==t&&t.avatar)return console.log("[avatarService] Found avatar in Supabase profile for ".concat(e,":"),null===(o=s.data.avatar)||void 0===o?void 0:o.substring(0,30)),s.data.avatar}catch(n){console.warn("[avatarService] Failed to get profile for ".concat(e,":"),n)}return console.log("[avatarService] No avatar found for user ".concat(e,", using default")),l()}catch(i){return console.error("[avatarService] Error getting unified avatar for ".concat(e,":"),i),l()}},i=async e=>{const t=await(0,s.WR)();return await(async(e,t)=>{if(!e||!t)return console.warn("[avatarService] Invalid parameters for avatar update"),!1;try{if((0,o.Bx)(e),(await a.A.storeAvatar(e,t)).skipped&&console.log("[avatarService] Avatar storage skipped, but continuing with update flow"),"undefined"!==typeof window){const r={avatarUrl:t,timestamp:Date.now()};window.localStorage.setItem("tag.avatars.".concat(e),JSON.stringify(r))}return"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("avatar:updated",{detail:{userId:e,avatarUrl:t,avatarUpdatedAt:(new Date).toISOString()}})),console.log("[avatarService] Successfully updated unified avatar for user:",e),!0}catch(r){return console.error("[avatarService] Error updating unified avatar:",r),!1}})(t,e)},l=()=>"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB4PSIzMiIgeT0iMjQiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEM5Q0E2Ij4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+"},337:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});const o=new class{constructor(){this.dbName="TAGPortfolioDB",this.dbVersion=1,this.storeName="images"}async initDB(){return new Promise((e,t)=>{const r=indexedDB.open(this.dbName,this.dbVersion);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains(this.storeName)){t.createObjectStore(this.storeName,{keyPath:"path"}).createIndex("path","path",{unique:!0})}}})}async storeImage(e,t){const r=await this.initDB();let o;if(t instanceof Blob)o=t;else if(t instanceof File)o=t;else{if("string"!==typeof t||!t.startsWith("data:image/"))throw new Error("Unsupported data format");{const e=await fetch(t);o=await e.blob()}}return new Promise((t,a)=>{const s=r.transaction([this.storeName],"readwrite").objectStore(this.storeName).put({path:e,file:o,timestamp:Date.now()});s.onsuccess=()=>t({success:!0,path:e}),s.onerror=()=>a(s.error)})}async getImage(e){const t=await this.initDB();return new Promise((r,o)=>{const a=t.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);a.onsuccess=()=>{if(a.result){const t=a.result.file;t instanceof Blob?(console.log("[ImageStorage] Found Blob for ".concat(e,": ").concat(t.size," bytes")),r({success:!0,file:t})):(console.warn("[ImageStorage] Invalid Blob format for ".concat(e,": ").concat(typeof t)),r({success:!1,error:"Invalid Blob format"}))}else r({success:!1,error:"Image not found"})},a.onerror=()=>o(a.error)})}async deleteImage(e){const t=await this.initDB();return new Promise((r,o)=>{const a=t.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);a.onsuccess=()=>r({success:!0}),a.onerror=()=>o(a.error)})}async deleteImages(e){return(await Promise.all(e.map(e=>this.deleteImage(e)))).every(e=>e.success)}async getImageUrl(e){if(!e||"string"!==typeof e)return console.log("[ImageStorage] Invalid filePath type: ".concat(typeof e,", returning null")),null;if(console.log("[ImageStorage] Getting URL for: ".concat(e)),e.startsWith("data:image/"))try{const t=await fetch(e),r=await t.blob(),o=URL.createObjectURL(r);return console.log("[ImageStorage] Created ObjectURL from Data URL: ".concat(o)),o}catch(t){return console.error("[ImageStorage] Error converting Data URL to ObjectURL: ".concat(t)),null}if(e.startsWith("http"))return console.log("[ImageStorage] Returning remote URL: ".concat(e)),e;if(e.startsWith("portfolio/")||e.startsWith("collaboration_"))try{console.log("[ImageStorage] Looking up in IndexedDB: ".concat(e));const t=await this.getImage(e);if(console.log("[ImageStorage] IndexedDB lookup result:",t),t.success&&t.file instanceof Blob){const e=URL.createObjectURL(t.file);return console.log("[ImageStorage] Created ObjectURL from IndexedDB: ".concat(e)),e}return console.log("[ImageStorage] Blob not found in IndexedDB for ".concat(e)),null}catch(t){return console.error("[ImageStorage] Error reading from IndexedDB: ".concat(t)),null}return console.log("[ImageStorage] No valid image found for ".concat(e)),null}revokeImageUrl(e){e&&e.startsWith("blob:")&&URL.revokeObjectURL(e)}}},374:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=o(r(286));class s extends a.default{select(e){let t=!1;const r=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e){let{ascending:t=!0,nullsFirst:r,foreignTable:o,referencedTable:a=o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=a?"".concat(a,".order"):"order",n=this.url.searchParams.get(s);return this.url.searchParams.set(s,"".concat(n?"".concat(n,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===r?"":r?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(o,"".concat(e)),this}range(e,t){let{foreignTable:r,referencedTable:o=r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a="undefined"===typeof o?"offset":"".concat(o,".offset"),s="undefined"===typeof o?"limit":"".concat(o,".limit");return this.url.searchParams.set(a,"".concat(e)),this.url.searchParams.set(s,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain(){let{analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:o=!1,wal:a=!1,format:s="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var n;const i=[e?"analyze":null,t?"verbose":null,r?"settings":null,o?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(n=this.headers.get("Accept"))&&void 0!==n?n:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(s,'; for="').concat(l,'"; options=').concat(i,";")),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this}}t.default=s},391:(e,t,r)=>{"use strict";var o=r(950);t.createRoot=o.createRoot,t.hydrateRoot=o.hydrateRoot},392:(e,t,r)=>{"use strict";var o=r(218),a=r(496);function s(e){var t=0,r=0,o=0,a=0;return"detail"in e&&(r=e.detail),"wheelDelta"in e&&(r=-e.wheelDelta/120),"wheelDeltaY"in e&&(r=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=r,r=0),o=10*t,a=10*r,"deltaY"in e&&(a=e.deltaY),"deltaX"in e&&(o=e.deltaX),(o||a)&&e.deltaMode&&(1==e.deltaMode?(o*=40,a*=40):(o*=800,a*=800)),o&&!t&&(t=o<1?-1:1),a&&!r&&(r=a<1?-1:1),{spinX:t,spinY:r,pixelX:o,pixelY:a}}s.getEventType=function(){return o.firefox()?"DOMMouseScroll":a("wheel")?"wheel":"mousewheel"},e.exports=s},405:(e,t,r)=>{"use strict";r.d(t,{checkSupabaseConnection:()=>c,getProfile:()=>s,saveProfile:()=>n});var o=r(51),a=r(32);const s=async e=>{try{console.log("[Supabase Profile] Getting profile for user: ".concat(e));const{data:t,error:r}=await a.supabase.from("profiles").select("*").eq("id",e).single();if(r){if("PGRST116"===r.code)return console.log("[Supabase Profile] Profile not found for user: ".concat(e,", returning null")),{success:!1,error:"Profile not found"};throw r}const o=i(t);return console.log("[Supabase Profile] Successfully retrieved profile for user: ".concat(e)),{success:!0,data:o}}catch(t){return console.error("[Supabase Profile] Error getting profile for user ".concat(e,":"),t),{success:!1,error:t.message}}},n=async(e,t)=>{try{console.log("[Supabase Profile] Saving profile for user: ".concat(e));const r=l(t),{data:s,error:n}=await a.supabase.from("profiles").upsert((0,o.A)({id:e},r),{onConflict:"id"}).select().single();if(n)throw n;return console.log("[Supabase Profile] Successfully saved profile for user: ".concat(e)),{success:!0,data:i(s)}}catch(r){return console.error("[Supabase Profile] Error saving profile for user ".concat(e,":"),r),{success:!1,error:r.message}}},i=e=>{var t,r,o,a;return e?{id:e.id,fullName:e.full_name||"",title:e.title||"Artist",school:e.school||"",pronouns:e.pronouns||"",majors:Array.isArray(e.majors)?e.majors:[],minors:Array.isArray(e.minors)?e.minors:[],skills:Array.isArray(e.skills)?e.skills:[],bio:e.bio||"",socialLinks:{instagram:(null===(t=e.social_links)||void 0===t?void 0:t.instagram)||"",portfolio:(null===(r=e.social_links)||void 0===r?void 0:r.portfolio)||"",discord:(null===(o=e.social_links)||void 0===o?void 0:o.discord)||"",otherLinks:Array.isArray(null===(a=e.social_links)||void 0===a?void 0:a.otherLinks)?e.social_links.otherLinks:[]},avatar:e.avatar_url||"",createdAt:e.created_at,updatedAt:e.updated_at}:null},l=e=>{var t,r,o,a;return{full_name:e.fullName||"",title:e.title||"Artist",school:e.school||"",pronouns:e.pronouns||"",majors:Array.isArray(e.majors)?e.majors:[],minors:Array.isArray(e.minors)?e.minors:[],skills:Array.isArray(e.skills)?e.skills:[],bio:e.bio||"",social_links:{instagram:(null===(t=e.socialLinks)||void 0===t?void 0:t.instagram)||"",portfolio:(null===(r=e.socialLinks)||void 0===r?void 0:r.portfolio)||"",discord:(null===(o=e.socialLinks)||void 0===o?void 0:o.discord)||"",otherLinks:Array.isArray(null===(a=e.socialLinks)||void 0===a?void 0:a.otherLinks)?e.socialLinks.otherLinks:[]},avatar_url:e.avatar||""}},c=async()=>{try{const{data:e,error:t}=await a.supabase.from("profiles").select("id").limit(1);if(t)throw t;return!0}catch(e){return console.warn("[Supabase Profile] Connection check failed:",e.message),!1}}},420:(e,t,r)=>{"use strict";r.d(t,{CF:()=>n,o1:()=>a,ug:()=>s});var o=r(77);const a={alex:{id:"alex",name:"Alex Chen",displayName:"Alex Chen",email:"alex@example.com",avatar:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB4PSIzMiIgeT0iMjQiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEM5Q0E2Ij4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+",role:"Character Designer",roleIcon:"\ud83c\udfa8",bio:"Passionate character designer with 5+ years of experience in game development.",school:"Art Institute of Chicago",pronouns:"he/him",majors:["Character Design","Game Art"],skills:["Character Design","Digital Painting","Concept Art","3D Modeling"],socialLinks:{instagram:"@alexchen_art",portfolio:"alexchen.design",discord:"alexchen#1234",otherLinks:[]},portfolio:[{id:1,title:"Cyberpunk Warrior",thumb:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkY2QjNCQyIvPgo8dGV4dCB4PSIxMDAiIHk9IjEwMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+Q3liZXJwdW5rIFdhcnJpb3I8L3RleHQ+Cjwvc3ZnPgo=",category:"Character Design"},{id:2,title:"Fantasy Mage",thumb:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjOEM5Q0E2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5GYW50YXN5IE1hZ2U8L3RleHQ+Cjwvc3ZnPgo=",category:"Concept Art"}]},alice:{id:"alice",name:"Alice Rodriguez",displayName:"Alice Rodriguez",email:"alice@example.com",avatar:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB4PSIzMiIgeT0iMjQiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEM5Q0E2Ij4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+",role:"Art Director",roleIcon:"\ud83c\udfad",bio:"Creative art director specializing in visual storytelling and brand identity.",school:"Parsons School of Design",pronouns:"she/her",majors:["Graphic Design","Fine Arts"],skills:["Art Direction","Brand Identity","Visual Design","Creative Strategy"],socialLinks:{instagram:"@alice_rodriguez_art",portfolio:"alicerodriguez.com",discord:"alice_rod#5678",otherLinks:[]},portfolio:[{id:3,title:"Brand Identity Package",thumb:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkY2QjNCQyIvPgo8dGV4dCB4PSIxMDAiIHk9IjEwMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+QnJhbmQgSWRlbnRpdHkgUGFja2FnZTwvdGV4dD4KPC9zdmc+Cg==",category:"Brand Design"},{id:4,title:"Digital Illustration",thumb:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjOEM5Q0E2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5EaWdpdGFsIElsbHVzdHJhdGlvbjwvdGV4dD4KPC9zdmc+Cg==",category:"Digital Art"}]},bryan:{id:"bryan",name:"Bryan Kim",displayName:"Bryan Kim",email:"bryan@example.com",avatar:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB4PSIzMiIgeT0iMjQiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEM5Q0E2Ij4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+",role:"3D Modeler",roleIcon:"\ud83c\udfaf",bio:"Experienced 3D modeler with expertise in character and environment modeling.",school:"Rhode Island School of Design",pronouns:"he/him",majors:["3D Design","Industrial Design"],skills:["3D Modeling","Texturing","Rigging","Animation"],socialLinks:{instagram:"@bryan_kim_3d",portfolio:"bryankim3d.com",discord:"bryan_kim#9012",otherLinks:[]},portfolio:[{id:5,title:"Sci-Fi Character Model",thumb:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRkY2QjNCQyIvPgo8dGV4dCB4PSIxMDAiIHk9IjEwMCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE2IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+U2NpLUZpIENoYXJhY3RlciBNb2RlbDwvdGV4dD4KPC9zdmc+Cg==",category:"3D Modeling"},{id:6,title:"Environment Design",thumb:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjOEM5Q0E2Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTAwIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9IndoaXRlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5FbnZpcm9ubWVudCBEZXNpZ248L3RleHQ+Cjwvc3ZnPgo=",category:"Concept Art"}]}},s=e=>{if(!e&&!(0,o.isMock)())return console.warn("[getUserInfo] No userId provided and not in Mock mode, returning null"),null;if(!e)return console.log("[getUserInfo] No userId provided, returning null"),null;const t=a[e];return t||(console.log("[getUserInfo] User not found: ".concat(e,", returning null")),null)},n=()=>Object.values(a)},496:(e,t,r)=>{"use strict";var o,a=r(989);a.canUseDOM&&(o=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("","")),e.exports=function(e,t){if(!a.canUseDOM||t&&!("addEventListener"in document))return!1;var r="on"+e,s=r in document;if(!s){var n=document.createElement("div");n.setAttribute(r,"return;"),s="function"===typeof n[r]}return!s&&o&&"wheel"===e&&(s=document.implementation.hasFeature("Events.wheel","3.0")),s}},526:(e,t,r)=>{"use strict";function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function a(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=o(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}r.d(t,{A:()=>a})},579:(e,t,r)=>{"use strict";e.exports=r(153)},611:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=r},630:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Headers:()=>n,Request:()=>i,Response:()=>l,default:()=>s,fetch:()=>a});var o=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("unable to locate global object")}();const a=o.fetch,s=o.fetch.bind(o),n=o.Headers,i=o.Request,l=o.Response},730:(e,t,r)=>{"use strict";var o=r(43),a=r(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)n.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},p={};function g(e,t,r,o,a,s,n){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=n}var f={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){f[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];f[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){f[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){f[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){f[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){f[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){f[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){f[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){f[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var v=/[\-:]([a-z])/g;function x(e){return e[1].toUpperCase()}function b(e,t,r,o){var a=f.hasOwnProperty(t)?f[t]:null;(null!==a?0!==a.type:o||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,o){if(null===t||"undefined"===typeof t||function(e,t,r,o){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!o&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,o))return!0;if(o)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,o)&&(r=null),o||null===a?function(e){return!!u.call(p,e)||!u.call(m,e)&&(h.test(e)?p[e]=!0:(m[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,o=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,o?e.setAttributeNS(o,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(v,x);f[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(v,x);f[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(v,x);f[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){f[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),f.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){f[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var y=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),j=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),_=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var L=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var T=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=T&&e[T]||e["@@iterator"])?e:null}var F,R=Object.assign;function O(e){if(void 0===F)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var U=!1;function z(e,t){if(!e||U)return"";U=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var o=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){o=c}e.call(t.prototype)}else{try{throw Error()}catch(c){o=c}e()}}catch(c){if(c&&o&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),s=o.stack.split("\n"),n=a.length-1,i=s.length-1;1<=n&&0<=i&&a[n]!==s[i];)i--;for(;1<=n&&0<=i;n--,i--)if(a[n]!==s[i]){if(1!==n||1!==i)do{if(n--,0>--i||a[n]!==s[i]){var l="\n"+a[n].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=n&&0<=i);break}}}finally{U=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?O(e):""}function W(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case j:return"Portal";case N:return"Profiler";case S:return"StrictMode";case I:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return B(e(t))}catch(r){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function V(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),o=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){o=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return o},setValue:function(e){o=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),o="";return e&&(o=q(e)?e.checked?"true":"false":e.value),(e=o)!==r&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var r=t.checked;return R({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Y(e,t){var r=null==t.defaultValue?"":t.defaultValue,o=null!=t.checked?t.checked:t.defaultChecked;r=H(null!=t.value?t.value:r),e._wrapperState={initialChecked:o,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){Q(e,t);var r=H(t.value),o=t.type;if(null!=r)"number"===o?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===o||"reset"===o)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function X(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var o=t.type;if(!("submit"!==o&&"reset"!==o||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&Z(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,o){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&o&&(e[r].defaultSelected=!0)}else{for(r=""+H(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(o&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function oe(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return R({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(s(92));if(te(r)){if(1<r.length)throw Error(s(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:H(r)}}function se(e,t){var r=H(t.value),o=H(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=o&&(e.defaultValue=""+o)}function ne(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,o){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function fe(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var o=0===r.indexOf("--"),a=ge(r,t[r],o);"float"===r&&(r="cssFloat"),o?e.setProperty(r,a):e[r]=a}}Object.keys(me).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var ve=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xe(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ye=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var je=null,ke=null,Se=null;function Ne(e){if(e=ba(e)){if("function"!==typeof je)throw Error(s(280));var t=e.stateNode;t&&(t=wa(t),je(e.stateNode,e.type,t))}}function Ce(e){ke?Se?Se.push(e):Se=[e]:ke=e}function _e(){if(ke){var e=ke,t=Se;if(Se=ke=null,Ne(e),t)for(e=0;e<t.length;e++)Ne(t[e])}}function Ae(e,t){return e(t)}function Ie(){}var Pe=!1;function Ee(e,t,r){if(Pe)return e(t,r);Pe=!0;try{return Ae(e,t,r)}finally{Pe=!1,(null!==ke||null!==Se)&&(Ie(),_e())}}function De(e,t){var r=e.stateNode;if(null===r)return null;var o=wa(r);if(null===o)return null;r=o[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(o=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!o;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(s(231,t,typeof r));return r}var Le=!1;if(d)try{var Te={};Object.defineProperty(Te,"passive",{get:function(){Le=!0}}),window.addEventListener("test",Te,Te),window.removeEventListener("test",Te,Te)}catch(de){Le=!1}function Me(e,t,r,o,a,s,n,i,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Fe=!1,Re=null,Oe=!1,Ue=null,ze={onError:function(e){Fe=!0,Re=e}};function We(e,t,r,o,a,s,n,i,l){Fe=!1,Re=null,Me.apply(ze,arguments)}function Be(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Be(e)!==e)throw Error(s(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var r=e,o=t;;){var a=r.return;if(null===a)break;var n=a.alternate;if(null===n){if(null!==(o=a.return)){r=o;continue}break}if(a.child===n.child){for(n=a.child;n;){if(n===r)return He(a),e;if(n===o)return He(a),t;n=n.sibling}throw Error(s(188))}if(r.return!==o.return)r=a,o=n;else{for(var i=!1,l=a.child;l;){if(l===r){i=!0,r=a,o=n;break}if(l===o){i=!0,o=a,r=n;break}l=l.sibling}if(!i){for(l=n.child;l;){if(l===r){i=!0,r=n,o=a;break}if(l===o){i=!0,o=n,r=a;break}l=l.sibling}if(!i)throw Error(s(189))}}if(r.alternate!==o)throw Error(s(190))}if(3!==r.tag)throw Error(s(188));return r.stateNode.current===r?e:t}(e))?Ve(e):null}function Ve(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ve(e);if(null!==t)return t;e=e.sibling}return null}var Je=a.unstable_scheduleCallback,Ze=a.unstable_cancelCallback,Ke=a.unstable_shouldYield,Ye=a.unstable_requestPaint,Qe=a.unstable_now,$e=a.unstable_getCurrentPriorityLevel,Xe=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,rt=a.unstable_LowPriority,ot=a.unstable_IdlePriority,at=null,st=null;var nt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/lt|0)|0},it=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var r=e.pendingLanes;if(0===r)return 0;var o=0,a=e.suspendedLanes,s=e.pingedLanes,n=268435455&r;if(0!==n){var i=n&~a;0!==i?o=ut(i):0!==(s&=n)&&(o=ut(s))}else 0!==(n=r&~a)?o=ut(n):0!==s&&(o=ut(s));if(0===o)return 0;if(0!==t&&t!==o&&0===(t&a)&&((a=o&-o)>=(s=t&-t)||16===a&&0!==(4194240&s)))return t;if(0!==(4&o)&&(o|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=o;0<t;)a=1<<(r=31-nt(t)),o|=e[r],t&=~a;return o}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function ft(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-nt(t)]=r}function xt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var o=31-nt(r),a=1<<o;a&t|e[o]&t&&(e[o]|=t),r&=~a}}var bt=0;function yt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,jt,kt,St,Nt,Ct=!1,_t=[],At=null,It=null,Pt=null,Et=new Map,Dt=new Map,Lt=[],Tt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Et.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Ft(e,t,r,o,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:o,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&jt(t)),e):(e.eventSystemFlags|=o,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Rt(e){var t=xa(e.target);if(null!==t){var r=Be(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Ge(r)))return e.blockedOn=t,void Nt(e.priority,function(){kt(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ba(r))&&jt(t),e.blockedOn=r,!1;var o=new(r=e.nativeEvent).constructor(r.type,r);ye=o,r.target.dispatchEvent(o),ye=null,t.shift()}return!0}function Ut(e,t,r){Ot(e)&&r.delete(t)}function zt(){Ct=!1,null!==At&&Ot(At)&&(At=null),null!==It&&Ot(It)&&(It=null),null!==Pt&&Ot(Pt)&&(Pt=null),Et.forEach(Ut),Dt.forEach(Ut)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Bt(e){function t(t){return Wt(t,e)}if(0<_t.length){Wt(_t[0],e);for(var r=1;r<_t.length;r++){var o=_t[r];o.blockedOn===e&&(o.blockedOn=null)}}for(null!==At&&Wt(At,e),null!==It&&Wt(It,e),null!==Pt&&Wt(Pt,e),Et.forEach(t),Dt.forEach(t),r=0;r<Lt.length;r++)(o=Lt[r]).blockedOn===e&&(o.blockedOn=null);for(;0<Lt.length&&null===(r=Lt[0]).blockedOn;)Rt(r),null===r.blockedOn&&Lt.shift()}var Gt=y.ReactCurrentBatchConfig,Ht=!0;function qt(e,t,r,o){var a=bt,s=Gt.transition;Gt.transition=null;try{bt=1,Jt(e,t,r,o)}finally{bt=a,Gt.transition=s}}function Vt(e,t,r,o){var a=bt,s=Gt.transition;Gt.transition=null;try{bt=4,Jt(e,t,r,o)}finally{bt=a,Gt.transition=s}}function Jt(e,t,r,o){if(Ht){var a=Kt(e,t,r,o);if(null===a)Ho(e,t,o,Zt,r),Mt(e,o);else if(function(e,t,r,o,a){switch(t){case"focusin":return At=Ft(At,e,t,r,o,a),!0;case"dragenter":return It=Ft(It,e,t,r,o,a),!0;case"mouseover":return Pt=Ft(Pt,e,t,r,o,a),!0;case"pointerover":var s=a.pointerId;return Et.set(s,Ft(Et.get(s)||null,e,t,r,o,a)),!0;case"gotpointercapture":return s=a.pointerId,Dt.set(s,Ft(Dt.get(s)||null,e,t,r,o,a)),!0}return!1}(a,e,t,r,o))o.stopPropagation();else if(Mt(e,o),4&t&&-1<Tt.indexOf(e)){for(;null!==a;){var s=ba(a);if(null!==s&&wt(s),null===(s=Kt(e,t,r,o))&&Ho(e,t,o,Zt,r),s===a)break;a=s}null!==a&&o.stopPropagation()}else Ho(e,t,o,null,r)}}var Zt=null;function Kt(e,t,r,o){if(Zt=null,null!==(e=xa(e=we(o))))if(null===(t=Be(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Xe:return 1;case et:return 4;case tt:case rt:return 16;case ot:return 536870912;default:return 16}default:return 16}}var Qt=null,$t=null,Xt=null;function er(){if(Xt)return Xt;var e,t,r=$t,o=r.length,a="value"in Qt?Qt.value:Qt.textContent,s=a.length;for(e=0;e<o&&r[e]===a[e];e++);var n=o-e;for(t=1;t<=n&&r[o-t]===a[s-t];t++);return Xt=a.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function or(){return!1}function ar(e){function t(t,r,o,a,s){for(var n in this._reactName=t,this._targetInst=o,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(n)&&(t=e[n],this[n]=t?t(a):a[n]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?rr:or,this.isPropagationStopped=or,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var sr,nr,ir,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ar(lr),dr=R({},lr,{view:0,detail:0}),ur=ar(dr),hr=R({},dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ir&&(ir&&"mousemove"===e.type?(sr=e.screenX-ir.screenX,nr=e.screenY-ir.screenY):nr=sr=0,ir=e),sr)},movementY:function(e){return"movementY"in e?e.movementY:nr}}),mr=ar(hr),pr=ar(R({},hr,{dataTransfer:0})),gr=ar(R({},dr,{relatedTarget:0})),fr=ar(R({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=R({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xr=ar(vr),br=ar(R({},lr,{data:0})),yr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=jr[e])&&!!t[e]}function Sr(){return kr}var Nr=R({},dr,{key:function(e){if(e.key){var t=yr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cr=ar(Nr),_r=ar(R({},hr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ar=ar(R({},dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sr})),Ir=ar(R({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pr=R({},hr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Er=ar(Pr),Dr=[9,13,27,32],Lr=d&&"CompositionEvent"in window,Tr=null;d&&"documentMode"in document&&(Tr=document.documentMode);var Mr=d&&"TextEvent"in window&&!Tr,Fr=d&&(!Lr||Tr&&8<Tr&&11>=Tr),Rr=String.fromCharCode(32),Or=!1;function Ur(e,t){switch(e){case"keyup":return-1!==Dr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wr=!1;var Br={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Br[e.type]:"textarea"===t}function Hr(e,t,r,o){Ce(o),0<(t=Vo(t,"onChange")).length&&(r=new cr("onChange","change",null,r,o),e.push({event:r,listeners:t}))}var qr=null,Vr=null;function Jr(e){Oo(e,0)}function Zr(e){if(J(ya(e)))return e}function Kr(e,t){if("change"===e)return t}var Yr=!1;if(d){var Qr;if(d){var $r="oninput"in document;if(!$r){var Xr=document.createElement("div");Xr.setAttribute("oninput","return;"),$r="function"===typeof Xr.oninput}Qr=$r}else Qr=!1;Yr=Qr&&(!document.documentMode||9<document.documentMode)}function eo(){qr&&(qr.detachEvent("onpropertychange",to),Vr=qr=null)}function to(e){if("value"===e.propertyName&&Zr(Vr)){var t=[];Hr(t,Vr,e,we(e)),Ee(Jr,t)}}function ro(e,t,r){"focusin"===e?(eo(),Vr=r,(qr=t).attachEvent("onpropertychange",to)):"focusout"===e&&eo()}function oo(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Zr(Vr)}function ao(e,t){if("click"===e)return Zr(t)}function so(e,t){if("input"===e||"change"===e)return Zr(t)}var no="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function io(e,t){if(no(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(o=0;o<r.length;o++){var a=r[o];if(!u.call(t,a)||!no(e[a],t[a]))return!1}return!0}function lo(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function co(e,t){var r,o=lo(e);for(e=0;o;){if(3===o.nodeType){if(r=e+o.textContent.length,e<=t&&r>=t)return{node:o,offset:t-e};e=r}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=lo(o)}}function uo(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?uo(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ho(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(o){r=!1}if(!r)break;t=Z((e=t.contentWindow).document)}return t}function mo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function po(e){var t=ho(),r=e.focusedElem,o=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&uo(r.ownerDocument.documentElement,r)){if(null!==o&&mo(r))if(t=o.start,void 0===(e=o.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(o.start,a);o=void 0===o.end?s:Math.min(o.end,a),!e.extend&&s>o&&(a=o,o=s,s=a),a=co(r,s);var n=co(r,o);a&&n&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==n.node||e.focusOffset!==n.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>o?(e.addRange(t),e.extend(n.node,n.offset)):(t.setEnd(n.node,n.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var go=d&&"documentMode"in document&&11>=document.documentMode,fo=null,vo=null,xo=null,bo=!1;function yo(e,t,r){var o=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;bo||null==fo||fo!==Z(o)||("selectionStart"in(o=fo)&&mo(o)?o={start:o.selectionStart,end:o.selectionEnd}:o={anchorNode:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset},xo&&io(xo,o)||(xo=o,0<(o=Vo(vo,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:o}),t.target=fo)))}function wo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var jo={animationend:wo("Animation","AnimationEnd"),animationiteration:wo("Animation","AnimationIteration"),animationstart:wo("Animation","AnimationStart"),transitionend:wo("Transition","TransitionEnd")},ko={},So={};function No(e){if(ko[e])return ko[e];if(!jo[e])return e;var t,r=jo[e];for(t in r)if(r.hasOwnProperty(t)&&t in So)return ko[e]=r[t];return e}d&&(So=document.createElement("div").style,"AnimationEvent"in window||(delete jo.animationend.animation,delete jo.animationiteration.animation,delete jo.animationstart.animation),"TransitionEvent"in window||delete jo.transitionend.transition);var Co=No("animationend"),_o=No("animationiteration"),Ao=No("animationstart"),Io=No("transitionend"),Po=new Map,Eo="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Do(e,t){Po.set(e,t),l(t,[e])}for(var Lo=0;Lo<Eo.length;Lo++){var To=Eo[Lo];Do(To.toLowerCase(),"on"+(To[0].toUpperCase()+To.slice(1)))}Do(Co,"onAnimationEnd"),Do(_o,"onAnimationIteration"),Do(Ao,"onAnimationStart"),Do("dblclick","onDoubleClick"),Do("focusin","onFocus"),Do("focusout","onBlur"),Do(Io,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fo=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mo));function Ro(e,t,r){var o=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,o,a,n,i,l,c){if(We.apply(this,arguments),Fe){if(!Fe)throw Error(s(198));var d=Re;Fe=!1,Re=null,Oe||(Oe=!0,Ue=d)}}(o,t,void 0,e),e.currentTarget=null}function Oo(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var o=e[r],a=o.event;o=o.listeners;e:{var s=void 0;if(t)for(var n=o.length-1;0<=n;n--){var i=o[n],l=i.instance,c=i.currentTarget;if(i=i.listener,l!==s&&a.isPropagationStopped())break e;Ro(a,i,c),s=l}else for(n=0;n<o.length;n++){if(l=(i=o[n]).instance,c=i.currentTarget,i=i.listener,l!==s&&a.isPropagationStopped())break e;Ro(a,i,c),s=l}}}if(Oe)throw e=Ue,Oe=!1,Ue=null,e}function Uo(e,t){var r=t[ga];void 0===r&&(r=t[ga]=new Set);var o=e+"__bubble";r.has(o)||(Go(t,e,2,!1),r.add(o))}function zo(e,t,r){var o=0;t&&(o|=4),Go(r,e,o,t)}var Wo="_reactListening"+Math.random().toString(36).slice(2);function Bo(e){if(!e[Wo]){e[Wo]=!0,n.forEach(function(t){"selectionchange"!==t&&(Fo.has(t)||zo(t,!1,e),zo(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Wo]||(t[Wo]=!0,zo("selectionchange",!1,t))}}function Go(e,t,r,o){switch(Yt(t)){case 1:var a=qt;break;case 4:a=Vt;break;default:a=Jt}r=a.bind(null,t,r,e),a=void 0,!Le||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),o?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Ho(e,t,r,o,a){var s=o;if(0===(1&t)&&0===(2&t)&&null!==o)e:for(;;){if(null===o)return;var n=o.tag;if(3===n||4===n){var i=o.stateNode.containerInfo;if(i===a||8===i.nodeType&&i.parentNode===a)break;if(4===n)for(n=o.return;null!==n;){var l=n.tag;if((3===l||4===l)&&((l=n.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;n=n.return}for(;null!==i;){if(null===(n=xa(i)))return;if(5===(l=n.tag)||6===l){o=s=n;continue e}i=i.parentNode}}o=o.return}Ee(function(){var o=s,a=we(r),n=[];e:{var i=Po.get(e);if(void 0!==i){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Cr;break;case"focusin":c="focus",l=gr;break;case"focusout":c="blur",l=gr;break;case"beforeblur":case"afterblur":l=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ar;break;case Co:case _o:case Ao:l=fr;break;case Io:l=Ir;break;case"scroll":l=ur;break;case"wheel":l=Er;break;case"copy":case"cut":case"paste":l=xr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=_r}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==i?i+"Capture":null:i;d=[];for(var m,p=o;null!==p;){var g=(m=p).stateNode;if(5===m.tag&&null!==g&&(m=g,null!==h&&(null!=(g=De(p,h))&&d.push(qo(p,g,m)))),u)break;p=p.return}0<d.length&&(i=new l(i,c,null,r,a),n.push({event:i,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||r===ye||!(c=r.relatedTarget||r.fromElement)||!xa(c)&&!c[pa])&&(l||i)&&(i=a.window===a?a:(i=a.ownerDocument)?i.defaultView||i.parentWindow:window,l?(l=o,null!==(c=(c=r.relatedTarget||r.toElement)?xa(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=o),l!==c)){if(d=mr,g="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=_r,g="onPointerLeave",h="onPointerEnter",p="pointer"),u=null==l?i:ya(l),m=null==c?i:ya(c),(i=new d(g,p+"leave",l,r,a)).target=u,i.relatedTarget=m,g=null,xa(a)===o&&((d=new d(h,p+"enter",c,r,a)).target=m,d.relatedTarget=u,g=d),u=g,l&&c)e:{for(h=c,p=0,m=d=l;m;m=Jo(m))p++;for(m=0,g=h;g;g=Jo(g))m++;for(;0<p-m;)d=Jo(d),p--;for(;0<m-p;)h=Jo(h),m--;for(;p--;){if(d===h||null!==h&&d===h.alternate)break e;d=Jo(d),h=Jo(h)}d=null}else d=null;null!==l&&Zo(n,i,l,d,!1),null!==c&&null!==u&&Zo(n,u,c,d,!0)}if("select"===(l=(i=o?ya(o):window).nodeName&&i.nodeName.toLowerCase())||"input"===l&&"file"===i.type)var f=Kr;else if(Gr(i))if(Yr)f=so;else{f=oo;var v=ro}else(l=i.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(f=ao);switch(f&&(f=f(e,o))?Hr(n,f,r,a):(v&&v(e,i,o),"focusout"===e&&(v=i._wrapperState)&&v.controlled&&"number"===i.type&&ee(i,"number",i.value)),v=o?ya(o):window,e){case"focusin":(Gr(v)||"true"===v.contentEditable)&&(fo=v,vo=o,xo=null);break;case"focusout":xo=vo=fo=null;break;case"mousedown":bo=!0;break;case"contextmenu":case"mouseup":case"dragend":bo=!1,yo(n,r,a);break;case"selectionchange":if(go)break;case"keydown":case"keyup":yo(n,r,a)}var x;if(Lr)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wr?Ur(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Fr&&"ko"!==r.locale&&(Wr||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wr&&(x=er()):($t="value"in(Qt=a)?Qt.value:Qt.textContent,Wr=!0)),0<(v=Vo(o,b)).length&&(b=new br(b,e,null,r,a),n.push({event:b,listeners:v}),x?b.data=x:null!==(x=zr(r))&&(b.data=x))),(x=Mr?function(e,t){switch(e){case"compositionend":return zr(t);case"keypress":return 32!==t.which?null:(Or=!0,Rr);case"textInput":return(e=t.data)===Rr&&Or?null:e;default:return null}}(e,r):function(e,t){if(Wr)return"compositionend"===e||!Lr&&Ur(e,t)?(e=er(),Xt=$t=Qt=null,Wr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(o=Vo(o,"onBeforeInput")).length&&(a=new br("onBeforeInput","beforeinput",null,r,a),n.push({event:a,listeners:o}),a.data=x))}Oo(n,t)})}function qo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Vo(e,t){for(var r=t+"Capture",o=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=De(e,r))&&o.unshift(qo(e,s,a)),null!=(s=De(e,t))&&o.push(qo(e,s,a))),e=e.return}return o}function Jo(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Zo(e,t,r,o,a){for(var s=t._reactName,n=[];null!==r&&r!==o;){var i=r,l=i.alternate,c=i.stateNode;if(null!==l&&l===o)break;5===i.tag&&null!==c&&(i=c,a?null!=(l=De(r,s))&&n.unshift(qo(r,l,i)):a||null!=(l=De(r,s))&&n.push(qo(r,l,i))),r=r.return}0!==n.length&&e.push({event:t,listeners:n})}var Ko=/\r\n?/g,Yo=/\u0000|\uFFFD/g;function Qo(e){return("string"===typeof e?e:""+e).replace(Ko,"\n").replace(Yo,"")}function $o(e,t,r){if(t=Qo(t),Qo(e)!==t&&r)throw Error(s(425))}function Xo(){}var ea=null,ta=null;function ra(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var oa="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,sa="function"===typeof Promise?Promise:void 0,na="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof sa?function(e){return sa.resolve(null).then(e).catch(ia)}:oa;function ia(e){setTimeout(function(){throw e})}function la(e,t){var r=t,o=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===o)return e.removeChild(a),void Bt(t);o--}else"$"!==r&&"$?"!==r&&"$!"!==r||o++;r=a}while(r);Bt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function da(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var ua=Math.random().toString(36).slice(2),ha="__reactFiber$"+ua,ma="__reactProps$"+ua,pa="__reactContainer$"+ua,ga="__reactEvents$"+ua,fa="__reactListeners$"+ua,va="__reactHandles$"+ua;function xa(e){var t=e[ha];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pa]||r[ha]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=da(e);null!==e;){if(r=e[ha])return r;e=da(e)}return t}r=(e=r).parentNode}return null}function ba(e){return!(e=e[ha]||e[pa])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ya(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wa(e){return e[ma]||null}var ja=[],ka=-1;function Sa(e){return{current:e}}function Na(e){0>ka||(e.current=ja[ka],ja[ka]=null,ka--)}function Ca(e,t){ka++,ja[ka]=e.current,e.current=t}var _a={},Aa=Sa(_a),Ia=Sa(!1),Pa=_a;function Ea(e,t){var r=e.type.contextTypes;if(!r)return _a;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in r)s[a]=t[a];return o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Da(e){return null!==(e=e.childContextTypes)&&void 0!==e}function La(){Na(Ia),Na(Aa)}function Ta(e,t,r){if(Aa.current!==_a)throw Error(s(168));Ca(Aa,t),Ca(Ia,r)}function Ma(e,t,r){var o=e.stateNode;if(t=t.childContextTypes,"function"!==typeof o.getChildContext)return r;for(var a in o=o.getChildContext())if(!(a in t))throw Error(s(108,G(e)||"Unknown",a));return R({},r,o)}function Fa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_a,Pa=Aa.current,Ca(Aa,e),Ca(Ia,Ia.current),!0}function Ra(e,t,r){var o=e.stateNode;if(!o)throw Error(s(169));r?(e=Ma(e,t,Pa),o.__reactInternalMemoizedMergedChildContext=e,Na(Ia),Na(Aa),Ca(Aa,e)):Na(Ia),Ca(Ia,r)}var Oa=null,Ua=!1,za=!1;function Wa(e){null===Oa?Oa=[e]:Oa.push(e)}function Ba(){if(!za&&null!==Oa){za=!0;var e=0,t=bt;try{var r=Oa;for(bt=1;e<r.length;e++){var o=r[e];do{o=o(!0)}while(null!==o)}Oa=null,Ua=!1}catch(a){throw null!==Oa&&(Oa=Oa.slice(e+1)),Je(Xe,Ba),a}finally{bt=t,za=!1}}return null}var Ga=[],Ha=0,qa=null,Va=0,Ja=[],Za=0,Ka=null,Ya=1,Qa="";function $a(e,t){Ga[Ha++]=Va,Ga[Ha++]=qa,qa=e,Va=t}function Xa(e,t,r){Ja[Za++]=Ya,Ja[Za++]=Qa,Ja[Za++]=Ka,Ka=e;var o=Ya;e=Qa;var a=32-nt(o)-1;o&=~(1<<a),r+=1;var s=32-nt(t)+a;if(30<s){var n=a-a%5;s=(o&(1<<n)-1).toString(32),o>>=n,a-=n,Ya=1<<32-nt(t)+a|r<<a|o,Qa=s+e}else Ya=1<<s|r<<a|o,Qa=e}function es(e){null!==e.return&&($a(e,1),Xa(e,1,0))}function ts(e){for(;e===qa;)qa=Ga[--Ha],Ga[Ha]=null,Va=Ga[--Ha],Ga[Ha]=null;for(;e===Ka;)Ka=Ja[--Za],Ja[Za]=null,Qa=Ja[--Za],Ja[Za]=null,Ya=Ja[--Za],Ja[Za]=null}var rs=null,os=null,as=!1,ss=null;function ns(e,t){var r=Ec(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function is(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,os=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,os=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Ka?{id:Ya,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Ec(18,null,null,0)).stateNode=t,r.return=e,e.child=r,rs=e,os=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(as){var t=os;if(t){var r=t;if(!is(e,t)){if(ls(e))throw Error(s(418));t=ca(r.nextSibling);var o=rs;t&&is(e,t)?ns(o,r):(e.flags=-4097&e.flags|2,as=!1,rs=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,rs=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function us(e){if(e!==rs)return!1;if(!as)return ds(e),as=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ra(e.type,e.memoizedProps)),t&&(t=os)){if(ls(e))throw hs(),Error(s(418));for(;t;)ns(e,t),t=ca(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){os=ca(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}os=null}}else os=rs?ca(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=os;e;)e=ca(e.nextSibling)}function ms(){os=rs=null,as=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var gs=y.ReactCurrentBatchConfig;function fs(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(s(309));var o=r.stateNode}if(!o)throw Error(s(147,e));var a=o,n=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===n?t.ref:(t=function(e){var t=a.refs;null===e?delete t[n]:t[n]=e},t._stringRef=n,t)}if("string"!==typeof e)throw Error(s(284));if(!r._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,r){if(e){var o=t.deletions;null===o?(t.deletions=[r],t.flags|=16):o.push(r)}}function r(r,o){if(!e)return null;for(;null!==o;)t(r,o),o=o.sibling;return null}function o(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Lc(e,t)).index=0,e.sibling=null,e}function n(t,r,o){return t.index=o,e?null!==(o=t.alternate)?(o=o.index)<r?(t.flags|=2,r):o:(t.flags|=2,r):(t.flags|=1048576,r)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,o){return null===t||6!==t.tag?((t=Rc(r,e.mode,o)).return=e,t):((t=a(t,r)).return=e,t)}function c(e,t,r,o){var s=r.type;return s===k?u(e,t,r.props.children,o,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&xs(s)===t.type)?((o=a(t,r.props)).ref=fs(e,t,r),o.return=e,o):((o=Tc(r.type,r.key,r.props,null,e.mode,o)).ref=fs(e,t,r),o.return=e,o)}function d(e,t,r,o){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Oc(r,e.mode,o)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function u(e,t,r,o,s){return null===t||7!==t.tag?((t=Mc(r,e.mode,o,s)).return=e,t):((t=a(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Rc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Tc(t.type,t.key,t.props,null,e.mode,r)).ref=fs(e,null,t),r.return=e,r;case j:return(t=Oc(t,e.mode,r)).return=e,t;case D:return h(e,(0,t._init)(t._payload),r)}if(te(t)||M(t))return(t=Mc(t,e.mode,r,null)).return=e,t;vs(e,t)}return null}function m(e,t,r,o){var a=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==a?null:l(e,t,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===a?c(e,t,r,o):null;case j:return r.key===a?d(e,t,r,o):null;case D:return m(e,t,(a=r._init)(r._payload),o)}if(te(r)||M(r))return null!==a?null:u(e,t,r,o,null);vs(e,r)}return null}function p(e,t,r,o,a){if("string"===typeof o&&""!==o||"number"===typeof o)return l(t,e=e.get(r)||null,""+o,a);if("object"===typeof o&&null!==o){switch(o.$$typeof){case w:return c(t,e=e.get(null===o.key?r:o.key)||null,o,a);case j:return d(t,e=e.get(null===o.key?r:o.key)||null,o,a);case D:return p(e,t,r,(0,o._init)(o._payload),a)}if(te(o)||M(o))return u(t,e=e.get(r)||null,o,a,null);vs(t,o)}return null}function g(a,s,i,l){for(var c=null,d=null,u=s,g=s=0,f=null;null!==u&&g<i.length;g++){u.index>g?(f=u,u=null):f=u.sibling;var v=m(a,u,i[g],l);if(null===v){null===u&&(u=f);break}e&&u&&null===v.alternate&&t(a,u),s=n(v,s,g),null===d?c=v:d.sibling=v,d=v,u=f}if(g===i.length)return r(a,u),as&&$a(a,g),c;if(null===u){for(;g<i.length;g++)null!==(u=h(a,i[g],l))&&(s=n(u,s,g),null===d?c=u:d.sibling=u,d=u);return as&&$a(a,g),c}for(u=o(a,u);g<i.length;g++)null!==(f=p(u,a,g,i[g],l))&&(e&&null!==f.alternate&&u.delete(null===f.key?g:f.key),s=n(f,s,g),null===d?c=f:d.sibling=f,d=f);return e&&u.forEach(function(e){return t(a,e)}),as&&$a(a,g),c}function f(a,i,l,c){var d=M(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,g=i,f=i=0,v=null,x=l.next();null!==g&&!x.done;f++,x=l.next()){g.index>f?(v=g,g=null):v=g.sibling;var b=m(a,g,x.value,c);if(null===b){null===g&&(g=v);break}e&&g&&null===b.alternate&&t(a,g),i=n(b,i,f),null===u?d=b:u.sibling=b,u=b,g=v}if(x.done)return r(a,g),as&&$a(a,f),d;if(null===g){for(;!x.done;f++,x=l.next())null!==(x=h(a,x.value,c))&&(i=n(x,i,f),null===u?d=x:u.sibling=x,u=x);return as&&$a(a,f),d}for(g=o(a,g);!x.done;f++,x=l.next())null!==(x=p(g,a,f,x.value,c))&&(e&&null!==x.alternate&&g.delete(null===x.key?f:x.key),i=n(x,i,f),null===u?d=x:u.sibling=x,u=x);return e&&g.forEach(function(e){return t(a,e)}),as&&$a(a,f),d}return function e(o,s,n,l){if("object"===typeof n&&null!==n&&n.type===k&&null===n.key&&(n=n.props.children),"object"===typeof n&&null!==n){switch(n.$$typeof){case w:e:{for(var c=n.key,d=s;null!==d;){if(d.key===c){if((c=n.type)===k){if(7===d.tag){r(o,d.sibling),(s=a(d,n.props.children)).return=o,o=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&xs(c)===d.type){r(o,d.sibling),(s=a(d,n.props)).ref=fs(o,d,n),s.return=o,o=s;break e}r(o,d);break}t(o,d),d=d.sibling}n.type===k?((s=Mc(n.props.children,o.mode,l,n.key)).return=o,o=s):((l=Tc(n.type,n.key,n.props,null,o.mode,l)).ref=fs(o,s,n),l.return=o,o=l)}return i(o);case j:e:{for(d=n.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===n.containerInfo&&s.stateNode.implementation===n.implementation){r(o,s.sibling),(s=a(s,n.children||[])).return=o,o=s;break e}r(o,s);break}t(o,s),s=s.sibling}(s=Oc(n,o.mode,l)).return=o,o=s}return i(o);case D:return e(o,s,(d=n._init)(n._payload),l)}if(te(n))return g(o,s,n,l);if(M(n))return f(o,s,n,l);vs(o,n)}return"string"===typeof n&&""!==n||"number"===typeof n?(n=""+n,null!==s&&6===s.tag?(r(o,s.sibling),(s=a(s,n)).return=o,o=s):(r(o,s),(s=Rc(n,o.mode,l)).return=o,o=s),i(o)):r(o,s)}}var ys=bs(!0),ws=bs(!1),js=Sa(null),ks=null,Ss=null,Ns=null;function Cs(){Ns=Ss=ks=null}function _s(e){var t=js.current;Na(js),e._currentValue=t}function As(e,t,r){for(;null!==e;){var o=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==o&&(o.childLanes|=t)):null!==o&&(o.childLanes&t)!==t&&(o.childLanes|=t),e===r)break;e=e.return}}function Is(e,t){ks=e,Ns=Ss=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bi=!0),e.firstContext=null)}function Ps(e){var t=e._currentValue;if(Ns!==e)if(e={context:e,memoizedValue:t,next:null},null===Ss){if(null===ks)throw Error(s(308));Ss=e,ks.dependencies={lanes:0,firstContext:e}}else Ss=Ss.next=e;return t}var Es=null;function Ds(e){null===Es?Es=[e]:Es.push(e)}function Ls(e,t,r,o){var a=t.interleaved;return null===a?(r.next=r,Ds(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ts(e,o)}function Ts(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Ms=!1;function Fs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,r){var o=e.updateQueue;if(null===o)return null;if(o=o.shared,0!==(2&Al)){var a=o.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),o.pending=t,Ts(e,r)}return null===(a=o.interleaved)?(t.next=t,Ds(o)):(t.next=a.next,a.next=t),o.interleaved=t,Ts(e,r)}function zs(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var o=t.lanes;r|=o&=e.pendingLanes,t.lanes=r,xt(e,r)}}function Ws(e,t){var r=e.updateQueue,o=e.alternate;if(null!==o&&r===(o=o.updateQueue)){var a=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var n={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===s?a=s=n:s=s.next=n,r=r.next}while(null!==r);null===s?a=s=t:s=s.next=t}else a=s=t;return r={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:o.shared,effects:o.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Bs(e,t,r,o){var a=e.updateQueue;Ms=!1;var s=a.firstBaseUpdate,n=a.lastBaseUpdate,i=a.shared.pending;if(null!==i){a.shared.pending=null;var l=i,c=l.next;l.next=null,null===n?s=c:n.next=c,n=l;var d=e.alternate;null!==d&&((i=(d=d.updateQueue).lastBaseUpdate)!==n&&(null===i?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=a.baseState;for(n=0,d=c=l=null,i=s;;){var h=i.lane,m=i.eventTime;if((o&h)===h){null!==d&&(d=d.next={eventTime:m,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var p=e,g=i;switch(h=t,m=r,g.tag){case 1:if("function"===typeof(p=g.payload)){u=p.call(m,u,h);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=g.payload)?p.call(m,u,h):p)||void 0===h)break e;u=R({},u,h);break e;case 2:Ms=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[i]:h.push(i))}else m={eventTime:m,lane:h,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===d?(c=d=m,l=u):d=d.next=m,n|=h;if(null===(i=i.next)){if(null===(i=a.shared.pending))break;i=(h=i).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{n|=a.lane,a=a.next}while(a!==t)}else null===s&&(a.shared.lanes=0);Fl|=n,e.lanes=n,e.memoizedState=u}}function Gs(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var o=e[t],a=o.callback;if(null!==a){if(o.callback=null,o=r,"function"!==typeof a)throw Error(s(191,a));a.call(o)}}}var Hs={},qs=Sa(Hs),Vs=Sa(Hs),Js=Sa(Hs);function Zs(e){if(e===Hs)throw Error(s(174));return e}function Ks(e,t){switch(Ca(Js,t),Ca(Vs,e),Ca(qs,Hs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Na(qs),Ca(qs,t)}function Ys(){Na(qs),Na(Vs),Na(Js)}function Qs(e){Zs(Js.current);var t=Zs(qs.current),r=le(t,e.type);t!==r&&(Ca(Vs,e),Ca(qs,r))}function $s(e){Vs.current===e&&(Na(qs),Na(Vs))}var Xs=Sa(0);function en(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tn=[];function rn(){for(var e=0;e<tn.length;e++)tn[e]._workInProgressVersionPrimary=null;tn.length=0}var on=y.ReactCurrentDispatcher,an=y.ReactCurrentBatchConfig,sn=0,nn=null,ln=null,cn=null,dn=!1,un=!1,hn=0,mn=0;function pn(){throw Error(s(321))}function gn(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!no(e[r],t[r]))return!1;return!0}function fn(e,t,r,o,a,n){if(sn=n,nn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,on.current=null===e||null===e.memoizedState?Xn:ei,e=r(o,a),un){n=0;do{if(un=!1,hn=0,25<=n)throw Error(s(301));n+=1,cn=ln=null,t.updateQueue=null,on.current=ti,e=r(o,a)}while(un)}if(on.current=$n,t=null!==ln&&null!==ln.next,sn=0,cn=ln=nn=null,dn=!1,t)throw Error(s(300));return e}function vn(){var e=0!==hn;return hn=0,e}function xn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===cn?nn.memoizedState=cn=e:cn=cn.next=e,cn}function bn(){if(null===ln){var e=nn.alternate;e=null!==e?e.memoizedState:null}else e=ln.next;var t=null===cn?nn.memoizedState:cn.next;if(null!==t)cn=t,ln=e;else{if(null===e)throw Error(s(310));e={memoizedState:(ln=e).memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},null===cn?nn.memoizedState=cn=e:cn=cn.next=e}return cn}function yn(e,t){return"function"===typeof t?t(e):t}function wn(e){var t=bn(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var o=ln,a=o.baseQueue,n=r.pending;if(null!==n){if(null!==a){var i=a.next;a.next=n.next,n.next=i}o.baseQueue=a=n,r.pending=null}if(null!==a){n=a.next,o=o.baseState;var l=i=null,c=null,d=n;do{var u=d.lane;if((sn&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),o=d.hasEagerState?d.eagerState:e(o,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,i=o):c=c.next=h,nn.lanes|=u,Fl|=u}d=d.next}while(null!==d&&d!==n);null===c?i=o:c.next=l,no(o,t.memoizedState)||(bi=!0),t.memoizedState=o,t.baseState=i,t.baseQueue=c,r.lastRenderedState=o}if(null!==(e=r.interleaved)){a=e;do{n=a.lane,nn.lanes|=n,Fl|=n,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function jn(e){var t=bn(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var o=r.dispatch,a=r.pending,n=t.memoizedState;if(null!==a){r.pending=null;var i=a=a.next;do{n=e(n,i.action),i=i.next}while(i!==a);no(n,t.memoizedState)||(bi=!0),t.memoizedState=n,null===t.baseQueue&&(t.baseState=n),r.lastRenderedState=n}return[n,o]}function kn(){}function Sn(e,t){var r=nn,o=bn(),a=t(),n=!no(o.memoizedState,a);if(n&&(o.memoizedState=a,bi=!0),o=o.queue,Fn(_n.bind(null,r,o,e),[e]),o.getSnapshot!==t||n||null!==cn&&1&cn.memoizedState.tag){if(r.flags|=2048,En(9,Cn.bind(null,r,o,a,t),void 0,null),null===Il)throw Error(s(349));0!==(30&sn)||Nn(r,t,a)}return a}function Nn(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=nn.updateQueue)?(t={lastEffect:null,stores:null},nn.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Cn(e,t,r,o){t.value=r,t.getSnapshot=o,An(t)&&In(e)}function _n(e,t,r){return r(function(){An(t)&&In(e)})}function An(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!no(e,r)}catch(o){return!0}}function In(e){var t=Ts(e,1);null!==t&&rc(t,e,1,-1)}function Pn(e){var t=xn();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:e},t.queue=e,e=e.dispatch=Zn.bind(null,nn,e),[t.memoizedState,e]}function En(e,t,r,o){return e={tag:e,create:t,destroy:r,deps:o,next:null},null===(t=nn.updateQueue)?(t={lastEffect:null,stores:null},nn.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(o=r.next,r.next=e,e.next=o,t.lastEffect=e),e}function Dn(){return bn().memoizedState}function Ln(e,t,r,o){var a=xn();nn.flags|=e,a.memoizedState=En(1|t,r,void 0,void 0===o?null:o)}function Tn(e,t,r,o){var a=bn();o=void 0===o?null:o;var s=void 0;if(null!==ln){var n=ln.memoizedState;if(s=n.destroy,null!==o&&gn(o,n.deps))return void(a.memoizedState=En(t,r,s,o))}nn.flags|=e,a.memoizedState=En(1|t,r,s,o)}function Mn(e,t){return Ln(8390656,8,e,t)}function Fn(e,t){return Tn(2048,8,e,t)}function Rn(e,t){return Tn(4,2,e,t)}function On(e,t){return Tn(4,4,e,t)}function Un(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zn(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Tn(4,4,Un.bind(null,t,e),r)}function Wn(){}function Bn(e,t){var r=bn();t=void 0===t?null:t;var o=r.memoizedState;return null!==o&&null!==t&&gn(t,o[1])?o[0]:(r.memoizedState=[e,t],e)}function Gn(e,t){var r=bn();t=void 0===t?null:t;var o=r.memoizedState;return null!==o&&null!==t&&gn(t,o[1])?o[0]:(e=e(),r.memoizedState=[e,t],e)}function Hn(e,t,r){return 0===(21&sn)?(e.baseState&&(e.baseState=!1,bi=!0),e.memoizedState=r):(no(r,t)||(r=gt(),nn.lanes|=r,Fl|=r,e.baseState=!0),t)}function qn(e,t){var r=bt;bt=0!==r&&4>r?r:4,e(!0);var o=an.transition;an.transition={};try{e(!1),t()}finally{bt=r,an.transition=o}}function Vn(){return bn().memoizedState}function Jn(e,t,r){var o=tc(e);if(r={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null},Kn(e))Yn(t,r);else if(null!==(r=Ls(e,t,r,o))){rc(r,e,o,ec()),Qn(r,t,o)}}function Zn(e,t,r){var o=tc(e),a={lane:o,action:r,hasEagerState:!1,eagerState:null,next:null};if(Kn(e))Yn(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var n=t.lastRenderedState,i=s(n,r);if(a.hasEagerState=!0,a.eagerState=i,no(i,n)){var l=t.interleaved;return null===l?(a.next=a,Ds(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(r=Ls(e,t,a,o))&&(rc(r,e,o,a=ec()),Qn(r,t,o))}}function Kn(e){var t=e.alternate;return e===nn||null!==t&&t===nn}function Yn(e,t){un=dn=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Qn(e,t,r){if(0!==(4194240&r)){var o=t.lanes;r|=o&=e.pendingLanes,t.lanes=r,xt(e,r)}}var $n={readContext:Ps,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useInsertionEffect:pn,useLayoutEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useMutableSource:pn,useSyncExternalStore:pn,useId:pn,unstable_isNewReconciler:!1},Xn={readContext:Ps,useCallback:function(e,t){return xn().memoizedState=[e,void 0===t?null:t],e},useContext:Ps,useEffect:Mn,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Ln(4194308,4,Un.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Ln(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ln(4,2,e,t)},useMemo:function(e,t){var r=xn();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var o=xn();return t=void 0!==r?r(t):t,o.memoizedState=o.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},o.queue=e,e=e.dispatch=Jn.bind(null,nn,e),[o.memoizedState,e]},useRef:function(e){return e={current:e},xn().memoizedState=e},useState:Pn,useDebugValue:Wn,useDeferredValue:function(e){return xn().memoizedState=e},useTransition:function(){var e=Pn(!1),t=e[0];return e=qn.bind(null,e[1]),xn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var o=nn,a=xn();if(as){if(void 0===r)throw Error(s(407));r=r()}else{if(r=t(),null===Il)throw Error(s(349));0!==(30&sn)||Nn(o,t,r)}a.memoizedState=r;var n={value:r,getSnapshot:t};return a.queue=n,Mn(_n.bind(null,o,n,e),[e]),o.flags|=2048,En(9,Cn.bind(null,o,n,r,t),void 0,null),r},useId:function(){var e=xn(),t=Il.identifierPrefix;if(as){var r=Qa;t=":"+t+"R"+(r=(Ya&~(1<<32-nt(Ya)-1)).toString(32)+r),0<(r=hn++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=mn++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ei={readContext:Ps,useCallback:Bn,useContext:Ps,useEffect:Fn,useImperativeHandle:zn,useInsertionEffect:Rn,useLayoutEffect:On,useMemo:Gn,useReducer:wn,useRef:Dn,useState:function(){return wn(yn)},useDebugValue:Wn,useDeferredValue:function(e){return Hn(bn(),ln.memoizedState,e)},useTransition:function(){return[wn(yn)[0],bn().memoizedState]},useMutableSource:kn,useSyncExternalStore:Sn,useId:Vn,unstable_isNewReconciler:!1},ti={readContext:Ps,useCallback:Bn,useContext:Ps,useEffect:Fn,useImperativeHandle:zn,useInsertionEffect:Rn,useLayoutEffect:On,useMemo:Gn,useReducer:jn,useRef:Dn,useState:function(){return jn(yn)},useDebugValue:Wn,useDeferredValue:function(e){var t=bn();return null===ln?t.memoizedState=e:Hn(t,ln.memoizedState,e)},useTransition:function(){return[jn(yn)[0],bn().memoizedState]},useMutableSource:kn,useSyncExternalStore:Sn,useId:Vn,unstable_isNewReconciler:!1};function ri(e,t){if(e&&e.defaultProps){for(var r in t=R({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function oi(e,t,r,o){r=null===(r=r(o,t=e.memoizedState))||void 0===r?t:R({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var ai={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var o=ec(),a=tc(e),s=Os(o,a);s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Us(e,s,a))&&(rc(t,e,a,o),zs(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var o=ec(),a=tc(e),s=Os(o,a);s.tag=1,s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Us(e,s,a))&&(rc(t,e,a,o),zs(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),o=tc(e),a=Os(r,o);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Us(e,a,o))&&(rc(t,e,o,r),zs(t,e,o))}};function si(e,t,r,o,a,s,n){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(o,s,n):!t.prototype||!t.prototype.isPureReactComponent||(!io(r,o)||!io(a,s))}function ni(e,t,r){var o=!1,a=_a,s=t.contextType;return"object"===typeof s&&null!==s?s=Ps(s):(a=Da(t)?Pa:Aa.current,s=(o=null!==(o=t.contextTypes)&&void 0!==o)?Ea(e,a):_a),t=new t(r,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ai,e.stateNode=t,t._reactInternals=e,o&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function ii(e,t,r,o){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,o),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,o),t.state!==e&&ai.enqueueReplaceState(t,t.state,null)}function li(e,t,r,o){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Fs(e);var s=t.contextType;"object"===typeof s&&null!==s?a.context=Ps(s):(s=Da(t)?Pa:Aa.current,a.context=Ea(e,s)),a.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(oi(e,t,s,r),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&ai.enqueueReplaceState(a,a.state,null),Bs(e,r,a,o),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function ci(e,t){try{var r="",o=t;do{r+=W(o),o=o.return}while(o);var a=r}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:a,digest:null}}function di(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function ui(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var hi="function"===typeof WeakMap?WeakMap:Map;function mi(e,t,r){(r=Os(-1,r)).tag=3,r.payload={element:null};var o=t.value;return r.callback=function(){Hl||(Hl=!0,ql=o),ui(0,t)},r}function pi(e,t,r){(r=Os(-1,r)).tag=3;var o=e.type.getDerivedStateFromError;if("function"===typeof o){var a=t.value;r.payload=function(){return o(a)},r.callback=function(){ui(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(r.callback=function(){ui(0,t),"function"!==typeof o&&(null===Vl?Vl=new Set([this]):Vl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function gi(e,t,r){var o=e.pingCache;if(null===o){o=e.pingCache=new hi;var a=new Set;o.set(t,a)}else void 0===(a=o.get(t))&&(a=new Set,o.set(t,a));a.has(r)||(a.add(r),e=Nc.bind(null,e,t,r),t.then(e,e))}function fi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vi(e,t,r,o,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Os(-1,1)).tag=2,Us(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var xi=y.ReactCurrentOwner,bi=!1;function yi(e,t,r,o){t.child=null===e?ws(t,null,r,o):ys(t,e.child,r,o)}function wi(e,t,r,o,a){r=r.render;var s=t.ref;return Is(t,a),o=fn(e,t,r,o,s,a),r=vn(),null===e||bi?(as&&r&&es(t),t.flags|=1,yi(e,t,o,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hi(e,t,a))}function ji(e,t,r,o,a){if(null===e){var s=r.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Tc(r.type,null,o,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,ki(e,t,s,o,a))}if(s=e.child,0===(e.lanes&a)){var n=s.memoizedProps;if((r=null!==(r=r.compare)?r:io)(n,o)&&e.ref===t.ref)return Hi(e,t,a)}return t.flags|=1,(e=Lc(s,o)).ref=t.ref,e.return=t,t.child=e}function ki(e,t,r,o,a){if(null!==e){var s=e.memoizedProps;if(io(s,o)&&e.ref===t.ref){if(bi=!1,t.pendingProps=o=s,0===(e.lanes&a))return t.lanes=e.lanes,Hi(e,t,a);0!==(131072&e.flags)&&(bi=!0)}}return Ci(e,t,r,o,a)}function Si(e,t,r){var o=t.pendingProps,a=o.children,s=null!==e?e.memoizedState:null;if("hidden"===o.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ca(Ll,Dl),Dl|=r;else{if(0===(1073741824&r))return e=null!==s?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ca(Ll,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=null!==s?s.baseLanes:r,Ca(Ll,Dl),Dl|=o}else null!==s?(o=s.baseLanes|r,t.memoizedState=null):o=r,Ca(Ll,Dl),Dl|=o;return yi(e,t,a,r),t.child}function Ni(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ci(e,t,r,o,a){var s=Da(r)?Pa:Aa.current;return s=Ea(t,s),Is(t,a),r=fn(e,t,r,o,s,a),o=vn(),null===e||bi?(as&&o&&es(t),t.flags|=1,yi(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Hi(e,t,a))}function _i(e,t,r,o,a){if(Da(r)){var s=!0;Fa(t)}else s=!1;if(Is(t,a),null===t.stateNode)Gi(e,t),ni(t,r,o),li(t,r,o,a),o=!0;else if(null===e){var n=t.stateNode,i=t.memoizedProps;n.props=i;var l=n.context,c=r.contextType;"object"===typeof c&&null!==c?c=Ps(c):c=Ea(t,c=Da(r)?Pa:Aa.current);var d=r.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof n.getSnapshotBeforeUpdate;u||"function"!==typeof n.UNSAFE_componentWillReceiveProps&&"function"!==typeof n.componentWillReceiveProps||(i!==o||l!==c)&&ii(t,n,o,c),Ms=!1;var h=t.memoizedState;n.state=h,Bs(t,o,n,a),l=t.memoizedState,i!==o||h!==l||Ia.current||Ms?("function"===typeof d&&(oi(t,r,d,o),l=t.memoizedState),(i=Ms||si(t,r,i,o,h,l,c))?(u||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||("function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount()),"function"===typeof n.componentDidMount&&(t.flags|=4194308)):("function"===typeof n.componentDidMount&&(t.flags|=4194308),t.memoizedProps=o,t.memoizedState=l),n.props=o,n.state=l,n.context=c,o=i):("function"===typeof n.componentDidMount&&(t.flags|=4194308),o=!1)}else{n=t.stateNode,Rs(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ri(t.type,i),n.props=c,u=t.pendingProps,h=n.context,"object"===typeof(l=r.contextType)&&null!==l?l=Ps(l):l=Ea(t,l=Da(r)?Pa:Aa.current);var m=r.getDerivedStateFromProps;(d="function"===typeof m||"function"===typeof n.getSnapshotBeforeUpdate)||"function"!==typeof n.UNSAFE_componentWillReceiveProps&&"function"!==typeof n.componentWillReceiveProps||(i!==u||h!==l)&&ii(t,n,o,l),Ms=!1,h=t.memoizedState,n.state=h,Bs(t,o,n,a);var p=t.memoizedState;i!==u||h!==p||Ia.current||Ms?("function"===typeof m&&(oi(t,r,m,o),p=t.memoizedState),(c=Ms||si(t,r,c,o,h,p,l)||!1)?(d||"function"!==typeof n.UNSAFE_componentWillUpdate&&"function"!==typeof n.componentWillUpdate||("function"===typeof n.componentWillUpdate&&n.componentWillUpdate(o,p,l),"function"===typeof n.UNSAFE_componentWillUpdate&&n.UNSAFE_componentWillUpdate(o,p,l)),"function"===typeof n.componentDidUpdate&&(t.flags|=4),"function"===typeof n.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof n.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof n.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=o,t.memoizedState=p),n.props=o,n.state=p,n.context=l,o=c):("function"!==typeof n.componentDidUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof n.getSnapshotBeforeUpdate||i===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),o=!1)}return Ai(e,t,r,o,s,a)}function Ai(e,t,r,o,a,s){Ni(e,t);var n=0!==(128&t.flags);if(!o&&!n)return a&&Ra(t,r,!1),Hi(e,t,s);o=t.stateNode,xi.current=t;var i=n&&"function"!==typeof r.getDerivedStateFromError?null:o.render();return t.flags|=1,null!==e&&n?(t.child=ys(t,e.child,null,s),t.child=ys(t,null,i,s)):yi(e,t,i,s),t.memoizedState=o.state,a&&Ra(t,r,!0),t.child}function Ii(e){var t=e.stateNode;t.pendingContext?Ta(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ta(0,t.context,!1),Ks(e,t.containerInfo)}function Pi(e,t,r,o,a){return ms(),ps(a),t.flags|=256,yi(e,t,r,o),t.child}var Ei,Di,Li,Ti,Mi={dehydrated:null,treeContext:null,retryLane:0};function Fi(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ri(e,t,r){var o,a=t.pendingProps,n=Xs.current,i=!1,l=0!==(128&t.flags);if((o=l)||(o=(null===e||null!==e.memoizedState)&&0!==(2&n)),o?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(n|=1),Ca(Xs,1&n),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=a.children,e=a.fallback,i?(a=t.mode,i=t.child,l={mode:"hidden",children:l},0===(1&a)&&null!==i?(i.childLanes=0,i.pendingProps=l):i=Fc(l,a,0,null),e=Mc(e,a,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fi(r),t.memoizedState=Mi,e):Oi(t,l));if(null!==(n=e.memoizedState)&&null!==(o=n.dehydrated))return function(e,t,r,o,a,n,i){if(r)return 256&t.flags?(t.flags&=-257,Ui(e,t,i,o=di(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(n=o.fallback,a=t.mode,o=Fc({mode:"visible",children:o.children},a,0,null),(n=Mc(n,a,i,null)).flags|=2,o.return=t,n.return=t,o.sibling=n,t.child=o,0!==(1&t.mode)&&ys(t,e.child,null,i),t.child.memoizedState=Fi(i),t.memoizedState=Mi,n);if(0===(1&t.mode))return Ui(e,t,i,null);if("$!"===a.data){if(o=a.nextSibling&&a.nextSibling.dataset)var l=o.dgst;return o=l,Ui(e,t,i,o=di(n=Error(s(419)),o,void 0))}if(l=0!==(i&e.childLanes),bi||l){if(null!==(o=Il)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(o.suspendedLanes|i))?0:a)&&a!==n.retryLane&&(n.retryLane=a,Ts(e,a),rc(o,e,a,-1))}return gc(),Ui(e,t,i,o=di(Error(s(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),a._reactRetry=t,null):(e=n.treeContext,os=ca(a.nextSibling),rs=t,as=!0,ss=null,null!==e&&(Ja[Za++]=Ya,Ja[Za++]=Qa,Ja[Za++]=Ka,Ya=e.id,Qa=e.overflow,Ka=t),t=Oi(t,o.children),t.flags|=4096,t)}(e,t,l,a,o,n,r);if(i){i=a.fallback,l=t.mode,o=(n=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&l)&&t.child!==n?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Lc(n,c)).subtreeFlags=14680064&n.subtreeFlags,null!==o?i=Lc(o,i):(i=Mc(i,l,r,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,l=null===(l=e.child.memoizedState)?Fi(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=e.childLanes&~r,t.memoizedState=Mi,a}return e=(i=e.child).sibling,a=Lc(i,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Oi(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ui(e,t,r,o){return null!==o&&ps(o),ys(t,e.child,null,r),(e=Oi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zi(e,t,r){e.lanes|=t;var o=e.alternate;null!==o&&(o.lanes|=t),As(e.return,t,r)}function Wi(e,t,r,o,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:o,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=o,s.tail=r,s.tailMode=a)}function Bi(e,t,r){var o=t.pendingProps,a=o.revealOrder,s=o.tail;if(yi(e,t,o.children,r),0!==(2&(o=Xs.current)))o=1&o|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zi(e,r,t);else if(19===e.tag)zi(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(Ca(Xs,o),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===en(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Wi(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===en(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Wi(t,!0,r,null,s);break;case"together":Wi(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Gi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hi(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(r=Lc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Lc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function qi(e,t){if(!as)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var o=null;null!==r;)null!==r.alternate&&(o=r),r=r.sibling;null===o?t||null===e.tail?e.tail=null:e.tail.sibling=null:o.sibling=null}}function Vi(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,o=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,o|=14680064&a.subtreeFlags,o|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=o,e.childLanes=r,t}function Ji(e,t,r){var o=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vi(t),null;case 1:case 17:return Da(t.type)&&La(),Vi(t),null;case 3:return o=t.stateNode,Ys(),Na(Ia),Na(Aa),rn(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(nc(ss),ss=null))),Di(e,t),Vi(t),null;case 5:$s(t);var a=Zs(Js.current);if(r=t.type,null!==e&&null!=t.stateNode)Li(e,t,r,o,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!o){if(null===t.stateNode)throw Error(s(166));return Vi(t),null}if(e=Zs(qs.current),us(t)){o=t.stateNode,r=t.type;var n=t.memoizedProps;switch(o[ha]=t,o[ma]=n,e=0!==(1&t.mode),r){case"dialog":Uo("cancel",o),Uo("close",o);break;case"iframe":case"object":case"embed":Uo("load",o);break;case"video":case"audio":for(a=0;a<Mo.length;a++)Uo(Mo[a],o);break;case"source":Uo("error",o);break;case"img":case"image":case"link":Uo("error",o),Uo("load",o);break;case"details":Uo("toggle",o);break;case"input":Y(o,n),Uo("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!n.multiple},Uo("invalid",o);break;case"textarea":ae(o,n),Uo("invalid",o)}for(var l in xe(r,n),a=null,n)if(n.hasOwnProperty(l)){var c=n[l];"children"===l?"string"===typeof c?o.textContent!==c&&(!0!==n.suppressHydrationWarning&&$o(o.textContent,c,e),a=["children",c]):"number"===typeof c&&o.textContent!==""+c&&(!0!==n.suppressHydrationWarning&&$o(o.textContent,c,e),a=["children",""+c]):i.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Uo("scroll",o)}switch(r){case"input":V(o),X(o,n,!0);break;case"textarea":V(o),ne(o);break;case"select":case"option":break;default:"function"===typeof n.onClick&&(o.onclick=Xo)}o=a,t.updateQueue=o,null!==o&&(t.flags|=4)}else{l=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof o.is?e=l.createElement(r,{is:o.is}):(e=l.createElement(r),"select"===r&&(l=e,o.multiple?l.multiple=!0:o.size&&(l.size=o.size))):e=l.createElementNS(e,r),e[ha]=t,e[ma]=o,Ei(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(r,o),r){case"dialog":Uo("cancel",e),Uo("close",e),a=o;break;case"iframe":case"object":case"embed":Uo("load",e),a=o;break;case"video":case"audio":for(a=0;a<Mo.length;a++)Uo(Mo[a],e);a=o;break;case"source":Uo("error",e),a=o;break;case"img":case"image":case"link":Uo("error",e),Uo("load",e),a=o;break;case"details":Uo("toggle",e),a=o;break;case"input":Y(e,o),a=K(e,o),Uo("invalid",e);break;case"option":default:a=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},a=R({},o,{value:void 0}),Uo("invalid",e);break;case"textarea":ae(e,o),a=oe(e,o),Uo("invalid",e)}for(n in xe(r,a),c=a)if(c.hasOwnProperty(n)){var d=c[n];"style"===n?fe(e,d):"dangerouslySetInnerHTML"===n?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===n?"string"===typeof d?("textarea"!==r||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&"autoFocus"!==n&&(i.hasOwnProperty(n)?null!=d&&"onScroll"===n&&Uo("scroll",e):null!=d&&b(e,n,d,l))}switch(r){case"input":V(e),X(e,o,!1);break;case"textarea":V(e),ne(e);break;case"option":null!=o.value&&e.setAttribute("value",""+H(o.value));break;case"select":e.multiple=!!o.multiple,null!=(n=o.value)?re(e,!!o.multiple,n,!1):null!=o.defaultValue&&re(e,!!o.multiple,o.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Xo)}switch(r){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vi(t),null;case 6:if(e&&null!=t.stateNode)Ti(e,t,e.memoizedProps,o);else{if("string"!==typeof o&&null===t.stateNode)throw Error(s(166));if(r=Zs(Js.current),Zs(qs.current),us(t)){if(o=t.stateNode,r=t.memoizedProps,o[ha]=t,(n=o.nodeValue!==r)&&null!==(e=rs))switch(e.tag){case 3:$o(o.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$o(o.nodeValue,r,0!==(1&e.mode))}n&&(t.flags|=4)}else(o=(9===r.nodeType?r:r.ownerDocument).createTextNode(o))[ha]=t,t.stateNode=o}return Vi(t),null;case 13:if(Na(Xs),o=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==os&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ms(),t.flags|=98560,n=!1;else if(n=us(t),null!==o&&null!==o.dehydrated){if(null===e){if(!n)throw Error(s(318));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(s(317));n[ha]=t}else ms(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vi(t),n=!1}else null!==ss&&(nc(ss),ss=null),n=!0;if(!n)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((o=null!==o)!==(null!==e&&null!==e.memoizedState)&&o&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Xs.current)?0===Tl&&(Tl=3):gc())),null!==t.updateQueue&&(t.flags|=4),Vi(t),null);case 4:return Ys(),Di(e,t),null===e&&Bo(t.stateNode.containerInfo),Vi(t),null;case 10:return _s(t.type._context),Vi(t),null;case 19:if(Na(Xs),null===(n=t.memoizedState))return Vi(t),null;if(o=0!==(128&t.flags),null===(l=n.rendering))if(o)qi(n,!1);else{if(0!==Tl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=en(e))){for(t.flags|=128,qi(n,!1),null!==(o=l.updateQueue)&&(t.updateQueue=o,t.flags|=4),t.subtreeFlags=0,o=r,r=t.child;null!==r;)e=o,(n=r).flags&=14680066,null===(l=n.alternate)?(n.childLanes=0,n.lanes=e,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,e=l.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ca(Xs,1&Xs.current|2),t.child}e=e.sibling}null!==n.tail&&Qe()>Bl&&(t.flags|=128,o=!0,qi(n,!1),t.lanes=4194304)}else{if(!o)if(null!==(e=en(l))){if(t.flags|=128,o=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),qi(n,!0),null===n.tail&&"hidden"===n.tailMode&&!l.alternate&&!as)return Vi(t),null}else 2*Qe()-n.renderingStartTime>Bl&&1073741824!==r&&(t.flags|=128,o=!0,qi(n,!1),t.lanes=4194304);n.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=n.last)?r.sibling=l:t.child=l,n.last=l)}return null!==n.tail?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=Qe(),t.sibling=null,r=Xs.current,Ca(Xs,o?1&r|2:1&r),t):(Vi(t),null);case 22:case 23:return uc(),o=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==o&&(t.flags|=8192),o&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Vi(t),6&t.subtreeFlags&&(t.flags|=8192)):Vi(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Zi(e,t){switch(ts(t),t.tag){case 1:return Da(t.type)&&La(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Na(Ia),Na(Aa),rn(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $s(t),null;case 13:if(Na(Xs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ms()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Na(Xs),null;case 4:return Ys(),null;case 10:return _s(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ei=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Di=function(){},Li=function(e,t,r,o){var a=e.memoizedProps;if(a!==o){e=t.stateNode,Zs(qs.current);var s,n=null;switch(r){case"input":a=K(e,a),o=K(e,o),n=[];break;case"select":a=R({},a,{value:void 0}),o=R({},o,{value:void 0}),n=[];break;case"textarea":a=oe(e,a),o=oe(e,o),n=[];break;default:"function"!==typeof a.onClick&&"function"===typeof o.onClick&&(e.onclick=Xo)}for(d in xe(r,o),r=null,a)if(!o.hasOwnProperty(d)&&a.hasOwnProperty(d)&&null!=a[d])if("style"===d){var l=a[d];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(i.hasOwnProperty(d)?n||(n=[]):(n=n||[]).push(d,null));for(d in o){var c=o[d];if(l=null!=a?a[d]:void 0,o.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(n||(n=[]),n.push(d,r)),r=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(n=n||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(n=n||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(i.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Uo("scroll",e),n||l===c||(n=[])):(n=n||[]).push(d,c))}r&&(n=n||[]).push("style",r);var d=n;(t.updateQueue=d)&&(t.flags|=4)}},Ti=function(e,t,r,o){r!==o&&(t.flags|=4)};var Ki=!1,Yi=!1,Qi="function"===typeof WeakSet?WeakSet:Set,$i=null;function Xi(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(o){Sc(e,t,o)}else r.current=null}function el(e,t,r){try{r()}catch(o){Sc(e,t,o)}}var tl=!1;function rl(e,t,r){var o=t.updateQueue;if(null!==(o=null!==o?o.lastEffect:null)){var a=o=o.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&el(t,r,s)}a=a.next}while(a!==o)}}function ol(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var o=r.create;r.destroy=o()}r=r.next}while(r!==t)}}function al(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[ma],delete t[ga],delete t[fa],delete t[va])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nl(e){return 5===e.tag||3===e.tag||4===e.tag}function il(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||nl(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Xo));else if(4!==o&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var o=e.tag;if(5===o||6===o)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==o&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var dl=null,ul=!1;function hl(e,t,r){for(r=r.child;null!==r;)ml(e,t,r),r=r.sibling}function ml(e,t,r){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(at,r)}catch(i){}switch(r.tag){case 5:Yi||Xi(r,t);case 6:var o=dl,a=ul;dl=null,hl(e,t,r),ul=a,null!==(dl=o)&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):dl.removeChild(r.stateNode));break;case 18:null!==dl&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?la(e.parentNode,r):1===e.nodeType&&la(e,r),Bt(e)):la(dl,r.stateNode));break;case 4:o=dl,a=ul,dl=r.stateNode.containerInfo,ul=!0,hl(e,t,r),dl=o,ul=a;break;case 0:case 11:case 14:case 15:if(!Yi&&(null!==(o=r.updateQueue)&&null!==(o=o.lastEffect))){a=o=o.next;do{var s=a,n=s.destroy;s=s.tag,void 0!==n&&(0!==(2&s)||0!==(4&s))&&el(r,t,n),a=a.next}while(a!==o)}hl(e,t,r);break;case 1:if(!Yi&&(Xi(r,t),"function"===typeof(o=r.stateNode).componentWillUnmount))try{o.props=r.memoizedProps,o.state=r.memoizedState,o.componentWillUnmount()}catch(i){Sc(r,t,i)}hl(e,t,r);break;case 21:hl(e,t,r);break;case 22:1&r.mode?(Yi=(o=Yi)||null!==r.memoizedState,hl(e,t,r),Yi=o):hl(e,t,r);break;default:hl(e,t,r)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Qi),t.forEach(function(t){var o=Ac.bind(null,e,t);r.has(t)||(r.add(t),t.then(o,o))})}}function gl(e,t){var r=t.deletions;if(null!==r)for(var o=0;o<r.length;o++){var a=r[o];try{var n=e,i=t,l=i;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(s(160));ml(n,i,a),dl=null,ul=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(d){Sc(a,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)fl(t,e),t=t.sibling}function fl(e,t){var r=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),vl(e),4&o){try{rl(3,e,e.return),ol(3,e)}catch(f){Sc(e,e.return,f)}try{rl(5,e,e.return)}catch(f){Sc(e,e.return,f)}}break;case 1:gl(t,e),vl(e),512&o&&null!==r&&Xi(r,r.return);break;case 5:if(gl(t,e),vl(e),512&o&&null!==r&&Xi(r,r.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(f){Sc(e,e.return,f)}}if(4&o&&null!=(a=e.stateNode)){var n=e.memoizedProps,i=null!==r?r.memoizedProps:n,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===n.type&&null!=n.name&&Q(a,n),be(l,i);var d=be(l,n);for(i=0;i<c.length;i+=2){var u=c[i],h=c[i+1];"style"===u?fe(a,h):"dangerouslySetInnerHTML"===u?ue(a,h):"children"===u?he(a,h):b(a,u,h,d)}switch(l){case"input":$(a,n);break;case"textarea":se(a,n);break;case"select":var m=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!n.multiple;var p=n.value;null!=p?re(a,!!n.multiple,p,!1):m!==!!n.multiple&&(null!=n.defaultValue?re(a,!!n.multiple,n.defaultValue,!0):re(a,!!n.multiple,n.multiple?[]:"",!1))}a[ma]=n}catch(f){Sc(e,e.return,f)}}break;case 6:if(gl(t,e),vl(e),4&o){if(null===e.stateNode)throw Error(s(162));a=e.stateNode,n=e.memoizedProps;try{a.nodeValue=n}catch(f){Sc(e,e.return,f)}}break;case 3:if(gl(t,e),vl(e),4&o&&null!==r&&r.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(f){Sc(e,e.return,f)}break;case 4:default:gl(t,e),vl(e);break;case 13:gl(t,e),vl(e),8192&(a=e.child).flags&&(n=null!==a.memoizedState,a.stateNode.isHidden=n,!n||null!==a.alternate&&null!==a.alternate.memoizedState||(Wl=Qe())),4&o&&pl(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(Yi=(d=Yi)||u,gl(t,e),Yi=d):gl(t,e),vl(e),8192&o){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for($i=e,u=e.child;null!==u;){for(h=$i=u;null!==$i;){switch(p=(m=$i).child,m.tag){case 0:case 11:case 14:case 15:rl(4,m,m.return);break;case 1:Xi(m,m.return);var g=m.stateNode;if("function"===typeof g.componentWillUnmount){o=m,r=m.return;try{t=o,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(f){Sc(o,r,f)}}break;case 5:Xi(m,m.return);break;case 22:if(null!==m.memoizedState){wl(h);continue}}null!==p?(p.return=m,$i=p):wl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{a=h.stateNode,d?"function"===typeof(n=a.style).setProperty?n.setProperty("display","none","important"):n.display="none":(l=h.stateNode,i=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",i))}catch(f){Sc(e,e.return,f)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(f){Sc(e,e.return,f)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),vl(e),4&o&&pl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(nl(r)){var o=r;break e}r=r.return}throw Error(s(160))}switch(o.tag){case 5:var a=o.stateNode;32&o.flags&&(he(a,""),o.flags&=-33),cl(e,il(e),a);break;case 3:case 4:var n=o.stateNode.containerInfo;ll(e,il(e),n);break;default:throw Error(s(161))}}catch(i){Sc(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function xl(e,t,r){$i=e,bl(e,t,r)}function bl(e,t,r){for(var o=0!==(1&e.mode);null!==$i;){var a=$i,s=a.child;if(22===a.tag&&o){var n=null!==a.memoizedState||Ki;if(!n){var i=a.alternate,l=null!==i&&null!==i.memoizedState||Yi;i=Ki;var c=Yi;if(Ki=n,(Yi=l)&&!c)for($i=a;null!==$i;)l=(n=$i).child,22===n.tag&&null!==n.memoizedState?jl(a):null!==l?(l.return=n,$i=l):jl(a);for(;null!==s;)$i=s,bl(s,t,r),s=s.sibling;$i=a,Ki=i,Yi=c}yl(e)}else 0!==(8772&a.subtreeFlags)&&null!==s?(s.return=a,$i=s):yl(e)}}function yl(e){for(;null!==$i;){var t=$i;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yi||ol(5,t);break;case 1:var o=t.stateNode;if(4&t.flags&&!Yi)if(null===r)o.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:ri(t.type,r.memoizedProps);o.componentDidUpdate(a,r.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var n=t.updateQueue;null!==n&&Gs(t,n,o);break;case 3:var i=t.updateQueue;if(null!==i){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Gs(t,i,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(s(163))}Yi||512&t.flags&&al(t)}catch(m){Sc(t,t.return,m)}}if(t===e){$i=null;break}if(null!==(r=t.sibling)){r.return=t.return,$i=r;break}$i=t.return}}function wl(e){for(;null!==$i;){var t=$i;if(t===e){$i=null;break}var r=t.sibling;if(null!==r){r.return=t.return,$i=r;break}$i=t.return}}function jl(e){for(;null!==$i;){var t=$i;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{ol(4,t)}catch(l){Sc(t,r,l)}break;case 1:var o=t.stateNode;if("function"===typeof o.componentDidMount){var a=t.return;try{o.componentDidMount()}catch(l){Sc(t,a,l)}}var s=t.return;try{al(t)}catch(l){Sc(t,s,l)}break;case 5:var n=t.return;try{al(t)}catch(l){Sc(t,n,l)}}}catch(l){Sc(t,t.return,l)}if(t===e){$i=null;break}var i=t.sibling;if(null!==i){i.return=t.return,$i=i;break}$i=t.return}}var kl,Sl=Math.ceil,Nl=y.ReactCurrentDispatcher,Cl=y.ReactCurrentOwner,_l=y.ReactCurrentBatchConfig,Al=0,Il=null,Pl=null,El=0,Dl=0,Ll=Sa(0),Tl=0,Ml=null,Fl=0,Rl=0,Ol=0,Ul=null,zl=null,Wl=0,Bl=1/0,Gl=null,Hl=!1,ql=null,Vl=null,Jl=!1,Zl=null,Kl=0,Yl=0,Ql=null,$l=-1,Xl=0;function ec(){return 0!==(6&Al)?Qe():-1!==$l?$l:$l=Qe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==El?El&-El:null!==gs.transition?(0===Xl&&(Xl=gt()),Xl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,r,o){if(50<Yl)throw Yl=0,Ql=null,Error(s(185));vt(e,r,o),0!==(2&Al)&&e===Il||(e===Il&&(0===(2&Al)&&(Rl|=r),4===Tl&&ic(e,El)),oc(e,o),1===r&&0===Al&&0===(1&t.mode)&&(Bl=Qe()+500,Ua&&Ba()))}function oc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,o=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var n=31-nt(s),i=1<<n,l=a[n];-1===l?0!==(i&r)&&0===(i&o)||(a[n]=mt(i,t)):l<=t&&(e.expiredLanes|=i),s&=~i}}(e,t);var o=ht(e,e===Il?El:0);if(0===o)null!==r&&Ze(r),e.callbackNode=null,e.callbackPriority=0;else if(t=o&-o,e.callbackPriority!==t){if(null!=r&&Ze(r),1===t)0===e.tag?function(e){Ua=!0,Wa(e)}(lc.bind(null,e)):Wa(lc.bind(null,e)),na(function(){0===(6&Al)&&Ba()}),r=null;else{switch(yt(o)){case 1:r=Xe;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=ot}r=Ic(r,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ac(e,t){if($l=-1,Xl=0,0!==(6&Al))throw Error(s(327));var r=e.callbackNode;if(jc()&&e.callbackNode!==r)return null;var o=ht(e,e===Il?El:0);if(0===o)return null;if(0!==(30&o)||0!==(o&e.expiredLanes)||t)t=fc(e,o);else{t=o;var a=Al;Al|=2;var n=pc();for(Il===e&&El===t||(Gl=null,Bl=Qe()+500,hc(e,t));;)try{xc();break}catch(l){mc(e,l)}Cs(),Nl.current=n,Al=a,null!==Pl?t=0:(Il=null,El=0,t=Tl)}if(0!==t){if(2===t&&(0!==(a=pt(e))&&(o=a,t=sc(e,a))),1===t)throw r=Ml,hc(e,0),ic(e,o),oc(e,Qe()),r;if(6===t)ic(e,o);else{if(a=e.current.alternate,0===(30&o)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var o=0;o<r.length;o++){var a=r[o],s=a.getSnapshot;a=a.value;try{if(!no(s(),a))return!1}catch(i){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=fc(e,o))&&(0!==(n=pt(e))&&(o=n,t=sc(e,n))),1===t))throw r=Ml,hc(e,0),ic(e,o),oc(e,Qe()),r;switch(e.finishedWork=a,e.finishedLanes=o,t){case 0:case 1:throw Error(s(345));case 2:case 5:wc(e,zl,Gl);break;case 3:if(ic(e,o),(130023424&o)===o&&10<(t=Wl+500-Qe())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&o)!==o){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=oa(wc.bind(null,e,zl,Gl),t);break}wc(e,zl,Gl);break;case 4:if(ic(e,o),(4194240&o)===o)break;for(t=e.eventTimes,a=-1;0<o;){var i=31-nt(o);n=1<<i,(i=t[i])>a&&(a=i),o&=~n}if(o=a,10<(o=(120>(o=Qe()-o)?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*Sl(o/1960))-o)){e.timeoutHandle=oa(wc.bind(null,e,zl,Gl),o);break}wc(e,zl,Gl);break;default:throw Error(s(329))}}}return oc(e,Qe()),e.callbackNode===r?ac.bind(null,e):null}function sc(e,t){var r=Ul;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=fc(e,t))&&(t=zl,zl=r,null!==t&&nc(t)),e}function nc(e){null===zl?zl=e:zl.push.apply(zl,e)}function ic(e,t){for(t&=~Ol,t&=~Rl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-nt(t),o=1<<r;e[r]=-1,t&=~o}}function lc(e){if(0!==(6&Al))throw Error(s(327));jc();var t=ht(e,0);if(0===(1&t))return oc(e,Qe()),null;var r=fc(e,t);if(0!==e.tag&&2===r){var o=pt(e);0!==o&&(t=o,r=sc(e,o))}if(1===r)throw r=Ml,hc(e,0),ic(e,t),oc(e,Qe()),r;if(6===r)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,Gl),oc(e,Qe()),null}function cc(e,t){var r=Al;Al|=1;try{return e(t)}finally{0===(Al=r)&&(Bl=Qe()+500,Ua&&Ba())}}function dc(e){null!==Zl&&0===Zl.tag&&0===(6&Al)&&jc();var t=Al;Al|=1;var r=_l.transition,o=bt;try{if(_l.transition=null,bt=1,e)return e()}finally{bt=o,_l.transition=r,0===(6&(Al=t))&&Ba()}}function uc(){Dl=Ll.current,Na(Ll)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,aa(r)),null!==Pl)for(r=Pl.return;null!==r;){var o=r;switch(ts(o),o.tag){case 1:null!==(o=o.type.childContextTypes)&&void 0!==o&&La();break;case 3:Ys(),Na(Ia),Na(Aa),rn();break;case 5:$s(o);break;case 4:Ys();break;case 13:case 19:Na(Xs);break;case 10:_s(o.type._context);break;case 22:case 23:uc()}r=r.return}if(Il=e,Pl=e=Lc(e.current,null),El=Dl=t,Tl=0,Ml=null,Ol=Rl=Fl=0,zl=Ul=null,null!==Es){for(t=0;t<Es.length;t++)if(null!==(o=(r=Es[t]).interleaved)){r.interleaved=null;var a=o.next,s=r.pending;if(null!==s){var n=s.next;s.next=a,o.next=n}r.pending=o}Es=null}return e}function mc(e,t){for(;;){var r=Pl;try{if(Cs(),on.current=$n,dn){for(var o=nn.memoizedState;null!==o;){var a=o.queue;null!==a&&(a.pending=null),o=o.next}dn=!1}if(sn=0,cn=ln=nn=null,un=!1,hn=0,Cl.current=null,null===r||null===r.return){Tl=1,Ml=t,Pl=null;break}e:{var n=e,i=r.return,l=r,c=t;if(t=El,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=fi(i);if(null!==p){p.flags&=-257,vi(p,i,l,0,t),1&p.mode&&gi(n,d,t),c=d;var g=(t=p).updateQueue;if(null===g){var f=new Set;f.add(c),t.updateQueue=f}else g.add(c);break e}if(0===(1&t)){gi(n,d,t),gc();break e}c=Error(s(426))}else if(as&&1&l.mode){var v=fi(i);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vi(v,i,l,0,t),ps(ci(c,l));break e}}n=c=ci(c,l),4!==Tl&&(Tl=2),null===Ul?Ul=[n]:Ul.push(n),n=i;do{switch(n.tag){case 3:n.flags|=65536,t&=-t,n.lanes|=t,Ws(n,mi(0,c,t));break e;case 1:l=c;var x=n.type,b=n.stateNode;if(0===(128&n.flags)&&("function"===typeof x.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Vl||!Vl.has(b)))){n.flags|=65536,t&=-t,n.lanes|=t,Ws(n,pi(n,l,t));break e}}n=n.return}while(null!==n)}yc(r)}catch(y){t=y,Pl===r&&null!==r&&(Pl=r=r.return);continue}break}}function pc(){var e=Nl.current;return Nl.current=$n,null===e?$n:e}function gc(){0!==Tl&&3!==Tl&&2!==Tl||(Tl=4),null===Il||0===(268435455&Fl)&&0===(268435455&Rl)||ic(Il,El)}function fc(e,t){var r=Al;Al|=2;var o=pc();for(Il===e&&El===t||(Gl=null,hc(e,t));;)try{vc();break}catch(a){mc(e,a)}if(Cs(),Al=r,Nl.current=o,null!==Pl)throw Error(s(261));return Il=null,El=0,Tl}function vc(){for(;null!==Pl;)bc(Pl)}function xc(){for(;null!==Pl&&!Ke();)bc(Pl)}function bc(e){var t=kl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?yc(e):Pl=t,Cl.current=null}function yc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Ji(r,t,Dl)))return void(Pl=r)}else{if(null!==(r=Zi(r,t)))return r.flags&=32767,void(Pl=r);if(null===e)return Tl=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Tl&&(Tl=5)}function wc(e,t,r){var o=bt,a=_l.transition;try{_l.transition=null,bt=1,function(e,t,r,o){do{jc()}while(null!==Zl);if(0!==(6&Al))throw Error(s(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var n=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-nt(r),s=1<<a;t[a]=0,o[a]=-1,e[a]=-1,r&=~s}}(e,n),e===Il&&(Pl=Il=null,El=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Jl||(Jl=!0,Ic(tt,function(){return jc(),null})),n=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||n){n=_l.transition,_l.transition=null;var i=bt;bt=1;var l=Al;Al|=4,Cl.current=null,function(e,t){if(ea=Ht,mo(e=ho())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var o=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(o&&0!==o.rangeCount){r=o.anchorNode;var a=o.anchorOffset,n=o.focusNode;o=o.focusOffset;try{r.nodeType,n.nodeType}catch(w){r=null;break e}var i=0,l=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var p;h!==r||0!==a&&3!==h.nodeType||(l=i+a),h!==n||0!==o&&3!==h.nodeType||(c=i+o),3===h.nodeType&&(i+=h.nodeValue.length),null!==(p=h.firstChild);)m=h,h=p;for(;;){if(h===e)break t;if(m===r&&++d===a&&(l=i),m===n&&++u===o&&(c=i),null!==(p=h.nextSibling))break;m=(h=m).parentNode}h=p}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ta={focusedElem:e,selectionRange:r},Ht=!1,$i=t;null!==$i;)if(e=(t=$i).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,$i=e;else for(;null!==$i;){t=$i;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var f=g.memoizedProps,v=g.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?f:ri(t.type,f),v);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var y=t.stateNode.containerInfo;1===y.nodeType?y.textContent="":9===y.nodeType&&y.documentElement&&y.removeChild(y.documentElement);break;default:throw Error(s(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,$i=e;break}$i=t.return}g=tl,tl=!1}(e,r),fl(r,e),po(ta),Ht=!!ea,ta=ea=null,e.current=r,xl(r,e,a),Ye(),Al=l,bt=i,_l.transition=n}else e.current=r;if(Jl&&(Jl=!1,Zl=e,Kl=a),n=e.pendingLanes,0===n&&(Vl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),oc(e,Qe()),null!==t)for(o=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],o(a.value,{componentStack:a.stack,digest:a.digest});if(Hl)throw Hl=!1,e=ql,ql=null,e;0!==(1&Kl)&&0!==e.tag&&jc(),n=e.pendingLanes,0!==(1&n)?e===Ql?Yl++:(Yl=0,Ql=e):Yl=0,Ba()}(e,t,r,o)}finally{_l.transition=a,bt=o}return null}function jc(){if(null!==Zl){var e=yt(Kl),t=_l.transition,r=bt;try{if(_l.transition=null,bt=16>e?16:e,null===Zl)var o=!1;else{if(e=Zl,Zl=null,Kl=0,0!==(6&Al))throw Error(s(331));var a=Al;for(Al|=4,$i=e.current;null!==$i;){var n=$i,i=n.child;if(0!==(16&$i.flags)){var l=n.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for($i=d;null!==$i;){var u=$i;switch(u.tag){case 0:case 11:case 15:rl(8,u,n)}var h=u.child;if(null!==h)h.return=u,$i=h;else for(;null!==$i;){var m=(u=$i).sibling,p=u.return;if(sl(u),u===d){$i=null;break}if(null!==m){m.return=p,$i=m;break}$i=p}}}var g=n.alternate;if(null!==g){var f=g.child;if(null!==f){g.child=null;do{var v=f.sibling;f.sibling=null,f=v}while(null!==f)}}$i=n}}if(0!==(2064&n.subtreeFlags)&&null!==i)i.return=n,$i=i;else e:for(;null!==$i;){if(0!==(2048&(n=$i).flags))switch(n.tag){case 0:case 11:case 15:rl(9,n,n.return)}var x=n.sibling;if(null!==x){x.return=n.return,$i=x;break e}$i=n.return}}var b=e.current;for($i=b;null!==$i;){var y=(i=$i).child;if(0!==(2064&i.subtreeFlags)&&null!==y)y.return=i,$i=y;else e:for(i=b;null!==$i;){if(0!==(2048&(l=$i).flags))try{switch(l.tag){case 0:case 11:case 15:ol(9,l)}}catch(j){Sc(l,l.return,j)}if(l===i){$i=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,$i=w;break e}$i=l.return}}if(Al=a,Ba(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(at,e)}catch(j){}o=!0}return o}finally{bt=r,_l.transition=t}}return!1}function kc(e,t,r){e=Us(e,t=mi(0,t=ci(r,t),1),1),t=ec(),null!==e&&(vt(e,1,t),oc(e,t))}function Sc(e,t,r){if(3===e.tag)kc(e,e,r);else for(;null!==t;){if(3===t.tag){kc(t,e,r);break}if(1===t.tag){var o=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof o.componentDidCatch&&(null===Vl||!Vl.has(o))){t=Us(t,e=pi(t,e=ci(r,e),1),1),e=ec(),null!==t&&(vt(t,1,e),oc(t,e));break}}t=t.return}}function Nc(e,t,r){var o=e.pingCache;null!==o&&o.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Il===e&&(El&r)===r&&(4===Tl||3===Tl&&(130023424&El)===El&&500>Qe()-Wl?hc(e,0):Ol|=r),oc(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var r=ec();null!==(e=Ts(e,t))&&(vt(e,t,r),oc(e,r))}function _c(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Cc(e,r)}function Ac(e,t){var r=0;switch(e.tag){case 13:var o=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(s(314))}null!==o&&o.delete(t),Cc(e,r)}function Ic(e,t){return Je(e,t)}function Pc(e,t,r,o){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ec(e,t,r,o){return new Pc(e,t,r,o)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Lc(e,t){var r=e.alternate;return null===r?((r=Ec(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Tc(e,t,r,o,a,n){var i=2;if(o=e,"function"===typeof e)Dc(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case k:return Mc(r.children,a,n,t);case S:i=8,a|=8;break;case N:return(e=Ec(12,r,t,2|a)).elementType=N,e.lanes=n,e;case I:return(e=Ec(13,r,t,a)).elementType=I,e.lanes=n,e;case P:return(e=Ec(19,r,t,a)).elementType=P,e.lanes=n,e;case L:return Fc(r,a,n,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:i=10;break e;case _:i=9;break e;case A:i=11;break e;case E:i=14;break e;case D:i=16,o=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ec(i,r,t,a)).elementType=e,t.type=o,t.lanes=n,t}function Mc(e,t,r,o){return(e=Ec(7,e,o,t)).lanes=r,e}function Fc(e,t,r,o){return(e=Ec(22,e,o,t)).elementType=L,e.lanes=r,e.stateNode={isHidden:!1},e}function Rc(e,t,r){return(e=Ec(6,e,null,t)).lanes=r,e}function Oc(e,t,r){return(t=Ec(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,r,o,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ft(0),this.expirationTimes=ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ft(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,r,o,a,s,n,i,l){return e=new Uc(e,t,r,i,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ec(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:o,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fs(s),e}function Wc(e){if(!e)return _a;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Da(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var r=e.type;if(Da(r))return Ma(e,r,t)}return t}function Bc(e,t,r,o,a,s,n,i,l){return(e=zc(r,o,!0,e,0,s,0,i,l)).context=Wc(null),r=e.current,(s=Os(o=ec(),a=tc(r))).callback=void 0!==t&&null!==t?t:null,Us(r,s,a),e.current.lanes=a,vt(e,a,o),oc(e,o),e}function Gc(e,t,r,o){var a=t.current,s=ec(),n=tc(a);return r=Wc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Os(s,n)).payload={element:e},null!==(o=void 0===o?null:o)&&(t.callback=o),null!==(e=Us(a,t,n))&&(rc(e,a,n,s),zs(e,a,n)),n}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Vc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}kl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ia.current)bi=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return bi=!1,function(e,t,r){switch(t.tag){case 3:Ii(t),ms();break;case 5:Qs(t);break;case 1:Da(t.type)&&Fa(t);break;case 4:Ks(t,t.stateNode.containerInfo);break;case 10:var o=t.type._context,a=t.memoizedProps.value;Ca(js,o._currentValue),o._currentValue=a;break;case 13:if(null!==(o=t.memoizedState))return null!==o.dehydrated?(Ca(Xs,1&Xs.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Ri(e,t,r):(Ca(Xs,1&Xs.current),null!==(e=Hi(e,t,r))?e.sibling:null);Ca(Xs,1&Xs.current);break;case 19:if(o=0!==(r&t.childLanes),0!==(128&e.flags)){if(o)return Bi(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ca(Xs,Xs.current),o)break;return null;case 22:case 23:return t.lanes=0,Si(e,t,r)}return Hi(e,t,r)}(e,t,r);bi=0!==(131072&e.flags)}else bi=!1,as&&0!==(1048576&t.flags)&&Xa(t,Va,t.index);switch(t.lanes=0,t.tag){case 2:var o=t.type;Gi(e,t),e=t.pendingProps;var a=Ea(t,Aa.current);Is(t,r),a=fn(null,t,o,e,a,r);var n=vn();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Da(o)?(n=!0,Fa(t)):n=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Fs(t),a.updater=ai,t.stateNode=a,a._reactInternals=t,li(t,o,e,r),t=Ai(null,t,o,!0,n,r)):(t.tag=0,as&&n&&es(t),yi(null,t,a,r),t=t.child),t;case 16:o=t.elementType;e:{switch(Gi(e,t),e=t.pendingProps,o=(a=o._init)(o._payload),t.type=o,a=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===E)return 14}return 2}(o),e=ri(o,e),a){case 0:t=Ci(null,t,o,e,r);break e;case 1:t=_i(null,t,o,e,r);break e;case 11:t=wi(null,t,o,e,r);break e;case 14:t=ji(null,t,o,ri(o.type,e),r);break e}throw Error(s(306,o,""))}return t;case 0:return o=t.type,a=t.pendingProps,Ci(e,t,o,a=t.elementType===o?a:ri(o,a),r);case 1:return o=t.type,a=t.pendingProps,_i(e,t,o,a=t.elementType===o?a:ri(o,a),r);case 3:e:{if(Ii(t),null===e)throw Error(s(387));o=t.pendingProps,a=(n=t.memoizedState).element,Rs(e,t),Bs(t,o,null,r);var i=t.memoizedState;if(o=i.element,n.isDehydrated){if(n={element:o,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=n,t.memoizedState=n,256&t.flags){t=Pi(e,t,o,r,a=ci(Error(s(423)),t));break e}if(o!==a){t=Pi(e,t,o,r,a=ci(Error(s(424)),t));break e}for(os=ca(t.stateNode.containerInfo.firstChild),rs=t,as=!0,ss=null,r=ws(t,null,o,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(ms(),o===a){t=Hi(e,t,r);break e}yi(e,t,o,r)}t=t.child}return t;case 5:return Qs(t),null===e&&cs(t),o=t.type,a=t.pendingProps,n=null!==e?e.memoizedProps:null,i=a.children,ra(o,a)?i=null:null!==n&&ra(o,n)&&(t.flags|=32),Ni(e,t),yi(e,t,i,r),t.child;case 6:return null===e&&cs(t),null;case 13:return Ri(e,t,r);case 4:return Ks(t,t.stateNode.containerInfo),o=t.pendingProps,null===e?t.child=ys(t,null,o,r):yi(e,t,o,r),t.child;case 11:return o=t.type,a=t.pendingProps,wi(e,t,o,a=t.elementType===o?a:ri(o,a),r);case 7:return yi(e,t,t.pendingProps,r),t.child;case 8:case 12:return yi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(o=t.type._context,a=t.pendingProps,n=t.memoizedProps,i=a.value,Ca(js,o._currentValue),o._currentValue=i,null!==n)if(no(n.value,i)){if(n.children===a.children&&!Ia.current){t=Hi(e,t,r);break e}}else for(null!==(n=t.child)&&(n.return=t);null!==n;){var l=n.dependencies;if(null!==l){i=n.child;for(var c=l.firstContext;null!==c;){if(c.context===o){if(1===n.tag){(c=Os(-1,r&-r)).tag=2;var d=n.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}n.lanes|=r,null!==(c=n.alternate)&&(c.lanes|=r),As(n.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===n.tag)i=n.type===t.type?null:n.child;else if(18===n.tag){if(null===(i=n.return))throw Error(s(341));i.lanes|=r,null!==(l=i.alternate)&&(l.lanes|=r),As(i,r,t),i=n.sibling}else i=n.child;if(null!==i)i.return=n;else for(i=n;null!==i;){if(i===t){i=null;break}if(null!==(n=i.sibling)){n.return=i.return,i=n;break}i=i.return}n=i}yi(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,o=t.pendingProps.children,Is(t,r),o=o(a=Ps(a)),t.flags|=1,yi(e,t,o,r),t.child;case 14:return a=ri(o=t.type,t.pendingProps),ji(e,t,o,a=ri(o.type,a),r);case 15:return ki(e,t,t.type,t.pendingProps,r);case 17:return o=t.type,a=t.pendingProps,a=t.elementType===o?a:ri(o,a),Gi(e,t),t.tag=1,Da(o)?(e=!0,Fa(t)):e=!1,Is(t,r),ni(t,o,a),li(t,o,a,r),Ai(null,t,o,!0,e,r);case 19:return Bi(e,t,r);case 22:return Si(e,t,r)}throw Error(s(156,t.tag))};var Jc="function"===typeof reportError?reportError:function(e){console.error(e)};function Zc(e){this._internalRoot=e}function Kc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $c(){}function Xc(e,t,r,o,a){var s=r._reactRootContainer;if(s){var n=s;if("function"===typeof a){var i=a;a=function(){var e=Hc(n);i.call(e)}}Gc(t,n,e,a)}else n=function(e,t,r,o,a){if(a){if("function"===typeof o){var s=o;o=function(){var e=Hc(n);s.call(e)}}var n=Bc(t,o,e,0,null,!1,0,"",$c);return e._reactRootContainer=n,e[pa]=n.current,Bo(8===e.nodeType?e.parentNode:e),dc(),n}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof o){var i=o;o=function(){var e=Hc(l);i.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",$c);return e._reactRootContainer=l,e[pa]=l.current,Bo(8===e.nodeType?e.parentNode:e),dc(function(){Gc(t,l,r,o)}),l}(r,t,e,a,o);return Hc(n)}Kc.prototype.render=Zc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Gc(e,t,null,null)},Kc.prototype.unmount=Zc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Gc(null,e,null,null)}),t[pa]=null}},Kc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Lt.length&&0!==t&&t<Lt[r].priority;r++);Lt.splice(r,0,e),0===r&&Rt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ut(t.pendingLanes);0!==r&&(xt(t,1|r),oc(t,Qe()),0===(6&Al)&&(Bl=Qe()+500,Ba()))}break;case 13:dc(function(){var t=Ts(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}}),Vc(e,1)}},jt=function(e){if(13===e.tag){var t=Ts(e,134217728);if(null!==t)rc(t,e,134217728,ec());Vc(e,134217728)}},kt=function(e){if(13===e.tag){var t=tc(e),r=Ts(e,t);if(null!==r)rc(r,e,t,ec());Vc(e,t)}},St=function(){return bt},Nt=function(e,t){var r=bt;try{return bt=e,t()}finally{bt=r}},je=function(e,t,r){switch(t){case"input":if($(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var o=r[t];if(o!==e&&o.form===e.form){var a=wa(o);if(!a)throw Error(s(90));J(o),$(o,a)}}}break;case"textarea":se(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ae=cc,Ie=dc;var ed={usingClientEntryPoint:!1,Events:[ba,ya,wa,Ce,_e,cc]},td={findFiberByHostInstance:xa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var od=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!od.isDisabled&&od.supportsFiber)try{at=od.inject(rd),st=od}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,r){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:j,key:null==o?null:""+o,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var r=!1,o="",a=Jc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(o=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,r,0,o,a),e[pa]=t.current,Bo(8===e.nodeType?e.parentNode:e),new Zc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,r){if(!Qc(t))throw Error(s(200));return Xc(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Yc(e))throw Error(s(405));var o=null!=r&&r.hydratedSources||null,a=!1,n="",i=Jc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(n=r.identifierPrefix),void 0!==r.onRecoverableError&&(i=r.onRecoverableError)),t=Bc(t,null,e,1,null!=r?r:null,a,0,n,i),e[pa]=t.current,Bo(e),o)for(e=0;e<o.length;e++)a=(a=(r=o[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Kc(t)},t.render=function(e,t,r){if(!Qc(t))throw Error(s(200));return Xc(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){Xc(null,null,e,!1,function(){e._reactRootContainer=null,e[pa]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,o){if(!Qc(r))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Xc(e,t,r,!1,o)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=o(r(374));class s extends a.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)).join(",");return this.url.searchParams.append(e,"in.(".concat(r,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:r,type:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="";"plain"===o?a="pl":"phrase"===o?a="ph":"websearch"===o&&(a="w");const s=void 0===r?"":"(".concat(r,")");return this.url.searchParams.append(e,"".concat(a,"fts").concat(s,".").concat(t)),this}match(e){return Object.entries(e).forEach(e=>{let[t,r]=e;this.url.searchParams.append(t,"eq.".concat(r))}),this}not(e,t,r){return this.url.searchParams.append(e,"not.".concat(t,".").concat(r)),this}or(e){let{foreignTable:t,referencedTable:r=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=r?"".concat(r,".or"):"or";return this.url.searchParams.append(o,"(".concat(e,")")),this}filter(e,t,r){return this.url.searchParams.append(e,"".concat(t,".").concat(r)),this}}t.default=s},784:(e,t,r)=>{"use strict";r.d(t,{createGeneralNotification:()=>d,fp:()=>c});const o="notif:unreadChanged",a=e=>"".concat("tag.notifications.").concat(e);function s(e){try{if("undefined"===typeof window)return[];const t=window.localStorage.getItem(a(e));return t?JSON.parse(t):[]}catch(t){return[]}}function n(e,t){try{"undefined"!==typeof window&&window.localStorage.setItem(a(e),JSON.stringify(t))}catch(r){console.warn("Failed to write notifications:",r)}}const i=()=>Date.now().toString(36)+Math.random().toString(36).slice(2),l=()=>(new Date).toISOString(),c=async e=>{const t={id:i(),userId:e.userId,type:"collaboration",title:e.title,message:e.message,projectId:e.projectId,meta:e.meta||{},isRead:!1,createdAt:l()},r=s(e.userId);return r.unshift(t),n(e.userId,r),"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent(o,{detail:{userId:e.userId}})),t},d=async e=>{const t={id:i(),userId:e.userId,type:e.type||"general",title:e.title,message:e.message,projectId:e.projectId,meta:e.meta||{},isRead:!1,createdAt:l()},r=s(e.userId);return r.unshift(t),n(e.userId,r),"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent(o,{detail:{userId:e.userId}})),t}},792:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});const o=new class{constructor(){this.dbName="TAGAvatarDB",this.dbVersion=1,this.storeName="avatars"}async initDB(){return new Promise((e,t)=>{const r=indexedDB.open(this.dbName,this.dbVersion);r.onerror=()=>t(r.error),r.onsuccess=()=>e(r.result),r.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains(this.storeName)){t.createObjectStore(this.storeName,{keyPath:"userId"}).createIndex("userId","userId",{unique:!0})}}})}async storeAvatar(e,t){const r=await this.initDB();try{let a;if(t instanceof Blob)a=t;else if(t instanceof File)a=t;else if("string"===typeof t&&t.startsWith("data:image/")){const e=await fetch(t);a=await e.blob()}else{if("string"!==typeof t||!t.startsWith("http"))throw new Error("Unsupported avatar data format");try{const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch image: ".concat(e.status," ").concat(e.statusText));a=await e.blob()}catch(o){return console.warn("[AvatarStorage] Failed to fetch HTTP URL, skipping storage:",o),{success:!0,userId:e,skipped:!0}}}return new Promise((t,o)=>{const s=r.transaction([this.storeName],"readwrite").objectStore(this.storeName).put({userId:e,avatar:a,timestamp:Date.now()});s.onsuccess=()=>{console.log("[AvatarStorage] Stored avatar for user: ".concat(e,", size: ").concat(a.size," bytes")),t({success:!0,userId:e})},s.onerror=()=>o(s.error)})}catch(a){throw console.error("[AvatarStorage] Error storing avatar: ".concat(a)),a}}async getAvatar(e){const t=await this.initDB();return new Promise((r,o)=>{const a=t.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);a.onsuccess=()=>{a.result&&a.result.avatar instanceof Blob?(console.log("[AvatarStorage] Found avatar for user: ".concat(e,", size: ").concat(a.result.avatar.size," bytes")),r({success:!0,avatar:a.result.avatar})):(console.log("[AvatarStorage] No avatar found for user: ".concat(e)),r({success:!1,error:"Avatar not found"}))},a.onerror=()=>o(a.error)})}async getAvatarUrl(e){try{const t=await this.getAvatar(e);if(t.success&&t.avatar instanceof Blob){const r=URL.createObjectURL(t.avatar);return console.log("[AvatarStorage] Created ObjectURL for user: ".concat(e,": ").concat(r)),r}return console.log("[AvatarStorage] No avatar URL for user: ".concat(e)),null}catch(t){return console.error("[AvatarStorage] Error getting avatar URL: ".concat(t)),null}}async deleteAvatar(e){const t=await this.initDB();return new Promise((r,o)=>{const a=t.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);a.onsuccess=()=>{console.log("[AvatarStorage] Deleted avatar for user: ".concat(e)),r({success:!0})},a.onerror=()=>o(a.error)})}revokeAvatarUrl(e){e&&e.startsWith("blob:")&&(URL.revokeObjectURL(e),console.log("[AvatarStorage] Revoked ObjectURL: ".concat(e)))}async hasAvatar(e){return(await this.getAvatar(e)).success}}},829:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=o(r(736));t.default=class{constructor(e,t){let{headers:r={},schema:o,fetch:a}=t;this.url=e,this.headers=new Headers(r),this.schema=o,this.fetch=a}select(e){let{head:t=!1,count:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=t?"HEAD":"GET";let s=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map(e=>/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)).join("");return this.url.searchParams.set("select",n),r&&this.headers.append("Prefer","count=".concat(r)),new a.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e){let{count:t,defaultToNull:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var o;if(t&&this.headers.append("Prefer","count=".concat(t)),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(o=this.fetch)&&void 0!==o?o:fetch})}upsert(e){let{onConflict:t,ignoreDuplicates:r=!1,count:o,defaultToNull:s=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;if(this.headers.append("Prefer","resolution=".concat(r?"ignore":"merge","-duplicates")),void 0!==t&&this.url.searchParams.set("on_conflict",t),o&&this.headers.append("Prefer","count=".concat(o)),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>'"'.concat(e,'"'));this.url.searchParams.set("columns",e.join(","))}}return new a.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(n=this.fetch)&&void 0!==n?n:fetch})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;return t&&this.headers.append("Prefer","count=".concat(t)),new a.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var t;return e&&this.headers.append("Prefer","count=".concat(e)),new a.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}}},853:(e,t,r)=>{"use strict";e.exports=r(234)},915:(e,t,r)=>{"use strict";r.d(t,{Bx:()=>i,EP:()=>s,Ih:()=>n});const o=e=>e?"u.".concat(e):null,a=e=>{const t=o(e);return"".concat(t,".avatarCache")},s=e=>{try{if("undefined"===typeof window||!e)return null;const t=a(e);if(!t)return null;const r=JSON.parse(localStorage.getItem(t)||"{}")[e];return r&&Date.now()-r.timestamp<864e5?r.url:null}catch(t){return console.warn("Error reading avatar cache:",t),null}},n=(e,t)=>{try{if("undefined"===typeof window||!e)return;const r=a(e);if(!r)return;const o=JSON.parse(localStorage.getItem(r)||"{}");o[e]={url:t,timestamp:Date.now()},localStorage.setItem(r,JSON.stringify(o))}catch(r){console.warn("Error caching avatar:",r)}},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{if("undefined"===typeof window)return;if(e){const t=a(e),r=JSON.parse(localStorage.getItem(t)||"{}");delete r[e],localStorage.setItem(t,JSON.stringify(r));const s=(e=>{const t=o(e);return"".concat(t,".avatar")})(e);localStorage.removeItem(s),console.log("[clearAvatarCache] Cleared avatar data for user: ".concat(e))}else{Object.keys(localStorage).forEach(e=>{(e.includes(".avatarCache")||e.includes(".avatar"))&&localStorage.removeItem(e)}),console.log("[clearAvatarCache] Cleared all avatar data")}}catch(t){console.warn("Error clearing avatar cache:",t)}}},950:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(730)},980:function(e,t,r){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const a=o(r(210));t.PostgrestClient=a.default;const s=o(r(829));t.PostgrestQueryBuilder=s.default;const n=o(r(736));t.PostgrestFilterBuilder=n.default;const i=o(r(374));t.PostgrestTransformBuilder=i.default;const l=o(r(286));t.PostgrestBuilder=l.default;const c=o(r(611));t.PostgrestError=c.default,t.default={PostgrestClient:a.default,PostgrestQueryBuilder:s.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:l.default,PostgrestError:c.default}},989:e=>{"use strict";var t=!("undefined"===typeof window||!window.document||!window.document.createElement),r={canUseDOM:t,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:t&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:t&&!!window.screen,isInWorker:!t};e.exports=r}},t={};function r(o){var a=t[o];if(void 0!==a)return a.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=r(43),t=r(391);function o(e,t){if(null==e)return{};var r,o,a=function(e,t){if(null==e)return{};var r={};for(var o in e)if({}.hasOwnProperty.call(e,o)){if(-1!==t.indexOf(o))continue;r[o]=e[o]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)r=s[o],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var a=r(51);const s=["sri"],n=["page"],i=["page","matches"],l=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],c=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],d=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var u="popstate";function h(){return b(function(e,t){let{pathname:r,search:o,hash:a}=e.location;return f("",{pathname:r,search:o,hash:a},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:v(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function m(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function p(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(r){}}}function g(e,t){return{usr:e.state,key:e.key,idx:t}}function f(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;return(0,a.A)((0,a.A)({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?x(t):t),{},{state:r,key:t&&t.key||o||Math.random().toString(36).substring(2,10)})}function v(e){let{pathname:t="/",search:r="",hash:o=""}=e;return r&&"?"!==r&&(t+="?"===r.charAt(0)?r:"?"+r),o&&"#"!==o&&(t+="#"===o.charAt(0)?o:"#"+o),t}function x(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let o=e.indexOf("?");o>=0&&(t.search=e.substring(o),e=e.substring(0,o)),e&&(t.pathname=e)}return t}function b(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:s=document.defaultView,v5Compat:n=!1}=o,i=s.history,l="POP",c=null,d=h();function h(){return(i.state||{idx:null}).idx}function m(){l="POP";let e=h(),t=null==e?null:e-d;d=e,c&&c({action:l,location:v.location,delta:t})}function p(e){return y(e)}null==d&&(d=0,i.replaceState((0,a.A)((0,a.A)({},i.state),{},{idx:d}),""));let v={get action(){return l},get location(){return e(s,i)},listen(e){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(u,m),c=e,()=>{s.removeEventListener(u,m),c=null}},createHref:e=>t(s,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l="PUSH";let o=f(v.location,e,t);r&&r(o,e),d=h()+1;let a=g(o,d),u=v.createHref(o);try{i.pushState(a,"",u)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;s.location.assign(u)}n&&c&&c({action:l,location:v.location,delta:1})},replace:function(e,t){l="REPLACE";let o=f(v.location,e,t);r&&r(o,e),d=h();let a=g(o,d),s=v.createHref(o);i.replaceState(a,"",s),n&&c&&c({action:l,location:v.location,delta:0})},go:e=>i.go(e)};return v}function y(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="http://localhost";"undefined"!==typeof window&&(r="null"!==window.location.origin?window.location.origin:window.location.href),m(r,"No window.location.(origin|href) available to create URL");let o="string"===typeof e?e:v(e);return o=o.replace(/ $/,"%20"),!t&&o.startsWith("//")&&(o=r+o),new URL(o,r)}new WeakMap;function w(e,t){return j(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function j(e,t,r,o){let a=R(("string"===typeof t?x(t):t).pathname||"/",r);if(null==a)return null;let s=k(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let r=e.length===t.length&&e.slice(0,-1).every((e,r)=>e===t[r]);return r?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(s);let n=null;for(let i=0;null==n&&i<s.length;++i){let e=F(a);n=L(s[i],e,o)}return n}function k(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=function(e,s){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a,i=arguments.length>3?arguments[3]:void 0,l={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};if(l.relativePath.startsWith("/")){if(!l.relativePath.startsWith(o)&&n)return;m(l.relativePath.startsWith(o),'Absolute route path "'.concat(l.relativePath,'" nested under path "').concat(o,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),l.relativePath=l.relativePath.slice(o.length)}let c=B([o,l.relativePath]),d=r.concat(l);e.children&&e.children.length>0&&(m(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(c,'".')),k(e.children,t,d,c,n)),(null!=e.path||e.index)&&t.push({path:c,score:D(c,e.index),routesMeta:d})};return e.forEach((e,t)=>{var r;if(""!==e.path&&null!==(r=e.path)&&void 0!==r&&r.includes("?"))for(let o of S(e.path))s(e,t,!0,o);else s(e,t)}),t}function S(e){let t=e.split("/");if(0===t.length)return[];let[r,...o]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(0===o.length)return a?[s,""]:[s];let n=S(o.join("/")),i=[];return i.push(...n.map(e=>""===e?s:[s,e].join("/"))),a&&i.push(...n),i.map(t=>e.startsWith("/")&&""===t?"/":t)}var N=/^:[\w-]+$/,C=3,_=2,A=1,I=10,P=-2,E=e=>"*"===e;function D(e,t){let r=e.split("/"),o=r.length;return r.some(E)&&(o+=P),t&&(o+=_),r.filter(e=>!E(e)).reduce((e,t)=>e+(N.test(t)?C:""===t?A:I),o)}function L(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:o}=e,a={},s="/",n=[];for(let i=0;i<o.length;++i){let e=o[i],l=i===o.length-1,c="/"===s?t:t.slice(s.length)||"/",d=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&r&&!o[o.length-1].route.index&&(d=T({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(a,d.params),n.push({params:a,pathname:B([s,d.pathname]),pathnameBase:G(B([s,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(s=B([s,d.pathnameBase]))}return n}function T(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[r,o]=M(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],n=s.replace(/(.)\/+$/,"$1"),i=a.slice(1);return{params:o.reduce((e,t,r)=>{let{paramName:o,isOptional:a}=t;if("*"===o){let e=i[r]||"";n=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=i[r];return e[o]=a&&!l?void 0:(l||"").replace(/%2F/g,"/"),e},{}),pathname:s,pathnameBase:n,pattern:e}}function M(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];p("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let o=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,r)=>(o.push({paramName:t,isOptional:null!=r}),r?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(o.push({paramName:"*"}),a+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":""!==e&&"/"!==e&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),o]}function F(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return p(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function R(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,o=e.charAt(r);return o&&"/"!==o?null:e.slice(r)||"/"}function O(e,t,r,o){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(o),"].  Please separate it out to the `to.").concat(r,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function U(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function z(e){let t=U(e);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function W(e,t,r){let o,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?o=x(e):(o=(0,a.A)({},e),m(!o.pathname||!o.pathname.includes("?"),O("?","pathname","search",o)),m(!o.pathname||!o.pathname.includes("#"),O("#","pathname","hash",o)),m(!o.search||!o.search.includes("#"),O("#","search","hash",o)));let n,i=""===e||""===o.pathname,l=i?"/":o.pathname;if(null==l)n=r;else{let e=t.length-1;if(!s&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;o.pathname=t.join("/")}n=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:r,search:o="",hash:a=""}="string"===typeof e?x(e):e,s=r?r.startsWith("/")?r:function(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?r.length>1&&r.pop():"."!==e&&r.push(e)}),r.length>1?r.join("/"):"/"}(r,t):t;return{pathname:s,search:H(o),hash:q(a)}}(o,n),d=l&&"/"!==l&&l.endsWith("/"),u=(i||"."===l)&&r.endsWith("/");return c.pathname.endsWith("/")||!d&&!u||(c.pathname+="/"),c}var B=e=>e.join("/").replace(/\/\/+/g,"/"),G=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),H=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",q=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function V(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var J=["POST","PUT","PATCH","DELETE"],Z=(new Set(J),["GET",...J]);new Set(Z),Symbol("ResetLoaderData");var K=e.createContext(null);K.displayName="DataRouter";var Y=e.createContext(null);Y.displayName="DataRouterState";var Q=e.createContext(!1);var $=e.createContext({isTransitioning:!1});$.displayName="ViewTransition";var X=e.createContext(new Map);X.displayName="Fetchers";var ee=e.createContext(null);ee.displayName="Await";var te=e.createContext(null);te.displayName="Navigation";var re=e.createContext(null);re.displayName="Location";var oe=e.createContext({outlet:null,matches:[],isDataRoute:!1});oe.displayName="Route";var ae=e.createContext(null);ae.displayName="RouteError";function se(){return null!=e.useContext(re)}function ne(){return m(se(),"useLocation() may be used only in the context of a <Router> component."),e.useContext(re).location}var ie="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function le(t){e.useContext(te).static||e.useLayoutEffect(t)}function ce(){let{isDataRoute:t}=e.useContext(oe);return t?function(){let{router:t}=be("useNavigate"),r=we("useNavigate"),o=e.useRef(!1);le(()=>{o.current=!0});let s=e.useCallback(async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};p(o.current,ie),o.current&&("number"===typeof e?t.navigate(e):await t.navigate(e,(0,a.A)({fromRouteId:r},s)))},[t,r]);return s}():function(){m(se(),"useNavigate() may be used only in the context of a <Router> component.");let t=e.useContext(K),{basename:r,navigator:o}=e.useContext(te),{matches:a}=e.useContext(oe),{pathname:s}=ne(),n=JSON.stringify(z(a)),i=e.useRef(!1);le(()=>{i.current=!0});let l=e.useCallback(function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(p(i.current,ie),!i.current)return;if("number"===typeof e)return void o.go(e);let l=W(e,JSON.parse(n),s,"path"===a.relative);null==t&&"/"!==r&&(l.pathname="/"===l.pathname?r:B([r,l.pathname])),(a.replace?o.replace:o.push)(l,a.state,a)},[r,o,n,s,t]);return l}()}e.createContext(null);function de(){let{matches:t}=e.useContext(oe),r=t[t.length-1];return r?r.params:{}}function ue(t){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:o}=e.useContext(oe),{pathname:a}=ne(),s=JSON.stringify(z(o));return e.useMemo(()=>W(t,JSON.parse(s),a,"path"===r),[t,s,a,r])}function he(t,r,o,s,n){m(se(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=e.useContext(te),{matches:l}=e.useContext(oe),c=l[l.length-1],d=c?c.params:{},u=c?c.pathname:"/",h=c?c.pathnameBase:"/",g=c&&c.route;{let e=g&&g.path||"";Se(u,!g||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,v=ne();if(r){var b;let e="string"===typeof r?x(r):r;m("/"===h||(null===(b=e.pathname)||void 0===b?void 0:b.startsWith(h)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(h,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=v;let y=f.pathname||"/",j=y;if("/"!==h){let e=h.replace(/^\//,"").split("/");j="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let k=w(t,{pathname:j});p(g||null!=k,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),p(null==k||void 0!==k[k.length-1].route.element||void 0!==k[k.length-1].route.Component||void 0!==k[k.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let S=ve(k&&k.map(e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:B([h,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:B([h,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),l,o,s,n);return r&&S?e.createElement(re.Provider,{value:{location:(0,a.A)({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},S):S}function me(){let t=je(),r=V(t)?"".concat(t.status," ").concat(t.statusText):t instanceof Error?t.message:JSON.stringify(t),o=t instanceof Error?t.stack:null,a="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:a},n={padding:"2px 4px",backgroundColor:a},i=null;return console.error("Error handled by React Router default ErrorBoundary:",t),i=e.createElement(e.Fragment,null,e.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),e.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",e.createElement("code",{style:n},"ErrorBoundary")," or"," ",e.createElement("code",{style:n},"errorElement")," prop on your route.")),e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},r),o?e.createElement("pre",{style:s},o):null,i)}var pe=e.createElement(me,null),ge=class extends e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?e.createElement(oe.Provider,{value:this.props.routeContext},e.createElement(ae.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function fe(t){let{routeContext:r,match:o,children:a}=t,s=e.useContext(K);return s&&s.static&&s.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=o.route.id),e.createElement(oe.Provider,{value:r},a)}function ve(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==t){if(!o)return null;if(o.errors)t=o.matches;else{if(0!==r.length||o.initialized||!(o.matches.length>0))return null;t=o.matches}}let s=t,n=null===o||void 0===o?void 0:o.errors;if(null!=n){let e=s.findIndex(e=>e.route.id&&void 0!==(null===n||void 0===n?void 0:n[e.route.id]));m(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(n).join(","))),s=s.slice(0,Math.min(s.length,e+1))}let i=!1,l=-1;if(o)for(let e=0;e<s.length;e++){let t=s[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(l=e),t.route.id){let{loaderData:e,errors:r}=o,a=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!r||void 0===r[t.route.id]);if(t.route.lazy||a){i=!0,s=l>=0?s.slice(0,l+1):[s[0]];break}}}return s.reduceRight((t,c,d)=>{let u,h=!1,m=null,p=null;o&&(u=n&&c.route.id?n[c.route.id]:void 0,m=c.route.errorElement||pe,i&&(l<0&&0===d?(Se("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,p=null):l===d&&(h=!0,p=c.route.hydrateFallbackElement||null)));let g=r.concat(s.slice(0,d+1)),f=()=>{let r;return r=u?m:h?p:c.route.Component?e.createElement(c.route.Component,null):c.route.element?c.route.element:t,e.createElement(fe,{match:c,routeContext:{outlet:t,matches:g,isDataRoute:null!=o},children:r})};return o&&(c.route.ErrorBoundary||c.route.errorElement||0===d)?e.createElement(ge,{location:o.location,revalidation:o.revalidation,component:m,error:u,children:f(),routeContext:{outlet:null,matches:g,isDataRoute:!0},unstable_onError:a}):f()},null)}function xe(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function be(t){let r=e.useContext(K);return m(r,xe(t)),r}function ye(t){let r=e.useContext(Y);return m(r,xe(t)),r}function we(t){let r=function(t){let r=e.useContext(oe);return m(r,xe(t)),r}(t),o=r.matches[r.matches.length-1];return m(o.route.id,"".concat(t,' can only be used on routes that contain a unique "id"')),o.route.id}function je(){var t;let r=e.useContext(ae),o=ye("useRouteError"),a=we("useRouteError");return void 0!==r?r:null===(t=o.errors)||void 0===t?void 0:t[a]}var ke={};function Se(e,t,r){t||ke[e]||(ke[e]=!0,p(!1,r))}var Ne={};function Ce(e,t){e||Ne[t]||(Ne[t]=!0,console.warn(t))}e.memo(function(e){let{routes:t,future:r,state:o,unstable_onError:a}=e;return he(t,void 0,o,a,r)});function _e(t){let{to:r,replace:o,state:a,relative:s}=t;m(se(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=e.useContext(te);p(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=e.useContext(oe),{pathname:l}=ne(),c=ce(),d=W(r,z(i),l,"path"===s),u=JSON.stringify(d);return e.useEffect(()=>{c(JSON.parse(u),{replace:o,state:a,relative:s})},[c,u,s,o,a]),null}function Ae(e){m(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Ie(t){let{basename:r="/",children:o=null,location:a,navigationType:s="POP",navigator:n,static:i=!1}=t;m(!se(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=r.replace(/^\/*/,"/"),c=e.useMemo(()=>({basename:l,navigator:n,static:i,future:{}}),[l,n,i]);"string"===typeof a&&(a=x(a));let{pathname:d="/",search:u="",hash:h="",state:g=null,key:f="default"}=a,v=e.useMemo(()=>{let e=R(d,l);return null==e?null:{location:{pathname:e,search:u,hash:h,state:g,key:f},navigationType:s}},[l,d,u,h,g,f,s]);return p(null!=v,'<Router basename="'.concat(l,'"> is not able to match the URL "').concat(d).concat(u).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==v?null:e.createElement(te.Provider,{value:c},e.createElement(re.Provider,{children:o,value:v}))}function Pe(e){let{children:t,location:r}=e;return he(Ee(t),r)}e.Component;function Ee(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[];return e.Children.forEach(t,(t,a)=>{if(!e.isValidElement(t))return;let s=[...r,a];if(t.type===e.Fragment)return void o.push.apply(o,Ee(t.props.children,s));m(t.type===Ae,"[".concat("string"===typeof t.type?t.type:t.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),m(!t.props.index||!t.props.children,"An index route cannot have child routes.");let n={id:t.props.id||s.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,hydrateFallbackElement:t.props.hydrateFallbackElement,HydrateFallback:t.props.HydrateFallback,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:!0===t.props.hasErrorBoundary||null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(n.children=Ee(t.props.children,s)),o.push(n)}),o}var De="get",Le="application/x-www-form-urlencoded";function Te(e){return null!=e&&"string"===typeof e.tagName}function Me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new URLSearchParams("string"===typeof e||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let o=e[r];return t.concat(Array.isArray(o)?o.map(e=>[r,e]):[[r,o]])},[]))}var Fe=null;var Re=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Oe(e){return null==e||Re.has(e)?e:(p(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Le,'"')),null)}function Ue(e,t){let r,o,a,s,n;if(Te(i=e)&&"form"===i.tagName.toLowerCase()){let n=e.getAttribute("action");o=n?R(n,t):null,r=e.getAttribute("method")||De,a=Oe(e.getAttribute("enctype"))||Le,s=new FormData(e)}else if(function(e){return Te(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Te(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let n=e.form;if(null==n)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let i=e.getAttribute("formaction")||n.getAttribute("action");if(o=i?R(i,t):null,r=e.getAttribute("formmethod")||n.getAttribute("method")||De,a=Oe(e.getAttribute("formenctype"))||Oe(n.getAttribute("enctype"))||Le,s=new FormData(n,e),!function(){if(null===Fe)try{new FormData(document.createElement("form"),0),Fe=!1}catch(e){Fe=!0}return Fe}()){let{name:t,type:r,value:o}=e;if("image"===r){let e=t?"".concat(t,"."):"";s.append("".concat(e,"x"),"0"),s.append("".concat(e,"y"),"0")}else t&&s.append(t,o)}}else{if(Te(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=De,o=null,a=Le,n=e}var i;return s&&"text/plain"===a&&(n=s,s=void 0),{action:o,method:r.toLowerCase(),encType:a,formData:s,body:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function ze(e){return{__html:e}}function We(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Be(e,t,r){let o="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===o.pathname?o.pathname="_root.".concat(r):t&&"/"===R(o.pathname,t)?o.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(r):o.pathname="".concat(o.pathname.replace(/\/$/,""),".").concat(r),o}async function Ge(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function He(e){return null!=e&&"string"===typeof e.page}function qe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function Ve(e,t,r,o,a,s){let n=(e,t)=>!r[t]||e.route.id!==r[t].route.id,i=(e,t)=>{var o;return r[t].pathname!==e.pathname||(null===(o=r[t].route.path)||void 0===o?void 0:o.endsWith("*"))&&r[t].params["*"]!==e.params["*"]};return"assets"===s?t.filter((e,t)=>n(e,t)||i(e,t)):"data"===s?t.filter((t,s)=>{let l=o.routes[t.route.id];if(!l||!l.hasLoader)return!1;if(n(t,s)||i(t,s))return!0;if(t.route.shouldRevalidate){var c;let o=t.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:(null===(c=r[0])||void 0===c?void 0:c.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof o)return o}return!0}):[]}function Je(e,t){let{includeHydrateFallback:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return o=e.map(e=>{let o=t.routes[e.route.id];if(!o)return[];let a=[o.module];return o.clientActionModule&&(a=a.concat(o.clientActionModule)),o.clientLoaderModule&&(a=a.concat(o.clientLoaderModule)),r&&o.hydrateFallbackModule&&(a=a.concat(o.hydrateFallbackModule)),o.imports&&(a=a.concat(o.imports)),a}).flat(1),[...new Set(o)];var o}function Ze(e,t){let r=new Set,o=new Set(t);return e.reduce((e,a)=>{if(t&&!He(a)&&"script"===a.as&&a.href&&o.has(a.href))return e;let s=JSON.stringify(function(e){let t={},r=Object.keys(e).sort();for(let o of r)t[o]=e[o];return t}(a));return r.has(s)||(r.add(s),e.push({key:s,link:a})),e},[])}function Ke(e,t){return"lazy"===e.mode&&!0===t}function Ye(){let t=e.useContext(K);return We(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Qe(){let t=e.useContext(Y);return We(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var $e=e.createContext(void 0);function Xe(){let t=e.useContext($e);return We(t,"You must render this element inside a <HydratedRouter> element"),t}function et(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function tt(e,t,r){if(r&&!st)return[e[0]];if(t){let r=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,r+1)}return e}$e.displayName="FrameworkContext";function rt(t){let{page:r}=t,s=o(t,n),{router:i}=Ye(),l=e.useMemo(()=>w(i.routes,r,i.basename),[i.routes,r,i.basename]);return l?e.createElement(at,(0,a.A)({page:r,matches:l},s)):null}function ot(t){let{manifest:r,routeModules:o}=Xe(),[s,n]=e.useState([]);return e.useEffect(()=>{let e=!1;return async function(e,t,r){return Ze((await Promise.all(e.map(async e=>{let o=t.routes[e.route.id];if(o){let e=await Ge(o,r);return e.links?e.links():[]}return[]}))).flat(1).filter(qe).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?(0,a.A)((0,a.A)({},e),{},{rel:"prefetch",as:"style"}):(0,a.A)((0,a.A)({},e),{},{rel:"prefetch"})))}(t,r,o).then(t=>{e||n(t)}),()=>{e=!0}},[t,r,o]),s}function at(t){let{page:r,matches:s}=t,n=o(t,i),l=ne(),{manifest:c,routeModules:d}=Xe(),{basename:u}=Ye(),{loaderData:h,matches:m}=Qe(),p=e.useMemo(()=>Ve(r,s,m,c,l,"data"),[r,s,m,c,l]),g=e.useMemo(()=>Ve(r,s,m,c,l,"assets"),[r,s,m,c,l]),f=e.useMemo(()=>{if(r===l.pathname+l.search+l.hash)return[];let e=new Set,t=!1;if(s.forEach(r=>{var o;let a=c.routes[r.route.id];a&&a.hasLoader&&(!p.some(e=>e.route.id===r.route.id)&&r.route.id in h&&null!==(o=d[r.route.id])&&void 0!==o&&o.shouldRevalidate||a.hasClientLoader?t=!0:e.add(r.route.id))}),0===e.size)return[];let o=Be(r,u,"data");return t&&e.size>0&&o.searchParams.set("_routes",s.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[o.pathname+o.search]},[u,h,l,c,p,s,r,d]),v=e.useMemo(()=>Je(g,c),[g,c]),x=ot(g);return e.createElement(e.Fragment,null,f.map(t=>e.createElement("link",(0,a.A)({key:t,rel:"prefetch",as:"fetch",href:t},n))),v.map(t=>e.createElement("link",(0,a.A)({key:t,rel:"modulepreload",href:t},n))),x.map(t=>{let{key:r,link:o}=t;return e.createElement("link",(0,a.A)({key:r,nonce:n.nonce},o))}))}var st=!1;function nt(t){let{manifest:r,serverHandoffString:n,isSpaMode:i,renderMeta:l,routeDiscovery:c,ssr:d}=Xe(),{router:u,static:h,staticContext:m}=Ye(),{matches:p}=Qe(),g=e.useContext(Q),f=Ke(c,d);l&&(l.didRenderScripts=!0);let v=tt(p,null,i);e.useEffect(()=>{0},[]);let x=e.useMemo(()=>{var i;if(g)return null;let l=m?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",c=h?"".concat(null!==r.hmr&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(r.hmr.runtime),";"):"").concat(f?"":"import ".concat(JSON.stringify(r.url)),";\n").concat(v.map((e,t)=>{let o="route".concat(t),a=r.routes[e.route.id];We(a,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:s,clientLoaderModule:n,clientMiddlewareModule:i,hydrateFallbackModule:l,module:c}=a,d=[...s?[{module:s,varName:"".concat(o,"_clientAction")}]:[],...n?[{module:n,varName:"".concat(o,"_clientLoader")}]:[],...i?[{module:i,varName:"".concat(o,"_clientMiddleware")}]:[],...l?[{module:l,varName:"".concat(o,"_HydrateFallback")}]:[],{module:c,varName:"".concat(o,"_main")}];return 1===d.length?"import * as ".concat(o," from ").concat(JSON.stringify(c),";"):[d.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(o," = {").concat(d.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(f?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:r}=e,n=o(e,s),i=new Set(t.state.matches.map(e=>e.route.id)),l=t.state.location.pathname.split("/").filter(Boolean),c=["/"];for(l.pop();l.length>0;)c.push("/".concat(l.join("/"))),l.pop();c.forEach(e=>{let r=w(t.routes,e,t.basename);r&&r.forEach(e=>i.add(e.route.id))});let d=[...i].reduce((e,t)=>Object.assign(e,{[t]:n.routes[t]}),{});return(0,a.A)((0,a.A)({},n),{},{routes:d,sri:!!r||void 0})}(r,u),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(r.entry.module),");"):" ";return e.createElement(e.Fragment,null,e.createElement("script",(0,a.A)((0,a.A)({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:ze(l),type:void 0})),e.createElement("script",(0,a.A)((0,a.A)({},t),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:ze(c),type:"module",async:!0})))},[]),b=st||g?[]:(r.entry.imports.concat(Je(v,r,{includeHydrateFallback:!0})),[...new Set(y)]);var y;let j="object"===typeof r.sri?r.sri:{};return Ce(!g,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),st||g?null:e.createElement(e.Fragment,null,"object"===typeof r.sri?e.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:j})}}):null,f?null:e.createElement("link",{rel:"modulepreload",href:r.url,crossOrigin:t.crossOrigin,integrity:j[r.url],suppressHydrationWarning:!0}),e.createElement("link",{rel:"modulepreload",href:r.entry.module,crossOrigin:t.crossOrigin,integrity:j[r.entry.module],suppressHydrationWarning:!0}),b.map(r=>e.createElement("link",{key:r,rel:"modulepreload",href:r,crossOrigin:t.crossOrigin,integrity:j[r],suppressHydrationWarning:!0})),x)}function it(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}e.Component;function lt(t){let{error:r,isOutsideRemixApp:o}=t;console.error(r);let a,s=e.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(V(r))return e.createElement(ct,{title:"Unhandled Thrown Response!"},e.createElement("h1",{style:{fontSize:"24px"}},r.status," ",r.statusText),s);if(r instanceof Error)0;else{let e=null==r?"Unknown Error":"object"===typeof r&&"toString"in r?r.toString():JSON.stringify(r);new Error(e)}return e.createElement(ct,{title:"Application Error!",isOutsideRemixApp:o},e.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),e.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},a.stack),s)}function ct(t){var r;let{title:o,renderScripts:a,isOutsideRemixApp:s,children:n}=t,{routeModules:i}=Xe();return null!==i.root&&void 0!==r&&r.Layout&&!s?n:e.createElement("html",{lang:"en"},e.createElement("head",null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),e.createElement("title",null,o)),e.createElement("body",null,e.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},n,a?e.createElement(nt,null):null)))}var dt="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{dt&&(window.__reactRouterVersion="7.8.2")}catch(dm){}function ut(t){let{basename:r,children:o,window:a}=t,s=e.useRef();null==s.current&&(s.current=h({window:a,v5Compat:!0}));let n=s.current,[i,l]=e.useState({action:n.action,location:n.location}),c=e.useCallback(t=>{e.startTransition(()=>l(t))},[l]);return e.useLayoutEffect(()=>n.listen(c),[n,c]),e.createElement(Ie,{basename:r,children:o,location:i.location,navigationType:i.action,navigator:n})}var ht=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,mt=e.forwardRef(function(t,r){let s,{onClick:n,discover:i="render",prefetch:c="none",relative:d,reloadDocument:u,replace:h,state:g,target:f,to:x,preventScrollReset:b,viewTransition:y}=t,w=o(t,l),{basename:j}=e.useContext(te),k="string"===typeof x&&ht.test(x),S=!1;if("string"===typeof x&&k&&(s=x,dt))try{let e=new URL(window.location.href),t=x.startsWith("//")?new URL(e.protocol+x):new URL(x),r=R(t.pathname,j);t.origin===e.origin&&null!=r?x=r+t.search+t.hash:S=!0}catch(dm){p(!1,'<Link to="'.concat(x,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let N=function(t){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};m(se(),"useHref() may be used only in the context of a <Router> component.");let{basename:o,navigator:a}=e.useContext(te),{hash:s,pathname:n,search:i}=ue(t,{relative:r}),l=n;return"/"!==o&&(l="/"===n?o:B([o,n])),a.createHref({pathname:l,search:i,hash:s})}(x,{relative:d}),[C,_,A]=function(t,r){let o=e.useContext($e),[a,s]=e.useState(!1),[n,i]=e.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:u,onTouchStart:h}=r,m=e.useRef(null);e.useEffect(()=>{if("render"===t&&i(!0),"viewport"===t){let e=new IntersectionObserver(e=>{e.forEach(e=>{i(e.isIntersecting)})},{threshold:.5});return m.current&&e.observe(m.current),()=>{e.disconnect()}}},[t]),e.useEffect(()=>{if(a){let e=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(e)}}},[a]);let p=()=>{s(!0)},g=()=>{s(!1),i(!1)};return o?"intent"!==t?[n,m,{}]:[n,m,{onFocus:et(l,p),onBlur:et(c,g),onMouseEnter:et(d,p),onMouseLeave:et(u,g),onTouchStart:et(h,p)}]:[!1,m,{}]}(c,w),I=function(t){let{target:r,replace:o,state:a,preventScrollReset:s,relative:n,viewTransition:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=ce(),c=ne(),d=ue(t,{relative:n});return e.useCallback(e=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,r)){e.preventDefault();let r=void 0!==o?o:v(c)===v(d);l(t,{replace:r,state:a,preventScrollReset:s,relative:n,viewTransition:i})}},[c,l,d,o,a,r,t,s,n,i])}(x,{replace:h,state:g,target:f,preventScrollReset:b,relative:d,viewTransition:y});let P=e.createElement("a",(0,a.A)((0,a.A)((0,a.A)({},w),A),{},{href:s||N,onClick:S||u?n:function(e){n&&n(e),e.defaultPrevented||I(e)},ref:it(r,_),target:f,"data-discover":k||"render"!==i?void 0:"true"}));return C&&!k?e.createElement(e.Fragment,null,P,e.createElement(rt,{page:N})):P});mt.displayName="Link",e.forwardRef(function(t,r){let{"aria-current":s="page",caseSensitive:n=!1,className:i="",end:l=!1,style:d,to:u,viewTransition:h,children:p}=t,g=o(t,c),f=ue(u,{relative:g.relative}),v=ne(),x=e.useContext(Y),{navigator:b,basename:y}=e.useContext(te),w=null!=x&&function(t){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.useContext($);m(null!=o,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=ft("useViewTransitionState"),s=ue(t,{relative:r});if(!o.isTransitioning)return!1;let n=R(o.currentLocation.pathname,a)||o.currentLocation.pathname,i=R(o.nextLocation.pathname,a)||o.nextLocation.pathname;return null!=T(s.pathname,i)||null!=T(s.pathname,n)}(f)&&!0===h,j=b.encodeLocation?b.encodeLocation(f).pathname:f.pathname,k=v.pathname,S=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;n||(k=k.toLowerCase(),S=S?S.toLowerCase():null,j=j.toLowerCase()),S&&y&&(S=R(S,y)||S);const N="/"!==j&&j.endsWith("/")?j.length-1:j.length;let C,_=k===j||!l&&k.startsWith(j)&&"/"===k.charAt(N),A=null!=S&&(S===j||!l&&S.startsWith(j)&&"/"===S.charAt(j.length)),I={isActive:_,isPending:A,isTransitioning:w},P=_?s:void 0;C="function"===typeof i?i(I):[i,_?"active":null,A?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let E="function"===typeof d?d(I):d;return e.createElement(mt,(0,a.A)((0,a.A)({},g),{},{"aria-current":P,className:C,ref:r,style:E,to:u,viewTransition:h}),"function"===typeof p?p(I):p)}).displayName="NavLink";var pt=e.forwardRef((t,r)=>{let{discover:s="render",fetcherKey:n,navigate:i,reloadDocument:l,replace:c,state:u,method:h=De,action:p,onSubmit:g,relative:f,preventScrollReset:x,viewTransition:b}=t,y=o(t,d),w=yt(),j=function(t){let{relative:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:o}=e.useContext(te),s=e.useContext(oe);m(s,"useFormAction must be used inside a RouteContext");let[n]=s.matches.slice(-1),i=(0,a.A)({},ue(t||".",{relative:r})),l=ne();if(null==t){i.search=l.search;let e=new URLSearchParams(i.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let r=e.toString();i.search=r?"?".concat(r):""}}t&&"."!==t||!n.route.index||(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index");"/"!==o&&(i.pathname="/"===i.pathname?o:B([o,i.pathname]));return v(i)}(p,{relative:f}),k="get"===h.toLowerCase()?"get":"post",S="string"===typeof p&&ht.test(p);return e.createElement("form",(0,a.A)((0,a.A)({ref:r,method:k,action:j,onSubmit:l?g:e=>{if(g&&g(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,r=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||h;w(t||e.currentTarget,{fetcherKey:n,method:r,navigate:i,replace:c,state:u,relative:f,preventScrollReset:x,viewTransition:b})}},y),{},{"data-discover":S||"render"!==s?void 0:"true"}))});function gt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function ft(t){let r=e.useContext(K);return m(r,gt(t)),r}function vt(t){p("undefined"!==typeof URLSearchParams,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let r=e.useRef(Me(t)),o=e.useRef(!1),a=ne(),s=e.useMemo(()=>function(e,t){let r=Me(e);return t&&t.forEach((e,o)=>{r.has(o)||t.getAll(o).forEach(e=>{r.append(o,e)})}),r}(a.search,o.current?null:r.current),[a.search]),n=ce(),i=e.useCallback((e,t)=>{const r=Me("function"===typeof e?e(new URLSearchParams(s)):e);o.current=!0,n("?"+r,t)},[n,s]);return[s,i]}pt.displayName="Form";var xt=0,bt=()=>"__".concat(String(++xt),"__");function yt(){let{router:t}=ft("useSubmit"),{basename:r}=e.useContext(te),o=we("useRouteId");return e.useCallback(async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:s,method:n,encType:i,formData:l,body:c}=Ue(e,r);if(!1===a.navigate){let e=a.fetcherKey||bt();await t.fetch(e,o,a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||n,formEncType:a.encType||i,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||n,formEncType:a.encType||i,replace:a.replace,state:a.state,fromRouteId:o,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,r,o])}var wt=r(32);var jt=r(579);const kt=(0,e.createContext)(),St=()=>{const t=(0,e.useContext)(kt);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Nt=t=>{let{children:r}=t;const[o,a]=(0,e.useState)(null),[s,n]=(0,e.useState)(!0),[i,l]=(0,e.useState)("LOADING");(0,e.useEffect)(()=>{(async()=>{try{const{success:o,user:s}=await(async()=>{try{const{data:{user:e},error:t}=await wt.supabase.auth.getUser();return t?{success:!1,error:t.message}:{success:!0,user:e}}catch(e){return{success:!1,error:e.message}}})();if(o&&s){var e,t,r;const o={id:s.id,email:s.email,name:(null===(e=s.user_metadata)||void 0===e?void 0:e.name)||(null===(t=s.email)||void 0===t?void 0:t.split("@")[0]),avatar:null===(r=s.user_metadata)||void 0===r?void 0:r.avatar_url,role:"artist",isVerified:!!s.email_confirmed_at};a(o),"undefined"!==typeof window&&(window.__authContextUser=o),l("SIGNED_IN")}else a(null),l("SIGNED_OUT")}catch(o){console.error("[AuthContext] Error loading user:",o),a(null),l("SIGNED_OUT")}finally{n(!1)}})();const e=setTimeout(()=>{n(!1)},3e3);return()=>clearTimeout(e)},[]),(0,e.useEffect)(()=>{const{data:{subscription:e}}=(t=async(e,t)=>{if(console.log("[AuthContext] Auth state changed:",e,t),"SIGNED_IN"===e&&null!==t&&void 0!==t&&t.user){var r,o,s;const e=t.user,n={id:e.id,email:e.email,name:(null===(r=e.user_metadata)||void 0===r?void 0:r.name)||(null===(o=e.email)||void 0===o?void 0:o.split("@")[0]),avatar:null===(s=e.user_metadata)||void 0===s?void 0:s.avatar_url,role:"artist",isVerified:!!e.email_confirmed_at};a(n),"undefined"!==typeof window&&(window.__authContextUser=n),l("SIGNED_IN")}else"SIGNED_OUT"===e&&(a(null),"undefined"!==typeof window&&(window.__authContextUser=null),l("SIGNED_OUT"),localStorage.removeItem("tag_user"),sessionStorage.removeItem("tag_user"),localStorage.removeItem("tag.currentUserId"))},wt.supabase.auth.onAuthStateChange(t));var t;return()=>e.unsubscribe()},[]);const c=async()=>{try{return await c()}catch(e){return console.error("Get session error:",e),{success:!1,error:e.message}}},d={user:o,loading:s,status:i,login:async(e,t)=>{try{const r=await(async(e,t)=>{try{const{data:r,error:o}=await wt.supabase.auth.signInWithPassword({email:e,password:t});return o?{success:!1,error:o.message}:{success:!0,user:r.user}}catch(r){return{success:!1,error:r.message}}})(e,t);return r.success?{success:!0}:{success:!1,error:r.error}}catch(r){return console.error("Login error:",r),{success:!1,error:r.message}}},register:async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const o=await async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const{data:o,error:a}=await wt.supabase.auth.signUp({email:e,password:t,options:{data:r}});return a?{success:!1,error:a.message}:{success:!0,user:o.user}}catch(o){return{success:!1,error:o.message}}}(e,t,r);return o.success?{success:!0,user:o.user}:{success:!1,error:o.error}}catch(o){return console.error("Register error:",o),{success:!1,error:o.message}}},logout:async()=>{try{const e=await(async()=>{try{const{error:e}=await wt.supabase.auth.signOut();return e?{success:!1,error:e.message}:{success:!0}}catch(e){return{success:!1,error:e.message}}})();return e.success?(a(null),"undefined"!==typeof window&&(window.__authContextUser=null),localStorage.removeItem("tag_user"),sessionStorage.removeItem("tag_user"),localStorage.removeItem("tag.currentUserId"),{success:!0}):{success:!1,error:e.error}}catch(e){return console.error("Logout error:",e),{success:!1,error:e.message}}},isAuthenticated:()=>null!==o,getSession:c};return(0,jt.jsx)(kt.Provider,{value:d,children:r})},Ct=e=>{let{onClick:t,className:r=""}=e;return(0,jt.jsx)(mt,{to:"/",className:"flex-shrink-0 cursor-pointer hover:opacity-80 transition-opacity duration-200 ".concat(r),onClick:t,children:(0,jt.jsx)("img",{src:"/TAG_Logo.png",alt:"TAG Logo",className:"h-12 w-auto"})})},_t=e=>{let{onInputChange:t,placeholder:r="Search for art, artists, or collections...",className:o=""}=e;return(0,jt.jsx)("div",{className:"".concat(o),children:(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,jt.jsx)("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),(0,jt.jsx)("input",{type:"text",placeholder:r,onChange:t,className:"block w-full pl-9 pr-3 py-2 border border-gray-200 rounded-md leading-5 bg-white placeholder-gray-400 focus:outline-none focus:placeholder-gray-300 focus:ring-1 focus:ring-gray-300 focus:border-gray-300 text-sm shadow-sm"})]})})};var At=r(313);const It=e=>e&&e.id&&"guest"!==e.id,Pt=(e,t)=>{if(It(e)){const o=(null===t||void 0===t?void 0:t.id)||(null===e||void 0===e?void 0:e.id);if(o&&"undefined"!==typeof window)try{const e=window.localStorage.getItem("tag.avatars.".concat(o));if(e){const t=JSON.parse(e);if(t&&t.avatarUrl)return t.avatarUrl}}catch(r){console.warn("[getUserAvatar] Failed to read avatar data:",r)}return(null===t||void 0===t?void 0:t.avatar)||e.avatar||null}return null},Et=t=>{let{user:r,currentMockUser:o,onClick:a,className:s=""}=t;const[n,i]=(0,e.useState)(Pt(r,o)),l=It(r);return(0,e.useEffect)(()=>{const e=e=>{const{userId:t,avatarUrl:a}=e.detail,s=(null===o||void 0===o?void 0:o.id)||(null===r||void 0===r?void 0:r.id);console.log("[UserAvatar] Avatar update event received:",{eventUserId:t,currentUserId:s,newAvatarUrl:null===a||void 0===a?void 0:a.substring(0,30)}),t===s&&(console.log("[UserAvatar] Avatar updated, setting new URL:",null===a||void 0===a?void 0:a.substring(0,30)),i(a))},t=e=>{const{userId:t}=e.detail;t===((null===o||void 0===o?void 0:o.id)||(null===r||void 0===r?void 0:r.id))&&(console.log("[UserAvatar] Avatar deleted, resetting to default"),i((null===o||void 0===o?void 0:o.avatar)||(null===r||void 0===r?void 0:r.avatar)||null))};return window.addEventListener("avatar:updated",e),window.addEventListener("avatar:deleted",t),()=>{window.removeEventListener("avatar:updated",e),window.removeEventListener("avatar:deleted",t)}},[null===o||void 0===o?void 0:o.id,null===r||void 0===r?void 0:r.id]),(0,e.useEffect)(()=>{(async()=>{const e=(null===o||void 0===o?void 0:o.id)||(null===r||void 0===r?void 0:r.id);if(e){const t=await(0,At.getUnifiedAvatar)(e);i(t||Pt(r,o))}else i(Pt(r,o))})()},[null===r||void 0===r?void 0:r.id,null===o||void 0===o?void 0:o.id]),l&&n?(0,jt.jsx)("img",{src:n,alt:(null===o||void 0===o?void 0:o.name)||(null===r||void 0===r?void 0:r.name)||"User",className:"w-8 h-8 rounded-full object-cover hover:opacity-80 transition-opacity duration-200 ".concat(s),onClick:a}):(0,jt.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center cursor-pointer hover:opacity-80 transition-opacity duration-200 ".concat(s),onClick:a,children:(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})})},Dt=e=>{let{children:t,onClick:r,disabled:o=!1,className:a="",size:s="md",fullWidth:n=!1}=e;const i=n?"w-full":"";return(0,jt.jsx)("button",{onClick:r,disabled:o,className:"\n        ".concat("bg-purple-600 text-white font-medium hover:bg-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl","\n        ").concat({sm:"px-4 py-2 text-sm",md:"px-6 py-3 text-base",lg:"px-8 py-3 text-lg"}[s],"\n        ").concat(i,"\n        ").concat(a,"\n        ").concat(o?"opacity-50 cursor-not-allowed":"","\n        rounded-lg\n      "),children:t})},Lt=e=>{let{children:t,onClick:r,disabled:o=!1,className:a="",size:s="md",fullWidth:n=!1,active:i=!1}=e;const l=i?"bg-purple-100 text-purple-700 border-2 border-purple-300":"bg-white text-gray-700 border-2 border-gray-300 hover:bg-gray-50",c=n?"w-full":"";return(0,jt.jsx)("button",{onClick:r,disabled:o,className:"\n        ".concat(l,"\n        ").concat({sm:"px-3 py-2 text-sm",md:"px-4 py-3 text-base",lg:"px-6 py-3 text-lg"}[s],"\n        ").concat(c,"\n        ").concat(a,"\n        ").concat(o?"opacity-50 cursor-not-allowed":"","\n        rounded-lg font-medium transition-all duration-200\n      "),children:t})};function Tt(e){let{title:t,subtitle:r,children:o}=e;return(0,jt.jsxs)("div",{className:"rounded-2xl border border-gray-200 p-4",children:[(t||r)&&(0,jt.jsxs)("div",{className:"mb-2",children:[t&&(0,jt.jsx)("h3",{className:"text-base font-semibold",children:t}),r&&(0,jt.jsx)("p",{className:"text-sm text-gray-500",children:r})]}),(0,jt.jsx)("div",{children:o})]})}function Mt(e){const{isOpen:t,onClose:r,title:o,children:a,maxWidth:s="max-w-md"}=e;return t?(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full mx-4 ".concat(s),children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:o}),(0,jt.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),a]})}):null}const Ft={saveButton:"SaveButton_saveButton__yEdmI",unfavorited:"SaveButton_unfavorited__X4yK2",disabled:"SaveButton_disabled__Z+CE2",favoritedWork:"SaveButton_favoritedWork__HJCeZ",favoritedCollab:"SaveButton_favoritedCollab__Dsgfs",icon:"SaveButton_icon__XjoP-",outlined:"SaveButton_outlined__7aOlI",filled:"SaveButton_filled__ZTBib",text:"SaveButton_text__Z-r6l",sm:"SaveButton_sm__3QuNk",md:"SaveButton_md__Ui0eR",lg:"SaveButton_lg__7C186",savePulse:"SaveButton_savePulse__Ll8kD"};function Rt(t){const{isFavorited:r=!1,itemType:o,itemId:a,onToggle:s,className:n="",disabled:i=!1,size:l="md"}=t,{user:c}=St(),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(null),p=!!c,g=i||!p,f=d?h:r,v=(0,e.useCallback)(async()=>{if(!g){u(!0),m(!f);try{await s(o,a,!f),u(!1),m(null)}catch(e){u(!1),m(null),console.error("[Favorites] Save toggle failed:",e)}}},[g,f,s,o,a]),x=(0,e.useCallback)(e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),v())},[v]),b="\n    ".concat(Ft.saveButton,"\n    ").concat(Ft[l],"\n    ").concat(f?"work"===o?Ft.favoritedWork:Ft.favoritedCollab:Ft.unfavorited,"\n    ").concat(g?Ft.disabled:"","\n    ").concat(n,"\n  ").trim(),y="\n    ".concat(Ft.icon,"\n    ").concat(f?Ft.filled:Ft.outlined,"\n  ").trim(),w=()=>p?f?"Remove from favorites":"Add to favorites":"Please log in to save favorites";return(0,jt.jsxs)("button",{type:"button",className:b,onClick:v,onKeyDown:x,disabled:g,"aria-pressed":f,"aria-label":w(),title:w(),children:[(0,jt.jsx)("svg",{className:y,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),(0,jt.jsx)("span",{className:Ft.text,children:f?"Saved":"Save"})]})}function Ot(e){const{onClick:t,text:r="Back",className:o="",showIcon:a=!0}=e;return(0,jt.jsxs)("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors duration-200 ".concat(o),children:[a&&(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),r]})}function Ut(e){const{isOpen:t,title:r="Error",message:o="An error occurred.",onClose:a,className:s=""}=e;return t?(0,jt.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,jt.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:a}),(0,jt.jsxs)("div",{className:"relative bg-white rounded-xl shadow-2xl p-8 max-w-md w-full mx-4 transform transition-all duration-300 scale-100 ".concat(s),children:[(0,jt.jsx)("div",{className:"flex justify-center mb-6",children:(0,jt.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 text-center mb-3",children:r}),(0,jt.jsx)("p",{className:"text-gray-600 text-center mb-6 leading-relaxed",children:o}),(0,jt.jsx)("div",{className:"flex justify-center",children:(0,jt.jsx)("button",{onClick:a,className:"bg-red-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-red-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",children:"OK"})}),(0,jt.jsx)("button",{onClick:a,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):null}function zt(e){const{isOpen:t,title:r="Success!",message:o="Operation completed successfully.",onClose:a,className:s=""}=e;return t?(0,jt.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,jt.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 transition-opacity duration-300",onClick:a}),(0,jt.jsxs)("div",{className:"relative bg-white rounded-xl shadow-2xl p-8 max-w-md w-full mx-4 transform transition-all duration-300 scale-100 ".concat(s),children:[(0,jt.jsx)("div",{className:"flex justify-center mb-6",children:(0,jt.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 text-center mb-3",children:r}),(0,jt.jsx)("p",{className:"text-gray-600 text-center mb-6 leading-relaxed",children:o}),(0,jt.jsx)("div",{className:"flex justify-center",children:(0,jt.jsx)("button",{onClick:a,className:"bg-tag-blue text-white px-6 py-3 rounded-lg font-medium hover:bg-tag-dark-blue transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:ring-offset-2",children:"Got it!"})}),(0,jt.jsx)("button",{onClick:a,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}):null}function Wt(e){const{message:t="Loading...",className:r="",size:o="md",color:a="blue",fullScreen:s=!1,variant:n="default"}=e,i={sm:"h-6 w-6",md:"h-12 w-12",lg:"h-16 w-16"},l={blue:"border-tag-blue",gray:"border-gray-600",green:"border-green-600",red:"border-red-600"};if("simple"===n)return(0,jt.jsx)("div",{className:"animate-spin rounded-full ".concat(i[o]," border-b-2 ").concat(l[a]," mx-auto ").concat(r)});const c=s?"flex items-center justify-center h-screen ".concat(r):"flex items-center justify-center ".concat(r);return(0,jt.jsx)("div",{className:c,children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full ".concat(i[o]," border-b-2 ").concat(l[a]," mx-auto mb-4")}),t&&(0,jt.jsx)("p",{className:"text-gray-600",children:t})]})})}class Bt extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"max-w-md mx-auto text-center p-6",children:[(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("svg",{className:"mx-auto h-12 w-12 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsx)("button",{onClick:()=>window.location.reload(),className:"w-full px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Refresh Page"}),(0,jt.jsx)("button",{onClick:()=>window.history.back(),className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Go Back"})]}),!1]})}):this.props.children}}const Gt=Bt,Ht={NETWORK:"NETWORK",VALIDATION:"VALIDATION",AUTHENTICATION:"AUTHENTICATION",AUTHORIZATION:"AUTHORIZATION",NOT_FOUND:"NOT_FOUND",SERVER:"SERVER",CLIENT:"CLIENT",UNKNOWN:"UNKNOWN"},qt="LOW",Vt="MEDIUM",Jt="HIGH",Zt="CRITICAL",Kt={[Ht.NETWORK]:{title:"Network Error",message:"Unable to connect to the server. Please check your internet connection and try again.",userMessage:"Connection failed. Please try again."},[Ht.VALIDATION]:{title:"Validation Error",message:"The provided data is invalid.",userMessage:"Please check your input and try again."},[Ht.AUTHENTICATION]:{title:"Authentication Error",message:"You are not authenticated. Please log in.",userMessage:"Please log in to continue."},[Ht.AUTHORIZATION]:{title:"Authorization Error",message:"You do not have permission to perform this action.",userMessage:"You do not have permission for this action."},[Ht.NOT_FOUND]:{title:"Not Found",message:"The requested resource was not found.",userMessage:"The requested item was not found."},[Ht.SERVER]:{title:"Server Error",message:"An internal server error occurred.",userMessage:"Something went wrong. Please try again later."},[Ht.CLIENT]:{title:"Client Error",message:"An error occurred in the application.",userMessage:"Something went wrong. Please refresh the page."},[Ht.UNKNOWN]:{title:"Unknown Error",message:"An unexpected error occurred.",userMessage:"Something went wrong. Please try again."}};new class{constructor(){this.errorLog=[],this.maxLogSize=100}analyzeErrorType(e){var t,r,o,a,s,n,i,l,c,d;return e?"NetworkError"===e.name||null!==(t=e.message)&&void 0!==t&&t.includes("network")||null!==(r=e.message)&&void 0!==r&&r.includes("fetch")||null!==(o=e.message)&&void 0!==o&&o.includes("connection")?Ht.NETWORK:"ValidationError"===e.name||null!==(a=e.message)&&void 0!==a&&a.includes("validation")||null!==(s=e.message)&&void 0!==s&&s.includes("invalid")?Ht.VALIDATION:null!==(n=e.message)&&void 0!==n&&n.includes("unauthorized")||null!==(i=e.message)&&void 0!==i&&i.includes("authentication")||401===e.status?Ht.AUTHENTICATION:null!==(l=e.message)&&void 0!==l&&l.includes("forbidden")||null!==(c=e.message)&&void 0!==c&&c.includes("permission")||403===e.status?Ht.AUTHORIZATION:null!==(d=e.message)&&void 0!==d&&d.includes("not found")||404===e.status?Ht.NOT_FOUND:e.status>=500?Ht.SERVER:e.status>=400&&e.status<500?Ht.CLIENT:Ht.UNKNOWN:Ht.UNKNOWN}determineSeverity(e,t){switch(e){case Ht.CRITICAL:case Ht.SERVER:return Zt;case Ht.AUTHENTICATION:case Ht.AUTHORIZATION:return Jt;case Ht.NETWORK:case Ht.VALIDATION:return Vt;default:return qt}}logError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=this.analyzeErrorType(e),a=this.determineSeverity(o,e),s={timestamp:(new Date).toISOString(),type:o,severity:a,context:t,message:e.message||"Unknown error",stack:e.stack,additionalData:r};this.errorLog.push(s),this.errorLog.length>this.maxLogSize&&this.errorLog.shift();console[a===Zt?"error":"warn"]("[".concat(o,"] ").concat(t,":"),e.message,r),a===Zt&&console.error("Full error stack:",e.stack)}getUserMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=this.analyzeErrorType(e),o=Kt[r];return{title:o.title,message:t||o.message,userMessage:o.userMessage,type:r}}handleError(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{log:o=!0,customMessage:a=null,additionalData:s={},rethrow:n=!1}=r;o&&this.logError(e,t,s);const i=this.getUserMessage(e,a),l={success:!1,error:i.userMessage,errorType:i.type,errorTitle:i.title,errorDetails:i.message,context:t,timestamp:(new Date).toISOString()};if(n)throw l;return l}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[]}isRecoverable(e){const t=this.analyzeErrorType(e);return[Ht.NETWORK,Ht.VALIDATION,Ht.AUTHENTICATION].includes(t)}};const Yt=["count","color","size","variant","className"];function Qt(e){const{count:t,color:r="gray",size:s="md",variant:n="default",className:i=""}=e,l=o(e,Yt),c={gray:"bg-gray-100 text-gray-600 border-gray-200",blue:"bg-blue-100 text-blue-600 border-blue-200",green:"bg-green-100 text-green-600 border-green-200",red:"bg-red-100 text-red-600 border-red-200",yellow:"bg-yellow-100 text-yellow-600 border-yellow-200",purple:"bg-purple-100 text-purple-600 border-purple-200"},d={default:"rounded-full",outline:"rounded-full border",dot:"rounded-full w-2 h-2"};if("dot"===n)return(0,jt.jsx)("span",(0,a.A)({className:"inline-block ".concat(c[r]," ").concat(d[n]," ").concat(i)},l));if(!t||0===t)return null;const u="".concat(c[r]," ").concat({sm:"text-xs px-1.5 py-0.5",md:"text-xs px-2 py-1",lg:"text-sm px-2.5 py-1.5"}[s]," ").concat(d[n]," ").concat(i);return(0,jt.jsx)("span",(0,a.A)((0,a.A)({className:"inline-flex items-center justify-center font-medium ".concat(u)},l),{},{children:t}))}function $t(e){const{unreadCount:t=0,className:r="",size:o="md",color:a="red"}=e;if(t<=0)return null;const s="".concat({sm:"w-4 h-4 text-xs",md:"w-5 h-5 text-xs",lg:"w-6 h-6 text-sm"}[o]," ").concat({red:"bg-red-500 text-white",blue:"bg-blue-500 text-white",green:"bg-green-500 text-white",orange:"bg-orange-500 text-white"}[a]," rounded-full flex items-center justify-center font-medium ").concat(r);return(0,jt.jsx)("div",{className:s,children:(0,jt.jsx)("span",{children:(n=t,n>99?"99+":n.toString())})});var n}const Xt=["progress","color","size","className","showLabel","label"];function er(e){const{progress:t=0,color:r="blue",size:s="md",className:n="",showLabel:i=!1,label:l}=e,c=o(e,Xt),d=Math.max(0,Math.min(100,t)),u={sm:"h-1",md:"h-2",lg:"h-3"},h="w-full bg-gray-200 rounded-full ".concat(u[s]," ").concat(n),m="".concat({blue:"bg-blue-600",green:"bg-green-600",purple:"bg-purple-600",red:"bg-red-600",orange:"bg-orange-600"}[r]," ").concat(u[s]," rounded-full transition-all duration-500");return(0,jt.jsxs)("div",{className:"w-full",children:[i&&(0,jt.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,jt.jsx)("span",{className:"text-sm text-gray-600",children:l||"Progress"}),(0,jt.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[d,"%"]})]}),(0,jt.jsx)("div",(0,a.A)((0,a.A)({className:h,role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":d,"aria-label":"Progress: ".concat(d,"%")},c),{},{children:(0,jt.jsx)("div",{className:m,style:{width:"".concat(d,"%")}})}))]})}const tr=["onFileUpload","id","children","className","variant","accept","multiple","buttonText","placeholder"];function rr(e){const{onFileUpload:t,id:r,children:s,className:n="",variant:i="default",accept:l=".jpg,.jpeg,.png,.gif,.pdf",multiple:c=!0,buttonText:d="Choose Files",placeholder:u="Drag and drop files here, or click to select"}=e,h=o(e,tr),m="".concat({default:"border-2 border-dashed border-gray-300 rounded-lg bg-white py-8 px-4",compact:"border-2 border-dashed border-gray-300 rounded-lg bg-white py-4 px-3",large:"border-2 border-dashed border-gray-300 rounded-lg bg-white py-12 px-6"}[i]," text-center ").concat(n);return(0,jt.jsxs)("div",(0,a.A)((0,a.A)({className:m},h),{},{children:[(0,jt.jsx)("svg",{className:"".concat({default:"w-8 h-8",compact:"w-6 h-6",large:"w-12 h-12"}[i]," text-gray-400 mx-auto mb-3"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),s||(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:u}),(0,jt.jsx)("input",{type:"file",multiple:c,accept:l,onChange:t,className:"hidden",id:r}),(0,jt.jsx)("label",{htmlFor:r,className:"bg-tag-blue text-white ".concat({default:"px-4 py-2",compact:"px-3 py-1 text-sm",large:"px-6 py-3 text-lg"}[i]," rounded cursor-pointer hover:bg-tag-dark-blue transition-colors duration-200 inline-block"),children:d})]}))}var or=r(526),ar=(r(255),r(420)),sr=r(200);const nr=async e=>{try{if(!e)return{success:!1,error:"Missing userId"};const t=await(0,sr.ep)(e);return console.log("[localStorageAdapter] Retrieved works for user ".concat(e)),t}catch(t){return console.error("[localStorageAdapter] Error getting works for user ".concat(e,":"),t),{success:!1,error:t.message}}},ir=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(!e)return{success:!1,error:"Missing workId"};if(t){const s=await(0,sr.ep)(t);if(s.success){const n=s.data.find(t=>t.id===e);if(n){var r,o;const s=(0,a.A)((0,a.A)({},n),{},{author:{id:t,name:(null===(r=(0,ar.ug)(t))||void 0===r?void 0:r.name)||"Unknown Artist",role:n.category||"Design",avatar:(null===(o=(0,ar.ug)(t))||void 0===o?void 0:o.avatar)||null}});return console.log("[localStorageAdapter] Found work ".concat(e," for user ").concat(t)),{success:!0,data:s}}}}else{const t=await(0,sr.S5)();if(t.success){const r=t.data.find(t=>t.id===e);if(r){var s,n,i,l;const t=(0,a.A)((0,a.A)({},r),{},{author:{id:(null===(s=r.profiles)||void 0===s?void 0:s.id)||r.userId||"unknown",name:(null===(n=r.profiles)||void 0===n?void 0:n.full_name)||"Unknown Artist",role:(null===(i=r.profiles)||void 0===i?void 0:i.role)||r.category||"Design",avatar:(null===(l=r.profiles)||void 0===l?void 0:l.avatar_url)||""}});return console.log("[localStorageAdapter] Found work ".concat(e)),{success:!0,data:t}}}}return console.log("[localStorageAdapter] Work ".concat(e," not found")),{success:!1,error:"Work not found"}}catch(c){return console.error("[localStorageAdapter] Error getting work ".concat(e,":"),c),{success:!1,error:c.message}}},lr=async e=>{try{if(!e)return{success:!1,error:"Missing workData"};const t=await(0,sr.qo)(e);return console.log("[localStorageAdapter] Created work"),t}catch(t){return console.error("[localStorageAdapter] Error creating work:",t),{success:!1,error:t.message}}},cr=async(e,t)=>{try{if(!e||!t)return{success:!1,error:"Missing workId or workData"};const r=await(0,sr.updatePortfolioItem)(e,t);return console.log("[localStorageAdapter] Updated work ".concat(e)),r}catch(r){return console.error("[localStorageAdapter] Error updating work ".concat(e,":"),r),{success:!1,error:r.message}}},dr=async e=>{try{if(!e)return{success:!1,error:"Missing workId"};const t=await(0,sr.zB)(e);return console.log("[localStorageAdapter] Deleted work ".concat(e)),t}catch(t){return console.error("[localStorageAdapter] Error deleting work ".concat(e,":"),t),{success:!1,error:t.message}}},ur=async()=>{try{const e=await(0,sr.S5)();if(e.success&&e.data){const t=e.data.map(e=>{var t,r,o;return(0,a.A)((0,a.A)({},e),{},{author:{id:(null===(t=e.profiles)||void 0===t?void 0:t.id)||e.userId||"unknown",name:(null===(r=e.profiles)||void 0===r?void 0:r.full_name)||"Unknown Artist",role:e.category||"Design",avatar:(null===(o=e.profiles)||void 0===o?void 0:o.avatar_url)||""}})});return console.log("[localStorageAdapter] Retrieved all public works with unified author format"),{success:!0,data:t}}return e}catch(e){return console.error("[localStorageAdapter] Error getting all public works:",e),{success:!1,error:e.message}}},hr=async e=>{try{if(!e)return{success:!1,error:"Missing userId"};const t=ar.o1[e];if(!t||!t.portfolio)return console.log("[mockUsersAdapter] No portfolio found for user ".concat(e)),{success:!0,data:[]};const r=t.portfolio.map(r=>({id:r.id,title:r.title,description:"",category:r.category,tags:r.tags,imagePaths:[r.thumb],thumbnailPath:r.thumb,isPublic:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),author:{id:e,name:t.name,avatar:t.avatar,role:t.role}}));return console.log("[mockUsersAdapter] Retrieved ".concat(r.length," works for user ").concat(e," (fallback)")),{success:!0,data:r}}catch(t){return console.error("[mockUsersAdapter] Error getting works for user ".concat(e,":"),t),{success:!1,error:t.message}}},mr=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(!e)return{success:!1,error:"Missing workId"};if(t){const r=ar.o1[t];if(r&&r.portfolio){const o=r.portfolio.find(t=>t.id===e);if(o){const a={id:o.id,title:o.title,description:"",category:o.category,tags:o.tags,imagePaths:[o.thumb],thumbnailPath:o.thumb,isPublic:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),author:{id:t,name:r.name,avatar:r.avatar,role:r.role}};return console.log("[mockUsersAdapter] Found work ".concat(e," for user ").concat(t," (fallback)")),{success:!0,data:a}}}}else for(const[t,r]of Object.entries(ar.o1))if(r.portfolio){const o=r.portfolio.find(t=>t.id===e);if(o){const a={id:o.id,title:o.title,description:"",category:o.category,tags:o.tags,imagePaths:[o.thumb],thumbnailPath:o.thumb,isPublic:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),author:{id:t,name:r.name,avatar:r.avatar,role:r.role}};return console.log("[mockUsersAdapter] Found work ".concat(e," for user ").concat(t," (fallback)")),{success:!0,data:a}}}return console.log("[mockUsersAdapter] Work ".concat(e," not found (fallback)")),{success:!1,error:"Work not found"}}catch(r){return console.error("[mockUsersAdapter] Error getting work ".concat(e,":"),r),{success:!1,error:r.message}}},pr=async()=>{try{const e=[];for(const[t,r]of Object.entries(ar.o1))if(r.portfolio){const o=r.portfolio.map(e=>({id:e.id,title:e.title,description:"",category:e.category,tags:e.tags,imagePaths:[e.thumb],thumbnailPath:e.thumb,isPublic:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),author:{id:t,name:r.name,avatar:r.avatar,role:r.role}}));e.push(...o)}return console.log("[mockUsersAdapter] Retrieved ".concat(e.length," public works (fallback)")),{success:!0,data:e}}catch(e){return console.error("[mockUsersAdapter] Error getting all public works:",e),{success:!1,error:e.message}}},gr={getAllPublicWorks:async()=>{console.log("[Supabase WorkService] Getting all public works");try{const{data:e,error:t}=await wt.supabase.from("portfolio").select("*").eq("is_public",!0).order("created_at",{ascending:!1});if(t)throw console.error("[Supabase WorkService] Database error:",t),t;console.log("[Supabase WorkService] Found ".concat(e.length," public works"));return{success:!0,data:await Promise.all(e.map(async e=>{let t=null;if(e.thumbnail_path){const r=await(0,sr.getPortfolioImageUrl)(e.thumbnail_path);r.success&&(t=r.data.url)}else if(e.image_paths&&e.image_paths.length>0){const r=await(0,sr.getPortfolioImageUrl)(e.image_paths[0]);r.success&&(t=r.data.url)}return{id:e.id,title:e.title,description:e.description,category:e.category,tags:e.tags||[],mainImageUrl:t,allImages:e.image_paths||[],thumbnailPath:e.thumbnail_path,isPublic:e.is_public,createdAt:e.created_at,updatedAt:e.updated_at,userId:e.user_id,author:{id:e.user_id,name:"Unknown Artist",avatar:"",role:"Design"}}}))}}catch(e){throw console.error("[Supabase WorkService] Error getting public works:",e),e}},getUserWorks:async e=>{if(console.log("[Supabase WorkService] Getting works for user ".concat(e)),!e)throw new Error("User ID is required");try{const{data:t,error:r}=await wt.supabase.from("portfolio").select("*").eq("user_id",e).eq("is_public",!0).order("created_at",{ascending:!1});if(r)throw console.error("[Supabase WorkService] Database error:",r),r;console.log("[Supabase WorkService] Found ".concat(t.length," works for user ").concat(e));return{success:!0,data:await Promise.all(t.map(async e=>{let t=null;if(e.thumbnail_path){const r=await(0,sr.getPortfolioImageUrl)(e.thumbnail_path);r.success&&(t=r.data.url)}else if(e.image_paths&&e.image_paths.length>0){const r=await(0,sr.getPortfolioImageUrl)(e.image_paths[0]);r.success&&(t=r.data.url)}return{id:e.id,title:e.title,description:e.description,category:e.category,tags:e.tags||[],mainImageUrl:t,allImages:e.image_paths||[],thumbnailPath:e.thumbnail_path,isPublic:e.is_public,createdAt:e.created_at,updatedAt:e.updated_at,userId:e.user_id}}))}}catch(t){throw console.error("[Supabase WorkService] Error getting user works:",t),t}},getWorkById:async function(e){if(console.log("[Supabase WorkService] Getting work by ID: ".concat(e)),!e)throw new Error("Work ID is required");try{const{data:t,error:r}=await wt.supabase.from("portfolio").select("*").eq("id",e).eq("is_public",!0).single();if(r)throw console.error("[Supabase WorkService] Database error:",r),r;if(!t)throw new Error("Work not found");console.log("[Supabase WorkService] Found work: ".concat(t.title));let o=null,a=[];if(t.thumbnail_path){const e=await(0,sr.getPortfolioImageUrl)(t.thumbnail_path);e.success&&(o=e.data.url)}if(t.image_paths&&t.image_paths.length>0){const e=t.image_paths.map(async e=>{const t=await(0,sr.getPortfolioImageUrl)(e);return t.success?t.data.url:null});a=(await Promise.all(e)).filter(e=>null!==e),!o&&a.length>0&&(o=a[0])}return{success:!0,data:{id:t.id,title:t.title,description:t.description,category:t.category,tags:t.tags||[],mainImageUrl:o,allImages:a,thumbnailPath:t.thumbnail_path,isPublic:t.is_public,createdAt:t.created_at,updatedAt:t.updated_at,userId:t.user_id}}}catch(t){throw console.error("[Supabase WorkService] Error getting work by ID:",t),t}},createWork:async e=>{console.log("[Supabase WorkService] Creating new work");try{const{data:t,error:r}=await wt.supabase.from("portfolio").insert({user_id:e.userId,title:e.title,description:e.description,category:e.category,tags:e.tags,image_paths:e.imagePaths,thumbnail_path:e.thumbnailPath,is_public:!1!==e.isPublic}).select().single();if(r)throw console.error("[Supabase WorkService] Create error:",r),r;return{success:!0,data:{id:t.id,title:t.title,description:t.description,category:t.category,tags:t.tags,imagePaths:t.image_paths,thumbnailPath:t.thumbnail_path,isPublic:t.is_public,createdAt:t.created_at,updatedAt:t.updated_at,userId:t.user_id}}}catch(t){throw console.error("[Supabase WorkService] Error creating work:",t),t}},updateWork:async(e,t,r)=>{console.log("[Supabase WorkService] Updating work: ".concat(e));try{const{data:o,error:a}=await wt.supabase.from("portfolio").update({title:t.title,description:t.description,category:t.category,tags:t.tags,image_paths:t.imagePaths,thumbnail_path:t.thumbnailPath,is_public:t.isPublic,updated_at:(new Date).toISOString()}).eq("id",e).eq("user_id",r).select().single();if(a)throw console.error("[Supabase WorkService] Update error:",a),a;return{success:!0,data:{id:o.id,title:o.title,description:o.description,category:o.category,tags:o.tags,imagePaths:o.image_paths,thumbnailPath:o.thumbnail_path,isPublic:o.is_public,createdAt:o.created_at,updatedAt:o.updated_at,userId:o.user_id}}}catch(o){throw console.error("[Supabase WorkService] Error updating work:",o),o}},deleteWork:async(e,t)=>{console.log("[Supabase WorkService] Deleting work: ".concat(e));try{const{error:r}=await wt.supabase.from("portfolio").delete().eq("id",e).eq("user_id",t);if(r)throw console.error("[Supabase WorkService] Delete error:",r),r;return{success:!0,data:{id:e}}}catch(r){throw console.error("[Supabase WorkService] Error deleting work:",r),r}}},fr=gr,vr={getUserWorks:async e=>{try{const{isMock:a}=await Promise.resolve().then(r.bind(r,77));if(!a())try{var t;const r=await fr.getUserWorks(e);return console.log("[workService] Using Supabase works for user ".concat(e," (").concat((null===r||void 0===r||null===(t=r.data)||void 0===t?void 0:t.length)||0," works)")),r}catch(o){throw console.error("[workService] Supabase failed for user ".concat(e,":"),o),o}return console.log("[workService] Mock mode: Using LocalStorage works for user ".concat(e)),await nr(e)}catch(a){return console.error("[workService] Error getting works for user ".concat(e,":"),a),await hr(e)}},getWorkById:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{const{isMock:a}=await Promise.resolve().then(r.bind(r,77));if(!a())try{const r=await fr.getWorkById(e,t);return console.log("[workService] Using Supabase work data for ".concat(e)),r}catch(o){throw console.error("[workService] Supabase failed for work ".concat(e,":"),o),o}return console.log("[workService] Mock mode: Using LocalStorage work data for ".concat(e)),await ir(e,t)}catch(a){return console.error("[workService] Error getting work ".concat(e,":"),a),await mr(e,t)}},createWork:async e=>{try{const t=await lr(e);if(t.success)return console.log("[workService] Created work in LocalStorage"),t;const r=await fr.createWork(e);return r.success?(console.log("[workService] Created work in Supabase"),r):(console.warn("[workService] Failed to create work"),{success:!1,error:"Failed to create work"})}catch(t){return console.error("[workService] Error creating work:",t),{success:!1,error:t.message}}},updateWork:async(e,t)=>{try{const r=await cr(e,t);if(r.success)return console.log("[workService] Updated work ".concat(e," in LocalStorage")),r;const o=await fr.updateWork(e,t);return o.success?(console.log("[workService] Updated work ".concat(e," in Supabase")),o):(console.warn("[workService] Failed to update work ".concat(e)),{success:!1,error:"Failed to update work"})}catch(r){return console.error("[workService] Error updating work ".concat(e,":"),r),{success:!1,error:r.message}}},deleteWork:async e=>{try{const t=await dr(e);if(t.success)return console.log("[workService] Deleted work ".concat(e," from LocalStorage")),t;const r=await fr.deleteWork(e);return r.success?(console.log("[workService] Deleted work ".concat(e," from Supabase")),r):(console.warn("[workService] Failed to delete work ".concat(e)),{success:!1,error:"Failed to delete work"})}catch(t){return console.error("[workService] Error deleting work ".concat(e,":"),t),{success:!1,error:t.message}}},getAllPublicWorks:async()=>{try{const{isMock:o}=await Promise.resolve().then(r.bind(r,77));if(!o())try{var e;const t=await fr.getAllPublicWorks();return console.log("[workService] Using Supabase public works (".concat((null===t||void 0===t||null===(e=t.data)||void 0===e?void 0:e.length)||0," works)")),t}catch(t){throw console.error("[workService] Supabase failed for public works:",t),t}return console.log("[workService] Mock mode: Using LocalStorage public works"),await ur()}catch(o){return console.error("[workService] Error getting all public works:",o),await pr()}}};var xr=r(179);const br={getPublicArtists:async()=>{try{const t=[],r=await xr.IG.keys();for(const o of r)if(o&&o.startsWith("artist_"))try{const e=await xr.IG.getItem(o);if(e){const r=JSON.parse(e);t.push(r)}}catch(e){console.warn("[localStorageAdapter] Failed to parse artist data for key ".concat(o,":"),e)}return console.log("[localStorageAdapter] Retrieved ".concat(t.length," artists")),{success:!0,data:t}}catch(e){return console.error("[localStorageAdapter] Error getting public artists:",e),{success:!1,error:e.message}}},getArtistProfile:async e=>{try{if(!e)return{success:!1,error:"Missing artistId"};const t=await xr.IG.getItem("artist_".concat(e));if(!t)return console.log("[localStorageAdapter] No artist data found for ".concat(e)),{success:!1,error:"Artist not found"};const r=JSON.parse(t);return console.log("[localStorageAdapter] Retrieved artist profile for ".concat(e)),{success:!0,data:r}}catch(t){return console.error("[localStorageAdapter] Error getting artist profile ".concat(e,":"),t),{success:!1,error:t.message}}},createArtist:async(e,t)=>{try{if(!e||!t)return{success:!1,error:"Missing artistId or artistData"};const r=await br.getArtistProfile(e);if(r.success)return console.log("[localStorageAdapter] Artist ".concat(e," already exists")),{success:!0,data:r.data};const o=(0,a.A)((0,a.A)({id:e},t),{},{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});return await xr.IG.setItem("artist_".concat(e),JSON.stringify(o)),console.log("[localStorageAdapter] Created artist ".concat(e)),{success:!0,data:o}}catch(r){return console.error("[localStorageAdapter] Error creating artist ".concat(e,":"),r),{success:!1,error:r.message}}},updateArtist:async(e,t)=>{try{if(!e||!t)return{success:!1,error:"Missing artistId or artistData"};const r=await br.getArtistProfile(e);if(!r.success)return console.warn("[localStorageAdapter] Artist ".concat(e," not found for update")),{success:!1,error:"Artist not found"};const o=(0,a.A)((0,a.A)((0,a.A)({},r.data),t),{},{updatedAt:(new Date).toISOString()});return await xr.IG.setItem("artist_".concat(e),JSON.stringify(o)),console.log("[localStorageAdapter] Updated artist ".concat(e)),{success:!0,data:o}}catch(r){return console.error("[localStorageAdapter] Error updating artist ".concat(e,":"),r),{success:!1,error:r.message}}},saveArtistIndex:async e=>{try{if(!Array.isArray(e))return{success:!1,error:"Artists must be an array"};for(const t of e)t.id&&await xr.IG.setItem("artist_".concat(t.id),JSON.stringify(t));return console.log("[localStorageAdapter] Saved ".concat(e.length," artists to index")),{success:!0,data:e}}catch(t){return console.error("[localStorageAdapter] Error saving artist index:",t),{success:!1,error:t.message}}},deleteArtist:async e=>{try{return e?(await xr.IG.removeItem("artist_".concat(e)),console.log("[localStorageAdapter] Deleted artist ".concat(e)),{success:!0}):{success:!1,error:"Missing artistId"}}catch(t){return console.error("[localStorageAdapter] Error deleting artist ".concat(e,":"),t),{success:!1,error:t.message}}}},yr=async()=>{try{const e=(0,ar.CF)().map(e=>({id:e.id,name:e.name,displayName:e.displayName,avatar:e.avatar,role:e.role,roleIcon:e.roleIcon,bio:e.bio,school:e.school,pronouns:e.pronouns,majors:e.majors,skills:e.skills,socialLinks:e.socialLinks,works:e.portfolio?e.portfolio.map(e=>({id:e.id,title:e.title,thumbnailPath:e.thumb,category:e.category})):[],followers:0,following:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}));return console.log("[mockUsersAdapter] Retrieved ".concat(e.length," artists (fallback)")),{success:!0,data:e}}catch(e){return console.error("[mockUsersAdapter] Error getting public artists:",e),{success:!1,error:e.message}}},wr=async()=>{try{console.log("[supabaseAdapter] Getting all registered artists from Supabase");const{data:e,error:t}=await wt.supabase.from("profiles").select("*").order("created_at",{ascending:!1});if(t)return console.error("[supabaseAdapter] Error fetching profiles:",t),{success:!1,error:t.message};if(!e||0===e.length)return console.log("[supabaseAdapter] No profiles found"),{success:!0,data:[]};const r=e.map(e=>e.id),[o,a,s]=await Promise.all([wt.supabase.from("follows").select("following_id").in("following_id",r),wt.supabase.from("follows").select("follower_id").in("follower_id",r),wt.supabase.from("portfolio").select("user_id").in("user_id",r).eq("is_public",!0)]),n=new Map,i=new Map,l=new Map;o.data&&o.data.forEach(e=>{const t=n.get(e.following_id)||0;n.set(e.following_id,t+1)}),a.data&&a.data.forEach(e=>{const t=i.get(e.follower_id)||0;i.set(e.follower_id,t+1)}),s.data&&s.data.forEach(e=>{const t=l.get(e.user_id)||0;l.set(e.user_id,t+1)});const c=e.map(e=>({id:e.id,name:e.full_name||"Unknown Artist",title:e.title||"Artist",school:e.school||"",majors:e.majors||[],minors:e.minors||[],avatar:e.avatar_url||null,worksCount:l.get(e.id)||0,followers:n.get(e.id)||0,following:i.get(e.id)||0,createdAt:e.created_at,updatedAt:e.updated_at,role:e.title||"Artist"}));return console.log("[supabaseAdapter] Found ".concat(c.length," registered artists")),{success:!0,data:c}}catch(e){return console.error("[supabaseAdapter] Error getting public artists:",e),{success:!1,error:e.message}}},jr=async e=>(console.log("[supabaseAdapter] getArtistProfile not implemented yet for ".concat(e)),{success:!1,data:null}),kr=async(e,t)=>(console.log("[supabaseAdapter] updateArtist not implemented yet for ".concat(e)),{success:!1,error:"Supabase adapter not implemented yet"}),Sr={getPublicArtists:async()=>{try{console.log("[artistService] Getting all registered artists");const e=await wr();if(e.success)return console.log("[artistService] Found ".concat(e.data.length," registered artists")),e;{console.error("[artistService] Supabase adapter failed:",e.error),console.log("[artistService] Falling back to localStorage adapter");const t=await br.getPublicArtists();return t.success?(console.log("[artistService] Fallback found ".concat(t.data.length," artists")),t):(console.log("[artistService] Falling back to mockUsers adapter"),await yr())}}catch(e){return console.error("[artistService] Error getting public artists:",e),{success:!1,error:e.message}}},getArtistProfile:async e=>{try{const t=await br.getArtistProfile(e);if(t&&t.data)return console.log("[artistService] Using LocalStorage artist profile for ".concat(e)),t;const r=await jr(e);return r&&r.data?(console.log("[artistService] Using Supabase artist profile for ".concat(e)),r):(console.log("[artistService] No artist profile found for ".concat(e,", returning null")),{success:!1,error:"Artist profile not found"})}catch(t){return console.error("[artistService] Error getting artist profile ".concat(e,":"),t),{success:!1,error:t.message}}},bootstrapFromPortfolios:async()=>{try{console.log("[artistService] Starting bootstrap from portfolios");const e=await vr.getAllPublicWorks();if(!e.success)return console.warn("[artistService] Failed to get all works for bootstrap"),{success:!1,error:"Failed to get works"};const t=new Map;for(const a of e.data)if(a.author&&a.author.id){const e=a.author.id;if(!t.has(e)){const r={id:e,name:a.author.name||"Unknown Artist",avatar:a.author.avatar||"",role:a.author.role||"Artist",bio:"",school:"",pronouns:"",majors:[],skills:[],socialLinks:{},works:[],followers:0,following:0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()};t.set(e,r)}const r=t.get(e);r.works.find(e=>e.id===a.id)||r.works.push({id:a.id,title:a.title,thumbnailPath:a.thumbnailPath,category:a.category})}const r=Array.from(t.values()),o=await br.saveArtistIndex(r);return console.log("[artistService] Bootstraped ".concat(r.length," artists from portfolios")),o}catch(e){return console.error("[artistService] Error bootstrapping from portfolios:",e),{success:!1,error:e.message}}},ensureArtistIndexed:async e=>{try{if(!e)return{success:!1,error:"Missing userId"};const o=await Sr.getArtistProfile(e);if(o&&o.success)return console.log("[artistService] Artist ".concat(e," already indexed")),{success:!0,data:o.data};const{userService:a}=await Promise.resolve().then(r.bind(r,255)),s=await a.getUserById(e);if(s){const r="portfolio_".concat(e),o=await br.getItem(r);let a=0,n=[];if(o)try{const e=JSON.parse(o);if(Array.isArray(e)){const t=e.filter(e=>!1!==e.isPublic);a=t.length,n=t}}catch(t){console.warn("[artistService] Failed to parse portfolio for ".concat(e,":"),t)}const i={id:e,name:s.name||s.displayName||"Unknown Artist",avatar:s.avatar||"",role:s.role||"Artist",bio:s.bio||"",school:s.school||"",pronouns:s.pronouns||"",majors:s.majors||[],skills:s.skills||[],socialLinks:s.socialLinks||{},works:n,worksCount:a,followers:0,following:0,createdAt:s.updatedAt||(new Date).toISOString(),updatedAt:s.updatedAt||(new Date).toISOString()},l=await br.createArtist(e,i);return console.log("[artistService] Created artist index for ".concat(e)),l}return console.warn("[artistService] No user data found for ".concat(e)),{success:!1,error:"No user data found"}}catch(o){return console.error("[artistService] Error ensuring artist indexed ".concat(e,":"),o),{success:!1,error:o.message}}},updateArtist:async(e,t)=>{try{const r=await br.updateArtist(e,t);if(r.success)return console.log("[artistService] Updated artist ".concat(e," in LocalStorage")),r;const o=await kr(e,t);return o.success?(console.log("[artistService] Updated artist ".concat(e," in Supabase")),o):(console.warn("[artistService] Failed to update artist ".concat(e)),{success:!1,error:"Failed to update artist"})}catch(r){return console.error("[artistService] Error updating artist ".concat(e,":"),r),{success:!1,error:r.message}}}};var Nr=r(106);const Cr=async(e,t)=>{try{const{data:o,error:a}=await wt.supabase.from("artwork_likes").select("id").eq("artwork_id",e).eq("user_id",t).single();if(a&&"PGRST205"===a.code){console.warn("[SupabaseLike] artwork_likes table not found, falling back to LocalStorage");const{localStorageAdapter:o}=await Promise.resolve().then(r.bind(r,106));return await o.toggleArtworkLike(e,t)}if(a&&"PGRST116"!==a.code)return console.error("[SupabaseLike] Error checking existing like:",a),{success:!1,error:a.message};let s=!1,n=0;if(o){const{error:r}=await wt.supabase.from("artwork_likes").delete().eq("artwork_id",e).eq("user_id",t);if(r)return console.error("[SupabaseLike] Error deleting like:",r),{success:!1,error:r.message};s=!1,console.log("[SupabaseLike] User ".concat(t," unliked artwork ").concat(e))}else{const{error:r}=await wt.supabase.from("artwork_likes").insert({artwork_id:e,user_id:t});if(r)return console.error("[SupabaseLike] Error inserting like:",r),{success:!1,error:r.message};s=!0,console.log("[SupabaseLike] User ".concat(t," liked artwork ").concat(e))}const{count:i,error:l}=await wt.supabase.from("artwork_likes").select("*",{count:"exact",head:!0}).eq("artwork_id",e);return l?(console.error("[SupabaseLike] Error getting like count:",l),n=0):n=i||0,console.log("[SupabaseLike] Artwork ".concat(e," total likes: ").concat(n)),{success:!0,data:{liked:s,likes:n}}}catch(o){return console.error("[SupabaseLike] Error toggling like:",o),{success:!1,error:o.message}}},_r=async(e,t)=>{try{const{data:o,error:a}=await wt.supabase.from("artwork_likes").select("id").eq("artwork_id",e).eq("user_id",t).single();if(a&&"PGRST205"===a.code){console.warn("[SupabaseLike] artwork_likes table not found, falling back to LocalStorage");const{localStorageAdapter:o}=await Promise.resolve().then(r.bind(r,106));return await o.checkUserLikeStatus(e,t)}if(a&&"PGRST116"!==a.code)return console.error("[SupabaseLike] Error checking like status:",a),{success:!1,error:a.message};const s=!!o,{count:n,error:i}=await wt.supabase.from("artwork_likes").select("*",{count:"exact",head:!0}).eq("artwork_id",e);if(i)return console.error("[SupabaseLike] Error getting like count:",i),{success:!1,error:i.message};const l=n||0;return console.log("[SupabaseLike] User ".concat(t," like status for artwork ").concat(e,": ").concat(s?"Liked":"Not liked",", Total: ").concat(l)),{success:!0,data:{liked:s,likes:l}}}catch(o){return console.error("[SupabaseLike] Error checking like status:",o),{success:!1,error:o.message}}},Ar=async e=>{try{const{count:t,error:o}=await wt.supabase.from("artwork_likes").select("*",{count:"exact",head:!0}).eq("artwork_id",e);if(o&&"PGRST205"===o.code){console.warn("[SupabaseLike] artwork_likes table not found, falling back to LocalStorage");const{localStorageAdapter:t}=await Promise.resolve().then(r.bind(r,106));return await t.getArtworkLikeCount(e)}if(o)return console.error("[SupabaseLike] Error getting like count:",o),{success:!1,error:o.message};const a=t||0;return console.log("[SupabaseLike] Artwork ".concat(e," total likes: ").concat(a)),{success:!0,data:{likes:a}}}catch(t){return console.error("[SupabaseLike] Error getting like count:",t),{success:!1,error:t.message}}},Ir=async(e,t)=>{try{const{isMock:a}=await Promise.resolve().then(r.bind(r,77));if(!a())try{const r=await Cr(e,t);return console.log("[likeService] Using Supabase like toggle for artwork ".concat(e)),r}catch(o){throw console.error("[likeService] Supabase failed for artwork ".concat(e,":"),o),o}return console.log("[likeService] Mock mode: Using LocalStorage like toggle for artwork ".concat(e)),await Nr.localStorageAdapter.toggleArtworkLike(e,t)}catch(a){return console.error("[likeService] Error toggling like for artwork ".concat(e,":"),a),{success:!1,error:a.message}}},Pr=async(e,t)=>{try{const{isMock:a}=await Promise.resolve().then(r.bind(r,77));if(!a())try{const r=await _r(e,t);return console.log("[likeService] Using Supabase like status check for artwork ".concat(e)),r}catch(o){throw console.error("[likeService] Supabase failed for artwork ".concat(e,":"),o),o}return console.log("[likeService] Mock mode: Using LocalStorage like status check for artwork ".concat(e)),await Nr.localStorageAdapter.checkUserLikeStatus(e,t)}catch(a){return console.error("[likeService] Error checking like status for artwork ".concat(e,":"),a),{success:!1,error:a.message}}},Er=async e=>{try{const{isMock:o}=await Promise.resolve().then(r.bind(r,77));if(!o())try{const t=await Ar(e);return console.log("[likeService] Using Supabase like count for artwork ".concat(e)),t}catch(t){throw console.error("[likeService] Supabase failed for artwork ".concat(e,":"),t),t}return console.log("[likeService] Mock mode: Using LocalStorage like count for artwork ".concat(e)),await Nr.localStorageAdapter.getArtworkLikeCount(e)}catch(o){return console.error("[likeService] Error getting like count for artwork ".concat(e,":"),o),{success:!1,error:o.message}}};var Dr=r(240);var Lr=r(8);const Tr={WORK:"work",COLLABORATION:"collaboration"},Mr={async getFavorites(e){console.log("[Favorites] Supabase getFavorites called:",e);const{userId:t,type:r="all",cursor:o,limit:a=20}=e;try{var s;let e=wt.supabase.from("favorites").select("*").eq("user_id",t).order("created_at",{ascending:!1});"all"!==r&&(e=e.eq("item_type",r)),o&&(e=e.lt("created_at",o)),e=e.limit(a+1);const{data:n,error:i}=await e;if(i)return console.error("[Favorites] Supabase getFavorites error:",i),{success:!1,error:i.message};const l=n.length>a,c=l?n.slice(0,a):n,d=l?null===(s=c[c.length-1])||void 0===s?void 0:s.created_at:null;return console.log("[Favorites] Supabase getFavorites success:",{count:c.length,hasMore:l}),{success:!0,data:{items:c,pagination:{cursor:d,hasMore:l,total:c.length}}}}catch(n){return console.error("[Favorites] Supabase getFavorites exception:",n),{success:!1,error:n.message}}},async addFavorite(e){console.log("[Favorites] Supabase addFavorite called:",e);const{userId:t,itemType:r,itemId:o}=e;try{const{data:e,error:a}=await wt.supabase.from("favorites").insert({user_id:t,item_type:r,item_id:o}).select().single();return a?"23505"===a.code?(console.log("[Favorites] Supabase addFavorite: already favorited"),{success:!0,data:{id:"existing"}}):(console.error("[Favorites] Supabase addFavorite error:",a),{success:!1,error:a.message}):(console.log("[Favorites] Supabase addFavorite success:",e),{success:!0,data:e})}catch(a){return console.error("[Favorites] Supabase addFavorite exception:",a),{success:!1,error:a.message}}},async removeFavorite(e){console.log("[Favorites] Supabase removeFavorite called:",e);const{userId:t,itemType:r,itemId:o}=e;try{const{data:e,error:a}=await wt.supabase.from("favorites").delete().eq("user_id",t).eq("item_type",r).eq("item_id",o).select().single();return a?(console.error("[Favorites] Supabase removeFavorite error:",a),{success:!1,error:a.message}):(console.log("[Favorites] Supabase removeFavorite success:",e),{success:!0,data:e})}catch(a){return console.error("[Favorites] Supabase removeFavorite exception:",a),{success:!1,error:a.message}}},async checkFavoriteStatus(e){console.log("[Favorites] Supabase checkFavoriteStatus called:",e);const{userId:t,itemType:r,itemId:o}=e;try{const{data:e,error:a}=await wt.supabase.from("favorites").select("id").eq("user_id",t).eq("item_type",r).eq("item_id",o).single();return a?"PGRST116"===a.code?(console.log("[Favorites] Supabase checkFavoriteStatus: not favorited"),{success:!0,data:{isFavorited:!1,favoriteId:null}}):(console.error("[Favorites] Supabase checkFavoriteStatus error:",a),{success:!1,error:a.message}):(console.log("[Favorites] Supabase checkFavoriteStatus: favorited"),{success:!0,data:{isFavorited:!0,favoriteId:e.id}})}catch(a){return console.error("[Favorites] Supabase checkFavoriteStatus exception:",a),{success:!1,error:a.message}}},async getFavoriteCount(e){console.log("[Favorites] Supabase getFavoriteCount called:",e);const{itemType:t,itemId:r}=e;try{const{data:e,error:o}=await wt.supabase.from("favorite_counts").select("favorite_count").eq("item_type",t).eq("item_id",r).single();return o?"PGRST116"===o.code?(console.log("[Favorites] Supabase getFavoriteCount: no favorites found"),{success:!0,data:{count:0}}):(console.error("[Favorites] Supabase getFavoriteCount error:",o),{success:!1,error:o.message}):(console.log("[Favorites] Supabase getFavoriteCount success:",e.favorite_count),{success:!0,data:{count:e.favorite_count||0}})}catch(o){return console.error("[Favorites] Supabase getFavoriteCount exception:",o),{success:!1,error:o.message}}},async batchCheckFavoriteStatus(e){console.log("[Favorites] Supabase batchCheckFavoriteStatus called:",e);try{const{data:t,error:r}=await wt.supabase.from("favorites").select("item_type, item_id").in("item_type",e.map(e=>e.item_type)).in("item_id",e.map(e=>e.item_id));if(r)return console.error("[Favorites] Supabase batchCheckFavoriteStatus error:",r),{success:!1,error:r.message};const o={};return t.forEach(e=>{const t="".concat(e.item_type,":").concat(e.item_id);o[t]=!0}),console.log("[Favorites] Supabase batchCheckFavoriteStatus success:",o),{success:!0,data:o}}catch(t){return console.error("[Favorites] Supabase batchCheckFavoriteStatus exception:",t),{success:!1,error:t.message}}}},Fr=Mr;const Rr=new class{constructor(){this.adapter=Fr}async getFavorites(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=await(0,Lr.HW)(),r=e.userId||(null===t||void 0===t?void 0:t.id);if(!r)throw new Error("User not authenticated");return this.adapter.getFavorites({userId:r,type:e.type||"all",cursor:e.cursor,limit:e.limit||20})}async addFavorite(e,t){console.log("[Favorites] addFavorite called:",{itemType:e,itemId:t});const r=await(0,Lr.HW)();return console.log("[Favorites] Current user:",r?"authenticated":"not authenticated"),null!==r&&void 0!==r&&r.id?e&&t?(e=>Object.values(Tr).includes(e))(e)?(console.log("[Favorites] Calling adapter.addFavorite"),this.adapter.addFavorite({userId:r.id,itemType:e,itemId:t})):(console.log("[Favorites] Invalid item type:",e),{success:!1,error:'Invalid item type. Must be "'.concat(Tr.WORK,'" or "').concat(Tr.COLLABORATION,'"')}):(console.log("[Favorites] Missing required parameters"),{success:!1,error:"Item type and ID are required"}):(console.log("[Favorites] User not authenticated, returning needAuth"),{success:!1,needAuth:!0,error:"User not authenticated"})}async removeFavorite(e,t){console.log("[Favorites] removeFavorite called:",{itemType:e,itemId:t});const r=await(0,Lr.HW)();return console.log("[Favorites] Current user:",r?"authenticated":"not authenticated"),null!==r&&void 0!==r&&r.id?e&&t?(console.log("[Favorites] Calling adapter.removeFavorite"),this.adapter.removeFavorite({userId:r.id,itemType:e,itemId:t})):(console.log("[Favorites] Missing required parameters"),{success:!1,error:"Item type and ID are required"}):(console.log("[Favorites] User not authenticated, returning needAuth"),{success:!1,needAuth:!0,error:"User not authenticated"})}async removeFavoriteById(e){const t=await(0,Lr.HW)();if(null===t||void 0===t||!t.id)throw new Error("User not authenticated");if(!e)throw new Error("Favorite ID is required");const r=await this.getFavorites({userId:t.id});if(!r.success)throw new Error("Failed to get favorites");const o=r.data.items.find(t=>t.id===e);if(!o)throw new Error("Favorite not found");return this.adapter.removeFavorite({userId:t.id,itemType:o.item_type,itemId:o.item_id})}async toggleFavorite(e,t,r){return console.log("[Favorites] toggleFavorite called:",{itemType:e,itemId:t,shouldFavorite:r}),r?this.addFavorite(e,t):this.removeFavorite(e,t)}async checkFavoriteStatus(e,t){const r=await(0,Lr.HW)();if(null===r||void 0===r||!r.id)return{success:!0,data:{isFavorited:!1,favoriteId:null}};if(!e||!t)throw new Error("Item type and ID are required");return this.adapter.checkFavoriteStatus({userId:r.id,itemType:e,itemId:t})}async getFavoriteCount(e,t){if(!e||!t)throw new Error("Item type and ID are required");return this.adapter.getFavoriteCount({itemType:e,itemId:t})}async batchCheckFavoriteStatus(e){const t=await(0,Lr.HW)();return null!==t&&void 0!==t&&t.id?this.adapter.batchCheckFavoriteStatus({userId:t.id,items:e}):e.reduce((e,t)=>(e["".concat(t.item_type,"_").concat(t.item_id)]=!1,e),{})}},Or={STORAGE_KEY:"tag_collaboration_drafts",async _getStorage(){try{const e=await xr.IG.getItem(this.STORAGE_KEY);return e?JSON.parse(e):{}}catch(e){return console.error("Failed to get drafts from storage:",e),{}}},async _setStorage(e){try{await xr.IG.setItem(this.STORAGE_KEY,JSON.stringify(e))}catch(t){console.error("Failed to save drafts to storage:",t)}},_generateId:()=>"draft_"+Date.now().toString(36)+Math.random().toString(36).substr(2),async getDrafts(e){var t;const{userId:r,type:o="all",cursor:a,limit:s=20}=e,n=(await this._getStorage())[r]||[];let i=n;"all"!==o&&(i=n.filter(e=>e.draftType===o)),i.sort((e,t)=>new Date(t.updatedAt)-new Date(e.updatedAt));let l=0;if(a){l=i.findIndex(e=>e.id===a)+1}const c=l+s,d=i.slice(l,c),u=c<i.length,h=u?null===(t=d[d.length-1])||void 0===t?void 0:t.id:null;return await new Promise(e=>setTimeout(e,100)),{success:!0,data:{items:d,pagination:{cursor:h,hasMore:u,total:i.length}}}},async saveDraft(e){const{userId:t,draftType:r,draftData:o}=e,s=await this._getStorage(),n=s[t]||[],i=(0,a.A)((0,a.A)({id:this._generateId(),userId:t,draftType:r},o),{},{createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()});return n.push(i),s[t]=n,await this._setStorage(s),await new Promise(e=>setTimeout(e,200)),{success:!0,data:i}},async updateDraft(e){const{userId:t,draftId:r,draftData:o}=e,s=await this._getStorage(),n=s[t]||[],i=n.findIndex(e=>e.id===r);if(-1===i)throw new Error("Draft not found");const l=(0,a.A)((0,a.A)((0,a.A)({},n[i]),o),{},{updatedAt:(new Date).toISOString()});return n[i]=l,s[t]=n,await this._setStorage(s),await new Promise(e=>setTimeout(e,200)),{success:!0,data:l}},async deleteDraft(e){const{userId:t,draftId:r}=e,o=await this._getStorage(),a=o[t]||[],s=a.findIndex(e=>e.id===r);if(-1===s)throw new Error("Draft not found");const n=a.splice(s,1)[0];return o[t]=a,await this._setStorage(o),await new Promise(e=>setTimeout(e,200)),{success:!0,data:n}},async getDraftById(e){const{userId:t,draftId:r}=e,o=((await this._getStorage())[t]||[]).find(e=>e.id===r);if(!o)throw new Error("Draft not found");return await new Promise(e=>setTimeout(e,100)),{success:!0,data:o}},async publishDraft(e){const{userId:t,draftId:r}=e,o=await this._getStorage(),s=o[t]||[],n=s.findIndex(e=>e.id===r);if(-1===n)throw new Error("Draft not found");s[n];const i=s.splice(n,1)[0];return o[t]=s,await this._setStorage(o),await new Promise(e=>setTimeout(e,300)),{success:!0,data:(0,a.A)((0,a.A)({},i),{},{publishedAt:(new Date).toISOString()})}},async clearUserDrafts(e){const t=await this._getStorage();delete t[e],await this._setStorage(t)},async getAllDrafts(){return await this._getStorage()}},Ur=Or;const zr=new class{constructor(){this.adapter=Ur}async getDrafts(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=await(0,Lr.HW)();if(!(e.userId||(null===t||void 0===t?void 0:t.id)))throw new Error("User not authenticated");return console.log("[DraftService] getDrafts: returning empty list to avoid storage errors"),{success:!0,data:{items:[],pagination:{cursor:null,hasMore:!1,total:0}}}}async saveDraft(e,t){const r=await(0,Lr.HW)();if(null===r||void 0===r||!r.id)throw new Error("User not authenticated");if(!e||!t)throw new Error("Draft type and data are required");return this.adapter.saveDraft({userId:r.id,draftType:e,draftData:t})}async updateDraft(e,t){const r=await(0,Lr.HW)();if(null===r||void 0===r||!r.id)throw new Error("User not authenticated");if(!e||!t)throw new Error("Draft ID and data are required");return this.adapter.updateDraft({userId:r.id,draftId:e,draftData:t})}async deleteDraft(e){const t=await(0,Lr.HW)();if(null===t||void 0===t||!t.id)throw new Error("User not authenticated");if(!e)throw new Error("Draft ID is required");return this.adapter.deleteDraft({userId:t.id,draftId:e})}async getDraftById(e){const t=await(0,Lr.HW)();if(null===t||void 0===t||!t.id)throw new Error("User not authenticated");if(!e)throw new Error("Draft ID is required");return this.adapter.getDraftById({userId:t.id,draftId:e})}async publishDraft(e){const t=await(0,Lr.HW)();if(null===t||void 0===t||!t.id)throw new Error("User not authenticated");if(!e)throw new Error("Draft ID is required");return this.adapter.publishDraft({userId:t.id,draftId:e})}},Wr={getStorageKey:e=>e?"u.".concat(e,".notifications"):null,createNotification:async e=>{try{const t=Wr.getStorageKey(e.receiverId),r=JSON.parse(localStorage.getItem(t)||"[]");r.unshift(e);const o=r.slice(0,100);return localStorage.setItem(t,JSON.stringify(o)),window.dispatchEvent(new CustomEvent("notif:unreadChanged",{detail:{userId:e.receiverId}})),console.log("[localStorageAdapter] Created notification for user ".concat(e.receiverId)),console.log("[localStorageAdapter] Notification data:",e),{success:!0,data:e}}catch(t){return console.error("[localStorageAdapter] Error creating notification:",t),{success:!1,error:t.message}}},getUserNotifications:async e=>{try{const t=Wr.getStorageKey(e),r=JSON.parse(localStorage.getItem(t)||"[]");return console.log("[localStorageAdapter] Retrieved ".concat(r.length," notifications for user ").concat(e)),{success:!0,data:r}}catch(t){return console.error("[localStorageAdapter] Error getting notifications for user ".concat(e,":"),t),{success:!1,error:t.message}}},markAsRead:async e=>{try{const t=Object.keys(localStorage).filter(e=>e.startsWith("u."));for(const r of t){const t=JSON.parse(localStorage.getItem(r)||"[]"),o=t.findIndex(t=>t.id===e);if(-1!==o){t[o].isRead=!0,localStorage.setItem(r,JSON.stringify(t));const a=r.replace("u.","");return window.dispatchEvent(new CustomEvent("notif:unreadChanged",{detail:{userId:a}})),console.log("[localStorageAdapter] Marked notification ".concat(e," as read")),{success:!0,data:t[o]}}}return console.warn("[localStorageAdapter] Notification ".concat(e," not found")),{success:!1,error:"Notification not found"}}catch(t){return console.error("[localStorageAdapter] Error marking notification as read:",t),{success:!1,error:t.message}}},markAllAsRead:async e=>{try{const t=Wr.getStorageKey(e),r=JSON.parse(localStorage.getItem(t)||"[]").map(e=>(0,a.A)((0,a.A)({},e),{},{isRead:!0}));return localStorage.setItem(t,JSON.stringify(r)),window.dispatchEvent(new CustomEvent("notif:unreadChanged",{detail:{userId:e}})),console.log("[localStorageAdapter] Marked all notifications as read for user ".concat(e)),{success:!0,data:r}}catch(t){return console.error("[localStorageAdapter] Error marking all notifications as read:",t),{success:!1,error:t.message}}},deleteNotification:async e=>{try{const t=Object.keys(localStorage).filter(e=>e.startsWith("u."));for(const r of t){const t=JSON.parse(localStorage.getItem(r)||"[]"),o=t.findIndex(t=>t.id===e);if(-1!==o){t.splice(o,1),localStorage.setItem(r,JSON.stringify(t));const a=r.replace("u.","");return window.dispatchEvent(new CustomEvent("notif:unreadChanged",{detail:{userId:a}})),console.log("[localStorageAdapter] Deleted notification ".concat(e)),{success:!0}}}return console.warn("[localStorageAdapter] Notification ".concat(e," not found")),{success:!1,error:"Notification not found"}}catch(t){return console.error("[localStorageAdapter] Error deleting notification:",t),{success:!1,error:t.message}}}},Br=async e=>(console.log("[supabaseAdapter] Would create notification in Supabase:",e),{success:!1,error:"Supabase adapter not implemented yet"}),Gr=async e=>(console.log("[supabaseAdapter] Would get notifications from Supabase for user: ".concat(e)),{success:!1,error:"Supabase adapter not implemented yet"}),Hr=async e=>(console.log("[supabaseAdapter] Would mark notification as read in Supabase: ".concat(e)),{success:!1,error:"Supabase adapter not implemented yet"}),qr=async e=>(console.log("[supabaseAdapter] Would mark all notifications as read in Supabase for user: ".concat(e)),{success:!1,error:"Supabase adapter not implemented yet"}),Vr=async e=>(console.log("[supabaseAdapter] Would delete notification in Supabase: ".concat(e)),{success:!1,error:"Supabase adapter not implemented yet"}),Jr={createFollowNotification:async(e,t,r)=>{try{const o={id:"follow_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:"follow",senderId:e,senderName:t,receiverId:r,title:"New Follower",content:"".concat(t," followed you"),message:"".concat(t," followed you"),isRead:!1,createdAt:(new Date).toISOString(),meta:{action:"follow",followerId:e,followerName:t}},a=await Wr.createNotification(o);if(a.success)return console.log("[notificationService] Created follow notification in LocalStorage"),a;const s=await Br(o);return s.success?(console.log("[notificationService] Created follow notification in Supabase"),s):(console.warn("[notificationService] Failed to create follow notification"),{success:!1,error:"Failed to create follow notification"})}catch(o){return console.error("[notificationService] Error creating follow notification:",o),{success:!1,error:o.message}}},createLikeNotification:async(e,t,r,o,a)=>{try{const s={id:"like_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:"like",senderId:e,senderName:t,receiverId:a,title:"Work Liked",content:"".concat(t,' liked your work "').concat(o,'"'),message:"".concat(t,' liked your work "').concat(o,'"'),isRead:!1,createdAt:(new Date).toISOString(),meta:{action:"like",workId:r,workTitle:o,likerId:e,likerName:t}},n=await Wr.createNotification(s);if(n.success)return console.log("[notificationService] Created like notification in LocalStorage"),n;const i=await Br(s);return i.success?(console.log("[notificationService] Created like notification in Supabase"),i):(console.warn("[notificationService] Failed to create like notification"),{success:!1,error:"Failed to create like notification"})}catch(s){return console.error("[notificationService] Error creating like notification:",s),{success:!1,error:s.message}}},createCommentNotification:async(e,t,r,o,a,s)=>{try{const n={id:"comment_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:"comment",senderId:e,senderName:t,receiverId:a,title:"New Comment",content:"".concat(t,' commented on your work "').concat(o,'"'),message:"".concat(t,' commented on your work "').concat(o,'": "').concat(s,'"'),isRead:!1,createdAt:(new Date).toISOString(),meta:{action:"comment",workId:r,workTitle:o,commenterId:e,commenterName:t,commentContent:s}},i=await Wr.createNotification(n);if(i.success)return console.log("[notificationService] Created comment notification in LocalStorage"),i;const l=await Br(n);return l.success?(console.log("[notificationService] Created comment notification in Supabase"),l):(console.warn("[notificationService] Failed to create comment notification"),{success:!1,error:"Failed to create comment notification"})}catch(n){return console.error("[notificationService] Error creating comment notification:",n),{success:!1,error:n.message}}},getUserNotifications:async e=>{try{const t=await Wr.getUserNotifications(e);if(t&&t.success)return console.log("[notificationService] Using LocalStorage notifications for user ".concat(e)),t;const r=await Gr(e);return r&&r.success?(console.log("[notificationService] Using Supabase notifications for user ".concat(e)),r):(console.log("[notificationService] No notifications found for user ".concat(e)),{success:!0,data:[]})}catch(t){return console.error("[notificationService] Error getting notifications for user ".concat(e,":"),t),{success:!1,error:t.message}}},createCollaborationApplicationNotification:async(e,t,r,o,a,s,n)=>{try{const i={id:"collaboration_application_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:"collaboration",senderId:e,senderName:t,senderAvatar:r,receiverId:s,title:"New Collaboration Application",content:"".concat(t,' applied for your collaboration "').concat(a,'"'),message:"".concat(t,' applied for your collaboration "').concat(a,'". Click to view the application details.'),isRead:!1,createdAt:(new Date).toISOString(),meta:{action:"collaboration_application",collaborationId:o,collaborationTitle:a,applicantId:e,applicantName:t,applicantAvatar:r,applicationData:n}},l=await Wr.createNotification(i);if(l.success)return console.log("[notificationService] Created collaboration application notification in LocalStorage"),l;const c=await Br(i);return c.success?(console.log("[notificationService] Created collaboration application notification in Supabase"),c):(console.warn("[notificationService] Failed to create collaboration application notification"),{success:!1,error:"Failed to create collaboration application notification"})}catch(i){return console.error("[notificationService] Error creating collaboration application notification:",i),{success:!1,error:i.message}}},markAsRead:async e=>{try{const t=await Wr.markAsRead(e);if(t.success)return console.log("[notificationService] Marked notification ".concat(e," as read in LocalStorage")),t;const r=await Hr(e);return r.success?(console.log("[notificationService] Marked notification ".concat(e," as read in Supabase")),r):(console.warn("[notificationService] Failed to mark notification ".concat(e," as read")),{success:!1,error:"Failed to mark notification as read"})}catch(t){return console.error("[notificationService] Error marking notification as read:",t),{success:!1,error:t.message}}},markAllAsRead:async e=>{try{const t=await Wr.markAllAsRead(e);if(t.success)return console.log("[notificationService] Marked all notifications as read in LocalStorage for user ".concat(e)),t;const r=await qr(e);return r.success?(console.log("[notificationService] Marked all notifications as read in Supabase for user ".concat(e)),r):(console.warn("[notificationService] Failed to mark all notifications as read for user ".concat(e)),{success:!1,error:"Failed to mark all notifications as read"})}catch(t){return console.error("[notificationService] Error marking all notifications as read:",t),{success:!1,error:t.message}}},deleteNotification:async e=>{try{const t=await Wr.deleteNotification(e);if(t.success)return console.log("[notificationService] Deleted notification ".concat(e," in LocalStorage")),t;const r=await Vr(e);return r.success?(console.log("[notificationService] Deleted notification ".concat(e," in Supabase")),r):(console.warn("[notificationService] Failed to delete notification ".concat(e)),{success:!1,error:"Failed to delete notification"})}catch(t){return console.error("[notificationService] Error deleting notification:",t),{success:!1,error:t.message}}},createGeneralNotification:async e=>{try{const t={id:"general_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),type:e.type||"general",senderId:null,senderName:null,receiverId:e.userId,title:e.title,content:e.message,message:e.message,isRead:!1,createdAt:(new Date).toISOString(),meta:(0,a.A)({action:e.type,projectId:e.projectId},e.meta)},r=await Wr.createNotification(t);if(r.success)return console.log("[notificationService] Created general notification in LocalStorage"),r;const o=await Br(t);return o.success?(console.log("[notificationService] Created general notification in Supabase"),o):(console.warn("[notificationService] Failed to create general notification"),{success:!1,error:"Failed to create general notification"})}catch(t){return console.error("[notificationService] Error creating general notification:",t),{success:!1,error:t.message}}}},Zr=async e=>{try{const t="comments_".concat(e.workId),r=JSON.parse(localStorage.getItem(t)||"[]"),o=(0,a.A)((0,a.A)({},e),{},{parentId:e.parentId||null,rootId:e.rootId||null,text:e.text||e.content||"",createdAt:e.createdAt||Date.now(),updatedAt:e.updatedAt||Date.now()});r.unshift(o);const s=r.slice(0,100);return localStorage.setItem(t,JSON.stringify(s)),console.log("[localStorageAdapter] Created comment for work ".concat(e.workId)),{success:!0,data:o}}catch(t){return console.error("[localStorageAdapter] Error creating comment:",t),{success:!1,error:t.message}}},Kr=async e=>{try{await(async()=>{})();const t="comments_".concat(e),r=JSON.parse(localStorage.getItem(t)||"[]").filter(e=>!e.isDeleted).map(e=>(0,a.A)((0,a.A)({},e),{},{parentId:e.parentId||null,rootId:e.rootId||null,text:e.text||e.content||"",createdAt:e.createdAt||(e.createdAt?new Date(e.createdAt).getTime():Date.now()),updatedAt:e.updatedAt||(e.updatedAt?new Date(e.updatedAt).getTime():Date.now())}));return console.log("[localStorageAdapter] Retrieved ".concat(r.length," comments for work ").concat(e)),{success:!0,data:r}}catch(t){return console.error("[localStorageAdapter] Error getting comments for work ".concat(e,":"),t),{success:!1,error:t.message}}},Yr=async(e,t)=>{try{const r="comments_".concat(e),o=JSON.parse(localStorage.getItem(r)||"[]");return o.find(e=>e.id===t)||null}catch(r){return console.error("[localStorageAdapter] Error finding parent comment:",r),null}},Qr=async(e,t)=>{try{const r=Object.keys(localStorage).filter(e=>e.startsWith("comments_"));for(const o of r){const r=JSON.parse(localStorage.getItem(o)||"[]"),a=r.findIndex(t=>t.id===e);if(-1!==a){const s=r[a];s.likedBy||(s.likedBy=[]);const n=s.likedBy.indexOf(t);return-1!==n?(s.likedBy.splice(n,1),s.likes=Math.max(0,s.likes-1)):(s.likedBy.push(t),s.likes++),s.updatedAt=(new Date).toISOString(),localStorage.setItem(o,JSON.stringify(r)),console.log("[localStorageAdapter] ".concat(-1!==n?"Unliked":"Liked"," comment ").concat(e)),{success:!0,data:s,isLiked:-1===n}}}return console.warn("[localStorageAdapter] Comment ".concat(e," not found")),{success:!1,error:"Comment not found"}}catch(r){return console.error("[localStorageAdapter] Error liking comment:",r),{success:!1,error:r.message}}},$r=async(e,t)=>{try{const r=Object.keys(localStorage).filter(e=>e.startsWith("comments_"));for(const o of r){const r=JSON.parse(localStorage.getItem(o)||"[]"),a=r.findIndex(t=>t.id===e);if(-1!==a){const s=r[a];s.likedBy||(s.likedBy=[]);const n=s.likedBy.indexOf(t);if(-1!==n)return s.likedBy.splice(n,1),s.likes=Math.max(0,s.likes-1),s.updatedAt=(new Date).toISOString(),localStorage.setItem(o,JSON.stringify(r)),console.log("[localStorageAdapter] Unliked comment ".concat(e)),{success:!0,data:s,isLiked:!1}}}return console.warn("[localStorageAdapter] Comment ".concat(e," not found or not liked")),{success:!1,error:"Comment not found or not liked"}}catch(r){return console.error("[localStorageAdapter] Error unliking comment:",r),{success:!1,error:r.message}}},Xr=async(e,t)=>{try{const r=Object.keys(localStorage).filter(e=>e.startsWith("comments_"));for(const o of r){const r=JSON.parse(localStorage.getItem(o)||"[]"),a=r.findIndex(t=>t.id===e);if(-1!==a){const s=r[a];return s.authorId!==t?(console.warn("[localStorageAdapter] User ".concat(t," not authorized to delete comment ").concat(e)),{success:!1,error:"Not authorized to delete comment"}):(s.isDeleted=!0,s.updatedAt=(new Date).toISOString(),localStorage.setItem(o,JSON.stringify(r)),console.log("[localStorageAdapter] Deleted comment ".concat(e)),{success:!0})}}return console.warn("[localStorageAdapter] Comment ".concat(e," not found")),{success:!1,error:"Comment not found"}}catch(r){return console.error("[localStorageAdapter] Error deleting comment:",r),{success:!1,error:r.message}}},eo=async(e,t,r)=>{try{const o=Object.keys(localStorage).filter(e=>e.startsWith("comments_"));for(const a of o){const o=JSON.parse(localStorage.getItem(a)||"[]"),s=o.findIndex(t=>t.id===e);if(-1!==s){const n=o[s];return n.authorId!==t?(console.warn("[localStorageAdapter] User ".concat(t," not authorized to update comment ").concat(e)),{success:!1,error:"Not authorized to update comment"}):(n.content=r,n.updatedAt=(new Date).toISOString(),localStorage.setItem(a,JSON.stringify(o)),console.log("[localStorageAdapter] Updated comment ".concat(e)),{success:!0,data:n})}}return console.warn("[localStorageAdapter] Comment ".concat(e," not found")),{success:!1,error:"Comment not found"}}catch(o){return console.error("[localStorageAdapter] Error updating comment:",o),{success:!1,error:o.message}}},to=async e=>(console.log("[supabaseAdapter] createComment - Placeholder implementation"),{success:!1,error:"Supabase adapter not implemented yet"}),ro=async e=>(console.log("[supabaseAdapter] getWorkComments - Placeholder implementation"),{success:!1,error:"Supabase adapter not implemented yet"}),oo=async(e,t)=>(console.log("[supabaseAdapter] likeComment - Placeholder implementation"),{success:!1,error:"Supabase adapter not implemented yet"}),ao=async(e,t)=>(console.log("[supabaseAdapter] unlikeComment - Placeholder implementation"),{success:!1,error:"Supabase adapter not implemented yet"}),so=async(e,t)=>(console.log("[supabaseAdapter] deleteComment - Placeholder implementation"),{success:!1,error:"Supabase adapter not implemented yet"}),no=async(e,t,r)=>(console.log("[supabaseAdapter] updateComment - Placeholder implementation"),{success:!1,error:"Supabase adapter not implemented yet"}),io={createComment:async function(e,t,r,o){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;try{let s=null;a&&(s=await Yr(e,a));const n={id:"comment_".concat(e,"_").concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),workId:e,authorId:t,authorName:r,text:o,parentId:a,rootId:s?s.rootId||s.id:null,likes:0,likedBy:[],isDeleted:!1,createdAt:Date.now(),updatedAt:Date.now()};a&&console.log("[reply:optimistic]",n);const i=await Zr(n);if(i.success)return console.log("[commentService] Created comment in LocalStorage"),a&&console.log("[reply:saved]",i.data),i;const l=await to(n);return l.success?(console.log("[commentService] Created comment in Supabase"),a&&console.log("[reply:saved]",l.data),l):(console.warn("[commentService] Failed to create comment"),{success:!1,error:"Failed to create comment"})}catch(s){return console.error("[commentService] Error creating comment:",s),{success:!1,error:s.message}}},getWorkComments:async e=>{try{const t=await Kr(e);if(t&&t.success)return console.log("[commentService] Using LocalStorage comments for work ".concat(e)),t;const r=await ro(e);return r&&r.success?(console.log("[commentService] Using Supabase comments for work ".concat(e)),r):(console.log("[commentService] No comments found for work ".concat(e)),{success:!0,data:[]})}catch(t){return console.error("[commentService] Error getting comments for work ".concat(e,":"),t),{success:!1,error:t.message}}},likeComment:async(e,t)=>{try{const r=await Qr(e,t);if(r.success)return console.log("[commentService] Liked comment ".concat(e," in LocalStorage")),r;const o=await oo(e,t);return o.success?(console.log("[commentService] Liked comment ".concat(e," in Supabase")),o):(console.warn("[commentService] Failed to like comment ".concat(e)),{success:!1,error:"Failed to like comment"})}catch(r){return console.error("[commentService] Error liking comment:",r),{success:!1,error:r.message}}},unlikeComment:async(e,t)=>{try{const r=await $r(e,t);if(r.success)return console.log("[commentService] Unliked comment ".concat(e," in LocalStorage")),r;const o=await ao(e,t);return o.success?(console.log("[commentService] Unliked comment ".concat(e," in Supabase")),o):(console.warn("[commentService] Failed to unlike comment ".concat(e)),{success:!1,error:"Failed to unlike comment"})}catch(r){return console.error("[commentService] Error unliking comment:",r),{success:!1,error:r.message}}},deleteComment:async(e,t)=>{try{const r=await Xr(e,t);if(r.success)return console.log("[commentService] Deleted comment ".concat(e," in LocalStorage")),r;const o=await so(e,t);return o.success?(console.log("[commentService] Deleted comment ".concat(e," in Supabase")),o):(console.warn("[commentService] Failed to delete comment ".concat(e)),{success:!1,error:"Failed to delete comment"})}catch(r){return console.error("[commentService] Error deleting comment:",r),{success:!1,error:r.message}}},updateComment:async(e,t,r)=>{try{const o=await eo(e,t,r);if(o.success)return console.log("[commentService] Updated comment ".concat(e," in LocalStorage")),o;const a=await no(e,t,r);return a.success?(console.log("[commentService] Updated comment ".concat(e," in Supabase")),a):(console.warn("[commentService] Failed to update comment ".concat(e)),{success:!1,error:"Failed to update comment"})}catch(o){return console.error("[commentService] Error updating comment:",o),{success:!1,error:o.message}}}};var lo=r(792);const co=e=>"".concat("tag.userProfile.").concat(e);function uo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return Array.isArray(e)?e.filter(e=>e&&e.trim()).map(e=>e.trim()).filter((e,t,r)=>r.indexOf(e)===t).slice(0,t):[]}function ho(e){var t,r,o,a;return{id:e.id||"",fullName:(e.fullName||"").trim(),title:(e.title||"").trim(),school:(e.school||"").trim(),pronouns:(e.pronouns||"").trim(),majors:uo(e.majors,3),minors:uo(e.minors,3),skills:uo(e.skills,12),bio:(e.bio||"").trim(),avatar:e.avatar||null,socialLinks:{instagram:((null===(t=e.socialLinks)||void 0===t?void 0:t.instagram)||"").trim(),portfolio:((null===(r=e.socialLinks)||void 0===r?void 0:r.portfolio)||"").trim(),discord:((null===(o=e.socialLinks)||void 0===o?void 0:o.discord)||"").trim(),otherLinks:Array.isArray(null===(a=e.socialLinks)||void 0===a?void 0:a.otherLinks)?e.socialLinks.otherLinks.filter(e=>e&&e.label&&e.url):[]},updatedAt:e.updatedAt||(new Date).toISOString()}}function mo(e,t){try{return"undefined"!==typeof window&&(window.localStorage.setItem(co(e),JSON.stringify(t)),!0)}catch(r){return console.warn("Failed to write user profile data:",r),!1}}const po=async e=>{try{try{const{getProfile:o,checkSupabaseConnection:a}=await Promise.resolve().then(r.bind(r,405));if(await a()){console.log("[userProfileService] Attempting to get profile from Supabase...");const r=await o(e);if(r.success){console.log("[userProfileService] Successfully retrieved profile from Supabase");try{const t=window.localStorage.getItem("tag.avatars.".concat(e));if(t){const e=JSON.parse(t);e&&e.avatarUrl&&(r.data.avatar=e.avatarUrl,console.log("[userProfileService] Loaded avatar from tag.avatars storage"))}}catch(t){console.warn("[userProfileService] Failed to load avatar from tag.avatars storage:",t)}return r}}}catch(o){console.warn("[userProfileService] Supabase fallback failed, using Mock API:",o.message)}console.log("[userProfileService] Using Mock API fallback");const s=function(e){try{if("undefined"===typeof window)return null;const t=window.localStorage.getItem(co(e));return t?JSON.parse(t):null}catch(t){return console.warn("Failed to read user profile data:",t),null}}(e),n=function(e){return{id:e,fullName:"",title:"Artist",school:"",pronouns:"",majors:[],minors:[],skills:[],bio:"",avatar:null,socialLinks:{instagram:"",portfolio:"",discord:"",otherLinks:[]},updatedAt:(new Date).toISOString()}}(e);if(!s)return{success:!0,data:n};const i=(0,a.A)((0,a.A)((0,a.A)({},n),s),{},{socialLinks:(0,a.A)((0,a.A)({},n.socialLinks),s.socialLinks||{})});try{const t=window.localStorage.getItem("tag.avatars.".concat(e));if(t){const e=JSON.parse(t);e&&e.avatarUrl&&(i.avatar=e.avatarUrl,console.log("[userProfileService] Loaded avatar from tag.avatars storage"))}}catch(t){console.warn("[userProfileService] Failed to load avatar from tag.avatars storage:",t)}const l=ho(i);return console.log("[userProfileService] Loading profile data from Mock API:",{userId:e,socialLinks:l.socialLinks,fullProfile:l}),{success:!0,data:l}}catch(t){return console.error("Failed to get profile:",t),{success:!1,error:t.message}}},go=async(e,t)=>{try{const s=await po(e);if(!s.success)return s;const n=s.data,i=ho((0,a.A)((0,a.A)((0,a.A)({},n),t),{},{socialLinks:(0,a.A)((0,a.A)({},n.socialLinks),t.socialLinks||{}),id:e,updatedAt:(new Date).toISOString()})),l=function(e){const t={};return e.fullName&&e.fullName.trim()||(t.fullName="Full name is required"),{isValid:0===Object.keys(t).length,errors:t}}(i);if(!l.isValid)return{success:!1,errors:l.errors};try{const{saveProfile:t,checkSupabaseConnection:o}=await Promise.resolve().then(r.bind(r,405));if(await o()){console.log("[userProfileService] Attempting to save profile to Supabase...");const r=await t(e,i);if(r.success){console.log("[userProfileService] Successfully saved profile to Supabase");return mo(e,i)||console.warn("[userProfileService] Failed to backup to Mock API"),await fo(e,i),r}}}catch(o){console.warn("[userProfileService] Supabase save failed, using Mock API:",o.message)}console.log("[userProfileService] Using Mock API fallback for save"),console.log("[userProfileService] Saving profile data to Mock API:",{userId:e,socialLinks:i.socialLinks,fullProfile:i});return mo(e,i)?(console.log("[userProfileService] Profile data saved successfully to Mock API"),await fo(e,i),{success:!0,data:i}):{success:!1,error:"Failed to save profile data"}}catch(s){return console.error("Failed to save profile:",s),{success:!1,error:s.message}}},fo=async(e,t)=>{if(t.avatar)try{(await lo.A.storeAvatar(e,t.avatar)).success?console.log("[userProfileService] Avatar stored in IndexedDB for user: ".concat(e)):console.warn("[userProfileService] Failed to store avatar in IndexedDB for user: ".concat(e));const r={avatarUrl:t.avatar,timestamp:Date.now()};localStorage.setItem("tag.avatars.".concat(e),JSON.stringify(r)),console.log("[userProfileService] Avatar stored in localStorage for user: ".concat(e))}catch(o){console.error("[userProfileService] Error storing avatar: ".concat(o))}var r;r=t,"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("profile:updated",{detail:r}))},vo=async(e,t)=>{try{console.log("[avatarService] Supabase: Starting avatar upload for user:",t);const r=(e=>{const t=Date.now();return"".concat(e,"/").concat(t,".webp")})(t);console.log("[avatarService] Supabase: Generated filename:",r);const o=await(async e=>{try{const t=await fetch(e);return await t.blob()}catch(s){throw console.error("[avatarService] Failed to convert dataURL to blob:",s),new Error("Failed to convert image data")}})(e);console.log("[avatarService] Supabase: Converted to blob, size:",o.size);const{data:a,error:s}=await wt.supabase.storage.from("avatars").upload(r,o,{cacheControl:"3600",upsert:!0});if(s)return console.error("[avatarService] Supabase: Upload failed:",s),{success:!1,error:s.message};console.log("[avatarService] Supabase: Successfully uploaded avatar:",r);const{data:n}=wt.supabase.storage.from("avatars").getPublicUrl(r),i=n.publicUrl,l=(new Date).toISOString(),{error:c}=await wt.supabase.from("profiles").update({avatar_url:i}).eq("id",t);return c&&console.warn("[avatarService] Supabase: Failed to update profile avatar_key:",c),"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("avatar:updated",{detail:{userId:t,avatarUrl:i,avatarUpdatedAt:l,avatarKey:r}})),{success:!0,data:{avatarUrl:i,avatarUpdatedAt:l,fileName:r,avatarKey:r}}}catch(r){return console.error("[avatarService] Supabase: Error uploading avatar:",r),{success:!1,error:r.message}}},xo=async e=>{try{const t=await(async e=>{try{console.log("[avatarService] Supabase: Getting avatar info for user:",e);const{data:t,error:r}=await wt.supabase.from("profiles").select("avatar_url").eq("id",e).single();if(r)return console.warn("[avatarService] Supabase: Failed to get profile:",r),{success:!0,data:{avatarUrl:null,avatarUpdatedAt:null,fileName:null}};if(!t||!t.avatar_url)return console.log("[avatarService] Supabase: No avatar found for user:",e),{success:!0,data:{avatarUrl:null,avatarUpdatedAt:null,fileName:null}};const o=t.avatar_url,a=t.avatar_url.split("/").pop();return console.log("[avatarService] Supabase: Retrieved avatar info:",{fileName:a}),{success:!0,data:{avatarUrl:o,fileName:a}}}catch(t){return console.error("[avatarService] Supabase: Error getting avatar info:",t),{success:!1,error:t.message}}})(e);if(!t.success||!t.data.avatarUrl)return null;const r=Date.now(),o=t.data.avatarUrl.includes("?")?"&":"?";return"".concat(t.data.avatarUrl).concat(o,"t=").concat(r)}catch(t){return console.error("[avatarService] Supabase: Error getting avatar URL with cache bust:",t),null}};class bo{constructor(){this.capabilities=this.detectCapabilities()}detectCapabilities(){const e={localStorage:this.testLocalStorage(),indexedDB:this.testIndexedDB(),fetch:this.testFetch(),cors:this.testCORS(),privateMode:this.detectPrivateMode()};return console.log("[BrowserCompatibility] Detected capabilities:",e),e}testLocalStorage(){try{const e="__test_localStorage__";localStorage.setItem(e,"test");const t="test"===localStorage.getItem(e);return localStorage.removeItem(e),t}catch(e){return console.warn("[BrowserCompatibility] localStorage not available:",e),!1}}testIndexedDB(){try{return"indexedDB"in window&&null!==indexedDB}catch(e){return console.warn("[BrowserCompatibility] IndexedDB not available:",e),!1}}testFetch(){try{return"fetch"in window&&"function"===typeof fetch}catch(e){return console.warn("[BrowserCompatibility] fetch not available:",e),!1}}testCORS(){try{return"cors"in new Request("https://example.com")}catch(e){return console.warn("[BrowserCompatibility] CORS test failed:",e),!1}}detectPrivateMode(){try{const e="__private_mode_test__";localStorage.setItem(e,"test");const t="test"===localStorage.getItem(e);return localStorage.removeItem(e),!t}catch(e){return!0}}getCompatibilityStatus(){const{localStorage:e,indexedDB:t,fetch:r,cors:o,privateMode:a}=this.capabilities;return a?{level:"warning",message:"Private browsing mode detected. Some features may be limited.",recommendations:["Use normal browsing mode for full functionality"]}:e&&t?r&&o?{level:"success",message:"All features supported.",recommendations:[]}:{level:"warning",message:"Limited network capabilities. Some images may not load.",recommendations:["Check network settings","Disable strict CORS policies"]}:{level:"error",message:"Storage not available. Core features will not work.",recommendations:["Enable cookies and storage","Use a supported browser"]}}}class yo{constructor(){this.checker=new bo}getStorageInterface(){const{localStorage:e,indexedDB:t}=this.checker.capabilities;return e&&t?{type:"full",localStorage:this.createSafeLocalStorage(),indexedDB:this.createSafeIndexedDB()}:e?{type:"localStorage_only",localStorage:this.createSafeLocalStorage(),indexedDB:this.createMockIndexedDB()}:{type:"memory_only",localStorage:this.createMemoryStorage(),indexedDB:this.createMockIndexedDB()}}createSafeLocalStorage(){return{getItem:e=>{try{return localStorage.getItem(e)}catch(t){return console.warn("[SafeStorage] Failed to get ".concat(e,":"),t),null}},setItem:(e,t)=>{try{return localStorage.setItem(e,t),!0}catch(r){return console.warn("[SafeStorage] Failed to set ".concat(e,":"),r),!1}},removeItem:e=>{try{return localStorage.removeItem(e),!0}catch(t){return console.warn("[SafeStorage] Failed to remove ".concat(e,":"),t),!1}}}}createSafeIndexedDB(){return{getImageUrl:async e=>{try{const t=await Promise.resolve().then(r.bind(r,337));return await t.default.getImageUrl(e)}catch(t){return console.warn("[SafeStorage] Failed to get image ".concat(e,":"),t),null}}}}createMemoryStorage(){const e=new Map;return{getItem:t=>e.get(t)||null,setItem:(t,r)=>(e.set(t,r),!0),removeItem:t=>(e.delete(t),!0)}}createMockIndexedDB(){return{getImageUrl:async e=>"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIG5vdCBhdmFpbGFibGU8L3RleHQ+PC9zdmc+"}}}class wo{constructor(){this.checker=new bo}async getSafeImageUrl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return this.getDefaultPlaceholder();if(e.startsWith("data:"))return e;if(!e.startsWith("http"))try{const t=await Promise.resolve().then(r.bind(r,337)),o=await t.default.getImageUrl(e);if(o)return o}catch(o){console.warn("[ImageFallback] Failed to get image from IndexedDB:",o)}if(e.startsWith("http")&&this.checker.capabilities.cors)try{if((await fetch(e,{method:"HEAD"})).ok)return e}catch(o){console.warn("[ImageFallback] CORS check failed:",o)}return t||this.getDefaultPlaceholder()}getDefaultPlaceholder(){return"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZmlsbD0iIzk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIG5vdCBhdmFpbGFibGU8L3RleHQ+PC9zdmc+"}}new bo,new yo,new wo;const jo=async()=>{try{console.log("[ResetData] Starting data reset...");const e=await xr.IG.keys();console.log("[ResetData] Found keys:",e);const t=e.filter(e=>e.startsWith("tag.")||e.startsWith("user_")||e.startsWith("artist_")||e.startsWith("portfolio_")||e.startsWith("tag_favorites")||e.startsWith("tag_follows")||e.startsWith("tag_service_data")||e.includes("comment")||e.includes("notification")||e.includes("view")||e.includes("like")||e.includes("review")||e.includes("collaboration")||e.includes("avatar"));console.log("[ResetData] Clearing TAG keys:",t);for(const r of t)await xr.IG.removeItem(r),console.log("[ResetData] Removed key: ".concat(r));if("undefined"!==typeof window){const e=Object.keys(localStorage).filter(e=>e.startsWith("tag.")||e.startsWith("user_")||e.startsWith("artist_")||e.startsWith("portfolio_")||e.startsWith("tag_favorites")||e.startsWith("tag_follows")||e.startsWith("tag_service_data")||e.includes("comment")||e.includes("notification")||e.includes("view")||e.includes("like")||e.includes("review")||e.includes("collaboration")||e.includes("avatar"));console.log("[ResetData] Clearing localStorage TAG keys:",e);for(const t of e)localStorage.removeItem(t),console.log("[ResetData] Removed localStorage key: ".concat(t))}return console.log("[ResetData] Data reset completed successfully"),{success:!0,message:"Data reset completed"}}catch(e){return console.error("[ResetData] Error during data reset:",e),{success:!1,error:e.message}}},ko=()=>{try{"undefined"!==typeof window&&(localStorage.setItem("tag.currentUserId","alice"),console.log("[ResetData] Reset current user to alice"))}catch(e){console.error("[ResetData] Error resetting current user:",e)}},So=async()=>{try{return console.log("[ResetData] Force reinitializing all data..."),await jo(),ko(),"undefined"!==typeof window&&(console.log("[ResetData] Reloading page to reinitialize..."),window.location.reload()),{success:!0,message:"Reinitialization triggered"}}catch(e){return console.error("[ResetData] Error during reinitialization:",e),{success:!1,error:e.message}}};"undefined"!==typeof window&&(window.resetTAGData=jo,window.resetTAGUser=ko,window.forceTAGReinit=So,console.log("[ResetData] Reset functions added to console:"),console.log("- window.resetTAGData() - \u6e05\u9664\u6240\u6709TAG\u6570\u636e"),console.log("- window.resetTAGUser() - \u91cd\u7f6e\u5f53\u524d\u7528\u6237"),console.log("- window.forceTAGReinit() - \u5f3a\u5236\u91cd\u65b0\u521d\u59cb\u5316"));const No={selectedArtist:null,selectedCollaboration:null,selectedMilestone:null,isLoading:!1,showDetail:!1,navigationHistory:[],scrollPositions:{},isInitialized:!1,comments:[{id:1,user:"Alex Chen",avatar:null,role:"Character Designer",comment:"The character sketches are looking great! I think we should focus more on the facial expressions for the next iteration.",timestamp:"2 hours ago",likes:3},{id:2,user:"Maya Rodriguez",avatar:null,role:"Art Director",comment:"Love the color palette choices. The purple hair really makes the character stand out.",timestamp:"4 hours ago",likes:5},{id:3,user:"Jordan Kim",avatar:null,role:"3D Modeler",comment:"The 3D models are coming along nicely. Can't wait to see the final renders!",timestamp:"1 day ago",likes:2}]},Co="SET_SELECTED_ARTIST",_o="SET_SELECTED_COLLABORATION",Ao="SET_SELECTED_MILESTONE",Io="SET_LOADING",Po="SET_SHOW_DETAIL",Eo="ADD_TO_HISTORY",Do="CLEAR_HISTORY",Lo="RESET_STATE",To="SAVE_SCROLL_POSITION",Mo="CLEAR_SCROLL_POSITION",Fo="ADD_COMMENT",Ro="UPDATE_COMMENT",Oo="DELETE_COMMENT",Uo="SET_INITIALIZED",zo=(e,t)=>{switch(t.type){case Co:return(0,a.A)((0,a.A)({},e),{},{selectedArtist:t.payload});case _o:return(0,a.A)((0,a.A)({},e),{},{selectedCollaboration:t.payload});case Ao:return(0,a.A)((0,a.A)({},e),{},{selectedMilestone:t.payload});case Io:return(0,a.A)((0,a.A)({},e),{},{isLoading:t.payload});case Po:return(0,a.A)((0,a.A)({},e),{},{showDetail:t.payload});case Eo:return(0,a.A)((0,a.A)({},e),{},{navigationHistory:[...e.navigationHistory,t.payload]});case Do:return(0,a.A)((0,a.A)({},e),{},{navigationHistory:[]});case Lo:return(0,a.A)((0,a.A)({},No),{},{isInitialized:e.isInitialized,navigationHistory:e.navigationHistory,scrollPositions:e.scrollPositions});case To:return(0,a.A)((0,a.A)({},e),{},{scrollPositions:(0,a.A)((0,a.A)({},e.scrollPositions),{},{[t.payload.path]:{scrollY:t.payload.position,elementInfo:t.payload.elementInfo||null,timestamp:Date.now()}})});case Mo:{const r=e.scrollPositions,s=t.payload,{[s]:n}=r,i=o(r,[s].map(or.A));return(0,a.A)((0,a.A)({},e),{},{scrollPositions:i})}case Fo:return(0,a.A)((0,a.A)({},e),{},{comments:[t.payload,...e.comments]});case Ro:return(0,a.A)((0,a.A)({},e),{},{comments:e.comments.map(e=>e.id===t.payload.id?t.payload:e)});case Oo:return(0,a.A)((0,a.A)({},e),{},{comments:e.comments.filter(e=>e.id!==t.payload)});case Uo:return(0,a.A)((0,a.A)({},e),{},{isInitialized:t.payload});default:return e}},Wo=(0,e.createContext)(),Bo=t=>{let{children:r}=t;const[o,a]=(0,e.useReducer)(zo,No),s={setSelectedArtist:(0,e.useCallback)(e=>a({type:Co,payload:e}),[a]),setSelectedCollaboration:(0,e.useCallback)(e=>a({type:_o,payload:e}),[a]),setSelectedMilestone:(0,e.useCallback)(e=>a({type:Ao,payload:e}),[a]),setLoading:(0,e.useCallback)(e=>a({type:Io,payload:e}),[a]),setShowDetail:(0,e.useCallback)(e=>a({type:Po,payload:e}),[a]),addToHistory:(0,e.useCallback)(e=>a({type:Eo,payload:e}),[a]),clearHistory:(0,e.useCallback)(()=>a({type:Do}),[a]),resetState:(0,e.useCallback)(()=>a({type:Lo}),[a]),saveScrollPosition:(0,e.useCallback)(function(e,t){return a({type:To,payload:{path:e,position:t,elementInfo:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null}})},[a]),clearScrollPosition:(0,e.useCallback)(e=>a({type:Mo,payload:e}),[a]),addComment:(0,e.useCallback)(e=>a({type:Fo,payload:e}),[a]),updateComment:(0,e.useCallback)(e=>a({type:Ro,payload:e}),[a]),deleteComment:(0,e.useCallback)(e=>a({type:Oo,payload:e}),[a]),setInitialized:(0,e.useCallback)(e=>a({type:Uo,payload:e}),[a])};(0,e.useEffect)(()=>{a({type:Uo,payload:!0});const e=setTimeout(()=>{o.isInitialized||a({type:Uo,payload:!0})},1e3);return()=>clearTimeout(e)},[]);const n=e.useMemo(()=>({state:o,actions:s}),[o,s]);return(0,jt.jsx)(Wo.Provider,{value:n,children:r})},Go=()=>{const t=(0,e.useContext)(Wo);if(!t)throw new Error("useAppContext must be used within an AppProvider");return t};function Ho(){const{state:e}=Go();return e.isLoading?(0,jt.jsx)("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-tag-blue mx-auto mb-4"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):null}function qo(){const{pathname:t}=ne(),r=(0,e.useRef)(t);return(0,e.useEffect)(()=>{r.current!==t&&("/"!==t&&window.scrollTo(0,0),r.current=t)},[t]),null}function Vo(){const[t,r]=(0,e.useState)("Latest"),[o,a]=(0,e.useState)([]),[s,n]=(0,e.useState)([]);return(0,jt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filters"}),(0,jt.jsxs)("div",{className:"flex gap-2 mb-6",children:[(0,jt.jsx)("button",{onClick:()=>{const e=new URLSearchParams;e.append("sort",t.toLowerCase()),o.length>0&&e.append("categories",o.join(",")),s.length>0&&e.append("software",s.join(","));const r="/major-aggregation?".concat(e.toString());window.open(r,"_blank")},disabled:0===o.length&&0===s.length,className:"flex-1 px-3 py-1.5 text-sm rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(0===o.length&&0===s.length?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-tag-blue text-white hover:bg-blue-600 focus:ring-tag-blue"),children:"Apply"}),(0,jt.jsx)("button",{onClick:()=>{r("Latest"),a([]),n([]),console.log("Clear all filters - Reset to default state")},className:"flex-1 px-3 py-1.5 bg-gray-100 text-gray-600 text-sm rounded-md hover:bg-gray-200 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-1",children:"Clear"})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Sort By"}),(0,jt.jsxs)("select",{value:t,onChange:e=>r(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue",children:[(0,jt.jsx)("option",{value:"Latest",children:"Latest"}),(0,jt.jsx)("option",{value:"Popular",children:"Popular"})]})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Major"}),(0,jt.jsx)("div",{className:"space-y-2",children:["Accessory Design","Acting","Advertising","Animation","Architecture","Art History","Creative Business Leadership","Fashion Design","Fibers","Film","Film/Television","Fine Art","Game/ITGM","Graphic Design","Industrial Design","Illustration","Interior Design","Jewelry","Motion Design","Painting","Photography","Service Design","Sequential Art","UI/UX","Visual Effects"].map(e=>(0,jt.jsxs)("label",{className:"flex items-center",children:[(0,jt.jsx)("input",{type:"checkbox",checked:o.includes(e),onChange:()=>(e=>{a(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),className:"h-4 w-4 text-tag-blue focus:ring-tag-blue border-gray-300 rounded"}),(0,jt.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e})]},e))})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Software"}),(0,jt.jsx)("div",{className:"space-y-2",children:["3D-Coat","3ds Max","After Effects","Blender","Cinema 4D","DaVinci Resolve","Figma","Gaea","Houdini","Illustrator","InDesign","JavaScript","Maya","Nuke","Photoshop","Python","Substance Designer","Substance Painter","Unity","Unreal Engine","ZBrush"].map(e=>(0,jt.jsxs)("label",{className:"flex items-center",children:[(0,jt.jsx)("input",{type:"checkbox",checked:s.includes(e),onChange:()=>(e=>{n(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])})(e),className:"h-4 w-4 text-tag-blue focus:ring-tag-blue border-gray-300 rounded"}),(0,jt.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e})]},e))})]})]})}const Jo=["options","value","onChange","placeholder","name"];function Zo(e){let{options:t,value:r,onChange:s,placeholder:n,name:i}=e,l=o(e,Jo);return(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsxs)("select",(0,a.A)((0,a.A)({value:r,onChange:s,name:i,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 pr-10 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple appearance-none"},l),{},{children:[n&&(0,jt.jsx)("option",{value:"",children:n}),t.map((e,t)=>(0,jt.jsx)("option",{value:e.value,children:e.label},t))]})),(0,jt.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})}function Ko(){return(0,jt.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsxs)("div",{className:"mb-8",children:[(0,jt.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"TAG"}),(0,jt.jsx)("p",{className:"text-gray-600 mt-2",children:"Loading your creative world..."})]}),(0,jt.jsxs)("div",{className:"flex justify-center space-x-2",children:[(0,jt.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce"}),(0,jt.jsx)("div",{className:"w-3 h-3 bg-purple-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,jt.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,jt.jsx)("p",{className:"text-sm text-gray-500 mt-6",children:"Initializing application..."})]})})}const Yo=e=>{let{isOpen:t,onClose:r,errors:o,title:a="Please Complete Required Fields"}=e;return t?(0,jt.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,jt.jsx)("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:r}),(0,jt.jsxs)("div",{className:"relative bg-white rounded-2xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",children:[(0,jt.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-purple-700 px-6 py-4",children:(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-white",children:a})]}),(0,jt.jsx)("button",{onClick:r,className:"text-white/80 hover:text-white transition-colors",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,jt.jsx)("div",{className:"px-6 py-6",children:(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("p",{className:"text-gray-700 text-sm leading-relaxed",children:"Please complete the following required fields to continue:"}),(0,jt.jsx)("div",{className:"space-y-2",children:Array.isArray(o)?o.map((e,t)=>(0,jt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,jt.jsx)("div",{className:"flex-shrink-0 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center mt-0.5",children:(0,jt.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),(0,jt.jsx)("span",{className:"text-sm text-red-700 font-medium",children:e})]},t)):(0,jt.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,jt.jsx)("div",{className:"flex-shrink-0 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center mt-0.5",children:(0,jt.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}),(0,jt.jsx)("span",{className:"text-sm text-red-700 font-medium",children:o})]})})]})}),(0,jt.jsx)("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:(0,jt.jsx)("button",{onClick:r,className:"w-full bg-gradient-to-r from-purple-600 to-purple-700 text-white font-semibold py-3 px-6 rounded-lg hover:from-purple-700 hover:to-purple-800 transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2",children:"Got it, I'll fix these"})})]})]}):null},Qo=e=>{let{user:t,currentMockUser:r,showDropdown:o,onToggle:a,onLogoutClick:s,unreadCount:n=0,dropdownRef:i,className:l=""}=e;const c=It(t),d=ce();return(0,jt.jsxs)("div",{className:"relative ".concat(l),ref:i,"data-navbar-dropdown":!0,children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,jt.jsx)(Et,{user:t,currentMockUser:r,className:"hover:opacity-80 transition-opacity duration-200 cursor-pointer",onClick:()=>{c&&d("/artist/me")}}),c&&(0,jt.jsx)("button",{onClick:a,className:"flex items-center text-gray-700 hover:text-gray-900 transition-colors duration-200 cursor-pointer",children:(0,jt.jsx)("svg",{className:"w-4 h-4 self-center transition-transform duration-200 ".concat(o?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),c&&o&&(0,jt.jsxs)("div",{className:"absolute right-0 mt-2 w-40 bg-white rounded-md shadow-lg py-1 z-50 border border-gray-200",children:[(0,jt.jsxs)(mt,{to:"/settings/edit-profile",className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200",children:[(0,jt.jsxs)("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]}),(0,jt.jsxs)(mt,{to:"/notifications",className:"flex items-center justify-between w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200",children:[(0,jt.jsxs)("div",{className:"flex items-center",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),(0,jt.jsx)("span",{children:"Notifications"})]}),(0,jt.jsx)($t,{unreadCount:n})]}),(0,jt.jsxs)("button",{onClick:s,className:"flex items-center w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 border-t border-gray-100",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 mr-2 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]})},$o=t=>{const[r,o]=(0,e.useState)(0),{user:a}=St(),[s,n]=(0,e.useState)(!1),i=async()=>{try{if(null===a||void 0===a||!a.id)return void o(0);const e=await Jr.getUserNotifications(a.id);if(e.success){const t=(e.data||[]).filter(e=>!e.isRead).length;o(t)}else console.error("Error loading unread notifications:",e.error),o(0)}catch(e){console.error("Error loading unread notifications:",e),o(0)}};return(0,e.useEffect)(()=>{let e=!0;(async()=>{e&&await i()})();const t=t=>{var r;const o=null===t||void 0===t||null===(r=t.detail)||void 0===r?void 0:r.userId;console.log("[useNavbarState] Notification change event:",t),console.log("[useNavbarState] Event userId:",o),console.log("[useNavbarState] Current userId:",null===a||void 0===a?void 0:a.id),o&&o!==(null===a||void 0===a?void 0:a.id)||(console.log("[useNavbarState] Reloading unread count..."),e&&setTimeout(()=>{e&&i()},100))};return window.addEventListener("notif:unreadChanged",t),()=>{e=!1,window.removeEventListener("notif:unreadChanged",t)}},[]),(0,e.useEffect)(()=>{const e=e=>{if(s){e.target.closest("[data-navbar-dropdown]")||n(!1)}};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[s]),{unreadCount:r,currentUser:a,showDropdown:s,setUnreadCount:o,setShowDropdown:n,loadUnreadCount:i,toggleDropdown:()=>n(!s),closeDropdown:()=>n(!1)}},Xo=()=>{const e=ce(),t=ne(),{actions:r,state:o}=Go(),a=e=>{const t=o.scrollPositions[e];void 0!==t&&setTimeout(()=>{window.scrollTo({top:t,behavior:"instant"})},100)};return{navigateToWork:function(o){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gallery";r.setLoading(!0),r.addToHistory({path:t.pathname,from:a}),"/"===t.pathname&&r.saveScrollPosition("/",window.scrollY),setTimeout(()=>{r.setShowDetail(!0),r.setLoading(!1),e("/work/".concat(o),{state:{from:a}}),window.scrollTo(0,0)},300)},navigateToArtist:function(o){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gallery",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Artists";if(r.setLoading(!0),r.setSelectedArtist(o),r.addToHistory({path:t.pathname,from:a,activeTab:s}),"/"===t.pathname){var n;const e=window.scrollY,t=document.querySelector('[data-artist-id="'.concat(o,'"]')),a=t?{id:o,type:"artist",scrollY:e,elementRect:t.getBoundingClientRect?t.getBoundingClientRect():null,elementIndex:(null===(n=t.dataset)||void 0===n?void 0:n.index)||null}:null;console.log("[Navigation] Saving scroll position:",e),console.log("[Navigation] Saving element info:",a),r.saveScrollPosition("/",e,a)}setTimeout(()=>{r.setLoading(!1);const t="/artist/".concat(o);e(t),window.scrollTo(0,0)},300)},navigateToTAGMe:()=>{r.saveScrollPosition("/tag",window.scrollY),r.addToHistory({from:"tagme",path:"/tagme",activeTab:"Collaborations"}),e("/tagme"),setTimeout(()=>{a("/tagme")},100)},navigateToMilestone:function(o){"/tagme"===t.pathname&&r.saveScrollPosition("/tagme-Milestones",window.scrollY),r.setLoading(!0),r.setSelectedMilestone(o),r.addToHistory({path:t.pathname,from:"tagme",activeTab:"Milestones"}),setTimeout(()=>{r.setShowDetail(!0),r.setLoading(!1);const t="/tagme/milestone/".concat(o.id);e(t,{state:{milestone:o}}),window.scrollTo(0,0)},300)},navigateToCollaboration:o=>{"/tagme"===t.pathname&&r.saveScrollPosition("/tagme-Collaborations",window.scrollY),r.setLoading(!0),r.setSelectedCollaboration(o),r.addToHistory({path:t.pathname,from:"tagme",activeTab:"Collaborations"});const a="/tagme/collaboration/".concat(o.id);e(a,{state:{project:o}}),setTimeout(()=>{r.setLoading(!1)},100)},goBack:()=>{const t=o.navigationHistory.length>0?o.navigationHistory[o.navigationHistory.length-1]:{path:"/",from:"home"};if(console.log("[Navigation] goBack - previousHistory:",t),"artists"===t.from)return console.log("[Navigation] Returning from artists section"),r.setLoading(!0),e("/",{state:{from:"artist-profile",activeTab:"Artists",scrollToGallery:!0}}),void setTimeout(()=>{r.setLoading(!1)},100);"/tagme"===t.path||"/"===t.path?(r.setLoading(!0),e(-1),setTimeout(()=>{r.setLoading(!1)},100)):e(-1)},goHome:()=>{r.resetState(),e("/"),window.scrollTo(0,0)},navigateToGallery:()=>{if(r.addToHistory({path:t.pathname,from:"gallery",fromNavbar:!0,activeTab:"Works"}),"/"===t.pathname){console.log("[Navigation] Already on homepage, scrolling to gallery section");const e=document.querySelectorAll("section");console.log("[Navigation] All sections found:",e.length),e.forEach((e,t)=>{var r;console.log("[Navigation] Section ".concat(t,":"),{className:e.className,dataSection:e.getAttribute("data-section"),textContent:(null===(r=e.textContent)||void 0===r?void 0:r.substring(0,50))+"..."})});const t=document.querySelector('[data-section="gallery"]');if(console.log("[Navigation] Gallery section found:",!!t),t){const e=t.getBoundingClientRect();console.log("[Navigation] Gallery section position:",{top:e.top,bottom:e.bottom,height:e.height});const r=window.pageYOffset+e.top-80;console.log("[Navigation] Scrolling to position:",r),window.scrollTo({top:r,behavior:"smooth"}),console.log("[Navigation] Scrolled to gallery section")}else console.warn("[Navigation] Gallery section not found, scrolling to top"),window.scrollTo(0,0)}else console.log("[Navigation] Navigating to homepage first, then scrolling to gallery"),r.resetState(),e("/"),setTimeout(()=>{const e=document.querySelector('[data-section="gallery"]');if(e){const t=e.getBoundingClientRect(),r=window.pageYOffset+t.top-80;window.scrollTo({top:r,behavior:"smooth"}),console.log("[Navigation] Scrolled to gallery section after navigation")}else console.warn("[Navigation] Gallery section not found after navigation"),window.scrollTo(0,0)},300)},scrollToElement:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64;setTimeout(()=>{const r=document.querySelector(e);if(r){const e=r.getBoundingClientRect(),o=window.pageYOffset+e.top-t;window.scrollTo({top:o,behavior:"instant"})}else window.scrollTo(0,0)},100)},saveCurrentScrollPosition:()=>{const e=window.pageYOffset;r.saveScrollPosition(t.pathname,e)},restoreScrollPosition:a}},ea=t=>{let{state:r,setters:o,user:a}=t;const s=ce(),{navigateToTAGMe:n,goHome:i,navigateToGallery:l,navigateToArtist:c}=Xo(),{logout:d}=St(),u=(0,e.useCallback)(e=>{if(e.stopPropagation(),!It(a))return void s("/login");const t=e.target,n="IMG"===t.tagName||t.closest("img");"svg"===t.tagName||t.closest("svg");n?(console.log("\ud83d\udd0d [handleDropdownToggle] Avatar clicked, navigating to /me"),s("/me")):o.setShowDropdown(!r.showDropdown)},[a,r.showDropdown,o,s,c]),h=(0,e.useCallback)(()=>{o.setShowDropdown(!1),s("/settings/edit-profile")},[o,s]),m=(0,e.useCallback)(()=>{o.setShowDropdown(!1),s("/notifications")},[o,s]),p=(0,e.useCallback)(()=>{o.setShowDropdown(!1),d(),s("/login")},[o,d,s]),g=(0,e.useCallback)(()=>{s("/upload/guidelines")},[s]),f=(0,e.useCallback)(()=>{n()},[n]),v=(0,e.useCallback)(()=>{l()},[l]);return{handleLogoClick:(0,e.useCallback)(()=>{i()},[i]),handleUploadClick:g,handleTAGMeClick:f,handleGalleryClick:v,handleSearchInput:(0,e.useCallback)(e=>{const t=e.target.value;console.log("Search input:",t)},[]),handleDropdownToggle:u,handleSettingsClick:h,handleNotificationsClick:m,handleLogoutClick:p}},ta=()=>{const{user:t,loading:r}=St(),o=(0,e.useRef)(null),a=$o(t),s=ea({state:a,setters:{setShowDropdown:a.setShowDropdown,setUnreadCount:a.setUnreadCount},user:t}),n=t||{id:"guest",name:"Guest",avatar:null};return(0,jt.jsx)("nav",{className:"fixed top-0 left-0 right-0 bg-white shadow-sm z-50",children:(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,jt.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,jt.jsx)(Ct,{onClick:s.handleLogoClick}),(0,jt.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2",children:(0,jt.jsxs)("button",{onClick:s.handleUploadClick,className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-3 rounded-full text-sm font-semibold hover:from-blue-600 hover:to-purple-600 transition-all duration-200 flex items-center shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2","aria-label":"Upload Work",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Upload Work"]})}),(0,jt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,jt.jsx)("button",{onClick:s.handleGalleryClick,onMouseDown:e=>{1===e.button&&(e.preventDefault(),window.open("/","_blank"))},className:"bg-tag-blue text-white px-4 py-2 rounded-md text-sm font-semibold hover:bg-blue-700 transition-colors duration-200 min-w-[80px] text-center",children:"Gallery"}),(0,jt.jsx)(mt,{to:"/tagme",className:"bg-tag-purple text-white px-4 py-2 rounded-md text-sm font-semibold hover:bg-purple-700 transition-colors duration-200 min-w-[80px] text-center",children:"TAGMe"}),!r&&(0,jt.jsx)(Qo,{user:n,currentUser:a.currentUser,showDropdown:a.showDropdown,onToggle:s.handleDropdownToggle,onSettingsClick:s.handleSettingsClick,onNotificationsClick:s.handleNotificationsClick,onLogoutClick:s.handleLogoutClick,unreadCount:a.unreadCount,dropdownRef:o}),r&&(0,jt.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 animate-pulse"})]})]})})})},ra=()=>{const[t,r]=(0,e.useState)(""),[o,a]=(0,e.useState)(!1),[s,n]=(0,e.useState)(""),[i,l]=(0,e.useState)("");return(0,jt.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,jt.jsx)("section",{className:"pt-12 pb-6 bg-white",children:(0,jt.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:(0,jt.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"About TAG (Tech Art Guide)"})})}),(0,jt.jsx)("section",{className:"pt-8 pb-16 bg-gradient-to-br from-blue-50 to-blue-100",children:(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-8 shadow-lg",children:[(0,jt.jsx)("p",{className:"text-lg leading-relaxed mb-4",children:"TAG is an online platform that connects all students from all majors and departments. Our shared vision is to build a platform\u2014a bridge\u2014that brings together students across the entire college. The reason I wanted to do this is that, in many ways, popular sites like ArtStation, Behance, and LinkedIn are not always friendly to entry-level students. So why not build an online platform that truly belongs to us? A platform where we can showcase our works, discover talents around us, and look for collaboration opportunities. If we do so, we could create our own student-driven art market!"}),(0,jt.jsx)("p",{className:"text-lg leading-relaxed mb-4",children:"To put it simply:"}),(0,jt.jsx)("p",{className:"text-lg leading-relaxed mb-0",children:"This platform has two main purposes \u2013 one for increasing job visibility by uploading (TAG), and one for finding collaborators and experiences by doing (TAG Me). One helps build experience; the other helps get hired."})]}),(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-8 border-l-4 border-purple-500 mt-8 shadow-lg",children:[(0,jt.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"IMPORTANT"}),(0,jt.jsxs)("p",{className:"text-lg leading-relaxed text-gray-700",children:["At the current stage, all the"," ",(0,jt.jsx)("span",{className:"text-blue-600 font-semibold",children:"Gallery features (blue)"})," ","of TAG have been completed, while the"," ",(0,jt.jsx)("span",{className:"text-purple-600 font-semibold",children:"Collaboration system (purple)"})," ","is still under testing and development. I will do my best to bring those functions to life in the following weeks."]})]})]})}),(0,jt.jsx)("section",{className:"py-16 bg-white",children:(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,jt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"The Story & TAG Vision"}),(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("p",{className:"text-lg leading-relaxed",children:"Since my very first week in this college, I have been thinking about identifying pain points and solving real demands, because I know this is probably the last chance, as a student, to build something truly meaningful."}),(0,jt.jsx)("p",{className:"text-lg leading-relaxed",children:"I personally believe that people's behaviors are always driven by the environment. Here, we have thousands of students and over a hundred majors, and each of us carries a unique spirit and passion for creation. Yet if we do not have the chance to see each other's works, to witness these differences, I feel it would be a regret. But if we can see more, connect more, and find more real collaboration opportunities right now, right here\u2014wouldn't that be the most exciting thing?"}),(0,jt.jsx)("p",{className:"text-lg leading-relaxed",children:"Honestly, this has been extremely challenging for me. I have been planning this for months, doing extensive research, and investing a huge amount of time. Sometimes it took me an entire week and I still could not figure out a single function, and I had to take alternative paths to balance the site's features. Even now, I still feel there are so many features I wish I had time to implement, so many designs I wish I could refine, and so many needs I cannot yet fulfill. The work ahead seems 'infinite'..."}),(0,jt.jsx)("p",{className:"text-lg leading-relaxed",children:'Here, I sincerely hope you can be one of the people who share this vision with me. If every artist has their own personal spirit, then being a TAG Member means carrying that spirit to the world. In this environment with ten thousand students, the true value of a college is not about "ten thousand techniques," but "ten thousand personalities." Only we can tag ourselves, and let our personalities shape a platform that belongs to us all.'})]}),(0,jt.jsxs)("div",{className:"text-center mt-24",children:[(0,jt.jsx)("p",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Excited to have you join TAG."}),(0,jt.jsxs)("p",{className:"text-base text-gray-600 mt-8",children:["Best,",(0,jt.jsx)("br",{}),"Rain Wang",(0,jt.jsx)("br",{}),(0,jt.jsx)("span",{className:"text-purple-600 font-semibold",children:"Founder of TAG"})]}),(0,jt.jsxs)("p",{className:"text-base text-gray-600 mt-4",children:["Contact:"," ",(0,jt.jsx)("a",{href:"mailto:tag@rainwang.art",className:"text-purple-600 underline hover:text-purple-700 transition-colors duration-200",children:"tag@rainwang.art"})]})]})]})}),(0,jt.jsx)("section",{className:"py-16 bg-gray-50",children:(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,jt.jsx)("div",{className:"border-t border-gray-300 mb-12"}),(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-8 shadow-lg",children:[(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2 text-center",children:"Stay Connected with TAG"}),(0,jt.jsx)("p",{className:"text-base text-gray-600 mb-9 text-center",children:"to get the latest updates and new feature releases."}),(0,jt.jsxs)("form",{onSubmit:async e=>{e.preventDefault();if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.trim())||t.trim().length>=254)return n("Please enter a valid email address."),void l("error");a(!0),n(""),l("");try{const{data:e,error:o}=await wt.supabase.functions.invoke("subscribe",{body:{email:t.trim(),source:"about_page"}});if(o)throw o;e.success?(n(e.message),l("success"),r("")):(n(e.message||"Subscription failed. Please try again."),l("error"))}catch(o){console.error("Subscription error:",o),n("Something went wrong. Please try again later."),l("error")}finally{a(!1)}},className:"max-w-md mx-auto",children:[s&&(0,jt.jsx)("div",{className:"mb-4 p-3 rounded-md text-center ".concat("success"===i?"bg-green-100 text-green-700 border border-green-300":"bg-red-100 text-red-700 border border-red-300"),children:s}),(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("input",{type:"email",value:t,onChange:e=>r(e.target.value),placeholder:"Enter your email",className:"w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500",required:!0,disabled:o})}),(0,jt.jsx)("button",{type:"submit",disabled:o,className:"w-full px-6 py-3 rounded-md font-medium transition-all duration-200 shadow-lg transform ".concat(o?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-purple-700 text-white hover:from-purple-700 hover:to-purple-800 hover:shadow-xl hover:-translate-y-1"),children:o?"Subscribing...":"Subscribe"}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 mt-3 text-center",children:"We encourage your other emails (e.g. Gmail, Outlook). Note: SCAD.EDU accounts may sometimes filter messages into junk mail. We\u2019ll never share your information."})]})]})]})})]})},oa=e=>{try{console.log("[getCollaborationDataById] Looking for itemId:",e);const t=localStorage.getItem("mock_collaborations");if(console.log("[getCollaborationDataById] Raw stored data:",t),t){const r=JSON.parse(t);console.log("[getCollaborationDataById] Parsed collaborations:",r),console.log("[getCollaborationDataById] Searching for itemId:",e),console.log("[getCollaborationDataById] Available collaborations:",r.map(e=>({id:e.id,title:e.title})));let o=r.find(t=>t.id===e);if(o||(o=r.find(t=>t.id.toString()===e.toString())),o||isNaN(e)||(o=r.find(t=>t.id===parseInt(e))),o)return console.log("[getCollaborationDataById] Found collaboration data:",o),console.log("[getCollaborationDataById] Collaboration roles:",o.roles),o;if(console.warn("[getCollaborationDataById] No collaboration found with id:",e),console.log("[getCollaborationDataById] Available IDs:",r.map(e=>e.id)),r.length>0){const e=r[0];return console.log("[getCollaborationDataById] Using latest collaboration as fallback:",e),console.log("[getCollaborationDataById] Latest collaboration roles:",e.roles),e}}else console.warn("[getCollaborationDataById] No data in localStorage");return console.warn("[getCollaborationDataById] No collaboration data found in localStorage for itemId:",e),null}catch(t){return console.error("[getCollaborationDataById] Error getting collaboration data:",t),null}},aa=t=>{let{favorite:o,isOwnProfile:a=!1,onRemove:s}=t;const n=ce(),[i,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(null),[u,h]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(async()=>{try{console.log("[FavoriteCollabCard] Loading data for itemId:",o.item_id);const e=oa(o.item_id);if(d(e),e){const e=await(async e=>{const t=oa(e);if(!t)return console.warn("[Favorites] No collaboration data found for itemId:",e),null;if(console.log("[Favorites] Getting image for collaboration:",t),t.posterPreview)try{const e=await Promise.resolve().then(r.bind(r,337)),o=await e.default.getImageUrl(t.posterPreview);return console.log("[Favorites] Got image URL from posterPreview:",o),o}catch(o){console.warn("[Favorites] Failed to get collaboration image from posterPreview: ".concat(t.posterPreview),o)}if(t.heroImage)try{const e=await Promise.resolve().then(r.bind(r,337)),o=await e.default.getImageUrl(t.heroImage);return console.log("[Favorites] Got image URL from heroImage:",o),o}catch(o){console.warn("[Favorites] Failed to get collaboration image from heroImage: ".concat(t.heroImage),o)}return t.image?(console.log("[Favorites] Using fallback image:",t.image),t.image):(console.warn("[Favorites] No image found for collaboration:",e),null)})(o.item_id);l(e),console.log("[FavoriteCollabCard] Loaded image URL:",e)}else console.warn("[FavoriteCollabCard] No collaboration data found for itemId:",o.item_id)}catch(e){console.error("[FavoriteCollabCard] Error loading collaboration data:",e)}finally{h(!1)}})()},[o.item_id]);return u?(0,jt.jsx)("div",{className:"relative aspect-[4/3] bg-gray-200 rounded-lg shadow-sm overflow-hidden",children:(0,jt.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,jt.jsx)("div",{className:"text-gray-500",children:"Loading..."})})}):(0,jt.jsxs)("div",{className:"relative aspect-[4/3] bg-tag-purple rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 overflow-hidden cursor-pointer",onClick:()=>{c?n("/tagme/collaboration/".concat(o.item_id),{state:{project:c}}):(console.warn("[FavoriteCollabCard] No collaboration data available for navigation"),n("/tagme/collaboration/".concat(o.item_id)))},children:[i?(0,jt.jsx)("img",{src:i,alt:(null===c||void 0===c?void 0:c.title)||"Collaboration",className:"w-full h-full object-cover"}):(0,jt.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:(0,jt.jsx)("div",{className:"text-gray-500 text-sm",children:"No Image"})}),(0,jt.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-2 bg-tag-purple"}),a&&(0,jt.jsx)("button",{onClick:e=>{e.stopPropagation(),s()},className:"absolute top-2 right-2 w-8 h-8 bg-white/80 hover:bg-white rounded-full flex items-center justify-center transition-colors duration-200",title:"Remove from favorites",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},sa=()=>{ce();const e="No favorites yet",t="Start Exploring";return(0,jt.jsxs)("div",{className:"text-center py-12",children:[(0,jt.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:e}),(0,jt.jsx)(mt,{to:"/",className:"inline-block px-6 py-3 bg-tag-blue text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:t})]})},na=()=>(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,t)=>(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden animate-pulse",children:[(0,jt.jsx)("div",{className:"w-full h-48 bg-gray-200"}),(0,jt.jsxs)("div",{className:"p-4",children:[(0,jt.jsx)("div",{className:"h-5 bg-gray-200 rounded mb-2"}),(0,jt.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-3"}),(0,jt.jsxs)("div",{className:"flex items-center mb-3",children:[(0,jt.jsx)("div",{className:"w-6 h-6 bg-gray-200 rounded-full mr-2"}),(0,jt.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"})]}),(0,jt.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,jt.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,jt.jsx)("div",{className:"h-3 bg-gray-200 rounded w-5/6"})]}),(0,jt.jsxs)("div",{className:"flex gap-1 mb-3",children:[(0,jt.jsx)("div",{className:"w-12 h-6 bg-gray-200 rounded-full"}),(0,jt.jsx)("div",{className:"w-16 h-6 bg-gray-200 rounded-full"}),(0,jt.jsx)("div",{className:"w-14 h-6 bg-gray-200 rounded-full"})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{className:"flex space-x-4",children:[(0,jt.jsx)("div",{className:"w-12 h-4 bg-gray-200 rounded"}),(0,jt.jsx)("div",{className:"w-16 h-4 bg-gray-200 rounded"})]}),(0,jt.jsx)("div",{className:"w-16 h-8 bg-gray-200 rounded"})]})]})]},t))}),ia=()=>{const[t,r]=(0,e.useState)({}),[o,a]=(0,e.useState)(!0),[s,n]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{try{a(!0),n(null);const e=await(0,sr.S5)();if(e.success){const t={},o=e.data.map(async e=>{if(e&&e.id){var t;let r="";const o=e.thumbnailPath||e.imagePaths&&e.imagePaths[0];if(o)try{const e=await(0,sr.getPortfolioImageUrl)(o);e.success&&(r=e.data)}catch(s){console.warn("[useWorkData] Failed to get image URL for:",o,s)}return{id:e.id,title:e.title||"Untitled",artist:(null===(t=e.profiles)||void 0===t?void 0:t.full_name)||"Unknown Artist",image:r,category:e.category||"design",tags:e.tags||[],description:e.description||"",createdAt:e.createdAt||(new Date).toISOString()}}return null});(await Promise.all(o)).forEach(e=>{e&&(t[e.id]=e)}),r(t),console.log("[useWorkData] Loaded works data:",t)}else n(e.error||"Failed to load works data"),console.error("[useWorkData] Failed to load works:",e.error)}catch(s){console.error("[useWorkData] Error loading works:",s),n(s.message||"Failed to load works data")}finally{a(!1)}})()},[]);return{worksData:t,loading:o,error:s,getWorkById:e=>{if(!e)return null;const r=t[e];if(r)return console.log("[useWorkData] Found real work data for:",e,r),r;const o=[{id:1,title:"Explosive Energy",artist:"Alex Chen",image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=400&fit=crop",category:"Visual Effects"},{id:2,title:"Dark Knight",artist:"Sarah Kim",image:"https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400&h=400&fit=crop",category:"Game Design"},{id:3,title:"Mobile UI Design",artist:"Mike Johnson",image:"https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=400&h=400&fit=crop",category:"UI/UX"},{id:4,title:"Enchanted Forest",artist:"Emma Wilson",image:"https://images.unsplash.com/photo-1489599435384-d5f1a131c7dc?w=400&h=400&fit=crop",category:"Illustration"},{id:5,title:"Digital Sculpture",artist:"David Lee",image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=400&fit=crop",category:"Fine Art"},{id:6,title:"Brand Identity",artist:"Lisa Wang",image:"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=400&fit=crop",category:"Graphic Design"}],a=o.find(t=>t.id.toString()===e);if(a)return console.log("[useWorkData] Found default work for simple ID:",e,a),a;if(e&&e.startsWith("mock_")){const t=o[Math.abs(e.split("_")[1]?parseInt(e.split("_")[1]):0)%o.length],r={id:e,title:t.title,artist:t.artist,image:t.image,category:t.category};return console.log("[useWorkData] Created mock work for complex ID:",e,r),r}return console.warn("[useWorkData] No work found for itemId:",e),null}}},la=e=>{var t;let{favorite:r,isOwnProfile:o=!1,onRemove:a}=e;ce();const{getWorkById:s,loading:n}=ia(),i=s(r.item_id);return(0,jt.jsxs)("div",{className:"relative aspect-[4/3] bg-tag-blue rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 overflow-hidden",children:[(0,jt.jsx)(mt,{to:"/work/".concat(r.item_id),className:"block w-full h-full",children:(0,jt.jsx)("img",{src:(null===i||void 0===i||null===(t=i.image)||void 0===t?void 0:t.url)||(null===i||void 0===i?void 0:i.image)||"/assets/placeholder.svg",alt:(null===i||void 0===i?void 0:i.title)||"Work",className:"w-full h-full object-cover",onError:e=>{console.error("[FavoriteWorkCard] Image failed to load:",e.target.src),e.target.src="/assets/placeholder.svg"},onLoad:()=>console.log("[FavoriteWorkCard] Image loaded successfully:",null===i||void 0===i?void 0:i.image)})}),(0,jt.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-2 bg-tag-blue"}),o&&(0,jt.jsx)("button",{onClick:e=>{e.stopPropagation(),a()},className:"absolute top-2 right-2 w-8 h-8 bg-white/80 hover:bg-white rounded-full flex items-center justify-center transition-colors duration-200",title:"Remove from favorites",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},ca=t=>{let{isOwnProfile:r=!1,viewedUserId:o=null}=t;const{favorites:s,loading:n,error:i,pagination:l,handleLoadMore:c,handleRemoveFavorite:d}=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const[r,o]=(0,e.useState)([]),[s,n]=(0,e.useState)(!0),[i,l]=(0,e.useState)(null),[c,d]=(0,e.useState)({cursor:null,hasMore:!1,total:0}),u=(0,e.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{n(!0),l(null);let r=t;if(!r){const e=(0,Lr.HW)();if(console.log("[useFavorites] \u5f53\u524d\u7528\u6237:",e),null===e||void 0===e||!e.id)return console.warn("[useFavorites] \u7528\u6237\u672a\u767b\u5f55\uff0c\u65e0\u6cd5\u52a0\u8f7d\u6536\u85cf"),o([]),void d({cursor:null,hasMore:!1,total:0});r=e.id}console.log("[useFavorites] \u83b7\u53d6\u6536\u85cf\u7684\u7528\u6237ID:",r);const a={userId:r,type:"all",cursor:e?null:c.cursor,limit:12};console.log("[useFavorites] \u52a0\u8f7d\u6536\u85cf\uff0c\u53c2\u6570:",a);const s=await Rr.getFavorites(a);if(s.success){const t=s.data.items;console.log("[useFavorites] \u52a0\u8f7d\u5230\u7684\u6536\u85cf:",t),console.log("[useFavorites] \u6536\u85cf\u7c7b\u578b\u7edf\u8ba1:",t.reduce((e,t)=>(e[t.item_type]=(e[t.item_type]||0)+1,e),{})),o(e?t:e=>[...e,...t]),d({cursor:s.data.pagination.cursor,hasMore:s.data.pagination.hasMore,total:s.data.pagination.total}),console.log("[useFavorites] \u5206\u9875\u4fe1\u606f:",s.data.pagination)}else console.error("[useFavorites] \u52a0\u8f7d\u6536\u85cf\u5931\u8d25:",s.error),l("Failed to load favorites")}catch(r){console.error("[useFavorites] \u52a0\u8f7d\u6536\u85cf\u65f6\u51fa\u9519:",r),l(r.message||"Failed to load favorites")}finally{n(!1)}},[]);(0,e.useEffect)(()=>{console.log("[useFavorites] \u521d\u59cb\u5316\u52a0\u8f7d\u6536\u85cf..."),u(!0)},[u,t]);const h=(0,e.useCallback)(()=>{!s&&c.hasMore&&(console.log("[useFavorites] \u52a0\u8f7d\u66f4\u591a\u6536\u85cf..."),u(!1))},[s,c.hasMore,u]),m=(0,e.useCallback)(e=>{console.log("[useFavorites] \u79fb\u9664\u6536\u85cf:",e),o(t=>t.filter(t=>t.id!==e)),d(e=>(0,a.A)((0,a.A)({},e),{},{total:Math.max(0,e.total-1)}))},[]);return{favorites:r,loading:s,error:i,pagination:c,handleLoadMore:h,handleRemoveFavorite:m,refresh:()=>u(!0)}}(o),{handleRemoveFavorite:u}={handleRemoveFavorite:(0,e.useCallback)(async e=>{try{const t=await Rr.removeFavoriteById(e);return t.success?(console.log("Favorite removed successfully"),!0):(console.error("Failed to remove favorite:",t.error),!1)}catch(i){return console.error("Error removing favorite:",i),!1}},[]),batchCheckFavoriteStatus:(0,e.useCallback)(async e=>{try{const t=e.map(e=>({itemType:e.type,itemId:e.id})),r=await Rr.batchCheckFavoriteStatus(t);return r.success?r.data:(console.error("Failed to check favorite status:",r.error),{})}catch(i){return console.error("Error checking favorite status:",i),{}}},[])},{loading:h}=ia(),m=e=>"work"===e.item_type?(0,jt.jsx)(la,{favorite:e,isOwnProfile:r,onRemove:async()=>{await u(e.id)&&d(e.id)}},e.id):"collaboration"===e.item_type?(0,jt.jsx)(aa,{favorite:e,isOwnProfile:r,onRemove:async()=>{await u(e.id)&&d(e.id)}},e.id):null;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,jt.jsx)("div",{className:"mb-6",children:(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Favorites"})}),n||h?(0,jt.jsx)(na,{}):i?(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsxs)("p",{className:"text-red-600",children:["Failed to load favorites: ",i]}),(0,jt.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-blue-700",children:"Retry"})]}):0===s.length?(0,jt.jsx)(sa,{}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(m)}),l.hasMore&&(0,jt.jsx)("div",{className:"text-center mt-8",children:(0,jt.jsx)("button",{onClick:c,disabled:n,className:"px-6 py-3 bg-tag-blue text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Loading...":"Load More"})})]})]})};var da=r(405);const ua=new Map,ha=e=>{if(!Array.isArray(e)||0===e.length)return void console.warn("[invalidate] Invalid keys provided:",e);const[t,r]=e;if("artist"===t&&r){const e="artist_".concat(r);ua.has(e)&&(ua.delete(e),console.log("[invalidate] Cleared cache for artist: ".concat(r)))}else if("artist"===t){for(const[e]of ua)e.startsWith("artist_")&&ua.delete(e);console.log("[invalidate] Cleared all artist cache")}},ma=e=>{const t={Photographer:"\ud83d\udcf7","Visual Designer":"\ud83c\udfa8",Illustrator:"\ud83c\udfa8","Concept Artist":"\ud83c\udfad","Graphic Designer":"\ud83c\udfa8","Digital Artist":"\ud83c\udfa8","3D Artist":"\ud83c\udfad",Animator:"\ud83c\udfac",default:"\ud83c\udfa8"};return t[e]||t.default},pa=async e=>{try{var t;if(!e)return console.warn("[getArtistById] No userId provided"),null;const s="artist_".concat(e);if(ua.has(s))return console.log("[getArtistById] Using cached data for: ".concat(e)),ua.get(s);const n=await(0,da.getProfile)(e);let i=null,l=null;if(n.success&&n.data)i=n.data,console.log("[getArtistById] Found Supabase profile for: ".concat(e));else{const t={1:"alex",2:"alice",3:"bryan"}[e]||e;l=ar.o1[t],l||(console.warn("[getArtistById] No profile found for ID: ".concat(e,", creating default profile")),i=fa(e))}let c=null;try{c=await(0,At.getUnifiedAvatar)(e),console.log("[getArtistById] Using unified avatar service for:",e,c?"found":"not found")}catch(o){var r;console.warn("[getArtistById] Failed to get unified avatar:",o),c=(null===(r=l)||void 0===r?void 0:r.avatar)||null}const d=i?(0,a.A)((0,a.A)({},i),{},{avatar:c}):null,u={following:0,followers:0};try{const[t,r]=await Promise.all([(0,Dr.getFollowers)(e),(0,Dr.getFollowing)(e)]);t.success&&(u.followers=t.data.length),r.success&&(u.following=r.data.length),console.log("[getArtistById] Follow stats for ".concat(e,":"),u)}catch(o){console.warn("[getArtistById] Failed to get follow stats for ".concat(e,":"),o)}const h=function(e){var t,r,o,a;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return console.warn("[selectArtistView] No profile provided"),null;const i=null!==s&&void 0!==s&&s.portfolio?s.portfolio.map((e,t)=>({id:e.id,title:e.title,image:e.thumb,category:e.category})):[];return{id:e.id||"",name:e.fullName||e.name||"Unknown Artist",title:e.title||e.role||"Artist",discipline:e.title||e.role||"Artist",roleIcon:ma(e.title||e.role),avatar:e.avatar||(null===s||void 0===s?void 0:s.avatar)||"",bio:e.bio||(null===s||void 0===s?void 0:s.bio)||"",school:e.school||(null===s||void 0===s?void 0:s.school)||"",pronouns:e.pronouns||(null===s||void 0===s?void 0:s.pronouns)||"",majors:Array.isArray(e.majors)?e.majors:[],minors:Array.isArray(e.minors)?e.minors:[],skills:Array.isArray(e.skills)?e.skills:[],works:i,stats:{following:(null===n||void 0===n?void 0:n.following)||0,followers:(null===n||void 0===n?void 0:n.followers)||0,collaborations:12},socialLinks:{instagram:(null===(t=e.socialLinks)||void 0===t?void 0:t.instagram)||"",portfolio:(null===(r=e.socialLinks)||void 0===r?void 0:r.portfolio)||"",discord:(null===(o=e.socialLinks)||void 0===o?void 0:o.discord)||"",otherLinks:(null===(a=e.socialLinks)||void 0===a?void 0:a.otherLinks)||[]},updatedAt:e.updatedAt||(new Date).toISOString()}}(d,l,u);return h?(console.log("[getArtistById] Artist view socialLinks:",{userId:e,profileSocialLinks:null===d||void 0===d?void 0:d.socialLinks,mockUserSocialLinks:null===(t=l)||void 0===t?void 0:t.socialLinks,finalSocialLinks:h.socialLinks}),ua.set(s,h),console.log("[getArtistById] Cached data for: ".concat(e)),h):(console.warn("[getArtistById] Failed to create artist view for ".concat(e)),null)}catch(o){return console.error("[getArtistById] Error getting artist data for ".concat(e,":"),o),null}},ga=e=>{const t="px-4 py-2 rounded-md font-medium transition-colors duration-200";return"".concat(t,e?" bg-gray-200 text-gray-700 hover:bg-gray-300":" bg-blue-500 text-white hover:bg-blue-600")},fa=e=>({id:e,fullName:"Artist",title:"Artist",school:"",pronouns:"",majors:[],minors:[],skills:[],bio:"",socialLinks:{instagram:"",portfolio:"",discord:"",otherLinks:[]},avatar:"",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()}),va=t=>{var r,o;let{artist:a,artworks:s=[],isFollowing:n,followersCount:i,followingCount:l,isOwnProfile:c,onBackClick:d,onEditProfileClick:u,onPreviewAsVisitorClick:h,onBackToOwnerViewClick:m,toggleFollow:p,onFollowersClick:g,onFollowingClick:f,from:v="gallery",className:x=""}=t;const[b,y]=(0,e.useState)(null),[w,j]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(async()=>{if(null!==a&&void 0!==a&&a.id)try{j(!0);const e=await(0,At.getUnifiedAvatar)(a.id);y(e)}catch(e){console.error("[ArtistHeader] Failed to load avatar:",e),y(a.avatar)}finally{j(!1)}})()},[null===a||void 0===a?void 0:a.id,null===a||void 0===a?void 0:a.avatar]);return(0,jt.jsxs)("div",{className:"".concat(x),children:[(0,jt.jsx)("div",{className:"border-b border-gray-200",children:(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,jt.jsxs)("button",{onClick:d,className:"flex items-center py-4 text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),(()=>{switch(v){case"artists":return"Back to Artists";case"gallery":default:return"Back to Gallery";case"tagme":return"Back to TAGMe";case"search":return"Back to Search"}})()]})})}),(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-8",children:(0,jt.jsx)("div",{className:"pb-8 border-b border-gray-200",children:(0,jt.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start",children:[(0,jt.jsxs)("div",{className:"flex items-center mb-6 lg:mb-0",children:[w?(0,jt.jsx)("div",{className:"w-20 h-20 rounded-full mr-6 bg-gray-200 animate-pulse"}):b?(0,jt.jsx)("img",{src:b,alt:a.name,className:"w-20 h-20 rounded-full mr-6 object-cover",onError:()=>{console.warn("[ArtistHeader] Avatar image failed to load, using fallback"),y(a.avatar)}}):(0,jt.jsx)("div",{className:"w-20 h-20 rounded-full mr-6 bg-gray-200 flex items-center justify-center",children:(0,jt.jsx)("span",{className:"text-gray-500 text-2xl font-bold",children:(null===(r=a.name)||void 0===r||null===(o=r.charAt(0))||void 0===o?void 0:o.toUpperCase())||"?"})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:a.name}),(0,jt.jsx)("div",{className:"flex items-center gap-3",children:(0,jt.jsx)("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:a.title})})]})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-8 mb-6 lg:mb-0 lg:ml-16",children:[(0,jt.jsxs)("div",{className:"text-left",children:[(0,jt.jsx)("div",{className:"text-xl font-bold text-gray-900",children:s.length}),(0,jt.jsx)("div",{className:"text-sm text-gray-600",children:"Works"})]}),(0,jt.jsxs)("div",{className:"text-left cursor-pointer hover:opacity-80 transition-opacity duration-200",onClick:f,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),f())},children:[(0,jt.jsx)("div",{className:"text-xl font-bold text-gray-900",children:l||0}),(0,jt.jsx)("div",{className:"text-sm text-gray-600",children:"Following"})]}),(0,jt.jsxs)("div",{className:"text-left cursor-pointer hover:opacity-80 transition-opacity duration-200",onClick:g,role:"button",tabIndex:0,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),g())},children:[(0,jt.jsx)("div",{className:"text-xl font-bold text-gray-900",children:i}),(0,jt.jsx)("div",{className:"text-sm text-gray-600",children:"Followers"})]})]}),(0,jt.jsx)("div",{className:"flex items-center gap-3 lg:ml-auto",children:c?(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsxs)("button",{onClick:h,className:"px-4 py-2 rounded-md font-medium transition-colors duration-200 bg-blue-500 text-white hover:bg-blue-600 flex items-center gap-2",children:[(0,jt.jsxs)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Preview as Visitor"]}),(0,jt.jsxs)("button",{onClick:u,className:"px-4 py-2 rounded-md font-medium transition-colors duration-200 bg-purple-500 text-white hover:bg-purple-600 flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Profile"]})]}):m?(0,jt.jsxs)("button",{onClick:m,className:"px-4 py-2 rounded-md font-medium transition-colors duration-200 bg-gray-500 text-white hover:bg-gray-600 flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Owner View"]}):(0,jt.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),p()},className:ga(n),children:n?"Following":"Follow"})})]})})})]})},xa=e=>{if(!e||!e.trim())return!1;if("#"===e||"http://#"===e||"https://#"===e)return!1;try{const t=new URL(e);return"http:"===t.protocol||"https:"===t.protocol}catch(t){return!1}},ba=(e,t)=>{xa(t)?window.open(t,"_blank","noopener,noreferrer"):console.warn("Invalid ".concat(e," URL:"),t)},ya=e=>{var t,r,o,a,s;let{artist:n,className:i=""}=e;return console.log("[ArtistSidebar] Artist data:",{artistId:null===n||void 0===n?void 0:n.id,artistName:null===n||void 0===n?void 0:n.name,socialLinks:null===n||void 0===n?void 0:n.socialLinks}),(0,jt.jsx)("div",{className:"lg:w-80 flex-shrink-0 ".concat(i),children:(0,jt.jsxs)("div",{className:"pb-8",children:[(0,jt.jsxs)("div",{className:"mb-6",children:[n.school&&(0,jt.jsxs)("div",{className:"mb-3",children:[(0,jt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"School:"}),(0,jt.jsx)("p",{className:"text-gray-600 mt-1",children:n.school})]}),n.pronouns&&(0,jt.jsxs)("div",{className:"mb-3",children:[(0,jt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Pronouns:"}),(0,jt.jsx)("p",{className:"text-gray-600 mt-1",children:n.pronouns})]}),(n.majors&&n.majors.length>0||n.minors&&n.minors.length>0)&&(0,jt.jsxs)("div",{className:"mb-3",children:[(0,jt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Major & Minor:"}),(0,jt.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[null===(t=n.majors)||void 0===t?void 0:t.map((e,t)=>(0,jt.jsx)("span",{className:"bg-purple-100 text-purple-700 text-xs px-2 py-1 rounded-full",children:e},"major-".concat(t))),null===(r=n.minors)||void 0===r?void 0:r.map((e,t)=>(0,jt.jsx)("span",{className:"bg-purple-100 text-purple-700 text-xs px-2 py-1 rounded-full",children:e},"minor-".concat(t)))]})]})]}),(0,jt.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"About"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:n.bio}),(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-2",children:"Skills"}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:n.skills.map((e,t)=>(0,jt.jsx)("span",{className:"bg-gray-100 text-gray-700 text-sm px-3 py-1 rounded-full",children:e},t))}),(0,jt.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-3",children:"Connect"}),(0,jt.jsxs)("div",{className:"flex gap-3",children:[(null===(o=n.socialLinks)||void 0===o?void 0:o.discord)&&xa(n.socialLinks.discord)&&(0,jt.jsx)("button",{onClick:()=>ba("discord",n.socialLinks.discord),className:"text-gray-600 hover:text-gray-900 transition-colors duration-200",title:"Discord",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.019 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})})}),(null===(a=n.socialLinks)||void 0===a?void 0:a.instagram)&&xa(n.socialLinks.instagram)&&(0,jt.jsx)("button",{onClick:()=>ba("instagram",n.socialLinks.instagram),className:"text-gray-600 hover:text-gray-900 transition-colors duration-200",title:"Instagram",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),(null===(s=n.socialLinks)||void 0===s?void 0:s.portfolio)&&xa(n.socialLinks.portfolio)&&(0,jt.jsx)("button",{onClick:()=>ba("portfolio",n.socialLinks.portfolio),className:"text-gray-600 hover:text-gray-900 transition-colors duration-200",title:"Portfolio",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})})})]}),n.socialLinks.otherLinks&&n.socialLinks.otherLinks.length>0&&n.socialLinks.otherLinks.some(e=>xa(e.url))&&(0,jt.jsxs)("div",{className:"mt-4",children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-2",children:"Other Websites"}),(0,jt.jsx)("div",{className:"space-y-2",children:n.socialLinks.otherLinks.filter(e=>xa(e.url)).map(e=>(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})})}),(0,jt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,jt.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.label}),(0,jt.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 transition-colors duration-200",children:e.url})]})]},e.id))})]})]})})},wa=t=>{let{artworks:r,onArtworkClick:o,className:a="",isOwnProfile:s=!1}=t;const n=ce(),[i,l]=(0,e.useState)(null);return(0,jt.jsxs)("div",{className:"pb-8 border-b border-gray-200 bg-blue-50 rounded-lg p-6 ".concat(a),children:[(0,jt.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"Portfolio"}),(0,jt.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(e=>(0,jt.jsx)("div",{onClick:()=>o(e),className:"group cursor-pointer relative",onMouseEnter:()=>l(e.id),onMouseLeave:()=>l(null),children:(0,jt.jsxs)("div",{className:"relative overflow-hidden rounded-lg",children:[(0,jt.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"}),s&&i===e.id&&(0,jt.jsx)("button",{onClick:t=>(e=>{e.stopPropagation(),n("/settings/edit-profile")})(t,e.id),className:"absolute top-2 right-2 p-2 bg-white bg-opacity-90 hover:bg-opacity-100 text-gray-600 hover:text-blue-600 rounded-full transition-all duration-200 shadow-md z-10",title:"Edit Profile",children:(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),(0,jt.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-end",children:(0,jt.jsxs)("div",{className:"p-3 w-full transform translate-y-full group-hover:translate-y-0 transition-transform duration-300",children:[(0,jt.jsx)("h4",{className:"text-white font-medium text-sm",children:e.title}),(0,jt.jsx)("p",{className:"text-gray-200 text-xs",children:e.category})]})})]})},e.id))})]})},ja=t=>{let{post:r,className:o="",onDelete:a}=t;const[s,n]=(0,e.useState)(!1),i=r.isDraft;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden ".concat(o),children:[(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("img",{src:r.image||"/assets/placeholder.svg",alt:r.title,className:"w-full h-48 object-cover"}),i&&a&&(0,jt.jsx)("button",{onClick:e=>{e.stopPropagation(),n(!0)},className:"absolute top-3 right-3 p-2 bg-white bg-opacity-90 hover:bg-opacity-100 rounded-full shadow-sm transition-all duration-200 hover:scale-110",title:"Delete draft",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,jt.jsxs)("div",{className:"p-4",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,jt.jsx)("h4",{className:"font-medium text-gray-900",children:r.title}),i&&(0,jt.jsx)("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-600 rounded-full",children:"Draft"})]}),(0,jt.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,jt.jsx)("span",{className:"text-sm text-gray-500",children:r.date})}),r.tags&&r.tags.length>0&&(0,jt.jsxs)("div",{className:"flex flex-wrap gap-1",children:[r.tags.slice(0,3).map((e,t)=>(0,jt.jsxs)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:["#",e]},t)),r.tags.length>3&&(0,jt.jsxs)("span",{className:"px-2 py-1 text-xs text-gray-500",children:["+",r.tags.length-3," more"]})]})]}),s&&(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.stopPropagation()},children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-sm mx-4",children:[(0,jt.jsxs)("div",{className:"flex items-center mb-4",children:[(0,jt.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3",children:(0,jt.jsx)("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Draft"})]}),(0,jt.jsxs)("p",{className:"text-gray-600 mb-6",children:['Are you sure you want to delete "',r.title,'"? This action cannot be undone.']}),(0,jt.jsxs)("div",{className:"flex gap-3",children:[(0,jt.jsx)("button",{onClick:e=>{e.stopPropagation(),n(!1)},className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors duration-200",children:"Cancel"}),(0,jt.jsx)("button",{onClick:e=>{e.stopPropagation(),a&&a(r.id),n(!1)},className:"flex-1 px-4 py-2 text-white bg-red-500 hover:bg-red-600 rounded-md transition-colors duration-200",children:"Delete"})]})]})})]})},ka=e=>{let{activeTab:t,onTabChange:r,className:o=""}=e;return(0,jt.jsx)("div",{className:"bg-gray-100 rounded-lg p-1 ".concat(o),children:(0,jt.jsxs)("div",{className:"flex bg-white rounded-md",children:[(0,jt.jsx)("button",{onClick:()=>r("published"),className:"flex-1 py-2 px-4 text-sm font-bold rounded-md transition-colors duration-200 ".concat("published"===t?"bg-tag-purple text-white":"text-gray-700 hover:text-gray-900"),children:"Published"}),(0,jt.jsx)("button",{onClick:()=>r("drafts"),className:"flex-1 py-2 px-4 text-sm font-bold rounded-md transition-colors duration-200 ".concat("drafts"===t?"bg-tag-purple text-white":"text-gray-700 hover:text-gray-900"),children:"Drafts"})]})})},Sa=t=>{let{collaborations:r,expandedCardId:o,onCollaborationToggle:a,className:s="",currentUserId:n="alice",viewedUserId:i=null}=t;const l=ce(),[c,d]=(0,e.useState)("published"),[u,h]=(0,e.useState)([]),[m,p]=(0,e.useState)(!1),[g,f]=(0,e.useState)(!1),[v,x]=(0,e.useState)([]),b=(0,e.useCallback)(async()=>{try{const e=localStorage.getItem("mock_collaborations");if(!e)return console.log("[CollaborationsSection] No collaborations found in storage"),void x([]);const t=JSON.parse(e);console.log("[CollaborationsSection] Found collaborations:",t.length);let r=i;if(!r){if(!n)return console.warn("[CollaborationsSection] No currentUserId provided"),void x([]);r=n}console.log("[CollaborationsSection] \u83b7\u53d6\u534f\u4f5c\u9879\u76ee\u7684\u7528\u6237ID:",r);const o=t.filter(e=>e.author&&e.author.id===r);console.log("[CollaborationsSection] User collaborations:",o.length);const a=o.map(e=>{const t=new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});let r="";r=e.heroImage?e.heroImage.startsWith("collaboration_")?"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop":e.heroImage:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop";const o=e.projectType?[e.projectType]:["Collaboration"];return{id:e.id,title:e.title,date:t,image:r,tags:o}});x(a)}catch(e){console.error("[CollaborationsSection] Error loading published collaborations:",e),x([])}},[n,i]);(0,e.useEffect)(()=>{b()},[b]),(0,e.useEffect)(()=>{const e=()=>{console.log("[CollaborationsSection] Collaboration created event received, refreshing published list"),b()};return window.addEventListener("collaboration:created",e),()=>{window.removeEventListener("collaboration:created",e)}},[b]);const y=async()=>{try{if(p(!0),!n||!i||n!==i)return console.log("[CollaborationsSection] Not owner page, skipping drafts load"),void h([]);const e=await zr.getDrafts({type:"collaboration"});if(e.success){const t=e.data.items.map(e=>({id:e.id,title:e.title||"Untitled Draft",date:new Date(e.updatedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),image:e.image||"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",tags:e.tags||[],isDraft:!0,draftData:e}));h(t)}}catch(e){console.error("Failed to load drafts:",e)}finally{p(!1)}};(0,e.useEffect)(()=>{y()},[n,i]),(0,e.useEffect)(()=>{const e=()=>{console.log("Draft saved event received, refreshing drafts list"),y()};return window.addEventListener("draft:saved",e),()=>{window.removeEventListener("draft:saved",e)}},[]);const w=async e=>{try{console.log("Deleting draft:",e);const t=await zr.deleteDraft(e);if(t.success){console.log("Draft deleted successfully");const e=async()=>{try{p(!0);const e=await zr.getDrafts({type:"collaboration"});if(e.success){const t=e.data.items.map(e=>({id:e.id,title:e.title||"Untitled Draft",date:new Date(e.updatedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),image:e.image||"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",tags:e.tags||[],isDraft:!0,draftData:e}));h(t)}}catch(e){console.error("Failed to reload drafts:",e)}finally{p(!1)}};e()}else console.error("Failed to delete draft:",t.error),alert("Failed to delete draft. Please try again.")}catch(t){console.error("Error deleting draft:",t),alert("Failed to delete draft. Please try again.")}};return(0,jt.jsxs)("div",{className:"pt-8 mt-8 bg-purple-50 rounded-lg p-6 ".concat(s),children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,jt.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Collaborations"}),(0,jt.jsx)("button",{onClick:()=>f(!0),className:"p-2 text-purple-600 hover:text-purple-700 hover:bg-purple-100 rounded-full transition-colors duration-200",title:"Learn about Collaborations",children:(0,jt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),(0,jt.jsxs)("div",{className:"mb-8",children:[(0,jt.jsx)("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"History & Experiences"}),(0,jt.jsx)("div",{className:"text-center py-8",children:(0,jt.jsx)("p",{className:"text-gray-500",children:"No Final Reviews yet \u2014 complete a collaboration to build your Experiences here."})})]}),(0,jt.jsx)("div",{className:"mb-6",children:(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,jt.jsx)(ka,{activeTab:c,onTabChange:e=>{d(e)}}),"drafts"===c&&(0,jt.jsxs)("div",{className:"text-sm text-gray-500",children:[u.length,"/3 drafts"]})]})}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["published"===c&&v.map(e=>(0,jt.jsx)("div",{onClick:()=>(e=>{console.log("Opening published collaboration:",e);const t=localStorage.getItem("mock_collaborations");if(t){const r=JSON.parse(t).find(t=>t.id===e.id);r?l("/tagme/collaboration/".concat(e.id),{state:{project:r}}):console.warn("Collaboration not found in storage:",e.id)}})(e),className:"cursor-pointer",children:(0,jt.jsx)(ja,{post:e})},e.id)),"drafts"===c&&(m?(0,jt.jsxs)("div",{className:"col-span-full text-center py-8",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-tag-purple mx-auto mb-4"}),(0,jt.jsx)("p",{className:"text-gray-500",children:"Loading drafts..."})]}):u.map(e=>(0,jt.jsx)("div",{onClick:()=>{return t=e,console.log("Opening draft for editing:",t),void l("/upload/form",{state:{activeUploadType:"collaboration",draftId:t.id,draftData:t.draftData,from:"draft-edit"}});var t},className:"cursor-pointer",children:(0,jt.jsx)(ja,{post:e,onDelete:w})},e.id)))]}),"published"===c&&0===v.length&&(0,jt.jsx)("div",{className:"text-center py-8",children:(0,jt.jsx)("p",{className:"text-gray-500",children:"No published collaborations yet."})}),"drafts"===c&&0===u.length&&(0,jt.jsx)("div",{className:"text-center py-8",children:(0,jt.jsx)("p",{className:"text-gray-500",children:"No draft collaborations yet."})}),"drafts"===c&&u.length>=3&&(0,jt.jsx)("div",{className:"col-span-full text-center py-4",children:(0,jt.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,jt.jsx)("div",{className:"text-orange-600 mb-2",children:(0,jt.jsx)("svg",{className:"w-6 h-6 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,jt.jsx)("p",{className:"text-orange-700 text-sm font-medium",children:"Draft limit reached (3/3)"}),(0,jt.jsx)("p",{className:"text-orange-600 text-xs mt-1",children:"Delete an existing draft to save a new one"})]})}),g&&(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-4xl mx-4 shadow-xl",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"What is Collaboration?"}),(0,jt.jsx)("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,jt.jsxs)("div",{className:"space-y-8 text-base text-gray-700",children:[(0,jt.jsxs)("div",{className:"flex items-start gap-5",children:[(0,jt.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mt-0.5",children:(0,jt.jsx)("span",{className:"text-purple-600 text-base font-bold",children:"1"})}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-3 text-lg",children:"Project Records"}),(0,jt.jsx)("p",{className:"text-gray-700 leading-relaxed",children:"Collaborations are shared project records that belong to all participants. Once published, they stay visible to ensure everyone's contributions are preserved."}),(0,jt.jsx)("p",{className:"text-gray-600 leading-relaxed mt-2 text-sm",children:"(You can always edit and update details, but the project itself remains as part of the team's history.)"})]})]}),(0,jt.jsxs)("div",{className:"flex items-start gap-5",children:[(0,jt.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mt-0.5",children:(0,jt.jsx)("span",{className:"text-purple-600 text-base font-bold",children:"2"})}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-3 text-lg",children:"Responsibilities"}),(0,jt.jsx)("p",{className:"text-gray-700 leading-relaxed",children:"Each member can describe their own responsibilities within a project. These should be written based on the team's discussion, so that everyone's role is represented fairly and clearly."})]})]}),(0,jt.jsxs)("div",{className:"flex items-start gap-5",children:[(0,jt.jsx)("div",{className:"flex-shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center mt-0.5",children:(0,jt.jsx)("span",{className:"text-purple-600 text-base font-bold",children:"3"})}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-3 text-lg",children:"Reviews"}),(0,jt.jsx)("p",{className:"text-gray-700 leading-relaxed",children:"After a project is completed, each Initiator or Collaborator will receive a review under their Responsibilities. Reviews from your teammates or project lead highlight your strengths, teamwork, and impact on the project."})]})]}),(0,jt.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6",children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-3 text-lg",children:"Additional Note on Collaborations Published & History:"}),(0,jt.jsx)("p",{className:"text-gray-700 leading-relaxed",children:"Any Collaboration you publish will first appear under the Published section. Only when the project is completed\u2014meaning you've received at least one Final Review from either an Initiator or a Collaborator\u2014will it be stored in your Collaboration History. At that point, it becomes part of your personal Experiences and represents a completed project record."})]})]}),(0,jt.jsx)("div",{className:"mt-8 border-t border-gray-200 pt-6",children:(0,jt.jsxs)("div",{className:"flex justify-between items-end",children:[(0,jt.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("p",{className:"mb-2",children:"If you have other questions, feel free to reach out:"}),(0,jt.jsxs)("div",{className:"space-y-1",children:[(0,jt.jsx)("div",{className:"font-medium",children:"Email: tag@rainwang.art"}),(0,jt.jsxs)("div",{className:"text-gray-500",children:["Founder of TAG:"," ",(0,jt.jsx)("span",{className:"font-bold",children:"Rain Wang"})]})]})]}),(0,jt.jsx)("div",{className:"text-right",children:(0,jt.jsx)("button",{onClick:()=>f(!1),className:"px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-200 text-base font-medium",children:"Got it"})})]})})]})})]})},Na=e=>{let{id:t,onBackClick:r,className:o=""}=e;return(0,jt.jsx)("div",{className:"bg-white min-h-screen flex items-center justify-center ".concat(o),children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"\u827a\u672f\u5bb6\u672a\u627e\u5230"}),(0,jt.jsxs)("p",{className:"text-gray-600 mb-6",children:["\u62b1\u6b49\uff0c\u627e\u4e0d\u5230ID\u4e3a ",t," \u7684\u827a\u672f\u5bb6\u3002"]}),(0,jt.jsx)("button",{onClick:r,className:"bg-blue-500 text-white px-6 py-2 rounded-md hover:bg-blue-600 transition-colors duration-200",children:"\u8fd4\u56de\u753b\u5eca"})]})})},Ca=t=>{let{type:o,targetId:s,onClose:n,currentUserId:i="alice"}=t;const l=ce(),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)(!0),[m,p]=(0,e.useState)(null),[g,f]=(0,e.useState)(!1),[v,x]=(0,e.useState)(null),[b,y]=(0,e.useState)(""),[w,j]=(0,e.useState)(null),[k,S]=(0,e.useState)({}),N=(0,e.useRef)(),C=(0,e.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{h(!0),p(null);const{getFollowers:t,getFollowing:a,getUserProfile:n,isFollowing:l}=await Promise.resolve().then(r.bind(r,240)),c={page:e?1:Math.floor((v||0)/20)+1,limit:20};let u;if(u="followers"===o?await t(s,c):await a(s,c),u.success){const t=u.data.map(e=>e.id),r=(await Promise.all(t.map(async e=>{const t=await n(e);if(t.success){let r=!1;if(i&&i!==e){const t=await l(i,e);t.success&&(r=t.isFollowing)}return{id:t.data.id,displayName:t.data.name||t.data.username||"Unknown User",avatar:t.data.avatar_url||"/assets/placeholder.svg",isFollowedByMe:r}}return null}))).filter(e=>null!==e),o=b.trim()?r.filter(e=>e.displayName.toLowerCase().includes(b.toLowerCase())):r;d(t=>e?o:[...t,...o]),f(20===u.data.length),x(e?20:(v||0)+20)}else p(u.error)}catch(t){p(t.message)}finally{h(!1)}},[o,s,v,b,i]);(0,e.useEffect)(()=>{w&&clearTimeout(w);const e=setTimeout(()=>{C(!0)},250);return j(e),()=>{e&&clearTimeout(e)}},[b]),(0,e.useEffect)(()=>{C(!0)},[o,s]);const _=(0,e.useCallback)(e=>{u||(N.current&&N.current.disconnect(),N.current=new IntersectionObserver(e=>{e[0].isIntersecting&&g&&C()}),e&&N.current.observe(e))},[u,g,C]),A=(e,t)=>{const s=t===c.length-1?_:null;return(0,jt.jsx)("div",{ref:s,className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow duration-200 cursor-pointer",onClick:()=>{return t=e.id,l("/artist/".concat(t)),void n();var t},children:(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)("img",{src:e.avatar,alt:e.displayName,className:"w-12 h-12 rounded-full object-cover"}),(0,jt.jsx)("div",{className:"flex-1 min-w-0",children:(0,jt.jsx)("h3",{className:"text-sm font-medium text-gray-900 truncate",children:e.displayName})}),(0,jt.jsx)("button",{onClick:t=>{t.stopPropagation(),(async(e,t)=>{try{S(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!0}));const{followUser:s,unfollowUser:n}=await Promise.resolve().then(r.bind(r,240)),l=i;let c;c=t?await n(l,e):await s(l,e),c.success?(d("following"===o&&t?t=>t.filter(t=>t.id!==e):r=>r.map(r=>r.id===e?(0,a.A)((0,a.A)({},r),{},{isFollowedByMe:!t}):r)),window.dispatchEvent(new CustomEvent("follow:changed",{detail:{followerId:l,followingId:e,isFollowing:!t,operation:t?"unfollow":"follow",type:o}})),console.log("[FollowList] Triggered follow:changed event - ".concat(t?"unfollow":"follow"," ").concat(e))):console.error("Follow toggle failed:",c.error)}catch(s){console.error("Follow toggle error:",s)}finally{S(t=>(0,a.A)((0,a.A)({},t),{},{[e]:!1}))}})(e.id,e.isFollowedByMe)},disabled:k[e.id],className:ga(e.isFollowedByMe),children:k[e.id]?(0,jt.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.isFollowedByMe?"Following":"Follow"})]})},e.id)};return(0,jt.jsxs)("div",{className:"h-full flex flex-col",children:[(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("input",{type:"text",placeholder:"Search ".concat(o,"..."),value:b,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),(0,jt.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[m?(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsxs)("p",{className:"text-red-500",children:["Error: ",m]}),(0,jt.jsx)("button",{onClick:()=>C(!0),className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Retry"})]}):0!==c.length||u?(0,jt.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:c.map((e,t)=>A(e,t))}):(0,jt.jsx)("div",{className:"text-center py-8",children:(0,jt.jsxs)("p",{className:"text-gray-500",children:["No ",o," found"]})}),u&&(0,jt.jsx)("div",{className:"text-center py-4",children:(0,jt.jsx)("div",{className:"inline-block w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})})]})]})},_a=t=>{let{isOpen:r,onClose:o,artistId:a,isOwnProfile:s=!1,currentUserId:n="alice"}=t;return(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&r&&o()};return r&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[r,o]),(0,jt.jsx)(Mt,{isOpen:r,onClose:o,title:"Followers",maxWidth:"max-w-3xl",children:(0,jt.jsx)("div",{className:"h-96",children:(0,jt.jsx)(Ca,{type:"followers",targetId:a,onClose:o,isOwnProfile:s,currentUserId:n})})})},Aa=t=>{let{isOpen:r,onClose:o,userId:a,isOwnProfile:s=!1,currentUserId:n="alice"}=t;return(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&r&&o()};return r&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[r,o]),(0,jt.jsx)(Mt,{isOpen:r,onClose:o,title:"Following",maxWidth:"max-w-3xl",children:(0,jt.jsx)("div",{className:"h-96",children:(0,jt.jsx)(Ca,{type:"following",targetId:a,onClose:o,isOwnProfile:s,currentUserId:n})})})},Ia=()=>{var t,r,o;const{id:s}=de(),n=ne(),{state:i}=Go(),{user:l}=St(),c="/me"===n.pathname||"/artist/me"===n.pathname,d=null!==(t=null===l||void 0===l||null===(r=l.id)||void 0===r||null===(o=r.toString)||void 0===o?void 0:o.call(r))&&void 0!==t?t:null,[u,h]=(0,e.useState)(null),[m,p]=(0,e.useState)([]),[g,f]=(0,e.useState)([]),[v,x]=(0,e.useState)(!0),[b,y]=(0,e.useState)(!1),[w,j]=(0,e.useState)(0),[k,S]=(0,e.useState)(null),N=(0,e.useMemo)(()=>{if(i.navigationHistory.length>0){const e=i.navigationHistory[i.navigationHistory.length-1];return{from:e.from||"gallery",activeTab:e.activeTab||"Works"}}return{from:"gallery",activeTab:"Works"}},[i.navigationHistory]);(0,e.useEffect)(()=>{s&&ha(["artist",s.toString()])},[s,null===l||void 0===l?void 0:l.id]),(0,e.useEffect)(()=>{const e=async e=>{const{userId:t,avatarUrl:r}=e.detail;if(t){console.log("[ArtistProfile] Avatar updated, clearing cache for user:",t),ha(["artist",t]);const e=c?d:null===s||void 0===s?void 0:s.toString();if(t===e){h(e=>(0,a.A)((0,a.A)({},e),{},{avatar:r}));const t=await pa(e);t&&h(t)}}};return window.addEventListener("avatar:updated",e),()=>window.removeEventListener("avatar:updated",e)},[d,s,c]),(0,e.useEffect)(()=>{const e=e=>{const t=e.detail;if(t&&t.id){console.log("[ArtistProfile] Profile updated, clearing cache for user:",t.id),ha(["artist",t.id]);const e=c?d:null===s||void 0===s?void 0:s.toString();t.id===e&&h(e=>(0,a.A)({},e))}};return window.addEventListener("profile:updated",e),()=>window.removeEventListener("profile:updated",e)},[d,s,c]),(0,e.useEffect)(()=>{const e=async e=>{const t=e.detail,r=c?d:null===s||void 0===s?void 0:s.toString();(null===t||void 0===t?void 0:t.id)===r&&h(e=>(0,a.A)((0,a.A)({},e),{},{title:t.title||(null===e||void 0===e?void 0:e.title),school:t.school||(null===e||void 0===e?void 0:e.school),pronouns:t.pronouns||(null===e||void 0===e?void 0:e.pronouns),majors:t.majors||(null===e||void 0===e?void 0:e.majors),minors:t.minors||(null===e||void 0===e?void 0:e.minors),skills:t.skills||(null===e||void 0===e?void 0:e.skills),bio:t.bio||(null===e||void 0===e?void 0:e.bio)}))};return window.addEventListener("profile:updated",e),()=>window.removeEventListener("profile:updated",e)},[d,s,c]),(0,e.useEffect)(()=>{window.scrollTo({top:0,behavior:"auto"})},[]),(0,e.useEffect)(()=>{let e=!0;const t=async()=>{x(!0),y(!1),j(0),S(null);let t=null;if(c?t=d:s&&(t=s.toString(),"me"===t&&(t=d)),t)try{const o=await pa(t);if(!e)return;if(o){var r;h(o);const e=await(0,sr.ep)(t);if(e.success){const t=await Promise.all(e.data.map(async e=>{const t=e.thumbnailPath||e.imagePaths&&e.imagePaths[0]||null;let r="/assets/placeholder.svg";if(t)try{console.log("[useArtistState] Converting image path: ".concat(t));const e=await(0,sr.getPortfolioImageUrl)(t);console.log("[useArtistState] Image conversion result:",e),e&&e.success&&e.data&&e.data.url?(r=e.data.url,console.log("[useArtistState] Successfully converted to: ".concat(r))):console.warn("[useArtistState] Invalid image result:",e)}catch(o){console.warn("[useArtistState] Failed to convert image path ".concat(t,":"),o)}return{id:e.id,title:e.title,image:r,category:e.category,tags:e.tags,description:e.description}}));p(t)}else p([]);const a=await(async e=>{try{console.log("[getCollaborationsData] Getting collaborations for userId:",e);const t=localStorage.getItem("mock_collaborations");if(!t)return console.log("[getCollaborationsData] No collaborations found in storage"),[];const r=JSON.parse(t);console.log("[getCollaborationsData] Found collaborations:",r.length);const o=r.filter(t=>t.author&&t.author.id===e);console.log("[getCollaborationsData] User collaborations:",o.length);const a=o.map(e=>{const t=new Date(e.createdAt),r=new Date,o=Math.floor((r-t)/2592e6);let a;a=0===o?"This month":1===o?"Last month":"".concat(o," months ago");let s="";return s=e.heroImage?e.heroImage.startsWith("collaboration_")?"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop":e.heroImage:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",{id:e.id,title:e.title,description:e.description,image:s,partner:"Team Members",partnerAvatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face",completionDate:"Created ".concat(a),category:e.projectType||"Collaboration",isInitiator:!0,role:"Project Owner \u2022 Initiator",dateRange:a,responsibility:"",teamFeedback:{feedbacker:"Team",feedbackerRole:"Collaborators",content:"This project is currently in progress. Team feedback will be available once the project is completed."}}});return console.log("[getCollaborationsData] Formatted collaborations:",a),a}catch(t){return console.error("[getCollaborationsData] Error getting collaborations:",t),[]}})(t);f(a),void 0!==(null===o||void 0===o||null===(r=o.stats)||void 0===r?void 0:r.followers)&&j(o.stats.followers)}else h(null),p([]),f([])}catch(o){h(null),p([]),f([])}finally{e&&x(!1)}else x(!1)};return(c||s)&&t(),()=>{e=!1}},[s,c,d]);const C=(0,e.useMemo)(()=>!!c||"me"===s,[c,s]),_=(0,e.useMemo)(()=>!(c||!s||!d||s.toString()!==d.toString()),[c,s,d]),A=(0,e.useCallback)(()=>{y(e=>!e),j(e=>b?e-1:e+1)},[b]);return{loading:v,currentUser:l,artist:u,artworks:m,collaborations:g,isFollowing:b,setIsFollowing:y,followersCount:w,expandedCardId:k,isOwnProfile:C,shouldShowBackToOwnerView:_,sourceInfo:N,setFollowersCount:j,setExpandedCardId:S,toggleFollow:A,toggleExpandedCard:e=>{S(t=>t===e?null:e)}}},Pa=t=>{var r;let{state:o,setters:a}=t;const s=ce(),{goBack:n,navigateToWork:i}=Xo();return{handleBackClick:(0,e.useCallback)(()=>{n()},[n]),handleEditProfileClick:(0,e.useCallback)(()=>{s("/settings/edit-profile")},[s]),handlePreviewAsVisitorClick:(0,e.useCallback)(()=>{var e;const t=null===(e=o.currentUser)||void 0===e?void 0:e.id;t&&s("/artist/".concat(t))},[s,null===(r=o.currentUser)||void 0===r?void 0:r.id]),handleBackToOwnerViewClick:(0,e.useCallback)(()=>{s("/artist/me")},[s]),handleArtworkClick:(0,e.useCallback)(e=>{e&&e.id&&i(e.id)},[i]),handleCollaborationToggle:(0,e.useCallback)(e=>{a.toggleExpandedCard(e)},[a]),handleSocialLinkClick:(0,e.useCallback)(()=>{},[])}},Ea=t=>{const{user:r}=St(),[o,a]=(0,e.useState)(0),[s,n]=(0,e.useState)(null),[i,l]=(0,e.useState)(!1),c=!(null===r||void 0===r||!r.id),d=(0,e.useCallback)(async()=>{if(t&&c&&!i)if(r.id!==t)if(null!==s)try{l(!0),console.log("[FollowCount] Toggling follow for artist:",t,"User:",r.id,"Current state:",s);const i=s;let c;if(c=i?await(0,Dr.unfollowUser)(r.id,t):await(0,Dr.followUser)(r.id,t),c.success){const s=!i;n(s);const l=await(0,Dr.getFollowers)(t);l.success&&a(l.data.length),console.log("[FollowCount] Follow toggled successfully:",s?"Following":"Unfollowing");const c=new CustomEvent("follow:changed",{detail:{followerId:r.id,artistId:t,isFollowing:s,operation:s?"follow":"unfollow"}});if(window.dispatchEvent(c),s)try{const e=await po(r.id),o=e.success&&e.data.fullName?e.data.fullName:r.name||r.username||"Unknown User";await Jr.createFollowNotification(r.id,o,t),console.log("[FollowCount] Created follow notification")}catch(e){console.error("[FollowCount] Failed to create follow notification:",e)}window.dispatchEvent(new CustomEvent("follow:changed",{detail:{followerId:r.id,artistId:t,isFollowing:s,followersCount:l.success?l.data.length:o}}))}else console.error("[FollowCount] Failed to toggle follow:",c.error)}catch(e){console.error("[FollowCount] Error toggling follow:",e)}finally{l(!1)}else console.log("[FollowCount] Follow status not loaded yet, skipping toggle");else console.warn("[FollowCount] Cannot follow yourself")},[t,c,null===r||void 0===r?void 0:r.id,null===r||void 0===r?void 0:r.name,null===r||void 0===r?void 0:r.username,i,s]),u=(0,e.useCallback)(async()=>{if(t&&c)try{const e=await(0,Dr.isFollowing)(r.id,t);if(!e.success)return void console.error("[FollowCount] Failed to check follow status:",e.error);const o=await(0,Dr.getFollowers)(t);if(!o.success)return void console.error("[FollowCount] Failed to get followers count:",o.error);a(o.data.length),n(e.isFollowing),console.log("[FollowCount] Refreshed follow status:",e.isFollowing?"Following":"Not following","Followers count:",o.data.length)}catch(e){console.error("[FollowCount] Error refreshing follow status:",e)}},[t,c,null===r||void 0===r?void 0:r.id]),h=(0,e.useCallback)(async()=>{if(t)try{const e=await(0,Dr.getFollowers)(t);e.success?(a(e.data.length),console.log("[FollowCount] Refreshed followers count:",e.data.length)):console.error("[FollowCount] Failed to refresh followers count:",e.error)}catch(e){console.error("[FollowCount] Error refreshing followers count:",e)}},[t]);return(0,e.useEffect)(()=>{const e=e=>{const{followerId:o,artistId:a,isFollowing:s}=e.detail;a===t&&(o===(null===r||void 0===r?void 0:r.id)&&n(s),h())};return window.addEventListener("follow:changed",e),()=>{window.removeEventListener("follow:changed",e)}},[t,null===r||void 0===r?void 0:r.id,h]),(0,e.useEffect)(()=>{t&&c&&u()},[t,c,u]),(0,e.useEffect)(()=>{n(null),l(!1),a(0)},[t,null===r||void 0===r?void 0:r.id]),{followersCount:o,isFollowing:s,isToggling:i,toggleFollow:d,refreshFollowStatus:u,refreshFollowersCount:h}},Da=t=>{const[r,o]=(0,e.useState)(0),[a,s]=(0,e.useState)(!1),n=(0,e.useCallback)(async()=>{if(t)try{s(!0);const e=await(0,Dr.getFollowing)(t);e.success?(o(e.data.length),console.log("[FollowingCount] Refreshed following count:",e.data.length)):console.error("[FollowingCount] Failed to refresh following count:",e.error)}catch(e){console.error("[FollowingCount] Error refreshing following count:",e)}finally{s(!1)}},[t]);return(0,e.useEffect)(()=>{const e=e=>{const{followerId:r}=e.detail;r===t&&n()};return window.addEventListener("follow:changed",e),()=>{window.removeEventListener("follow:changed",e)}},[t,n]),(0,e.useEffect)(()=>{t&&n()},[t,n]),{followingCount:r,isLoading:a,refreshFollowingCount:n}},La=()=>{var t,r,o,a,s,n,i,l,c,d,u,h,m,p;const{id:g}=de(),{user:f,loading:v,status:x}=St(),b=Ia(),y=(0,e.useMemo)(()=>({toggleFollow:b.toggleFollow,toggleExpandedCard:b.toggleExpandedCard}),[b.toggleFollow,b.toggleExpandedCard]),w=Pa({state:b,setters:y}),j=Ea(null===(t=b.artist)||void 0===t?void 0:t.id,b.followersCount),k=Da(b.isOwnProfile?null===(r=b.currentUser)||void 0===r?void 0:r.id:null===(o=b.artist)||void 0===o?void 0:o.id),[S,N]=e.useState(!1),[C,_]=e.useState(!1);if(e.useEffect(()=>{const e=e=>{var t;const{followerId:r,followingId:o,isFollowing:a,operation:s,type:n}=e.detail;console.log("[ArtistProfile] Received follow:changed event:",{followerId:r,followingId:o,isFollowing:a,operation:s,type:n}),r===(null===f||void 0===f?void 0:f.id)&&(console.log("[ArtistProfile] Current user performed follow operation, refreshing following count"),k.refresh&&k.refresh()),o===(null===(t=b.artist)||void 0===t?void 0:t.id)&&(console.log("[ArtistProfile] Current artist was followed/unfollowed, refreshing followers count"),j.refresh&&j.refresh())};return window.addEventListener("follow:changed",e),()=>{window.removeEventListener("follow:changed",e)}},[null===f||void 0===f?void 0:f.id,null===(a=b.artist)||void 0===a?void 0:a.id,k,j]),v)return(0,jt.jsx)(Wt,{});if("me"===g){if("SIGNED_OUT"===x)return window.location.href="/login",(0,jt.jsx)(Wt,{});if("LOADING"===x)return(0,jt.jsx)(Wt,{});if("SIGNED_IN"===x&&(null===f||void 0===f||!f.id))return(0,jt.jsx)(Wt,{})}if(b.loading)return(0,jt.jsx)(Wt,{});return(A=b.artist)&&A.id&&A.name?(0,jt.jsxs)("div",{className:"bg-white min-h-screen",children:[(0,jt.jsx)(va,{artist:b.artist,artworks:b.artworks,isFollowing:j.isFollowing,followersCount:j.followersCount,followingCount:k.followingCount,isOwnProfile:b.isOwnProfile,onBackClick:w.handleBackClick,onEditProfileClick:w.handleEditProfileClick,onPreviewAsVisitorClick:w.handlePreviewAsVisitorClick,onBackToOwnerViewClick:b.shouldShowBackToOwnerView?w.handleBackToOwnerViewClick:null,toggleFollow:j.toggleFollow,onFollowersClick:()=>{N(!0)},onFollowingClick:()=>{_(!0)},from:(null===(n=b.sourceInfo)||void 0===n?void 0:n.from)||"gallery"}),(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,jt.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8 pt-8",children:[(0,jt.jsx)(ya,{artist:b.artist,onSocialLinkClick:w.handleSocialLinkClick}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)(wa,{artworks:b.artworks,onArtworkClick:w.handleArtworkClick,isOwnProfile:b.isOwnProfile}),(0,jt.jsx)(Sa,{collaborations:b.collaborations,expandedCardId:b.expandedCardId,onCollaborationToggle:w.handleCollaborationToggle,currentUserId:null===(i=b.currentUser)||void 0===i?void 0:i.id,viewedUserId:null===(l=b.artist)||void 0===l?void 0:l.id}),(0,jt.jsx)("div",{className:"mt-8",children:(0,jt.jsx)(ca,{isOwnProfile:b.isOwnProfile,viewedUserId:null===(c=b.artist)||void 0===c?void 0:c.id})})]})]})}),(0,jt.jsx)(_a,{isOpen:S,onClose:()=>{N(!1)},artistId:null===(d=b.artist)||void 0===d?void 0:d.id,isOwnProfile:b.isOwnProfile,currentUserId:null===(u=b.currentUser)||void 0===u?void 0:u.id}),(0,jt.jsx)(Aa,{isOpen:C,onClose:()=>{_(!1)},userId:b.isOwnProfile?null===(h=b.currentUser)||void 0===h?void 0:h.id:null===(m=b.artist)||void 0===m?void 0:m.id,isOwnProfile:b.isOwnProfile,currentUserId:null===(p=b.currentUser)||void 0===p?void 0:p.id})]},"".concat(g,"-").concat(null!==(s=null===f||void 0===f?void 0:f.id)&&void 0!==s?s:"anonymous")):(0,jt.jsx)(Na,{id:g,onBackClick:w.handleBackClick});var A},Ta=()=>{ce();const[t,r]=(0,e.useState)(null),o=()=>{const e=document.querySelector('[data-section="gallery"]');if(e){const t=e.getBoundingClientRect(),r=window.pageYOffset+t.top-40;window.scrollTo({top:r,behavior:"smooth"})}};return(0,jt.jsx)("section",{className:"relative min-h-[560px] lg:min-h-[640px] overflow-hidden",children:(0,jt.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,jt.jsx)("div",{className:"relative w-full lg:w-1/2 bg-gradient-to-b from-blue-600 to-blue-700 min-h-[560px] lg:min-h-[640px] flex items-start justify-center px-8 lg:px-8 pt-20 lg:pt-24 pb-16 lg:pb-20 cursor-pointer transition-all duration-500 ease-out",style:{width:window.innerWidth>=1024?"blue"===t?"80%":"purple"===t?"20%":"50%":"100%",transitionTimingFunction:"cubic-bezier(.22,.61,.36,1)"},onClick:o,onKeyDown:e=>((e,t)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),t())})(e,o),onMouseEnter:()=>r("blue"),onMouseLeave:()=>r(null),role:"link",tabIndex:0,children:(0,jt.jsxs)("div",{className:"flex flex-col items-end max-w-md gap-6 lg:pr-0",children:[(0,jt.jsxs)("div",{className:"leading-[0.8]",children:[(0,jt.jsx)("h1",{className:"text-white font-black uppercase tracking-[-0.03em]",style:{fontSize:"clamp(56px, 7vw, 96px)",fontFamily:"Poppins, Inter, system-ui, sans-serif",textRendering:"optimizeLegibility"},children:"TAG"}),(0,jt.jsx)("h1",{className:"text-blue-200 font-black tracking-[-0.03em]",style:{fontSize:"clamp(32px, 4vw, 56px)",fontFamily:"Poppins, Inter, system-ui, sans-serif",textRendering:"optimizeLegibility"},children:"Gallery"})]}),(0,jt.jsxs)("div",{className:"space-y-2 mt-6 md:mt-8 text-right",children:[(0,jt.jsx)("p",{className:"text-white/95 font-semibold leading-tight",style:{fontSize:"clamp(20px, 2.2vw, 28px)"},children:"Show your work"}),(0,jt.jsx)("p",{className:"text-white/95 font-semibold leading-tight",style:{fontSize:"clamp(20px, 2.2vw, 28px)"},children:"Get hired!"})]}),(0,jt.jsx)("p",{className:"text-white text-lg opacity-80 leading-relaxed text-right",children:"Explore TAG Gallery"})]})}),(0,jt.jsx)(mt,{to:"/tagme",className:"relative w-full lg:w-1/2 bg-gradient-to-b from-purple-600 to-purple-700 min-h-[560px] lg:min-h-[640px] flex items-start justify-center px-8 lg:px-8 pt-20 lg:pt-24 pb-16 lg:pb-20 cursor-pointer transition-all duration-500 ease-out",style:{width:window.innerWidth>=1024?"blue"===t?"20%":"purple"===t?"80%":"50%":"100%",transitionTimingFunction:"cubic-bezier(.22,.61,.36,1)"},onMouseEnter:()=>r("purple"),onMouseLeave:()=>r(null),children:(0,jt.jsxs)("div",{className:"flex flex-col items-start max-w-md gap-6 lg:pl-0",children:[(0,jt.jsxs)("div",{className:"leading-[0.8]",children:[(0,jt.jsx)("h1",{className:"text-white font-black uppercase tracking-[-0.03em]",style:{fontSize:"clamp(56px, 7vw, 96px)",fontFamily:"Poppins, Inter, system-ui, sans-serif",textRendering:"optimizeLegibility"},children:"TAG"}),(0,jt.jsx)("h1",{className:"text-purple-200 font-black tracking-[-0.03em]",style:{fontSize:"clamp(48px, 6vw, 80px)",fontFamily:"Poppins, Inter, system-ui, sans-serif",textRendering:"optimizeLegibility"},children:"Me"})]}),(0,jt.jsxs)("div",{className:"space-y-2 mt-6 md:mt-8",children:[(0,jt.jsx)("p",{className:"text-white/95 font-semibold leading-tight",style:{fontSize:"clamp(20px, 2.2vw, 28px)"},children:"Find your team"}),(0,jt.jsx)("p",{className:"text-white/95 font-semibold leading-tight",style:{fontSize:"clamp(20px, 2.2vw, 28px)"},children:"Build experience!"})]}),(0,jt.jsx)("p",{className:"text-white text-lg opacity-80 leading-relaxed",children:"Explore TAGMe"})]})})]})})},Ma="applications",Fa=async e=>{try{const t="".concat(Ma,"_").concat(e),r=localStorage.getItem(t);if(!r)return console.log("[applicationService] No applications data found for collaboration ".concat(e)),null;const o=JSON.parse(r);return console.log("[applicationService] Retrieved applications data for collaboration ".concat(e,":"),o),o.applications||null}catch(t){return console.error("[applicationService] Failed to get applications data:",t),null}},Ra=async(e,t)=>{try{const r="".concat(Ma,"_").concat(e),o={applications:t,timestamp:Date.now()};return localStorage.setItem(r,JSON.stringify(o)),console.log("[applicationService] Saved applications data for collaboration ".concat(e,":"),t),{success:!0,data:o}}catch(r){return console.error("[applicationService] Failed to save applications data:",r),{success:!1,error:r.message}}},Oa={getApplicationsData:Fa,saveApplicationsData:Ra,addApplication:async(e,t,r)=>{try{const o=await Fa(e)||{},s=o[t]||[];if(s.findIndex(e=>e.userId===r.userId)>=0)return console.log("[applicationService] User ".concat(r.userId," already applied for position ").concat(t)),{success:!1,error:"Already applied"};const n=(0,a.A)((0,a.A)({},r),{},{id:Date.now(),appliedAt:"Just now",status:"pending",positionId:t});s.push(n),o[t]=s;return(await Ra(e,o)).success?(console.log("[applicationService] Added application for user ".concat(r.userId," to position ").concat(t)),{success:!0,data:n}):{success:!1,error:"Failed to save application"}}catch(o){return console.error("[applicationService] Failed to add application:",o),{success:!1,error:o.message}}},updateApplicationStatus:async(e,t,r,o)=>{try{const a=await Fa(e)||{},s=a[t]||[],n=s.findIndex(e=>e.userId===r||e.id===r);if(-1===n)return console.log("[applicationService] Application not found for user ".concat(r," in position ").concat(t)),{success:!1,error:"Application not found"};s[n].status=o,a[t]=s;return(await Ra(e,a)).success?(console.log("[applicationService] Updated application status to ".concat(o," for user ").concat(r," in position ").concat(t)),{success:!0,data:s[n]}):{success:!1,error:"Failed to save status update"}}catch(a){return console.error("[applicationService] Failed to update application status:",a),{success:!1,error:a.message}}},removeApplication:async(e,t,r)=>{try{const o=await Fa(e)||{},a=o[t]||[],s=a.findIndex(e=>e.userId===r||e.id===r);if(-1===s)return console.log("[applicationService] Application not found for user ".concat(r," in position ").concat(t)),{success:!1,error:"Application not found"};const n=a.splice(s,1)[0];o[t]=a;return(await Ra(e,o)).success?(console.log("[applicationService] Removed application for user ".concat(r," from position ").concat(t)),{success:!0,data:n}):{success:!1,error:"Failed to save removal"}}catch(o){return console.error("[applicationService] Failed to remove application:",o),{success:!1,error:o.message}}},updateApplicationUserName:async(e,t)=>{try{const o=Object.keys(localStorage).filter(e=>e.startsWith(Ma));let a=0;for(const s of o)try{const r=localStorage.getItem(s);if(!r)continue;const o=JSON.parse(r),n=o.applications;if(!n)continue;let i=!1;Object.keys(n).forEach(r=>{n[r].forEach(r=>{r.userId===e&&r.name!==t&&(r.name=t,i=!0)})}),i&&(o.applications=n,localStorage.setItem(s,JSON.stringify(o)),a++)}catch(r){console.warn("[applicationService] Failed to update key ".concat(s,":"),r)}return console.log("[applicationService] Updated application user name to ".concat(t," for user ").concat(e," in ").concat(a," collaborations")),{success:!0,updatedCount:a}}catch(r){return console.error("[applicationService] Failed to update application user name:",r),{success:!1,error:r.message}}},clearApplicationsData:async()=>{try{const e=Object.keys(localStorage).filter(e=>e.startsWith(Ma));return e.forEach(e=>{localStorage.removeItem(e)}),console.log("[applicationService] Cleared ".concat(e.length," application data entries")),{success:!0,clearedCount:e.length}}catch(e){return console.error("[applicationService] Failed to clear applications data:",e),{success:!1,error:e.message}}}},Ua=Oa,za="applicationStatus",Wa=(e,t)=>{try{const r="".concat(za,":").concat(e,":").concat(t),o=localStorage.getItem(r);if(!o)return console.log("[applicationStorage] No status found for position ".concat(e,", applicant ").concat(t)),null;const a=JSON.parse(o);return console.log("[applicationStorage] Retrieved status: ".concat(a.status," for position ").concat(e,", applicant ").concat(t)),a.status}catch(r){return console.error("[applicationStorage] Failed to get application status:",r),null}},Ba=t=>{let{isOpen:r,onClose:o,application:a,onApprove:s,onContact:n,isInitiator:i=!1,anchorElement:l,positionId:c,positions:d}=t;const[u,h]=(0,e.useState)(!1),m=(0,e.useRef)(null),p=e.useMemo(()=>{console.log("[ApplicationInfoPopover] Checking approval status..."),console.log("[ApplicationInfoPopover] Application:",a),console.log("[ApplicationInfoPopover] Application type:",typeof a),console.log("[ApplicationInfoPopover] Application keys:",a?Object.keys(a):"null"),console.log("[ApplicationInfoPopover] Position ID:",c),console.log("[ApplicationInfoPopover] Positions:",d),console.log("[ApplicationInfoPopover] Application status:",null===a||void 0===a?void 0:a.status);const e=(null===a||void 0===a?void 0:a.id)||(null===a||void 0===a?void 0:a.userId);if(c&&e){const t=((e,t)=>"approved"===Wa(e,t))(c,e);if(t)return console.log("[ApplicationInfoPopover] Application is approved in storage"),!0}if("approved"===(null===a||void 0===a?void 0:a.status))return console.log("[ApplicationInfoPopover] Application is already approved"),!0;if(c&&d){const e=d.find(e=>e.id===c);if(e&&e.applications){const t=e.applications.find(e=>e.id===(null===a||void 0===a?void 0:a.id)||e.userId===(null===a||void 0===a?void 0:a.userId));if(console.log("[ApplicationInfoPopover] App in position:",t),console.log("[ApplicationInfoPopover] App status in position:",null===t||void 0===t?void 0:t.status),"approved"===(null===t||void 0===t?void 0:t.status))return console.log("[ApplicationInfoPopover] App is approved in this specific position"),!0}}return c||"approved"!==(null===a||void 0===a?void 0:a.status)?(console.log("[ApplicationInfoPopover] Application is not approved for this position"),!1):(console.log("[ApplicationInfoPopover] No positionId, but application is approved"),!0)},[a,c,d]);console.log("[ApplicationInfoPopover] Application status:",null===a||void 0===a?void 0:a.status),console.log("[ApplicationInfoPopover] Position ID:",c),console.log("[ApplicationInfoPopover] Is approved:",p),(0,e.useEffect)(()=>{const e=e=>{!m.current||m.current.contains(e.target)||null!==l&&void 0!==l&&l.contains(e.target)||o()};if(r)return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[r,o,l]);if(!r||!a||!l)return null;const g=()=>{if(a.email)try{const e="mailto:".concat(a.email);window.open(e,"_blank"),console.log("[ApplicationInfoPopover] Opening mailto link:",e),setTimeout(()=>{console.log("[ApplicationInfoPopover] Mailto link should have opened")},100)}catch(e){console.error("[ApplicationInfoPopover] Failed to open mailto link:",e),navigator.clipboard.writeText(a.email).then(()=>{alert("Email address copied to clipboard: ".concat(a.email))}).catch(()=>{alert("Please copy this email address: ".concat(a.email))})}else console.warn("[ApplicationInfoPopover] No email address available");null===n||void 0===n||n()};return(0,jt.jsxs)("div",{ref:m,style:(()=>{if(!l)return{};const e=l.getBoundingClientRect(),t=window.pageYOffset||document.documentElement.scrollTop,r=window.pageXOffset||document.documentElement.scrollLeft;return{position:"absolute",top:e.bottom+t+8,left:e.left+r-150,zIndex:1e3}})(),className:"bg-white rounded-lg shadow-xl border border-gray-200 w-80 max-w-sm",children:[(0,jt.jsx)("div",{className:"absolute -top-2 left-6 w-4 h-4 bg-white border-l border-t border-gray-200 transform rotate-45"}),(0,jt.jsxs)("div",{className:"p-4 space-y-4",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Application Details"}),(0,jt.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,jt.jsx)("img",{src:a.avatar||"/assets/placeholder.svg",alt:a.name,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-200"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:a.name}),(0,jt.jsxs)("p",{className:"text-sm text-gray-500",children:["Applied on"," ",new Date(a.timestamp||Date.now()).toLocaleDateString()]})]})]}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,jt.jsx)("a",{href:"mailto:".concat(a.email),className:"text-purple-600 hover:text-purple-700 underline text-sm",onClick:e=>{e.preventDefault(),g()},children:a.email})]}),a.portfolio&&(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Portfolio"}),(0,jt.jsx)("a",{href:a.portfolio.startsWith("http")?a.portfolio:"https://".concat(a.portfolio),target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:text-purple-700 underline break-all text-sm",children:a.portfolio})]}),a.message&&(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,jt.jsx)("div",{className:"bg-gray-50 rounded-lg p-3",children:(0,jt.jsx)("p",{className:"text-gray-900 whitespace-pre-wrap text-sm",children:a.message})})]})]}),i&&(0,jt.jsxs)("div",{className:"flex gap-2 pt-2",children:[(0,jt.jsx)(Lt,{onClick:g,className:"flex-1 text-sm py-2",children:"Contact"}),(0,jt.jsx)(Dt,{onClick:()=>{h(!0)},disabled:p,className:"flex-1 text-sm py-2 transition-all duration-300 ".concat(p?"bg-green-100 text-green-800 border border-green-300 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700"),title:p?"Already approved for this position":"Approve this application for this position",children:p?"\u2713 Approved":"Approve"})]}),u&&(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Confirm Approval"}),(0,jt.jsxs)("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to approve"," ",(0,jt.jsx)("span",{className:"font-medium",children:a.name})," for this position? This action cannot be undone."]}),(0,jt.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,jt.jsx)(Lt,{onClick:()=>{h(!1)},className:"px-4 py-2",children:"Cancel"}),(0,jt.jsx)(Dt,{onClick:()=>{console.log("[ApplicationInfoPopover] Confirming approval for:",a.name,"position:",c),null===s||void 0===s||s(a,c),h(!1),console.log("[ApplicationInfoPopover] Application approved successfully")},className:"px-4 py-2 bg-green-600 hover:bg-green-700",children:"Confirm Approve"})]})]})})]})]})},Ga=e=>{let{isOpen:t,onClose:r,applyForm:o,onFormChange:a,onSubmit:s}=e;return(0,jt.jsx)(Mt,{isOpen:t,onClose:r,title:"Apply for Project",maxWidth:"max-w-md",children:(0,jt.jsxs)("form",{onSubmit:s,className:"space-y-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),(0,jt.jsx)("input",{id:"email",type:"email",name:"email",value:o.email,onChange:a,required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"your.email@example.com"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"portfolio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Portfolio Link"}),(0,jt.jsx)("input",{id:"portfolio",type:"text",name:"portfolio",value:o.portfolio,onChange:a,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"your-portfolio.com or any link"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-1",children:"Message"}),(0,jt.jsx)("textarea",{id:"message",name:"message",value:o.message,onChange:a,rows:"3",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"Tell us why you'd like to join this project..."}),(0,jt.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"All information you submit, including your message, will remain private and only accessible to the project initiator."})]}),(0,jt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,jt.jsxs)("div",{className:"flex items-start gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-yellow-800",children:"Important: One-time submission only"}),(0,jt.jsx)("p",{className:"text-xs text-yellow-700 mt-1",children:"Please review your information carefully before submitting. You cannot edit your application after submission."})]})]})}),(0,jt.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,jt.jsx)(Lt,{type:"button",onClick:r,fullWidth:!0,className:"flex-1",children:"Cancel"}),(0,jt.jsx)(Dt,{type:"submit",fullWidth:!0,className:"flex-1",children:"Submit Application"})]})]})})};var Ha=r(337);const qa=e=>{let{projectId:t,milestones:r=[],dueDate:o,onViewMilestones:a,isMilestonePage:s=!1,isInitiator:n=!1}=e;const i=r.length,l=r.filter(e=>["done","completed"].includes(e.status)).length,c=Math.round(l/Math.max(i,1)*100),d=i>0,u=d?"Completed ".concat(l," / ").concat(i," milestones"):"No milestones created yet",h=d?"View Milestones":n?"Create Milestones":"Milestones Locked",m=!d&&!n,p=()=>{d&&a&&!s?a(t):!d&&n&&(console.log("Initiator can create milestones for project:",t),window.location.href="/upload/form?tab=milestones")};return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8 w-full",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"Project Progress"}),o&&"Not specified"!==o&&""!==o&&(0,jt.jsxs)("span",{className:"text-sm text-gray-600 mr-4",children:["Deadline: ",o]})]}),d?(0,jt.jsxs)("div",{className:"flex items-center gap-4 ".concat(s?"":"cursor-pointer hover:bg-gray-50 p-3 rounded-lg transition-colors duration-200"),onClick:s?void 0:p,role:s?void 0:"button",tabIndex:s?void 0:0,onKeyDown:s?void 0:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),p())},"aria-label":s?void 0:"".concat(u," \xb7 Click to view milestone details"),children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,jt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:u}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[c,"%"]})]}),(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":c,"aria-label":"Project progress: ".concat(c,"%"),children:(0,jt.jsx)("div",{className:"h-full bg-purple-600 transition-all duration-300 ease-in-out",style:{width:"".concat(c,"%")}})})]}),!s&&(0,jt.jsx)("button",{onClick:e=>{e.stopPropagation(),p()},className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 bg-purple-600 text-white hover:bg-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1","aria-label":"View milestone details",children:h})]}):(0,jt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,jt.jsx)("span",{className:"text-sm font-medium text-gray-400",children:u}),(0,jt.jsx)("span",{className:"text-sm text-gray-400",children:"0%"})]}),(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"0","aria-label":"Project progress: 0% (disabled - no milestones)",children:(0,jt.jsx)("div",{className:"h-full bg-gray-400 transition-all duration-300 ease-in-out",style:{width:"0%"}})})]}),!s&&(0,jt.jsx)("button",{disabled:m,onClick:e=>{e.stopPropagation(),p()},className:"px-4 py-2 rounded-lg font-medium transition-all duration-200 ".concat(n&&!d?"bg-purple-600 text-white hover:bg-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1":m?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-purple-600 text-white hover:bg-purple-700 shadow-lg hover:shadow-xl transform hover:-translate-y-1"),"aria-label":m?"No milestones available":"Create milestones",children:h})]}),!d&&(0,jt.jsx)("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,jt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,jt.jsx)("div",{children:(0,jt.jsx)("p",{className:"text-yellow-800 text-base font-semibold mb-1",children:"Set up Milestones now to unlock Project Progress and open the Discussion Board! (Only Initiator can create milestones)"})})]})})]})},Va=t=>{let{imageKey:r,alt:o="Collaboration hero image",className:a="w-full h-full object-cover"}=t;const[s,n]=(0,e.useState)(null),[i,l]=(0,e.useState)(!1),[c,d]=(0,e.useState)(!1);return(0,e.useEffect)(()=>((async()=>{if(!r)return n(null),void d(!1);l(!0),d(!1);try{console.log("[CollaborationHeaderImage] Loading image for key: ".concat(r));const e=await Ha.default.getImageUrl(r);e?(console.log("[CollaborationHeaderImage] Successfully loaded image: ".concat(e.substring(0,50),"...")),n(e)):(console.warn("[CollaborationHeaderImage] No image URL returned for key: ".concat(r)),d(!0))}catch(e){console.warn("[CollaborationHeaderImage] Failed to load image: ".concat(r),e),d(!0)}finally{l(!1)}})(),()=>{s&&s.startsWith("blob:")&&(console.log("[CollaborationHeaderImage] Cleaning up blob URL: ".concat(s.substring(0,50),"...")),URL.revokeObjectURL(s))}),[r]),i?(0,jt.jsx)("div",{className:"w-full h-full bg-gradient-to-r from-purple-600 to-purple-700 flex items-center justify-center",children:(0,jt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}):c||!s?(0,jt.jsx)("div",{className:"w-full h-full bg-gradient-to-r from-purple-600 to-purple-700"}):(0,jt.jsx)("img",{src:s,alt:o,className:a,onError:e=>{console.warn("[CollaborationHeaderImage] Image failed to load: ".concat(s.substring(0,50),"...")),e.target.style.display="none"}})},Ja=e=>{var t,r,o;let{project:a,isSaved:s,onBack:n,onSaveToggle:i,onApplyNow:l,onViewMilestones:c,enableProjectProgressBar:d=!0,hasSubmittedApplication:u=!1}=e;const h=(0,Lr.HW)();console.log("[CollaborationHeader] project:",a),console.log("[CollaborationHeader] project.deadline (raw):",null===a||void 0===a?void 0:a.deadline);const m=(null===a||void 0===a?void 0:a.deadline)||(null===a||void 0===a?void 0:a.applicationDeadline)||"",p=!!m&&""!==m.trim(),g=m||"";console.log("[CollaborationHeader] deadline\u663e\u793a\u6761\u4ef6:",{rawDeadline:null===a||void 0===a?void 0:a.deadline,applicationDeadline:null===a||void 0===a?void 0:a.applicationDeadline,deadlineValue:m,deadlineDisplayText:g,shouldShowDeadline:p,hasDeadline:!!m,notEmpty:""!==(null===m||void 0===m?void 0:m.trim()),deadlineType:typeof m,deadlineLength:null===m||void 0===m?void 0:m.length});const f=(null===h||void 0===h?void 0:h.id)===(null===(t=a.author)||void 0===t?void 0:t.id);return(0,jt.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,jt.jsx)(Ot,{onClick:n,text:"Back to TAGMe",className:"mb-6"}),(0,jt.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[(0,jt.jsx)("button",{onClick:n,className:"hover:text-tag-blue transition-colors duration-200",children:"Collaborations"}),(0,jt.jsx)("span",{className:"mx-2",children:"/"}),(0,jt.jsx)("span",{className:"text-gray-900 font-medium",children:a.title})]}),(0,jt.jsx)("div",{className:"relative mb-6",children:(0,jt.jsx)("div",{className:"w-full h-48 bg-gradient-to-r from-purple-600 to-purple-700 rounded-lg overflow-hidden relative",children:a.heroImage?(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)(Va,{imageKey:a.heroImage,alt:a.title}),(0,jt.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/30 to-purple-700/30"})]}):(0,jt.jsx)("div",{className:"w-full h-full bg-gradient-to-r from-purple-600 to-purple-700"})})}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:a.title}),(0,jt.jsxs)("div",{className:"flex flex-wrap items-center gap-6 mb-4 text-sm text-gray-600",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,jt.jsx)("span",{children:a.postedTime})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,jt.jsxs)("span",{children:["Deadline:"," ",(null===a||void 0===a?void 0:a.applicationDeadline)||(null===a||void 0===a?void 0:a.deadline)||"Flexible"]})]}),(null===(r=a.contactInfo)||void 0===r?void 0:r.email)&&(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,jt.jsx)("span",{className:"text-gray-600",children:a.contactInfo.email})]}),(null===(o=a.contactInfo)||void 0===o?void 0:o.discord)&&(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"})}),(0,jt.jsx)("span",{className:"text-gray-600",children:a.contactInfo.discord})]})]}),(0,jt.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:a.tags.map((e,t)=>(0,jt.jsx)("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full",children:e},t))}),(0,jt.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,jt.jsx)(Rt,{isFavorited:s,itemType:"collaboration",itemId:a.id,onToggle:i,size:"md"}),!f&&(0,jt.jsx)(Dt,{onClick:u?void 0:l,size:"lg",disabled:u,className:"w-full sm:w-auto transition-all duration-300 ".concat(u?"bg-green-600 border-green-600 cursor-not-allowed opacity-75":"bg-purple-600 hover:bg-purple-700 border-purple-600"),children:u?(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Application Submitted"]}):"Apply Now"})]})]})]}),d&&(0,jt.jsx)("div",{className:"w-full",children:(0,jt.jsx)(qa,{projectId:a.id,milestones:a.milestones||[],dueDate:a.deadline||a.applicationDeadline,onViewMilestones:c,isInitiator:f})})]})})},Za=e=>{let{applications:t=[],onApplicationClick:r,isInitiator:o=!1,positionId:a}=e;return 0===t.length?(0,jt.jsxs)("div",{className:"text-center py-8",children:[(0,jt.jsx)("div",{className:"text-gray-400 mb-2",children:(0,jt.jsx)("svg",{className:"w-12 h-12 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,jt.jsx)("p",{className:"text-gray-500 text-sm",children:"No applications yet"}),(0,jt.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"Be the first to apply!"})]}):(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("h4",{className:"font-semibold text-gray-900",children:["Applications (",t.length,")"]}),(0,jt.jsxs)("span",{className:"text-sm text-gray-500",children:[t.length," ",1===t.length?"person":"people"," applied"]})]}),(0,jt.jsx)("div",{className:"grid grid-cols-8 gap-3",children:t.map((e,t)=>(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsxs)("div",{className:"relative group",children:[(0,jt.jsx)("img",{src:e.avatar||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face",alt:e.name,className:"w-12 h-12 rounded-full object-cover border-2 border-gray-200 transition-colors duration-200 ".concat(o?"hover:border-purple-300 cursor-pointer":"hover:border-gray-300"),onClick:t=>{console.log("[ProjectDescription ApplicationsWall] Clicking application:",e.name),console.log("[ProjectDescription ApplicationsWall] Position ID:",a),console.log("[ProjectDescription ApplicationsWall] Is initiator:",o),o&&r&&r(e,t,a)}}),"approved"===e.status&&(0,jt.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-2 border-white flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]})},t))}),t.length>6&&(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsxs)("button",{className:"text-sm text-purple-600 hover:text-purple-700 font-medium",children:["View all ",t.length," applications"]})})]})},Ka=e=>{var t,r,o,a,s,n;let{project:i,positions:l,hasSubmittedApplication:c,showWarning:d,appliedPositions:u,onApply:h,onCancelApplication:m,onFillPosition:p,getStatusColor:g,getStatusText:f,currentUser:v,onApplicationClick:x,isInitiator:b=!1}=e;return(0,jt.jsx)("div",{className:"lg:col-span-2",children:(0,jt.jsxs)(Tt,{className:"mb-8",children:[i.description&&(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Project Description"}),(0,jt.jsx)("p",{className:"text-gray-700 leading-relaxed mb-6",children:i.description})]}),(0,jt.jsxs)("div",{className:"flex flex-wrap gap-6 mt-6 pt-6 border-t border-gray-200",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Expected Team Size:"})," ",i.teamSize||"Not specified"]})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Duration:"})," ",i.duration||"Not specified"]})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Meeting Schedule:"})," ",i.meetingFrequency||"Not specified"]})]})]}),((null===(t=i.contactInfo)||void 0===t?void 0:t.email)||(null===(r=i.contactInfo)||void 0===r?void 0:r.discord)||(null===(o=i.contactInfo)||void 0===o?void 0:o.other))&&(0,jt.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contact Information"}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(null===(a=i.contactInfo)||void 0===a?void 0:a.email)&&(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Email:"})," ",i.contactInfo.email]})]}),(null===(s=i.contactInfo)||void 0===s?void 0:s.discord)&&(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Discord:"})," ",i.contactInfo.discord]})]}),(null===(n=i.contactInfo)||void 0===n?void 0:n.other)&&(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Other:"})," ",i.contactInfo.other]})]})]})]}),(0,jt.jsxs)("div",{className:"mt-24",children:[(0,jt.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-6",children:"Open Positions"}),!c&&!b&&(0,jt.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,jt.jsx)("span",{className:"text-yellow-800 text-sm font-medium",children:"Please 'Apply now' above to activate position applications"})]})}),c&&(0,jt.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),(0,jt.jsx)("span",{className:"text-green-800 text-sm font-medium",children:"Application submitted! You can now apply for specific positions."})]})}),(0,jt.jsx)("div",{className:"space-y-4",children:null===l||void 0===l?void 0:l.map((e,t)=>{var r;return(0,jt.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow duration-200",children:[(0,jt.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),(0,jt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(g(e.status)),children:f(e.status)})]}),(0,jt.jsx)("div",{className:"flex gap-2",children:b?(0,jt.jsx)("button",{onClick:()=>p(e.id),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 ".concat("filled"===e.status?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-purple-600 text-white hover:bg-purple-700"),children:"filled"===e.status?"Reopen Position":"Fill Position"}):(0,jt.jsx)(jt.Fragment,{children:"filled"===e.status?(0,jt.jsx)("button",{disabled:!0,className:"px-4 py-2 bg-gray-100 text-gray-500 rounded-lg text-sm font-medium cursor-not-allowed",children:"Position Filled"}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("button",{onClick:()=>h(e.id),disabled:!c||u.has(e.id),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 ".concat(u.has(e.id)?"bg-green-100 text-green-800 cursor-not-allowed":c?"bg-purple-600 text-white hover:bg-purple-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:u.has(e.id)?"Applied":"Apply"}),u.has(e.id)&&(0,jt.jsx)("button",{onClick:()=>m(e.id),className:"px-4 py-2 bg-red-100 text-red-700 rounded-lg text-sm font-medium hover:bg-red-200 transition-colors duration-200",children:"Cancel"})]})})})]}),(0,jt.jsx)("p",{className:"text-gray-700 text-sm mb-4",children:e.description}),(0,jt.jsxs)("div",{className:"mb-4",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Required Skills:"}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:null===(r=e.requiredSkills)||void 0===r?void 0:r.map((e,t)=>(0,jt.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:e},t))})]}),(0,jt.jsx)("div",{className:"p-6",children:(0,jt.jsx)(Za,{applications:e.applications||[],onApplicationClick:x,isInitiator:b,positionId:e.id})})]},t)})})]})]})})},Ya="tag_apply_form_data",Qa=(e,t)=>{try{const r="".concat(Ya,"_").concat(e,"_").concat(t),o=localStorage.getItem(r);if(!o)return console.log("[applyFormService] No apply form data found for collaboration ".concat(e,", user ").concat(t)),null;const a=JSON.parse(o);return console.log("[applyFormService] Retrieved apply form data for collaboration ".concat(e,", user ").concat(t,":"),a),a}catch(r){return console.error("[applyFormService] Failed to get apply form data:",r),null}},$a="tag_positions_status",Xa=e=>{try{const t="".concat($a,"_").concat(e),r=localStorage.getItem(t);return r?JSON.parse(r):{}}catch(t){return console.warn("Failed to get stored position status:",t),{}}},es=(e,t,r)=>{try{const o=Xa(e);return o[t]=r,((e,t)=>{try{const r="".concat($a,"_").concat(e);localStorage.setItem(r,JSON.stringify(t)),console.log("[positionService] Saved position status for collaboration ".concat(e,":"),t)}catch(r){console.warn("Failed to save position status:",r)}})(e,o),{success:!0,data:o}}catch(o){return console.error("Failed to update position status:",o),{success:!1,error:o.message}}},ts=e=>{switch(e){case"available":return"bg-green-100 text-green-800";case"filled":default:return"bg-gray-100 text-gray-800";case"in_progress":return"bg-blue-100 text-blue-800"}},rs=e=>{switch(e){case"available":return"Available";case"filled":return"Position Filled";case"in_progress":return"In Progress";default:return"Unknown"}},os=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(console.log("[getPositionsData] Input projectData:",t),console.log("[getPositionsData] ProjectData roles:",null===t||void 0===t?void 0:t.roles),console.log("[getPositionsData] ProjectData roles length:",null===t||void 0===t||null===(e=t.roles)||void 0===e?void 0:e.length),console.log("[getPositionsData] ProjectData roles type:",typeof(null===t||void 0===t?void 0:t.roles)),console.log("[getPositionsData] ProjectData roles is array:",Array.isArray(null===t||void 0===t?void 0:t.roles)),!t||!t.roles||0===t.roles.length)return console.log("[getPositionsData] Using default positions (no project data or empty roles)"),[{id:1,title:"UI/UX Designer",description:"We're looking for a talented UI/UX designer to create beautiful, intuitive user interfaces and engaging user experiences. You'll work closely with our development team to bring designs to life.",status:"available",requiredSkills:["Figma","Adobe Creative Suite","User Research","Prototyping","Design Systems"],applications:[]},{id:2,title:"Frontend Developer",description:"Join our frontend team to build responsive, performant web applications using modern technologies. You'll collaborate with designers and backend developers to create seamless user experiences.",status:"available",requiredSkills:["React","TypeScript","CSS/SCSS","JavaScript","Responsive Design"],applications:[]}];console.log("[getPositionsData] Converting roles to positions...");const r=t.roles.map((e,t)=>{console.log("[getPositionsData] Processing role ".concat(t,":"),e);const r=e.requiredSkills?Array.isArray(e.requiredSkills)?e.requiredSkills:"string"===typeof e.requiredSkills?e.requiredSkills.split(",").map(e=>e.trim()).filter(e=>e):[]:[],o={id:e.id||t+1,title:e.title||e.customRole||"Role ".concat(t+1),description:e.description||e.roleDescription||"",status:e.status||"available",requiredSkills:r,applications:e.applications||[]};return console.log("[getPositionsData] Created position ".concat(t,":"),o),o});return console.log("[getPositionsData] Final positions:",r),r},as=(e,t)=>{const{goBack:r,navigateToMilestone:o,navigateToArtist:s}=Xo(),{appliedPositions:n,hasSubmittedApplication:i,showWarning:l,showSuccessToast:c,showCancelModal:d,cancelPositionId:u}=e,{setAppliedPositions:h,setHasSubmittedApplication:m,setShowWarning:p,setShowSuccessToast:g,setShowCancelModal:f,setCancelPositionId:v,setShowApplyModal:x,setApplyForm:b,setIsSaved:y,setPositions:w,updateProjectData:j,updatePositions:k,saveCollaborationData:S}=t;return{goBack:r,navigateToMilestone:o,navigateToArtist:s,handleApply:async t=>{if(!i)return p(!0),void setTimeout(()=>p(!1),3e3);h(e=>{const r=new Set(e);return r.add(t),r});try{var r,o,s,n,l,c,d;const i=(0,Lr.HW)(),h=(null===i||void 0===i?void 0:i.id)||(null===(r=e.currentUser)||void 0===r?void 0:r.id),p=await(0,At.getUnifiedAvatar)(h);let D=(null===i||void 0===i?void 0:i.name)||(null===(o=e.currentUser)||void 0===o?void 0:o.name)||"Anonymous";try{var u;const e=await po(h);e.success&&null!==(u=e.data)&&void 0!==u&&u.fullName&&(D=e.data.fullName)}catch(P){console.warn("[useCollaborationActions] Failed to get user profile:",P)}const L={userId:h,name:D,avatar:p||(null===i||void 0===i?void 0:i.avatar)||(null===(s=e.currentUser)||void 0===s?void 0:s.avatar)||"/assets/placeholder.svg",email:(null===(n=e.applyForm)||void 0===n?void 0:n.email)||"",portfolio:(null===(l=e.applyForm)||void 0===l?void 0:l.portfolio)||"",message:(null===(c=e.applyForm)||void 0===c?void 0:c.message)||""};console.log("[useCollaborationActions] Apply form data:",e.applyForm),console.log("[useCollaborationActions] Created application:",L);const T=await Ua.addApplication(null===(d=e.project)||void 0===d?void 0:d.id,t,L);if(T.success){w(e=>e.map(e=>e.id===t?(0,a.A)((0,a.A)({},e),{},{applications:[...e.applications||[],T.data]}):e)),console.log("[useCollaborationActions] User ".concat(L.name," applied for position ").concat(t)),m(!0);try{var g,f,v,x,b,y,j,k,S,N,C,_;let r=null;if(null!==(g=e.project)&&void 0!==g&&null!==(f=g.author)&&void 0!==f&&f.id?r=e.project.author.id:null!==(v=e.project)&&void 0!==v&&v.initiatorId?r=e.project.initiatorId:null!==(x=e.project)&&void 0!==x&&x.authorId?r=e.project.authorId:null!==(b=e.project)&&void 0!==b&&null!==(y=b.creator)&&void 0!==y&&y.id?r=e.project.creator.id:(r="alice",console.warn("[useCollaborationActions] Using default initiatorId: alice")),console.log("[useCollaborationActions] Debug notification creation:"),console.log("  - Current user ID:",h),console.log("  - Project author ID:",null===(j=e.project)||void 0===j||null===(k=j.author)||void 0===k?void 0:k.id),console.log("  - Project initiatorId:",null===(S=e.project)||void 0===S?void 0:S.initiatorId),console.log("  - Project authorId:",null===(N=e.project)||void 0===N?void 0:N.authorId),console.log("  - Project creator ID:",null===(C=e.project)||void 0===C||null===(_=C.creator)||void 0===_?void 0:_.id),console.log("  - Final initiatorId:",r),console.log("  - Project data:",e.project),r&&r!==h){var A,I;console.log("[useCollaborationActions] Creating notification...");const o=await Jr.createCollaborationApplicationNotification(h,L.name,L.avatar,null===(A=e.project)||void 0===A?void 0:A.id,null===(I=e.project)||void 0===I?void 0:I.title,r,{positionId:t,email:L.email,portfolio:L.portfolio,message:L.message});o.success?(console.log("[useCollaborationActions] Created notification for initiator ".concat(r)),console.log("[useCollaborationActions] Notification result:",o)):console.warn("[useCollaborationActions] Failed to create notification:",o.error)}else console.warn("[useCollaborationActions] Skipping notification creation:"),console.warn("  - initiatorId is missing or same as current user"),console.warn("  - initiatorId:",r),console.warn("  - userId:",h)}catch(E){console.warn("[useCollaborationActions] Error creating notification:",E)}}else console.error("[useCollaborationActions] Failed to save application:",T.error)}catch(P){console.error("[useCollaborationActions] Error applying for position:",P)}},handleApplyNowClick:()=>{x(!0)},handleApplySubmit:t=>{t.preventDefault(),m(!0),x(!1);try{var r,o,s;const t=(0,Lr.HW)(),n=(null===t||void 0===t?void 0:t.id)||(null===(r=e.currentUser)||void 0===r?void 0:r.id);((e,t,r)=>{try{const o="".concat(Ya,"_").concat(e,"_").concat(t),s=(0,a.A)((0,a.A)({},r),{},{userId:t,timestamp:Date.now()});return localStorage.setItem(o,JSON.stringify(s)),console.log("[applyFormService] Saved apply form data for collaboration ".concat(e,", user ").concat(t,":"),r),{success:!0,data:s}}catch(o){return console.error("[applyFormService] Failed to save apply form data:",o),{success:!1,error:o.message}}})(null===(o=e.project)||void 0===o?void 0:o.id,n,e.applyForm),console.log("[useCollaborationActions] Saved apply form data for project ".concat(null===(s=e.project)||void 0===s?void 0:s.id,", user ").concat(n,":"),e.applyForm)}catch(n){console.error("[useCollaborationActions] Failed to save apply form data:",n)}g(!0)},handleApplyFormChange:e=>{const{name:t,value:r}=e.target;b(e=>(0,a.A)((0,a.A)({},e),{},{[t]:r}))},handleCancelApplication:e=>{v(e),f(!0)},handleConfirmCancelApplication:async()=>{if(u){var t;h(e=>{const t=new Set(e);return t.delete(u),t}),w(t=>t.map(t=>{if(t.id===u){var r;const o=(0,Lr.HW)(),s=(null===o||void 0===o?void 0:o.id)||(null===(r=e.currentUser)||void 0===r?void 0:r.id);return(0,a.A)((0,a.A)({},t),{},{applications:(t.applications||[]).filter(e=>e.userId!==s)})}return t}));try{var r,o;const t=(0,Lr.HW)(),a=(null===t||void 0===t?void 0:t.id)||(null===(r=e.currentUser)||void 0===r?void 0:r.id);await Ua.removeApplication(null===(o=e.project)||void 0===o?void 0:o.id,u,a)}catch(s){console.error("[useCollaborationActions] Failed to remove application from storage:",s)}console.log("[useCollaborationActions] User ".concat(null===(t=e.currentUser)||void 0===t?void 0:t.name," cancelled application for position ").concat(u))}f(!1),v(null)},handleCloseCancelModal:()=>{f(!1),v(null)},handleViewMilestones:()=>{o(e.project)},handleSaveToggle:async(e,t,r)=>{try{await Rr.toggleFavorite(e,t,r),y(r)}catch(o){console.error("Failed to toggle favorite:",o)}},handleFillPosition:async t=>{try{console.log("[useCollaborationActions] Filling position:",t);const r=e.positions.find(e=>e.id===t),o="filled"===(null===r||void 0===r?void 0:r.status)?"available":"filled",s=await es(e.project.id,t,o);s.success?(w(e=>e.map(e=>e.id===t?(0,a.A)((0,a.A)({},e),{},{status:o}):e)),console.log("[useCollaborationActions] Position ".concat("filled"===o?"filled":"reopened"," successfully"))):console.error("[useCollaborationActions] Failed to update position status:",s.error)}catch(r){console.error("[useCollaborationActions] Error updating position status:",r)}},updateProjectData:j,updatePositions:k,saveCollaborationData:S,getStatusColor:ts,getStatusText:rs}},ss=()=>{var t,r,o,s;const{state:n}=Go(),i=ne(),{id:l}=de(),[c,d]=(0,e.useState)(()=>{var e;const t=n.selectedCollaboration||(null===(e=i.state)||void 0===e?void 0:e.project);if(!t&&l){console.log("[useCollaborationData] No initial data, trying localStorage for id:",l);const e=oa(l);if(e)return console.log("[useCollaborationData] Found data in localStorage:",e),e}return t});console.log("[useCollaborationData] Final projectData:",c),console.log("[useCollaborationData] Final projectData.roles:",null===c||void 0===c?void 0:c.roles),console.log("[useCollaborationData] Final projectData.collaborators:",null===c||void 0===c?void 0:c.collaborators),console.log("[useCollaborationData] Final projectData.vision?.collaborators:",null===c||void 0===c||null===(t=c.vision)||void 0===t?void 0:t.collaborators),console.log("[useCollaborationData] ID from URL:",l),console.log("[useCollaborationData] Context data:",n.selectedCollaboration),console.log("[useCollaborationData] Location state:",null===(r=i.state)||void 0===r?void 0:r.project),console.log("[useCollaborationData] Location state roles:",null===(o=i.state)||void 0===o||null===(s=o.project)||void 0===s?void 0:s.roles);const[u,h]=(0,e.useState)(new Set),[m,p]=(0,e.useState)(!1),[g,f]=(0,e.useState)(!1),[v,x]=(0,e.useState)({email:"",portfolio:"",message:""}),[b,y]=(0,e.useState)(!1),[w,j]=(0,e.useState)(!1),[k,S]=(0,e.useState)(!1),[N,C]=(0,e.useState)(!1),[_,A]=(0,e.useState)(null),[I,P]=(0,e.useState)((0,Lr.HW)()),[E,D]=(0,e.useState)([]),[L,T]=(0,e.useState)(null);(0,e.useEffect)(()=>{const e=(e=>{var t,r,o,a,s,n,i,l,c,d,u,h,m,p,g,f,v,x,b,y;console.log("[processProjectData] Input projectData:",e),console.log("[processProjectData] Input projectData.roles:",null===e||void 0===e?void 0:e.roles);const w=e?{id:e.id,title:e.title,author:{id:(null===(t=e.author)||void 0===t?void 0:t.id)||e.authorId||null,title:e.title,artist:(null===(r=e.author)||void 0===r?void 0:r.name)||e.authorName||"Unknown",artistAvatar:(null===(o=e.author)||void 0===o?void 0:o.avatar)||e.authorAvatar||null,description:e.subtitle,image:e.posterPreview||e.image,category:(null===(a=e.categories)||void 0===a?void 0:a[0])||"Project",likes:e.likes,views:e.views,timeAgo:e.createdAt?new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown date",role:(null===(s=e.author)||void 0===s?void 0:s.role)||"Initiator"},duration:e.duration||"Not specified",teamSize:e.teamSize||"Not specified",postedTime:e.createdAt?new Date(e.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown date",tags:[],heroImage:e.posterPreview||e.image,description:e.description||e.subtitle||"",meetingFrequency:e.meetingSchedule||"Not specified",deadline:e.applicationDeadline||e.deadline||null,applicationDeadline:e.applicationDeadline||e.deadline||null,contactInfo:{discord:(null===(n=e.contactInfo)||void 0===n?void 0:n.discord)||e.contactDiscord||null,email:(null===(i=e.contactInfo)||void 0===i?void 0:i.email)||e.contactEmail||null,other:(null===(l=e.contactInfo)||void 0===l?void 0:l.other)||e.contactOther||null},status:"in_progress",vision:{tagline:e.projectVision||(null===(c=e.vision)||void 0===c?void 0:c.tagline)||(null===(d=e.vision)||void 0===d?void 0:d.narrative)||"",narrative:e.whyThisMatters||(null===(u=e.vision)||void 0===u?void 0:u.narrative)||(null===(h=e.vision)||void 0===h?void 0:h.whyThisMatters)||"",lookingFor:e.projectType?e.projectType.split(",").map(e=>e.trim()).filter(e=>e.length>0):[],contact:{discord:e.contactDiscord||null,email:e.contactEmail||null},collaborators:e.collaborators||[]},milestones:e.milestones||[],roles:e.roles||[],collaborators:e.collaborators||[]}:{id:1,title:"Modern E-commerce Mobile App",author:{id:1,title:"Modern E-commerce Mobile App",artist:"Sarah Chen",artistAvatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=100&h=100&fit=crop&crop=face",description:"A cutting-edge mobile shopping experience",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800&h=600&fit=crop",category:"Mobile App",likes:128,views:2048,timeAgo:"2 hours ago",role:"Initiator"},duration:e.duration||"Not specified",teamSize:e.teamSize||"Not specified",postedTime:"2 hours ago",tags:["Mobile App","E-commerce","React Native"],heroImage:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800&h=600&fit=crop",description:"A cutting-edge mobile shopping experience",meetingFrequency:e.meetingSchedule||"Not specified",deadline:e.applicationDeadline||e.deadline||null,applicationDeadline:e.applicationDeadline||e.deadline||null,contactInfo:{discord:(null===(m=e.contactInfo)||void 0===m?void 0:m.discord)||e.contactDiscord||null,email:(null===(p=e.contactInfo)||void 0===p?void 0:p.email)||e.contactEmail||null,other:(null===(g=e.contactInfo)||void 0===g?void 0:g.other)||e.contactOther||null},status:"in_progress",vision:{tagline:e.projectVision||(null===(f=e.vision)||void 0===f?void 0:f.tagline)||(null===(v=e.vision)||void 0===v?void 0:v.narrative)||"",narrative:e.whyThisMatters||(null===(x=e.vision)||void 0===x?void 0:x.narrative)||(null===(b=e.vision)||void 0===b?void 0:b.whyThisMatters)||"",lookingFor:e.projectType?e.projectType.split(",").map(e=>e.trim()).filter(e=>e.length>0):[],contact:{discord:e.contactDiscord||null,email:e.contactEmail||null},collaborators:e.collaborators||[]},milestones:e.milestones||[],roles:e.roles||[],collaborators:e.collaborators||[]};return console.log("[processProjectData] Final project.roles:",null===w||void 0===w?void 0:w.roles),console.log("[processProjectData] Final project.collaborators:",null===w||void 0===w?void 0:w.collaborators),console.log("[processProjectData] Final project.vision?.collaborators:",null===w||void 0===w||null===(y=w.vision)||void 0===y?void 0:y.collaborators),w||null})(c);if(console.log("[useCollaborationData] Processed project:",e),console.log("[useCollaborationData] Processed project.roles:",null===e||void 0===e?void 0:e.roles),(null===e||void 0===e||!e.roles||0===e.roles.length)&&(console.log("[useCollaborationData] Processed project has no roles, trying localStorage recovery..."),l)){const t=oa(l);if(t&&t.roles&&t.roles.length>0){console.log("[useCollaborationData] Found roles in localStorage:",t.roles);const r=(0,a.A)((0,a.A)({},e),{},{roles:t.roles});return console.log("[useCollaborationData] Updated project with roles:",r),void T(r)}}T(e)},[c,i,n,l]),(0,e.useEffect)(()=>{var e,t;if(!l)return;const r=c&&(!c.roles||!c.collaborators||!(null!==(e=c.vision)&&void 0!==e&&e.collaborators));console.log("[useCollaborationData] Data completeness check:"),console.log("  projectData exists:",!!c),console.log("  projectData.roles exists:",!(null===c||void 0===c||!c.roles)),console.log("  projectData.collaborators exists:",!(null===c||void 0===c||!c.collaborators)),console.log("  projectData.vision?.collaborators exists:",!(null===c||void 0===c||null===(t=c.vision)||void 0===t||!t.collaborators)),console.log("  hasIncompleteData:",r);const o=!c||r||c&&(!c.roles||0===c.roles.length);if(console.log("  needsDataRecovery:",o),o){console.log("[useCollaborationData] No data or incomplete data, trying localStorage for id:",l);const e=[l,parseInt(l),l.toString()];let t=null;for(const r of e)if(console.log("[useCollaborationData] Trying ID format: ".concat(r," (type: ").concat(typeof r,")")),t=oa(r),console.log("[useCollaborationData] getCollaborationDataById result:",t),t){console.log("[useCollaborationData] Found data with ID: ".concat(r));break}t?(console.log("[useCollaborationData] Found localStorage data:",t),console.log("[useCollaborationData] localStorage roles:",t.roles),d(t)):console.warn("[useCollaborationData] No data found in localStorage for any ID format")}},[l]);(0,e.useEffect)(()=>{const e=()=>{P((0,Lr.HW)())};return window.addEventListener("user:changed",e),()=>{window.removeEventListener("user:changed",e)}},[]),(0,e.useEffect)(()=>{if(console.log("[useCollaborationData] useEffect triggered, project?.id:",null===L||void 0===L?void 0:L.id),console.log("[useCollaborationData] project?.roles:",null===L||void 0===L?void 0:L.roles),null===L||void 0===L||!L.id)return void console.log("[useCollaborationData] No project ID, returning early");if(!L.roles||0===L.roles.length){console.log("[useCollaborationData] Project has no roles, trying to recover from localStorage...");const e=[L.id,parseInt(L.id),L.id.toString()];let t=null;for(const r of e)if(console.log("[useCollaborationData] Trying ID format: ".concat(r," (type: ").concat(typeof r,")")),t=oa(r),t&&t.roles&&t.roles.length>0){console.log("[useCollaborationData] Found roles data with ID: ".concat(r)),console.log("[useCollaborationData] Found roles:",t.roles);const e=(0,a.A)((0,a.A)({},L),{},{roles:t.roles});console.log("[useCollaborationData] Updated project with roles:",e),T(e)}console.log("[useCollaborationData] No roles data found in localStorage")}console.log("[useCollaborationData] About to call loadPositionsWithStatus"),(async()=>{try{const t=os(L),r=(e=L.id,Xa(e)),o=await Ua.getApplicationsData(L.id),s=async()=>{if(o){const r=(0,Lr.HW)();if(null!==r&&void 0!==r&&r.id)try{var e;const t=await po(r.id);if(t.success&&null!==(e=t.data)&&void 0!==e&&e.fullName){const e=t.data.fullName;let a=!1;if(Object.values(o).forEach(t=>{t.forEach(t=>{t.userId===r.id&&t.name!==e&&(a=!0)})}),a){await Ua.updateApplicationUserName(r.id,e);const t=await Ua.getApplicationsData(L.id);t&&Object.keys(t).forEach(o=>{t[o].forEach(t=>{t.userId===r.id&&(t.name=e)})})}}}catch(t){console.warn("[useCollaborationData] Failed to update application user names:",t)}}};s();(()=>{o&&Object.entries(o).forEach(e=>{let[t,r]=e;r.forEach(e=>{const r=e.id||e.userId;"approved"===Wa(t,r)?(console.log("[useCollaborationData] Restoring approved status from storage for user ".concat(e.userId," in position ").concat(t)),e.status="approved"):"approved"===e.status&&console.log("[useCollaborationData] Syncing approved status to storage for user ".concat(e.userId," in position ").concat(t))})})})();const n=t.map(e=>{const t=(null===o||void 0===o?void 0:o[e.id])||[];console.log("[useCollaborationData] Position ".concat(e.id," saved applications:"),t);const s=t.map(e=>(console.log("[useCollaborationData] Application ".concat(e.userId," status: ").concat(e.status)),(0,a.A)((0,a.A)({},e),{},{status:e.status||"pending"}))),n=(0,a.A)((0,a.A)({},e),{},{status:r[e.id]||e.status,applications:s});return console.log("[useCollaborationData] Final position ".concat(e.id," applications:"),n.applications),n});D(n)}catch(t){console.error("Failed to load positions with status:",t),D(os(L))}var e})(),console.log("[useCollaborationData] loadPositionsWithStatus called!")},[null===L||void 0===L?void 0:L.id,null===L||void 0===L?void 0:L.roles]),(0,e.useEffect)(()=>{if(null===L||void 0===L||!L.id||null===I||void 0===I||!I.id)return;(async()=>{try{const e=await Ua.getApplicationsData(L.id);if(e){const t=new Set;Object.entries(e).forEach(e=>{let[r,o]=e;o.some(e=>e.userId===I.id)&&t.add(parseInt(r))}),h(t),console.log("[useCollaborationData] Initialized applied positions for user ".concat(I.id,":"),Array.from(t))}}catch(e){console.error("Failed to initialize applied positions:",e)}})()},[null===L||void 0===L?void 0:L.id,null===I||void 0===I?void 0:I.id]),(0,e.useEffect)(()=>{if(null===L||void 0===L||!L.id||null===I||void 0===I||!I.id)return;(()=>{try{const e=Qa(L.id,I.id);e&&(x(e),y(((e,t)=>{try{const r=Qa(e,t);if(!r)return!1;const o=r.email&&""!==r.email.trim(),a=o;return console.log("[applyFormService] Form data completeness check for collaboration ".concat(e,", user ").concat(t,":"),{hasEmail:o,isComplete:a}),a}catch(r){return console.error("[applyFormService] Failed to check form data completeness:",r),!1}})(L.id,I.id)),console.log("[useCollaborationData] Loaded saved apply form data for user:",e))}catch(e){console.error("Failed to load apply form data:",e)}})()},[null===L||void 0===L?void 0:L.id,null===I||void 0===I?void 0:I.id]),(0,e.useEffect)(()=>{if(null===L||void 0===L||!L.id)return;(async()=>{try{const e=await Rr.checkFavoriteStatus("collaboration",L.id);e.success&&p(e.data.isFavorited)}catch(e){console.error("Failed to check favorite status:",e)}})()},[null===L||void 0===L?void 0:L.id]);const M=(0,e.useCallback)(e=>{T(e),console.log("[useCollaborationData] Updated project data:",e)},[]),F=(0,e.useCallback)(e=>{D(e),console.log("[useCollaborationData] Updated positions:",e)},[]),R=(0,e.useCallback)(async e=>{try{var t,r;console.log("[saveCollaborationData] Saving project data:",e);const n=(0,a.A)((0,a.A)({},e),{},{heroImage:void 0,posterPreview:void 0,image:void 0,author:e.author,authorId:e.authorId,authorName:e.authorName,id:e.id,title:e.title,description:e.description,collaborators:e.collaborators,roles:e.roles,vision:e.vision,duration:e.duration,teamSize:e.teamSize,tags:e.tags,status:e.status,postedTime:e.postedTime,applicationDeadline:e.applicationDeadline,meetingFrequency:e.meetingFrequency,contactInfo:e.contactInfo,categories:e.categories,milestones:e.milestones});console.log("[saveCollaborationData] Stripped project data for storage:",n),console.log("[saveCollaborationData] Project collaborators:",null===e||void 0===e?void 0:e.collaborators),console.log("[saveCollaborationData] Project vision collaborators:",null===e||void 0===e||null===(t=e.vision)||void 0===t?void 0:t.collaborators),console.log("[saveCollaborationData] Project positions:",null===e||void 0===e?void 0:e.roles);const i=localStorage.getItem("mock_collaborations"),l=i?JSON.parse(i):[];console.log("[saveCollaborationData] Existing collaborations:",l);const c=l.map(t=>{if(t.id===n.id){var r,o;console.log("[saveCollaborationData] Updating collaboration:",t.id),console.log("[saveCollaborationData] Old collaborators:",t.collaborators),console.log("[saveCollaborationData] New collaborators:",e.collaborators);const s=(0,a.A)((0,a.A)({},t),{},{collaborators:n.collaborators||t.collaborators||[],roles:n.roles||t.roles||[],vision:(0,a.A)((0,a.A)({},t.vision),{},{collaborators:(null===(r=n.vision)||void 0===r?void 0:r.collaborators)||n.collaborators||(null===(o=t.vision)||void 0===o?void 0:o.collaborators)||[]}),author:t.author,authorId:t.authorId,authorName:t.authorName,authorAvatar:t.authorAvatar,title:t.title,description:t.description,duration:t.duration,teamSize:t.teamSize,tags:t.tags,status:t.status,postedTime:t.postedTime,applicationDeadline:t.applicationDeadline,meetingFrequency:t.meetingFrequency,contactInfo:t.contactInfo,categories:t.categories,milestones:t.milestones});return console.log("[saveCollaborationData] Updated collaboration:",s),s}return t}),d=JSON.stringify(c),u=d.length;console.log("[saveCollaborationData] Data size: ".concat((u/1024/1024).toFixed(2)," MB"));try{localStorage.setItem("mock_collaborations",d),console.log("[saveCollaborationData] Successfully saved to localStorage")}catch(o){if("QuotaExceededError"!==o.name)throw o;console.error("[saveCollaborationData] localStorage quota exceeded, attempting smart cleanup...");try{const{default:e}=await Promise.resolve().then(function(){var e=new Error("Cannot find module '../../utils/smartDataCleaner.js'");throw e.code="MODULE_NOT_FOUND",e}),t=await e.manualCleanup(["avatarCache","tempImages","oldCollaborations","draftData"]);if(!t.success)throw new Error("Smart cleanup failed: "+t.error);console.log("[saveCollaborationData] Smart cleanup freed ".concat((t.freedSpace/1024).toFixed(1),"KB")),localStorage.setItem("mock_collaborations",d),console.log("[saveCollaborationData] Successfully saved after smart cleanup")}catch(s){console.error("[saveCollaborationData] Smart cleanup failed, falling back to manual cleanup:",s);["tag.avatars","tag.images","portfolio_alice","portfolio_bryan"].forEach(e=>{localStorage.getItem(e)&&(localStorage.removeItem(e),console.log("[saveCollaborationData] Removed ".concat(e," to free space")))}),localStorage.setItem("mock_collaborations",d),console.log("[saveCollaborationData] Successfully saved after manual cleanup")}}const h=localStorage.getItem("mock_collaborations"),m=(h?JSON.parse(h):[]).find(e=>e.id===n.id);console.log("[saveCollaborationData] Verified saved collaborators:",null===m||void 0===m?void 0:m.collaborators),console.log("[saveCollaborationData] Verified saved vision collaborators:",null===m||void 0===m||null===(r=m.vision)||void 0===r?void 0:r.collaborators),console.log("[saveCollaborationData] Verified saved positions:",null===m||void 0===m?void 0:m.roles)}catch(n){console.error("[saveCollaborationData] Failed to save collaboration data:",n)}},[]);return{project:L,projectData:c,positions:E,appliedPositions:u,isSaved:m,showApplyModal:g,applyForm:v,hasSubmittedApplication:b,showWarning:w,showSuccessToast:k,showCancelModal:N,cancelPositionId:_,currentUser:I,enableProjectProgressBar:!0,enableAfterFinishedReview:!0,enableReviewApprovalPanel:!1,setAppliedPositions:h,setIsSaved:p,setShowApplyModal:f,setApplyForm:x,setHasSubmittedApplication:y,setShowWarning:j,setShowSuccessToast:S,setShowCancelModal:C,setCancelPositionId:A,setCurrentUser:P,setPositions:D,updateProjectData:M,updatePositions:F,saveCollaborationData:R}},ns=e=>{var t,r;let{vision:o,owner:a,currentUser:s,onFinalReviewClick:n}=e;const i=o||{},l=i.tagline||i.narrative||"",c=i.narrative||i.whyThisMatters||"",d=(null===s||void 0===s?void 0:s.id)===(null===a||void 0===a?void 0:a.id),u=(null===o||void 0===o?void 0:o.collaborators)||[],{navigateToArtist:h}=Xo();return o?(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-4 pb-4 border-b border-gray-200 cursor-pointer hover:bg-gray-50 rounded-lg p-2 transition-colors duration-200",onClick:()=>{console.log("[ProjectVision] Owner data:",a),console.log("[ProjectVision] Owner ID:",a.id),console.log("[ProjectVision] Owner artist:",a.artist),a.id?(console.log("[ProjectVision] Navigating to artist:",a.id),h(a.id,"collaboration","Profile")):(console.warn("[ProjectVision] No artist ID found for owner:",a),console.warn("[ProjectVision] This means the collaboration data was created without proper author ID"))},title:"View ".concat(a.artist,"'s profile"),children:[a.artistAvatar?(0,jt.jsx)("img",{src:a.artistAvatar,alt:a.artist,className:"w-12 h-12 rounded-full object-cover",onError:e=>{e.target.style.display="none"}}):(0,jt.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center",children:(0,jt.jsx)("span",{className:"text-lg text-gray-600 font-medium",children:(null===(t=a.artist)||void 0===t||null===(r=t.charAt(0))||void 0===r?void 0:r.toUpperCase())||"U"})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"font-medium text-gray-900",children:a.artist}),(0,jt.jsx)("div",{className:"text-sm text-gray-500",children:(0,jt.jsx)("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:"Initiator"})})]})]}),l&&(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Project Vision"}),(0,jt.jsxs)("p",{className:"text-gray-700 italic",children:['"',l,'"']})]}),c&&(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Why This Matters"}),(0,jt.jsx)("div",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap",children:c})]}),o.lookingFor&&o.lookingFor.length>0&&(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Looking For"}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:o.lookingFor.map((e,t)=>(0,jt.jsx)("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full",children:e},t))})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Collaborators"}),(0,jt.jsx)("div",{className:"space-y-3",children:u.length>0?u.map(e=>(0,jt.jsxs)("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-gray-50 transition-colors duration-200",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("img",{src:e.avatar,alt:e.name,className:"w-10 h-10 rounded-full object-cover",onError:e=>{e.target.style.display="none"}})}),(0,jt.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,jt.jsx)("div",{className:"font-medium text-gray-900 truncate",children:e.name}),(0,jt.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,jt.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full ".concat("Initiator"===e.role?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"),children:e.role}),e.positionTitle&&(0,jt.jsx)("span",{className:"inline-flex items-center px-2 py-1 text-xs font-medium rounded-full bg-gray-100 text-gray-700",children:e.positionTitle})]})]}),d&&(0,jt.jsx)("button",{onClick:()=>n&&n(e),className:"px-3 py-1 bg-purple-600 text-white text-xs font-medium rounded-lg hover:bg-purple-700 transition-colors duration-200 flex-shrink-0",children:"Final Review"})]},e.id)):(0,jt.jsxs)("div",{className:"text-center py-6 text-gray-500",children:[(0,jt.jsx)("p",{children:"No collaborators yet"}),(0,jt.jsx)("p",{className:"text-sm mt-1",children:"Approved applicants will appear here"})]})})]})]}):(0,jt.jsx)("div",{className:"text-center py-8",children:(0,jt.jsx)("p",{className:"text-gray-500",children:"No project vision available"})})},is=t=>{let{project:r,owner:o,currentUser:a,eligibility:s}=t;const[n,i]=(0,e.useState)(!1),[l,c]=(0,e.useState)("ADD_EXPERIENCE"),d=a||{id:(()=>{if(null!==a&&void 0!==a&&a.id){return{alex:1,alice:2,bryan:3}[a.id]||a.id}return null})(),name:"Current User"};(0,e.useEffect)(()=>{console.log("[RightOwnerPanel] Component mounted with props:",{project:r,owner:o,currentUser:a,eligibility:s}),u()},[r.id]);const u=()=>{console.log("[RightOwnerPanel] Checking eligibility for user:",d),console.log("[RightOwnerPanel] Current user ID type:",typeof d.id),console.log("[RightOwnerPanel] Current user ID value:",d.id),console.log("[RightOwnerPanel] Project data:",r),console.log("[RightOwnerPanel] Project positions:",r.positions);let e=!1;r.positions&&Array.isArray(r.positions)&&r.positions.forEach(t=>{if(t.applications&&Array.isArray(t.applications)){console.log("[RightOwnerPanel] Checking position:",t.id),console.log("[RightOwnerPanel] Applications in position:",t.applications),console.log("[RightOwnerPanel] Current user ID:",d.id);const r=t.applications.find(e=>{const t=e.id===d.id,r=e.userId===d.id;return console.log("[RightOwnerPanel] Application check:",{appUserId:e.userId,appId:e.id,currentUserId:d.id,currentUserIdType:typeof d.id,userIdMatch:r,idMatch:t,status:e.status}),t&&"approved"===e.status});r&&(console.log("[RightOwnerPanel] Found approved application:",r),e=!0)}}),console.log("[RightOwnerPanel] Is approved collaborator:",e),c(e?"ADD_EXPERIENCE":"NOT_ELIGIBLE")},h=async()=>{i(!0);try{const e={id:"exp_".concat(Date.now()),projectId:r.id,title:r.name,description:r.description,image:r.heroImage||r.image,dateRange:"Completed ".concat((new Date).toLocaleDateString()),role:"Collaborator",isInitiator:!1,responsibility:"",teamFeedback:{feedbacker:"Team",feedbackerRole:"Collaborators",content:"This project has been completed successfully."},addedAt:(new Date).toISOString()},t=JSON.parse(localStorage.getItem("user_collaborations_".concat(d.id))||"[]");t.find(e=>e.projectId===r.id)?(console.log("[RightOwnerPanel] Experience already exists"),c("EXPERIENCE_ADDED")):(t.push(e),localStorage.setItem("user_collaborations_".concat(d.id),JSON.stringify(t)),console.log("[RightOwnerPanel] Experience added successfully:",e),c("EXPERIENCE_ADDED"))}catch(e){console.error("Error adding experience:",e)}finally{i(!1)}};return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 h-full overflow-auto",children:[(0,jt.jsx)(ns,{vision:r.vision,owner:o,currentUser:a}),(0,jt.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(()=>{const e="w-full py-2 px-4 rounded-lg font-medium transition-all duration-200";switch(l){case"ADD_EXPERIENCE":return(0,jt.jsx)("button",{className:"".concat(e," bg-purple-600 text-white hover:bg-purple-700"),onClick:h,disabled:n,children:n?"Adding...":"Add Experience"});case"EXPERIENCE_ADDED":return(0,jt.jsx)("button",{className:"".concat(e," bg-green-100 text-green-800 cursor-not-allowed"),disabled:!0,children:"Experience Added \u2713"});case"NOT_ELIGIBLE":return(0,jt.jsx)("button",{className:"".concat(e," bg-gray-300 text-gray-500 cursor-not-allowed"),disabled:!0,title:"Only approved collaborators can add this to their experience.",children:"Not Eligible"});default:return null}})()})]})},ls=e=>{let{isOpen:t,onClose:r,onConfirm:o,positionTitle:a}=e;return t?(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Cancel Application"})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:(0,jt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-orange-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-orange-800 text-sm font-medium mb-2",children:"Important: Cancellation Consequences"}),(0,jt.jsxs)("ul",{className:"text-orange-700 text-sm space-y-1",children:[(0,jt.jsxs)("li",{children:["\u2022 Your application for ",(0,jt.jsx)("strong",{children:a})," will be withdrawn"]}),(0,jt.jsx)("li",{children:"\u2022 If you reapply later, you'll need to get the project initiator's approval again"}),(0,jt.jsx)("li",{children:"\u2022 Your previous application data will be cleared"})]})]})]})}),(0,jt.jsx)("p",{className:"text-gray-700 text-sm",children:"Are you sure you want to cancel your application? This action cannot be undone."})]}),(0,jt.jsxs)("div",{className:"flex gap-3",children:[(0,jt.jsx)("button",{onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors duration-200",children:"Keep Application"}),(0,jt.jsx)("button",{onClick:o,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors duration-200",children:"Cancel Application"})]})]})}):null},cs=t=>{let{isVisible:r,message:o,onClose:a,duration:s=4e3}=t;const[n,i]=(0,e.useState)(100);return(0,e.useEffect)(()=>{if(r){i(100);const e=setTimeout(()=>{a()},s),t=setInterval(()=>{i(e=>e<=0?(clearInterval(t),0):e-100/(s/50))},50);return()=>{clearTimeout(e),clearInterval(t)}}},[r,s,a]),r?(0,jt.jsx)("div",{className:"fixed top-4 right-4 z-50 transform transition-all duration-300 ease-out translate-x-0 opacity-100",children:(0,jt.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg max-w-sm",children:[(0,jt.jsxs)("div",{className:"flex items-start gap-3",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,jt.jsx)("div",{className:"flex-1",children:(0,jt.jsx)("p",{className:"text-green-800 text-sm font-medium leading-relaxed",children:o})}),(0,jt.jsx)("button",{onClick:a,className:"flex-shrink-0 text-green-400 hover:text-green-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,jt.jsx)("div",{className:"mt-3 h-1 bg-green-200 rounded-full overflow-hidden",children:(0,jt.jsx)("div",{className:"h-full bg-green-500 rounded-full transition-all duration-50 ease-linear",style:{width:"".concat(n,"%")}})})]})}):null},ds=()=>{var t,r,o,s,n,i,l;const{state:c}=Go(),d=ne(),u=ss(),h=as(u,{setAppliedPositions:u.setAppliedPositions,setSelectedPosition:u.setSelectedPosition,setComment:u.setComment,setPositionComments:u.setPositionComments,setHasSubmittedApplication:u.setHasSubmittedApplication,setShowWarning:u.setShowWarning,setShowSuccessToast:u.setShowSuccessToast,setShowCancelModal:u.setShowCancelModal,setCancelPositionId:u.setCancelPositionId,setShowApplyModal:u.setShowApplyModal,setApplyForm:u.setApplyForm,setIsSaved:u.setIsSaved,setActivePositionTab:u.setActivePositionTab,setPositions:u.setPositions,updateProjectData:u.updateProjectData,updatePositions:u.updatePositions,saveCollaborationData:u.saveCollaborationData}),[m,p]=(0,e.useState)(null),[g,f]=(0,e.useState)(!1),[v,x]=(0,e.useState)(null),b=()=>{f(!1),p(null),x(null)},y=(null===(t=u.currentUser)||void 0===t?void 0:t.id)===(null===(r=u.project)||void 0===r||null===(o=r.author)||void 0===o?void 0:o.id);(0,e.useEffect)(()=>{var e;"tagme"===(null===(e=d.state)||void 0===e?void 0:e.from)||c.navigationHistory.length>0&&"/tagme"===c.navigationHistory[c.navigationHistory.length-1].path||"/tagme"===d.pathname||window.scrollTo({top:0,behavior:"auto"})},[d.pathname]);null===(s={})||void 0===s||null===(n=s.env)||void 0===n||n.MODE;return u.project?(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,jt.jsx)(Ja,{project:u.project,isSaved:u.isSaved,onBack:h.goBack,onSaveToggle:h.handleSaveToggle,onApplyNow:h.handleApplyNowClick,onViewMilestones:h.handleViewMilestones,enableProjectProgressBar:u.enableProjectProgressBar,hasSubmittedApplication:u.hasSubmittedApplication}),(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,jt.jsx)(Ka,{project:u.project,positions:u.positions,hasSubmittedApplication:u.hasSubmittedApplication,showWarning:u.showWarning,appliedPositions:u.appliedPositions,onApply:h.handleApply,onCancelApplication:h.handleCancelApplication,onFillPosition:h.handleFillPosition,getStatusColor:h.getStatusColor,getStatusText:h.getStatusText,currentUser:u.currentUser,onApplicationClick:(e,t,r)=>{var o;console.log("[handleApplicationClick] Application:",e),console.log("[handleApplicationClick] Application type:",typeof e),console.log("[handleApplicationClick] Application keys:",e?Object.keys(e):"null"),console.log("[handleApplicationClick] Position ID:",r),g&&(f(!1),p(null),x(null));const s=u.positions.find(e=>e.id===r),n=null===s||void 0===s||null===(o=s.applications)||void 0===o?void 0:o.find(t=>t.id===e.id||t.userId===e.userId),i=(0,a.A)((0,a.A)({},e),{},{positionId:r,status:(null===n||void 0===n?void 0:n.status)||e.status||"pending"});console.log("[handleApplicationClick] Application with position:",i),console.log("[handleApplicationClick] App in position status:",null===n||void 0===n?void 0:n.status),console.log("[handleApplicationClick] Final application status:",i.status),console.log("[handleApplicationClick] Application with position:",i),console.log("[handleApplicationClick] App in position status:",null===n||void 0===n?void 0:n.status),p(i),x(t.currentTarget),f(!0)},isInitiator:y}),(0,jt.jsx)("div",{className:"lg:col-span-1",children:(0,jt.jsx)(is,{project:u.project,owner:u.project.author,currentUser:u.currentUser,eligibility:{isMemberCompleted:!0}})})]})}),(0,jt.jsx)(Ga,{isOpen:u.showApplyModal,onClose:()=>u.setShowApplyModal(!1),applyForm:u.applyForm,onFormChange:h.handleApplyFormChange,onSubmit:h.handleApplySubmit}),(0,jt.jsx)(cs,{isVisible:u.showSuccessToast,message:"Application submitted successfully! You can now apply for specific positions.",onClose:()=>u.setShowSuccessToast(!1),duration:5e3}),(0,jt.jsx)(ls,{isOpen:u.showCancelModal,onClose:h.handleCloseCancelModal,onConfirm:h.handleConfirmCancelApplication,positionTitle:(null===(i=u.positions)||void 0===i||null===(l=i.find(e=>e.id===u.cancelPositionId))||void 0===l?void 0:l.title)||"this position"}),(0,jt.jsx)(Ba,{isOpen:g,onClose:b,application:m,onApprove:async(e,t)=>{var r,o,s,n,i,l,c;console.log("Approving application:",e,"for position:",t),console.log("Current project data:",u.project),console.log("Current project collaborators:",null===(r=u.project)||void 0===r?void 0:r.collaborators);const d=u.positions.find(e=>e.id===t);if(d&&d.applications){if(d.applications.find(t=>(t.id===e.id||t.userId===e.userId)&&"approved"===t.status))return void console.log("Application already approved for this position:",e.name,t)}if(((null===(o=u.project)||void 0===o?void 0:o.collaborators)||(null===(s=u.project)||void 0===s||null===(n=s.vision)||void 0===n?void 0:n.collaborators)||[]).some(r=>(r.id===e.id||r.userId===e.userId)&&r.positionId===t))return void console.log("Application already in collaborators for this position:",e.name,t);console.log("Application not yet approved for this position, proceeding with approval:",e.name,t);const g=(null===d||void 0===d?void 0:d.title)||"Unknown Position",f={id:"".concat(e.id||e.userId,"_").concat(t,"_").concat(Date.now()),name:e.name,avatar:e.avatar||"/assets/placeholder.svg",role:"Collaborator",positionId:t,positionTitle:g,email:e.email,portfolio:e.portfolio,approvedAt:(new Date).toISOString()},v=(null===(i=u.project)||void 0===i?void 0:i.collaborators)||(null===(l=u.project)||void 0===l||null===(c=l.vision)||void 0===c?void 0:c.collaborators)||[];console.log("Existing collaborators:",v);const x=(0,a.A)((0,a.A)({},u.project),{},{collaborators:[...v,f]}),y=(0,a.A)((0,a.A)({},u.project.vision),{},{collaborators:[...v,f]}),w=(0,a.A)((0,a.A)({},x),{},{vision:y}),j=u.positions.map(r=>{if(r.id===t&&r.applications){const t=r.applications.map(t=>t.id===e.id||t.userId===e.userId?(0,a.A)((0,a.A)({},t),{},{status:"approved"}):t);return(0,a.A)((0,a.A)({},r),{},{applications:t})}return r}),k=e.id||e.userId,S=await Ua.updateApplicationStatus(u.project.id,t,k,"approved");S.success?console.log("[handleApproveApplication] Successfully saved application status to applicationService"):console.error("[handleApproveApplication] Failed to save application status to applicationService:",S.error);const N=e.id||e.userId,C=((e,t,r)=>{try{const o="".concat(za,":").concat(e,":").concat(t),a={status:r,timestamp:Date.now(),positionId:e,applicantId:t};return localStorage.setItem(o,JSON.stringify(a)),console.log("[applicationStorage] Saved status: ".concat(r," for position ").concat(e,", applicant ").concat(t)),{success:!0}}catch(o){return console.error("[applicationStorage] Failed to save application status:",o),{success:!1,error:o.message}}})(t,N,"approved");C.success?console.log("[handleApproveApplication] Successfully saved application status to applicationStorage"):console.error("[handleApproveApplication] Failed to save application status to applicationStorage:",C.error),h.updateProjectData(w),h.updatePositions(j),h.saveCollaborationData(w),!m||m.id!==e.id&&m.userId!==e.userId||m.positionId!==t||(console.log("[handleApproveApplication] Updating selectedApplication status to approved"),p((0,a.A)((0,a.A)({},m),{},{status:"approved"}))),console.log("Application approved for position:",g,"New collaborator added:",f),console.log("Updated project with collaborators:",w);try{var _,A;console.log("[handleApproveApplication] Attempting to send notification to:",e.userId||e.id),console.log("[handleApproveApplication] Application ID vs UserID:",{id:e.id,userId:e.userId}),console.log("[handleApproveApplication] Notification data:",{userId:e.userId||e.id,type:"collaboration",title:"Application Approved",message:'Your application for "'.concat(g,'" position in "').concat(u.project.name,'" has been approved! You are now a collaborator.'),projectId:u.project.id,meta:{action:"application_approved",collaborationId:u.project.id,collaborationTitle:u.project.name,positionId:t,positionTitle:g,approvedBy:(null===(_=u.currentUser)||void 0===_?void 0:_.name)||"Project Owner"}});const r=await Jr.createGeneralNotification({userId:e.userId||e.id,type:"collaboration",title:"Application Approved",message:'Your application for "'.concat(g,'" position in "').concat(u.project.name,'" has been approved! You are now a collaborator.'),projectId:u.project.id,meta:{action:"application_approved",collaborationId:u.project.id,collaborationTitle:u.project.name,positionId:t,positionTitle:g,approvedBy:(null===(A=u.currentUser)||void 0===A?void 0:A.name)||"Project Owner"}});console.log("[handleApproveApplication] Notification result:",r),console.log("[handleApproveApplication] Approval notification sent successfully")}catch(I){console.error("[handleApproveApplication] Failed to send approval notification:",I)}setTimeout(()=>{b()},2e3)},onContact:()=>{console.log("Contacting applicant")},isInitiator:y,anchorElement:v,positionId:null===m||void 0===m?void 0:m.positionId,positions:u.positions})]}):(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Loading collaboration details..."})]})})},us=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},hs=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var ms={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ps=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],gs=(0,e.forwardRef)((t,r)=>{let{color:s="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u}=t,h=o(t,ps);return(0,e.createElement)("svg",(0,a.A)((0,a.A)((0,a.A)({ref:r},ms),{},{width:n,height:n,stroke:s,strokeWidth:l?24*Number(i)/Number(n):i,className:hs("lucide",c)},!d&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"}),h),[...u.map(t=>{let[r,o]=t;return(0,e.createElement)(r,o)}),...Array.isArray(d)?d:[d]])}),fs=["className"],vs=(t,r)=>{const s=(0,e.forwardRef)((s,n)=>{let{className:i}=s,l=o(s,fs);return(0,e.createElement)(gs,(0,a.A)({ref:n,iconNode:r,className:hs("lucide-".concat((c=us(t),c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(t),i)},l));var c});return s.displayName=us(t),s},xs=vs("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),bs="Modal_overlay__P+H2T",ys="Modal_modal__rilJw",ws="Modal_closeButton__9bf7g",js="Modal_content__pgGBX",ks="Modal_title__Wb1XE",Ss="Modal_body__UvKYn",Ns="Modal_emailLink__FjN3V",Cs="Modal_divider__RvwIc",_s="Modal_signature__g8MvT",As="Modal_actions__o32Lt",Is="Modal_primaryButton__lttlk",Ps=e=>{let{isOpen:t,onClose:r,onGoToCompetition:o}=e;if(!t)return null;return(0,jt.jsx)("div",{className:bs,onClick:e=>{e.target===e.currentTarget&&r()},children:(0,jt.jsxs)("div",{className:ys,children:[(0,jt.jsx)("button",{className:ws,onClick:r,children:(0,jt.jsx)(xs,{size:20})}),(0,jt.jsxs)("div",{className:js,children:[(0,jt.jsx)("h2",{className:ks,children:"Student Competitions 2025 \u2014 Notice"}),(0,jt.jsxs)("div",{className:Ss,children:[(0,jt.jsx)("p",{children:"This competition is currently in testing (beta)."}),(0,jt.jsx)("p",{children:"Some website features are still under development and will be released gradually."}),(0,jt.jsxs)("p",{children:["If you have any questions, please email:"," ",(0,jt.jsx)("a",{href:"mailto:tag@rainwang.art",className:Ns,children:"tag@rainwang.art"})]})]}),(0,jt.jsx)("div",{className:Cs}),(0,jt.jsx)("div",{className:_s,children:(0,jt.jsx)("p",{children:"Founder of TAG \u2014 Rain Wang"})}),(0,jt.jsx)("div",{className:As,children:(0,jt.jsx)("button",{className:Is,onClick:()=>{o(),r()},children:"I Understand"})})]})]})})},Es=()=>{const[t,r]=(0,e.useState)(!1);return(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("section",{className:"py-16 bg-white",children:(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[(0,jt.jsx)("h2",{className:"text-3xl md:text-4xl lg:text-5xl font-bold text-tag-blue mb-6",children:"Student Competitions 2025"}),(0,jt.jsx)("p",{className:"text-lg md:text-xl text-tag-blue mb-8 max-w-2xl mx-auto leading-relaxed opacity-90",children:"Participate in exciting design challenges and win recognition from industry professionals."}),(0,jt.jsxs)("button",{onClick:e=>{e.preventDefault(),r(!0)},className:"bg-tag-blue text-white px-8 py-3 rounded-md text-lg font-medium hover:bg-tag-dark-blue transition-colors duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1 inline-flex items-center",children:[(0,jt.jsx)("svg",{className:"w-6 h-6 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Join Now"]})]})}),(0,jt.jsx)(Ps,{isOpen:t,onClose:()=>{r(!1)},onGoToCompetition:()=>{window.location.href="/tagme/co-future-2025"}})]})},Ds={listStyle:"none",listStyleType:"none",listStyleImage:"none",listStylePosition:"outside"},Ls=t=>{let{onArtistClick:r}=t;const[o,a]=(0,e.useState)([]),[s,n]=(0,e.useState)(!0),[i,l]=(0,e.useState)(null),{navigateToArtist:c}=Xo();(0,e.useEffect)(()=>{const e=document.createElement("style");return e.textContent="\n      .no-markers::before,\n      .no-markers::after,\n      .no-markers *::before,\n      .no-markers *::after {\n        content: none !important;\n        display: none !important;\n      }\n      .no-markers {\n        list-style: none !important;\n        list-style-type: none !important;\n        list-style-image: none !important;\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}},[]),(0,e.useEffect)(()=>{d()},[]);const d=async()=>{try{n(!0);const e=await Sr.getPublicArtists();e&&e.success?(console.log("[ArtistsList] Loaded artists:",e.data.length),a(e.data)):(console.error("[ArtistsList] Failed to load artists:",null===e||void 0===e?void 0:e.error),l("Failed to load artists"))}catch(i){console.error("[ArtistsList] Error loading artists:",i),l("Error loading artists")}finally{n(!1)}};return s?(0,jt.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-tag-blue"}),(0,jt.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading artists..."})]}):i?(0,jt.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,jt.jsxs)("div",{className:"text-red-500 text-center",children:[(0,jt.jsx)("p",{className:"text-lg font-medium",children:"Error loading artists"}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:i}),(0,jt.jsx)("button",{onClick:d,className:"mt-4 px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Try Again"})]})}):0===o.length?(0,jt.jsx)("div",{className:"flex justify-center items-center py-12",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"No artists found"}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Check back later for new artists"})]})}):(0,jt.jsx)("div",{className:"space-y-0 list-none no-markers",style:Ds,children:o.map(e=>{return(0,jt.jsx)("div",{className:"group cursor-pointer bg-white border-b border-gray-200 p-6 hover:bg-gray-50 transition-all duration-300 block",style:Ds,onClick:t=>((e,t)=>{c(e.id,"artists","Artists",t.currentTarget)})(e,t),"data-artist-id":e.id,children:(0,jt.jsxs)("div",{className:"flex gap-4",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("img",{src:e.avatar||"/assets/placeholder.svg",alt:e.name,className:"w-40 h-32 object-cover rounded-lg group-hover:scale-105 transition-transform duration-300"})}),(0,jt.jsxs)("div",{className:"flex-1 flex flex-col justify-center",children:[(0,jt.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2 group-hover:text-tag-blue transition-colors duration-200",children:e.name}),(0,jt.jsx)("span",{className:"text-sm text-gray-500 mb-2",children:e.role}),(0,jt.jsx)("div",{className:"mb-4",children:e.bio?(0,jt.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.bio}):(0,jt.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,jt.jsx)("span",{className:"bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full",children:e.title||"Artist"}),e.school&&(0,jt.jsx)("span",{className:"bg-green-100 text-green-700 text-xs px-2 py-1 rounded-full",children:e.school}),e.majors&&e.majors.length>0&&e.majors.map((e,t)=>(0,jt.jsx)("span",{className:"bg-purple-100 text-purple-700 text-xs px-2 py-1 rounded-full",children:e},t))]})}),(0,jt.jsxs)("div",{className:"flex items-center gap-6 text-sm text-gray-500",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),(0,jt.jsxs)("span",{children:[e.worksCount||0," works"]})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,jt.jsxs)("span",{children:[e.followers||0," followers"]})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-1",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,jt.jsxs)("span",{children:[e.following||0," following"]})]}),(0,jt.jsx)("span",{className:"px-2 py-1 text-xs font-medium text-white rounded-full ".concat((t=e.role,{"Visual Effects":"bg-blue-500","Game Design":"bg-purple-500","UI/UX":"bg-green-500",Illustration:"bg-pink-500","Fine Art":"bg-yellow-500","3D Model":"bg-indigo-500",Animation:"bg-red-500",Photography:"bg-gray-500"}[t]||"bg-gray-500")),children:e.role}),e.school&&(0,jt.jsx)("span",{className:"text-gray-400",children:e.school})]})]})]})},e.id);var t})})},Ts=t=>{let{currentUser:r}=t;const{navigateToWork:o,navigateToArtist:a}=Xo(),[s,n]=(0,e.useState)([]),[i,l]=(0,e.useState)(!0),[c,d]=(0,e.useState)(null),u=(0,e.useCallback)(async()=>{try{l(!0),d(null);const e=await(0,sr.S5)();if(e.success){const t=await Promise.all(e.data.filter(e=>e&&e.id).map(async e=>{var t;const r=e.thumbnailPath||e.imagePaths&&e.imagePaths[0]||null;let o="/assets/placeholder.svg";if(r)try{console.log("[GalleryGrid] Converting image path: ".concat(r));const e=await(0,sr.getPortfolioImageUrl)(r);console.log("[GalleryGrid] Image conversion result:",e),e&&e.success&&e.data&&e.data.url?(o=e.data.url,console.log("[GalleryGrid] Successfully converted to: ".concat(o))):console.warn("[GalleryGrid] Invalid image result:",e)}catch(c){console.warn("[GalleryGrid] Failed to convert image path ".concat(r,":"),c)}return console.log("[GalleryGrid] Item ".concat(e.id,":"),{title:e.title,thumbnailPath:e.thumbnailPath,imagePaths:e.imagePaths,finalImage:o}),{id:e.id||"unknown",title:e.title||"Untitled",artist:(null===(t=e.profiles)||void 0===t?void 0:t.full_name)||"Unknown Artist",image:o,category:e.category||"design",tags:e.tags||[],description:e.description||"",createdAt:e.createdAt||(new Date).toISOString()}}));n(t)}else d(e.error||"Failed to load artworks"),n([])}catch(c){console.error("Error loading artworks:",c),d("Failed to load artworks"),n([])}finally{l(!1)}},[]);(0,e.useEffect)(()=>{u()},[u]);const h=s;return i?(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-0",children:[...Array(6)].map((e,t)=>(0,jt.jsx)("div",{className:"aspect-square bg-gray-200 animate-pulse"},t))}):c?(0,jt.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,jt.jsx)("div",{className:"text-gray-400 mb-4",children:(0,jt.jsx)("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Failed to load artworks"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:c}),(0,jt.jsx)("button",{onClick:u,className:"px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Try Again"})]}):0===h.length?(0,jt.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,jt.jsx)("div",{className:"text-gray-400 mb-4",children:(0,jt.jsx)("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No artworks found"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:"Be the first to upload your work and share it with the community!"}),(0,jt.jsx)(mt,{to:"/upload",className:"px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-blue-600 transition-colors",children:"Upload Your Work"})]}):(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-0",children:h.map(e=>(0,jt.jsxs)(mt,{to:"/work/".concat(e.id),className:"group cursor-pointer relative overflow-hidden aspect-square w-full h-full",children:[(0,jt.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",style:{display:"block"}}),(0,jt.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:(0,jt.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-white",children:[(0,jt.jsx)("h3",{className:"text-lg font-bold mb-1 leading-tight",children:e.title}),(0,jt.jsx)("p",{className:"text-sm text-gray-200",children:e.artist})]})})]},e.id))})},Ms=()=>{const[t,r]=(0,e.useState)(new Set),o=e=>{let{rating:t,reviews:r}=e;const o=[];for(let a=0;a<5;a++)a<t?o.push((0,jt.jsx)("svg",{className:"h-4 w-4 text-yellow-400 fill-current",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{d:"M10 15.27L16.18 19l-1.64-7.03L20 7.24l-7.19-.61L10 0 7.19 6.63 0 7.24l5.46 4.73L3.82 19z"})},a)):o.push((0,jt.jsx)("svg",{className:"h-4 w-4 text-gray-300 fill-current",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{d:"M10 15.27L16.18 19l-1.64-7.03L20 7.24l-7.19-.61L10 0 7.19 6.63 0 7.24l5.46 4.73L3.82 19z"})},a));return(0,jt.jsxs)("div",{className:"flex items-center",children:[(0,jt.jsx)("div",{className:"flex mr-1",children:o}),(0,jt.jsxs)("span",{className:"text-sm text-gray-500",children:["(",r,")"]})]})};return(0,jt.jsxs)("div",{className:"py-8",children:[(0,jt.jsx)("div",{className:"text-center py-8 mb-8",children:(0,jt.jsx)("p",{className:"text-red-500 text-lg font-medium",children:"Market feature coming soon..."})}),(0,jt.jsxs)("div",{className:"mb-8",children:[(0,jt.jsx)("h3",{className:"text-2xl font-bold text-gray-800 mb-2 text-center",children:"Marketplace Preview"}),(0,jt.jsx)("p",{className:"text-gray-600 text-center mb-8",children:"Discover student-created assets, tools, and resources"})]}),(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{id:1,image:"/assets/placeholder.svg",title:"Auto Retopology Tool",description:"Advanced mesh optimization plugin for Blender",price:"$15",originalPrice:"$25",author:"Alex Chen",authorAvatar:"/assets/placeholder.svg",rating:5,reviews:24,downloads:"1.2k"},{id:2,image:"/assets/placeholder.svg",title:"Sci-Fi Character Pack",description:"High-poly character models with PBR textures",price:"$45",originalPrice:null,author:"Maya Rodriguez",authorAvatar:"/assets/placeholder.svg",rating:4,reviews:856,downloads:"856"},{id:3,image:"/assets/placeholder.svg",title:"Procedural Building Generator",description:"Generate realistic buildings with customizable parameters",price:"$79",originalPrice:"$99",author:"John Doe",authorAvatar:"/assets/placeholder.svg",rating:4,reviews:120,downloads:"3.5k"},{id:4,image:"/assets/placeholder.svg",title:"Ocean Shader Pack",description:"Realistic ocean shaders for various rendering engines",price:"$29",originalPrice:null,author:"Oceanic Arts",authorAvatar:"/assets/placeholder.svg",rating:5,reviews:78,downloads:"900"},{id:5,image:"/assets/placeholder.svg",title:"UI Kit - Modern Dashboard",description:"Complete UI kit for modern web applications",price:"$35",originalPrice:"$50",author:"Design Studio",authorAvatar:"/assets/placeholder.svg",rating:5,reviews:156,downloads:"2.1k"},{id:6,image:"/assets/placeholder.svg",title:"Animation Rigging System",description:"Professional character rigging for Maya and Blender",price:"$89",originalPrice:null,author:"Animation Pro",authorAvatar:"/assets/placeholder.svg",rating:4,reviews:203,downloads:"1.8k"}].map(e=>(0,jt.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-4 hover:shadow-md transition-all duration-300 cursor-pointer group",children:[(0,jt.jsxs)("div",{className:"relative mb-4",children:[(0,jt.jsx)("img",{src:e.image,alt:e.title,className:"w-full aspect-[4/3] object-cover rounded-lg"}),(0,jt.jsx)("button",{onClick:t=>{var o;t.stopPropagation(),o=e.id,r(e=>{const t=new Set(e);return t.has(o)?t.delete(o):t.add(o),t})},className:"absolute top-2 right-2 p-2 bg-white/80 backdrop-blur-sm rounded-full hover:bg-white transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-5 h-5 ".concat(t.has(e.id)?"text-red-500 fill-current":"text-gray-400 hover:text-red-500"),fill:t.has(e.id)?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsx)("h4",{className:"text-lg font-bold text-gray-900 group-hover:text-tag-blue transition-colors duration-200",children:e.title}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 line-clamp-2",children:e.description}),(0,jt.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,jt.jsx)("span",{className:"text-xl font-bold text-tag-blue",children:e.price}),e.originalPrice&&(0,jt.jsx)("span",{className:"text-sm text-gray-400 line-through",children:e.originalPrice})]}),(0,jt.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),(0,jt.jsxs)("span",{children:[e.downloads," downloads"]})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100",children:[(0,jt.jsxs)("div",{className:"flex items-center",children:[(0,jt.jsx)("img",{src:e.authorAvatar,alt:e.author,className:"w-6 h-6 rounded-full mr-2"}),(0,jt.jsx)("span",{className:"text-sm text-gray-700",children:e.author})]}),(0,jt.jsx)(o,{rating:e.rating,reviews:e.reviews})]})]})]},e.id))})]})},Fs=()=>{const[t,r]=(0,e.useState)("Works"),[o,a]=(0,e.useState)(!0),{user:s}=St(),{navigateToArtist:n}=Xo(),{state:i}=Go(),l=ne();(0,e.useEffect)(()=>{var e,t;if(i.navigationHistory.length>0){const e=i.navigationHistory[i.navigationHistory.length-1];if(console.log("[GallerySection] Navigation history:",e),e.fromNavbar&&"gallery"===e.from)return console.log("[GallerySection] From navbar Gallery button, setting Works tab"),r("Works"),void a(!1)}if("upload-success"===(null===(e=l.state)||void 0===e?void 0:e.from))r(l.state.activeTab||"Works"),l.state.scrollToGallery?requestAnimationFrame(()=>{const e=document.querySelector('[data-section="gallery"]');if(e){const t=e.getBoundingClientRect(),r=window.pageYOffset+t.top-80;window.scrollTo({top:r,behavior:"auto"})}a(!1)}):a(!1),window.history.replaceState({},document.title);else if("artist-profile"===(null===(t=l.state)||void 0===t?void 0:t.from)){console.log("[GallerySection] Returning from artist-profile, setting activeTab:",l.state.activeTab),r(l.state.activeTab||"Works");const e=i.scrollPositions["/"];if(e){const t="object"===typeof e?e.scrollY:e,r="object"===typeof e?e.elementInfo:null;console.log("[GallerySection] Restoring saved position:",t),console.log("[GallerySection] Element info:",r),requestAnimationFrame(()=>{window.scrollTo({top:t,behavior:"auto"}),r&&"artist"===r.type&&setTimeout(()=>{const e=document.querySelector('[data-artist-id="'.concat(r.id,'"]'));console.log("[GallerySection] Target element found:",!!e),e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("bg-blue-50","border-2","border-blue-300"),setTimeout(()=>{e.classList.remove("bg-blue-50","border-2","border-blue-300")},2e3))},100)})}else l.state.scrollToGallery&&requestAnimationFrame(()=>{const e=document.querySelector('[data-section="gallery"]');if(e){const t=e.getBoundingClientRect(),r=window.pageYOffset+t.top-80;window.scrollTo({top:r,behavior:"auto"})}});a(!1),window.history.replaceState({},document.title)}else{const e=i.scrollPositions["/"];if(void 0!==e&&requestAnimationFrame(()=>{window.scrollTo({top:e,behavior:"auto"})}),i.navigationHistory.length>0){const e=i.navigationHistory[i.navigationHistory.length-1];e.activeTab&&"gallery"===e.from&&!e.fromNavbar?r(e.activeTab):r("Works")}else r("Works");a(!1)}},[l.state,i.scrollPositions,i.navigationHistory]);const c=["Works","Artists","Market"];return o?(0,jt.jsx)("section",{className:"py-16 bg-gray-50","data-section":"gallery",children:(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,jt.jsxs)("div",{className:"flex flex-col mb-8",children:[(0,jt.jsx)("h2",{className:"text-3xl font-bold text-gray-400 mb-6",children:"TAG Gallery"}),(0,jt.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,jt.jsx)("div",{className:"w-7/12",children:(0,jt.jsx)("div",{className:"h-10 bg-gray-200 rounded-md animate-pulse"})}),(0,jt.jsx)("div",{className:"inline-flex rounded-full border border-gray-300 bg-white p-1",children:c.map(e=>(0,jt.jsxs)("button",{className:"relative px-12 py-3 text-base font-semibold tracking-wide ".concat(t===e?"text-white":"text-gray-700"),children:[t===e&&(0,jt.jsx)("div",{className:"absolute inset-0 bg-tag-blue rounded-full"}),(0,jt.jsx)("span",{className:"relative z-10",children:e})]},e))})]})]}),(0,jt.jsx)("div",{className:"flex-1",children:(0,jt.jsx)("div",{className:"animate-pulse",children:(0,jt.jsx)("div",{className:"h-64 bg-gray-200 rounded-lg"})})})]})}):(0,jt.jsx)("section",{className:"py-16 bg-gray-50","data-section":"gallery",children:(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,jt.jsxs)("div",{className:"flex flex-col mb-8",children:[(0,jt.jsx)("h2",{className:"text-3xl font-bold text-gray-400 mb-6",children:"TAG Gallery"}),(0,jt.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,jt.jsx)("div",{className:"w-7/12",children:(0,jt.jsx)(_t,{onInputChange:e=>console.log("Search:",e.target.value),placeholder:"Search for Works or Artists",className:"w-full"})}),(0,jt.jsx)("div",{className:"inline-flex rounded-full border border-gray-300 bg-white p-1",children:c.map((e,o)=>(0,jt.jsxs)("button",{onClick:()=>r(e),className:"relative px-12 py-3 text-base font-semibold tracking-wide transition-all duration-300 ease-in-out ".concat(t===e?"text-white":"text-gray-700 hover:text-gray-900"),children:[t===e&&(0,jt.jsx)("div",{className:"absolute inset-0 bg-tag-blue rounded-full transition-all duration-300 ease-in-out"}),(0,jt.jsx)("span",{className:"relative z-10",children:e})]},e))})]})]}),(0,jt.jsxs)("div",{className:"flex flex-col lg:flex-row gap-4",children:[(0,jt.jsx)("div",{className:"hidden lg:block lg:w-64 flex-shrink-0",children:(0,jt.jsx)(Vo,{})}),(0,jt.jsxs)("div",{className:"flex-1",children:["Works"===t&&(0,jt.jsx)(Ts,{currentUser:s}),"Artists"===t&&(0,jt.jsx)(Ls,{onArtistClick:e=>{n(e.id,"gallery",t)}}),"Market"===t&&(0,jt.jsx)(Ms,{})]})]})]})})},Rs=()=>{const e=ce();return(0,jt.jsx)("section",{className:"pt-20 pb-16 bg-white",children:(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[(0,jt.jsx)("h1",{className:"text-4xl md:text-5xl lg:text-6xl text-gray-900 leading-tight",children:"One Platform"}),(0,jt.jsx)("p",{className:"font-bold text-4xl md:text-5xl lg:text-6xl text-gray-900 md:whitespace-nowrap tracking-tight mb-12",children:"All Students Across All Majors"}),(0,jt.jsx)("p",{className:"text-base md:text-lg text-gray-600 mt-1 mb-10 max-w-3xl mx-auto leading-relaxed",children:"A bridge for art students to showcase, connect, and collaborate"}),(0,jt.jsx)("button",{onClick:()=>{e("/about")},className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-md text-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:"About TAG"})]})})},Os=t=>{let{email:r,onEmailChange:o,onNextStep:a,error:s,setError:n,isLoading:i,setIsLoading:l}=t;const[c,d]=(0,e.useState)(!1),u=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);return(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:"Enter your email address and we'll send you a verification code to reset your password."})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"resetEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student Email"}),(0,jt.jsxs)("div",{className:"flex space-x-2",children:[(0,jt.jsx)("div",{className:"relative flex-1",children:(0,jt.jsx)("input",{id:"resetEmail",type:"email",value:r,onChange:e=>o(e.target.value),placeholder:"your.name@university.edu",className:"block w-full px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm ".concat(s?"border-red-300":"border-gray-300")})}),(0,jt.jsx)("button",{type:"button",onClick:async()=>{if(r)if(u(r)){d(!0);try{console.log("Sending reset code to:",r),setTimeout(()=>{d(!1),a()},1e3)}catch(s){console.error("Failed to send reset code:",s),d(!1),n("email","Failed to send reset code, please try again")}}else n("email","Please enter a valid email address");else n("email","Please enter your email address")},disabled:c||!r,className:"px-4 py-3 text-sm font-medium rounded-md whitespace-nowrap transition-colors duration-200 ".concat(r&&!c?"text-white bg-tag-blue hover:bg-tag-dark-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue":"text-gray-400 bg-gray-200 cursor-not-allowed"),children:c?"Sending...":"Send Code"})]}),s&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:s})]}),(0,jt.jsx)("div",{className:"flex space-x-3 pt-4",children:(0,jt.jsx)("button",{type:"button",onClick:()=>{r?u(r)?a():n("email","Please enter a valid email address"):n("email","Please enter your email address")},disabled:!r||i,className:"flex-1 bg-tag-blue text-white py-3 px-4 rounded-md text-sm font-medium hover:bg-tag-dark-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:"Continue"})}),(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsx)("p",{className:"text-xs text-gray-500",children:"Development Mode: You can continue without sending a real verification code."})})]})},Us=e=>{let{email:t,verificationCode:r,onCodeChange:o,onPreviousStep:a,onNextStep:s,error:n,setError:i,isLoading:l,setIsLoading:c}=e;return(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsxs)("p",{className:"text-sm text-gray-600",children:["We've sent a verification code to"," ",(0,jt.jsx)("span",{className:"font-medium text-gray-900",children:t})]}),(0,jt.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Please check your email and enter the 6-digit code below."})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"verificationCode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Verification Code"}),(0,jt.jsx)("input",{id:"verificationCode",type:"text",value:r,onChange:e=>o(e.target.value),placeholder:"Enter 6-digit code",maxLength:"6",className:"block w-full px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm text-center text-lg tracking-widest ".concat(n?"border-red-300":"border-gray-300")}),n&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:n})]}),(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsx)("button",{type:"button",className:"text-sm text-tag-blue hover:text-tag-dark-blue font-medium",onClick:()=>a(),children:"Didn't receive the code? Try again"})}),(0,jt.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,jt.jsx)("button",{type:"button",onClick:a,className:"flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-md text-sm font-medium hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200",children:"Back"}),(0,jt.jsx)("button",{type:"button",onClick:async()=>{if(r)if(/^\d{6}$/.test(r)){c(!0);try{console.log("Verifying code:",r,"for email:",t),setTimeout(()=>{c(!1),s()},1e3)}catch(n){console.error("Failed to verify code:",n),c(!1),i("verificationCode","Invalid verification code, please try again")}}else i("verificationCode","Verification code should be 6 digits");else i("verificationCode","Please enter the verification code")},disabled:!r||l,className:"flex-1 bg-tag-blue text-white py-3 px-4 rounded-md text-sm font-medium hover:bg-tag-dark-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:l?"Verifying...":"Verify Code"})]}),(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("p",{className:"text-xs text-gray-500",children:"Development Mode: You can enter any 6 digits to continue."}),(0,jt.jsx)("button",{type:"button",onClick:()=>{r?s():i("verificationCode","Please enter a verification code (or any 6 digits for testing)")},className:"text-xs text-tag-blue hover:text-tag-dark-blue mt-1",children:"Skip verification (dev mode)"})]})]})},zs=t=>{let{newPassword:r,confirmPassword:o,onPasswordChange:a,onPreviousStep:s,onComplete:n,error:i,setError:l,setGeneralError:c,isLoading:d,setIsLoading:u}=t;const[h,m]=(0,e.useState)(!1),[p,g]=(0,e.useState)(!1);return(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:"Create a new password for your account."}),(0,jt.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Make sure it's secure and easy to remember."})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("input",{id:"newPassword",type:h?"text":"password",value:r,onChange:e=>a("newPassword",e.target.value),placeholder:"Enter new password",className:"block w-full pr-10 px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm ".concat(i.newPassword?"border-red-300":"border-gray-300")}),(0,jt.jsx)("button",{type:"button",onClick:()=>m(!h),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:h?(0,jt.jsx)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,jt.jsxs)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),i.newPassword&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i.newPassword})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm New Password"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("input",{id:"confirmPassword",type:p?"text":"password",value:o,onChange:e=>a("confirmPassword",e.target.value),placeholder:"Confirm new password",className:"block w-full pr-10 px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm ".concat(i.confirmPassword?"border-red-300":"border-gray-300")}),(0,jt.jsx)("button",{type:"button",onClick:()=>g(!p),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:p?(0,jt.jsx)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,jt.jsxs)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),i.confirmPassword&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:i.confirmPassword})]}),(0,jt.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:[(0,jt.jsx)("p",{className:"text-sm text-blue-800",children:(0,jt.jsx)("strong",{children:"Password requirements:"})}),(0,jt.jsxs)("ul",{className:"text-sm text-blue-700 mt-1 space-y-1",children:[(0,jt.jsx)("li",{children:"\u2022 At least 6 characters long"}),(0,jt.jsx)("li",{children:"\u2022 Easy to remember but hard to guess"})]})]}),(0,jt.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,jt.jsx)("button",{type:"button",onClick:s,className:"flex-1 bg-gray-200 text-gray-700 py-3 px-4 rounded-md text-sm font-medium hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors duration-200",children:"Back"}),(0,jt.jsx)("button",{type:"button",onClick:async()=>{if(l("newPassword",""),l("confirmPassword",""),c(""),r)if(r.length>=6)if(o)if(((e,t)=>e===t)(r,o)){u(!0);try{console.log("Resetting password to:",r),setTimeout(()=>{u(!1),alert("Password reset successfully! You can now login with your new password."),n()},1e3)}catch(i){console.error("Failed to reset password:",i),u(!1),c("Failed to reset password, please try again")}}else l("confirmPassword","Passwords do not match");else l("confirmPassword","Please confirm your new password");else l("newPassword","Password must be at least 6 characters");else l("newPassword","Please enter a new password")},disabled:!r||!o||d,className:"flex-1 bg-tag-blue text-white py-3 px-4 rounded-md text-sm font-medium hover:bg-tag-dark-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:d?"Resetting...":"Reset Password"})]})]})},Ws=t=>{let{isOpen:r,onClose:o}=t;const[s,n]=(0,e.useState)("email"),[i,l]=(0,e.useState)({email:"",verificationCode:"",newPassword:"",confirmPassword:""}),[c,d]=(0,e.useState)({}),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(!1),g=e=>{n(e),d({})},f=e=>{n(e),d({})},v=()=>{n("email"),l({email:"",verificationCode:"",newPassword:"",confirmPassword:""}),d({}),h(!1),p(!1),o()},x=(e,t)=>{l(r=>(0,a.A)((0,a.A)({},r),{},{[e]:t})),c[e]&&d(t=>{const r=(0,a.A)({},t);return delete r[e],r})},b=(e,t)=>{d(r=>(0,a.A)((0,a.A)({},r),{},{[e]:t}))};return r?(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Reset Password"}),(0,jt.jsx)("button",{onClick:v,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,jt.jsxs)("div",{className:"p-6",children:[(0,jt.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat("email"===s?"bg-tag-blue text-white":"bg-gray-200 text-gray-600"),children:"1"}),(0,jt.jsx)("div",{className:"w-2 h-0.5 ".concat("code"===s||"password"===s?"bg-tag-blue":"bg-gray-200")}),(0,jt.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat("code"===s||"password"===s?"bg-tag-blue text-white":"bg-gray-200 text-gray-600"),children:"2"}),(0,jt.jsx)("div",{className:"w-2 h-0.5 ".concat("password"===s?"bg-tag-blue":"bg-gray-200")}),(0,jt.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ".concat("password"===s?"bg-tag-blue text-white":"bg-gray-200 text-gray-600"),children:"3"})]})}),"email"===s&&(0,jt.jsx)(Os,{email:i.email,onEmailChange:e=>x("email",e),onNextStep:()=>g("code"),error:c.email,setError:b,isLoading:m,setIsLoading:p}),"code"===s&&(0,jt.jsx)(Us,{email:i.email,verificationCode:i.verificationCode,onCodeChange:e=>x("verificationCode",e),onPreviousStep:()=>f("email"),onNextStep:()=>g("password"),error:c.verificationCode,setError:b,isLoading:u,setIsLoading:h}),"password"===s&&(0,jt.jsx)(zs,{newPassword:i.newPassword,confirmPassword:i.confirmPassword,onPasswordChange:(e,t)=>x(e,t),onPreviousStep:()=>f("code"),onComplete:v,error:c,setError:b,setGeneralError:e=>{d(t=>(0,a.A)((0,a.A)({},t),{},{general:e}))},isLoading:u,setIsLoading:h}),c.general&&(0,jt.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,jt.jsx)("p",{className:"text-sm text-red-600",children:c.general})})]})]})}):null},Bs=()=>{const t=ce(),{login:r}=St(),[o,s]=(0,e.useState)({email:"",password:"",rememberMe:!1}),[n,i]=(0,e.useState)(!1),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)("");e.useEffect(()=>{const e=setTimeout(()=>{const e=document.getElementById("email"),t=document.getElementById("password");e&&""!==e.value&&(e.value="",s(e=>(0,a.A)((0,a.A)({},e),{},{email:""}))),t&&""!==t.value&&(t.value="",s(e=>(0,a.A)((0,a.A)({},e),{},{password:""})))},100);return()=>clearTimeout(e)},[]);const h=e=>{const{name:t,value:r,type:o,checked:n}=e.target;s(e=>(0,a.A)((0,a.A)({},e),{},{[t]:"checkbox"===o?n:r}))};return(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,jt.jsx)("div",{className:"flex-1 flex items-center justify-center px-4 sm:px-6 lg:px-8",children:(0,jt.jsx)("div",{className:"max-w-md w-full space-y-8",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,jt.jsx)("div",{className:"text-center mb-8",children:(0,jt.jsx)("img",{src:"/TAG_Logo.png",alt:"TAG Logo",className:"h-12 w-auto mx-auto mb-6"})}),(0,jt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),i(!0);try{const e=await r(o.email,o.password);if(e.success){u("");try{var a;const{data:{session:e}}=await wt.supabase.auth.getSession();null!==e&&void 0!==e&&null!==(a=e.user)&&void 0!==a&&a.id?t("/artist/".concat(e.user.id)):t("/")}catch(s){console.warn("Failed to get session, redirecting to home:",s),t("/")}}else console.error("Login failed:",e.error),u(e.error||"Login failed. Please try again.")}catch(s){console.error("Login error:",s)}finally{i(!1)}},className:"space-y-6",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student Email"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,jt.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),(0,jt.jsx)("input",{id:"email",name:"email",type:"email",required:!0,value:o.email,onChange:h,placeholder:"your.name@university.edu",autoComplete:"off",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,jt.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,jt.jsx)("input",{id:"password",name:"password",type:"password",required:!0,value:o.password,onChange:h,placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",autoComplete:"off",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-tag-blue focus:border-tag-blue sm:text-sm"})]})]}),d&&(0,jt.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,jt.jsxs)("div",{className:"flex",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,jt.jsx)("div",{className:"ml-3",children:(0,jt.jsx)("p",{className:"text-sm text-red-700",children:d})})]})}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{className:"flex items-center",children:[(0,jt.jsx)("input",{id:"rememberMe",name:"rememberMe",type:"checkbox",checked:o.rememberMe,onChange:h,className:"h-4 w-4 text-tag-blue focus:ring-tag-blue border-gray-300 rounded"}),(0,jt.jsx)("label",{htmlFor:"rememberMe",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]}),(0,jt.jsx)("div",{className:"text-sm",children:(0,jt.jsx)("button",{type:"button",onClick:()=>c(!0),className:"font-medium text-tag-blue hover:text-tag-dark-blue",children:"Forgot password?"})})]}),(0,jt.jsxs)("button",{type:"submit",disabled:n,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-tag-blue hover:bg-tag-dark-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:[n?(0,jt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,jt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,jt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,n?"Signing in...":"Sign in"]})]}),(0,jt.jsx)("div",{className:"mt-6 flex justify-center",children:(0,jt.jsx)(mt,{to:"/register",className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue transition-colors duration-200",children:"Sign Up"})})]})})}),(0,jt.jsx)("footer",{className:"bg-white border-t border-gray-200",children:(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,jt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,jt.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,jt.jsx)("span",{className:"font-bold",children:"Tech Art Guide"}),(0,jt.jsx)("span",{className:"ml-2",children:"\xa9 2025 TAG. All rights reserved."})]}),(0,jt.jsxs)("div",{className:"flex space-x-6 text-sm text-gray-500",children:[(0,jt.jsx)("a",{href:"#",className:"hover:text-gray-700",children:"Privacy Policy"}),(0,jt.jsx)("a",{href:"#",className:"hover:text-gray-700",children:"Terms of Service"}),(0,jt.jsx)("a",{href:"#",className:"hover:text-gray-700",children:"Help Center"})]})]})})}),(0,jt.jsx)(Ws,{isOpen:l,onClose:()=>c(!1)})]})},Gs=e=>{let{comment:t,onCommentChange:r,onCommentSubmit:o,comments:a,onNavigateToArtist:s}=e;return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,jt.jsxs)("form",{onSubmit:o,className:"space-y-4",children:[(0,jt.jsx)("textarea",{value:t,onChange:r,placeholder:"Share your thoughts, feedback, or questions...",className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:"3"}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("button",{type:"button",className:"flex items-center gap-2 text-sm text-gray-600 hover:text-gray-800 transition-colors duration-200",children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),"Attach Image"]}),(0,jt.jsx)("button",{type:"submit",disabled:!t.trim(),className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Comment"})]})]})}),(0,jt.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,jt.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:(0,jt.jsxs)("div",{className:"flex items-start gap-4",children:[(0,jt.jsx)(mt,{to:"/artist/".concat(e.user),className:"w-10 h-10 rounded-full flex-shrink-0 cursor-pointer hover:opacity-80 transition-opacity duration-200",children:(0,jt.jsx)("img",{src:e.avatar,alt:e.user,className:"w-10 h-10 rounded-full"})}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,jt.jsx)(mt,{to:"/artist/".concat(e.user),className:"font-medium text-gray-900 cursor-pointer hover:text-tag-blue transition-colors duration-200",children:e.user}),(0,jt.jsx)("span",{className:"text-xs text-gray-500",children:"\u2022"}),(0,jt.jsx)("span",{className:"text-xs text-gray-500",children:e.role}),(0,jt.jsx)("span",{className:"text-xs text-gray-500",children:"\u2022"}),(0,jt.jsx)("span",{className:"text-xs text-gray-500",children:e.timestamp})]}),(0,jt.jsx)("p",{className:"text-gray-700 mb-3",children:e.comment}),(0,jt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,jt.jsxs)("button",{className:"flex items-center gap-1 text-sm text-gray-500 hover:text-gray-700 transition-colors duration-200",children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),e.likes]}),(0,jt.jsx)("button",{className:"text-sm text-gray-500 hover:text-gray-700 transition-colors duration-200",children:"Reply"})]})]})]})},e.id))})]})},Hs=e=>{let{goBack:t,project:r}=e;return(0,jt.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,jt.jsxs)("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors duration-200",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to TAGMe"]}),(0,jt.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[(0,jt.jsx)("button",{onClick:t,className:"hover:text-tag-blue transition-colors duration-200",children:"TAGMe"}),(0,jt.jsx)("span",{className:"mx-2",children:"/"}),(0,jt.jsx)("span",{children:"Milestones"}),(0,jt.jsx)("span",{className:"mx-2",children:"/"}),(0,jt.jsx)("span",{className:"text-gray-900 font-medium",children:r.title})]})]})})},qs=e=>{var t,r,o,a,s,n,i,l,c,d;let{project:u,onNavigateToArtist:h}=e;return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,jt.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Project Details"}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Expected Team Size:"})," ",u.teamSize||"Not specified"]})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Duration:"})," ",u.duration||"Not specified"]})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,jt.jsx)("span",{className:"font-medium",children:"Meeting Schedule:"})," ",u.meetingSchedule||"Not specified"]})]})]})]}),(0,jt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,jt.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Team Lead"}),(0,jt.jsxs)("div",{className:"flex items-center gap-3",children:[(0,jt.jsx)("img",{src:(null===(t=u.teamLead)||void 0===t?void 0:t.artistAvatar)||(null===(r=u.teamMembers[0])||void 0===r?void 0:r.artistAvatar)||"/assets/placeholder.svg",alt:(null===(o=u.teamLead)||void 0===o?void 0:o.artist)||(null===(a=u.teamMembers[0])||void 0===a?void 0:a.artist)||"Team Lead",className:"w-12 h-12 rounded-full"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"font-medium text-gray-900",children:(null===(s=u.teamLead)||void 0===s?void 0:s.artist)||(null===(n=u.teamMembers[0])||void 0===n?void 0:n.artist)||"Initiator"}),(0,jt.jsx)("div",{className:"text-sm text-gray-500",children:"Initiator"===((null===(i=u.teamLead)||void 0===i?void 0:i.role)||(null===(l=u.teamMembers[0])||void 0===l?void 0:l.role)||"Initiator")?(0,jt.jsx)("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:"Initiator"}):(null===(c=u.teamLead)||void 0===c?void 0:c.role)||(null===(d=u.teamMembers[0])||void 0===d?void 0:d.role)||"Initiator"})]})]})]}),(0,jt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,jt.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Team Members"}),(0,jt.jsx)("div",{className:"space-y-3",children:u.teamMembers.map((e,t)=>(0,jt.jsxs)(mt,{to:"/artist/".concat(e.id),className:"flex items-center gap-3 cursor-pointer hover:bg-gray-100 p-2 rounded-lg transition-colors duration-200",children:[(0,jt.jsx)("img",{src:e.artistAvatar,alt:e.artist,className:"w-8 h-8 rounded-full"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"text-sm font-medium text-gray-900 hover:text-tag-blue transition-colors duration-200",children:e.artist}),(0,jt.jsx)("div",{className:"text-xs text-gray-500",children:"Initiator"===e.role?(0,jt.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:"Initiator"}):e.role})]})]},t))})]})]})},Vs=e=>{let{project:t,onViewProject:r,milestones:o=[]}=e;return(0,jt.jsxs)("div",{className:"lg:col-span-2",children:[(0,jt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-3",children:t.title}),(0,jt.jsx)(qa,{projectId:t.id,milestones:o,dueDate:t.dueDate,isMilestonePage:!0,onViewMilestones:()=>{console.log("View milestones for project:",t.id)}}),(0,jt.jsxs)("div",{className:"mt-12 mb-4",children:[(0,jt.jsx)("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Looking For"}),(0,jt.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,jt.jsx)("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full",children:"UI/UX Designer"}),(0,jt.jsx)("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full",children:"Frontend Developer"}),(0,jt.jsx)("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full",children:"Motion Designer"}),(0,jt.jsx)("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full",children:"Product Manager"})]})]}),(0,jt.jsx)("div",{className:"flex justify-end",children:(0,jt.jsx)("button",{onClick:r,className:"bg-purple-600 text-white py-3 px-8 rounded-lg font-medium hover:bg-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl",children:"View & Apply"})}),(0,jt.jsxs)("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Project Vision"}),(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("p",{className:"text-gray-700 italic text-lg",children:'"Building the future of creative collaboration"'})}),(0,jt.jsxs)("div",{className:"mb-4",children:[(0,jt.jsx)("h4",{className:"text-md font-semibold text-gray-900 mb-2",children:"Why This Matters"}),(0,jt.jsx)("div",{className:"text-gray-700 leading-relaxed whitespace-pre-wrap text-sm",children:"We're creating a platform that connects talented designers and developers to build amazing digital experiences together. Our vision is to make collaboration seamless, inspiring, and productive. This project will showcase the power of interdisciplinary teamwork and innovative design thinking. We're looking for passionate individuals who share our vision and want to make a real impact. Join us in building something extraordinary that will revolutionize how creative teams work together."})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-md font-semibold text-gray-900 mb-2",children:"Contact"}),(0,jt.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"})}),(0,jt.jsx)("span",{children:"project_lead#1234"})]}),(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,jt.jsx)("span",{children:"project.lead@email.com"})]})]})]})]})]})},Js=e=>({completed:"Completed","in-progress":"In Progress",upcoming:"Upcoming"}[e]||"Unknown"),Zs=e=>{let{milestones:t}=e;return(0,jt.jsx)("div",{className:"space-y-6",children:t.map((e,t)=>{return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 relative overflow-hidden",children:[e.images.length>0&&(0,jt.jsx)("div",{className:"absolute inset-0 opacity-10 pointer-events-none",children:(0,jt.jsx)("img",{src:e.images[0],alt:"".concat(e.title," background"),className:"w-full h-full object-cover"})}),(0,jt.jsxs)("div",{className:"relative z-10",children:[(0,jt.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,jt.jsxs)("span",{className:"text-sm font-medium text-purple-600 bg-purple-100 px-2 py-1 rounded-full",children:["Stage ",e.id]}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.title})]}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,jt.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,jt.jsxs)("span",{children:["Stage Due Date: ",e.dueDate]}),e.progress>0&&(0,jt.jsxs)("span",{children:[e.progress,"% complete"]})]})]}),(0,jt.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full ".concat((r=e.status,{completed:"bg-green-100 text-green-800","in-progress":"bg-blue-100 text-blue-800",upcoming:"bg-gray-100 text-gray-800"}[r]||"bg-gray-100 text-gray-800")),children:Js(e.status)})]}),e.progress>0&&(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,jt.jsx)("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.progress,"%")}})})})]})]},e.id);var r})})},Ks=t=>{let{state:r,setters:o,actions:a,navigateToCollaboration:s,project:n,comments:i}=t;const{setComment:l}=o;return{handleCommentSubmit:(0,e.useCallback)(e=>{if(e.preventDefault(),r.comment.trim()){const e={id:((null===i||void 0===i?void 0:i.length)||0)+1,user:"You",avatar:"/assets/placeholder.svg",role:"Team Member",comment:r.comment,timestamp:"Just now",likes:0};a.addComment(e),l("")}},[r.comment,i,a,l]),handleApplyToCollaboration:(0,e.useCallback)(()=>{var e,t,r,o,a;console.log("\ud83d\udd0d [DEBUG] handleApplyToCollaboration - project:",n),console.log("\ud83d\udd0d [DEBUG] handleApplyToCollaboration - project.id:",n.id);const i={id:n.id,title:n.title,subtitle:n.description,image:n.images[0]||"/assets/placeholder.svg",categories:n.tags,author:{id:(null===(e=n.teamMembers[0])||void 0===e?void 0:e.id)||(null===(t=n.teamMembers[0])||void 0===t||null===(r=t.artist)||void 0===r?void 0:r.toLowerCase())||"bryan",name:(null===(o=n.teamMembers[0])||void 0===o?void 0:o.artist)||"Initiator",avatar:(null===(a=n.teamMembers[0])||void 0===a?void 0:a.artistAvatar)||"/assets/placeholder.svg"},likes:"1.2k",views:"8.4k"};console.log("\ud83d\udd0d [DEBUG] handleApplyToCollaboration - collaborationProject:",i),console.log("\ud83d\udd0d [DEBUG] handleApplyToCollaboration - collaborationProject.id:",i.id),s(i)},[n,s])}},Ys=()=>{const[t,r]=(0,e.useState)("timeline"),[o,a]=(0,e.useState)("");return(0,e.useMemo)(()=>({state:{activeTab:t,comment:o},setters:{setActiveTab:r,setComment:a}}),[t,o])},Qs=()=>{var t;const{goBack:r,navigateToArtist:o,navigateToCollaboration:a}=Xo(),{state:s,actions:n}=Go(),i=ne(),{id:l}=de(),c=s.selectedMilestone||(null===(t=i.state)||void 0===t?void 0:t.milestone),d=l||(null===c||void 0===c?void 0:c.id)||1,u=((e,t)=>e?{id:t,title:e.title,description:e.description,progress:e.progress||75,dueDate:e.dueDate||"March 15, 2024",projectType:e.projectType||"Project",teamSize:e.teamSize||2,duration:e.duration||"3-4 months",meetingSchedule:e.meetingSchedule||"2-3 times/week",tags:e.tags||["Project"],teamLead:e.teamLead||{artist:"Alex Chen",artistAvatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face",role:"Initiator"},teamMembers:e.teamMembers||[{id:1,title:"Cyberpunk Street Scene",artist:"Alex Chen",artistAvatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face",description:"A futuristic city street with vibrant neon signs and cyberpunk aesthetics",image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",category:"Visual Effects",likes:"1.2k",views:"8.4k",timeAgo:"2 days ago",role:"Character Designer"},{id:2,title:"Dragon Knight Concept",artist:"Maya Rodriguez",artistAvatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=100&h=100&fit=crop&crop=face",description:"Detailed illustration of a knight in dark, ornate armor",image:"https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400&h=300&fit=crop",category:"Game Design",likes:"2.1k",views:"12k",timeAgo:"5 days ago",role:"Art Director"}],images:["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=400&h=300&fit=crop"]}:{id:t,title:"Fantasy Character Series",description:"Digital illustration project exploring mythical creatures and fantasy character design. This collaborative project focuses on creating a series of unique characters with distinct personalities and visual styles.",progress:75,dueDate:"March 15, 2024",projectType:"Illustration Project",teamSize:2,duration:"3-4 months",meetingSchedule:"2-3 times/week",tags:["Illustration","Character Design","Digital Art"],teamLead:{artist:"Alex Chen",artistAvatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face",role:"Initiator"},teamMembers:[{id:1,title:"Cyberpunk Street Scene",artist:"Alex Chen",artistAvatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face",description:"A futuristic city street with vibrant neon signs and cyberpunk aesthetics",image:"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop",category:"Visual Effects",likes:"1.2k",views:"8.4k",timeAgo:"2 days ago",role:"Character Designer"},{id:2,title:"Dragon Knight Concept",artist:"Maya Rodriguez",artistAvatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=100&h=100&fit=crop&crop=face",description:"Detailed illustration of a knight in dark, ornate armor",image:"https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400&h=300&fit=crop",category:"Game Design",likes:"2.1k",views:"12k",timeAgo:"5 days ago",role:"Art Director"}],images:["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop","https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=400&h=300&fit=crop"]})(c,d),h="Artist Collaborations"===u.projectType?[{id:1,title:"Character Design Collaboration",description:"Collaborated with game studio on character design for fantasy RPG",introduction:"This stage focused on creating unique character designs that would resonate with players while maintaining the fantasy RPG aesthetic. We explored various visual styles and personality traits.",status:"completed",progress:100,dueDate:"Feb 15, 2024",images:["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=200&h=150&fit=crop","https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=200&h=150&fit=crop"]},{id:2,title:"UI/UX Design Project",description:"Led design team for mobile app interface redesign",introduction:"Redesigned the mobile app interface to improve user experience and accessibility. Focused on intuitive navigation and modern design principles.",status:"completed",progress:100,dueDate:"Feb 28, 2024",images:["https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=200&h=150&fit=crop"]},{id:3,title:"Animation Short Film",description:"Directed and animated short film for film festival",introduction:"Created a compelling short film that showcases storytelling through animation. This project pushed creative boundaries and technical skills.",status:"in-progress",progress:75,dueDate:"March 15, 2024",images:["https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=200&h=150&fit=crop","https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=200&h=150&fit=crop"]}]:[{id:1,title:"Character Concept Sketches",description:"Initial character design exploration and concept development",introduction:"Explored various character concepts through sketching and ideation. This stage established the foundation for all character designs in the series.",status:"completed",progress:100,dueDate:"Feb 15, 2024",images:["https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=200&h=150&fit=crop","https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=200&h=150&fit=crop"]},{id:2,title:"Color Palette Development",description:"Establishing the visual color scheme and mood for the series",introduction:"Developed a cohesive color palette that sets the mood and atmosphere for the entire character series. Focused on harmony and visual appeal.",status:"completed",progress:100,dueDate:"Feb 28, 2024",images:["https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=200&h=150&fit=crop"]},{id:3,title:"Final Character Illustrations",description:"Complete detailed illustrations of all main characters",introduction:"Creating the final detailed illustrations of all main characters. This stage brings together all previous work into polished, finished pieces.",status:"in-progress",progress:75,dueDate:"March 15, 2024",images:["https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=200&h=150&fit=crop","https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=200&h=150&fit=crop"]}];const{comments:m}=s,{state:p,setters:g}=Ys(),f=Ks({state:p,setters:g,actions:n,navigateToCollaboration:a,project:u,comments:m});return(0,e.useLayoutEffect)(()=>{window.scrollTo({top:0,left:0,behavior:"auto"})},[d]),(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,jt.jsx)(Hs,{goBack:r,project:u}),(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,jt.jsx)(Vs,{project:u,milestones:h,onViewProject:f.handleApplyToCollaboration}),(0,jt.jsx)(qs,{project:u,onNavigateToArtist:o})]})}),(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,jt.jsxs)("div",{className:"lg:col-span-1",children:[(0,jt.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Project Preview"}),(0,jt.jsx)("div",{className:"grid grid-cols-2 gap-3",children:u.images.map((e,t)=>(0,jt.jsx)("div",{className:"aspect-square overflow-hidden rounded-lg",children:(0,jt.jsx)("img",{src:e,alt:"Project preview ".concat(t+1),className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"})},t))})]}),(0,jt.jsxs)("div",{className:"lg:col-span-2",children:[(0,jt.jsxs)("div",{className:"flex border-b border-gray-200 mb-6",children:[(0,jt.jsx)("button",{onClick:()=>g.setActiveTab("timeline"),className:"px-6 py-3 text-xl font-bold border-b-2 transition-colors duration-200 ".concat("timeline"===p.activeTab?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Timeline"}),(0,jt.jsx)("button",{onClick:()=>g.setActiveTab("comments"),className:"px-6 py-3 text-xl font-bold border-b-2 transition-colors duration-200 ".concat("comments"===p.activeTab?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Discussion Board"})]}),"timeline"===p.activeTab&&(0,jt.jsx)(Zs,{milestones:h}),"comments"===p.activeTab&&(0,jt.jsx)(Gs,{comment:p.comment,onCommentChange:e=>g.setComment(e.target.value),onCommentSubmit:f.handleCommentSubmit,comments:m,onNavigateToArtist:o})]})]})})]})},$s=["All","System","Gallery","Collaboration"],Xs=["Last 7 days","Today","Last 30 days"],en=e=>{switch(e){case"system":default:return"System";case"gallery":case"comment":case"like":case"follow":return"Gallery";case"collaboration":case"collaboration_application":case"review_request":case"review_response":return"Collaboration"}},tn=(e,t)=>"All"===t?e.length:e.filter(e=>en(e.type)===t).length,rn=(e,t)=>{switch(e){case"system":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"})})});case"comments":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z",clipRule:"evenodd"})})});case"comment":case"final_comment":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z",clipRule:"evenodd"})})});case"collaboration":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-purple-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3z"})})});case"review_request":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-orange-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})});case"gallery":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"})})});case"follow":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-pink-100 rounded-full flex items-center justify-center",children:(0,jt.jsxs)("svg",{className:"w-4 h-4 text-pink-600",fill:"currentColor",viewBox:"0 0 20 20",children:[(0,jt.jsx)("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),(0,jt.jsx)("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]})});case"like":return(0,jt.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})})});default:return(0,jt.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})})}},on=e=>{let{activeTab:t,timeFilter:r,items:o,onTabChange:a,onTimeFilterChange:s,onMarkAllAsRead:n}=e;return(0,jt.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,jt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Notification Center"}),(0,jt.jsx)("div",{className:"flex space-x-8 border-b border-gray-200",children:$s.map(e=>(0,jt.jsxs)("button",{onClick:()=>a(e),className:"py-3 px-1 border-b-2 font-medium text-sm transition-colors duration-200 ".concat(t===e?"Collaboration"===e?"border-purple-500 text-purple-600":"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e,(0,jt.jsx)(Qt,{count:tn(o,e),color:t===e?"Collaboration"===e?"purple":"blue":"gray"})]},e))}),(0,jt.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,jt.jsx)("div",{className:"flex items-center space-x-4",children:(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("span",{className:"text-sm text-gray-600",children:"Filter by:"}),(0,jt.jsx)("select",{value:r,onChange:e=>s(e.target.value),className:"text-sm border border-gray-300 rounded-md px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Xs.map(e=>(0,jt.jsx)("option",{children:e},e))})]})}),(0,jt.jsxs)("button",{onClick:n,className:"text-blue-600 hover:text-blue-700 text-sm font-medium flex items-center space-x-1 transition-colors duration-200",children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,jt.jsx)("span",{children:"Mark all as read"})]})]})]})})},an=e=>{let{isOpen:t,onClose:r,onConfirm:o,onDeny:a,notification:s,actionType:n="collaboration"}=e;if(!t)return null;const i=(()=>{var e;return"collaboration"===n?{title:"Collaboration Request",confirmText:"Approve",denyText:"Deny",message:'Are you sure you want to approve the collaboration request from "'.concat((null===s||void 0===s||null===(e=s.meta)||void 0===e?void 0:e.requesterName)||"Unknown",'"?')}:{title:"Review Request",confirmText:"Approve",denyText:"Deny",message:"Are you sure you want to approve the review request?"}})();return(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:i.title}),(0,jt.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:i.message}),s&&(0,jt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-1",children:s.title}),s.message&&(0,jt.jsx)("p",{className:"text-xs text-gray-600",children:s.message})]})]}),(0,jt.jsxs)("div",{className:"flex space-x-3",children:[(0,jt.jsx)("button",{onClick:r,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),(0,jt.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 transition-colors duration-200",children:i.denyText}),(0,jt.jsx)("button",{onClick:o,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 transition-colors duration-200",children:i.confirmText})]})]})})},sn=e=>{let{isOpen:t=!1,onClose:r=()=>{},notification:o=null,className:a=""}=e;if(!t||!o)return null;const s=o.meta||{},n=s.commentText||"No comment content available",i=s.authorName||"Unknown User",l=s.authorRole||"Member",c=s.projectName||o.projectId||"Unknown Project",d=s.sentiment||"positive";return(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto ".concat(a),children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,jt.jsxs)("div",{className:"flex items-center",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),(0,jt.jsxs)("div",{className:"ml-4",children:[(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Final Comment Details"}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Review the submitted final comment"})]})]}),(0,jt.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,jt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Project Information"}),(0,jt.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,jt.jsxs)("p",{children:[(0,jt.jsx)("strong",{children:"Project:"})," ",c]}),(0,jt.jsxs)("p",{children:[(0,jt.jsx)("strong",{children:"Notification:"})," ",o.title]}),(0,jt.jsxs)("p",{children:[(0,jt.jsx)("strong",{children:"Received:"})," ",new Date(o.createdAt).toLocaleString()]})]})]}),(0,jt.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4 mb-6",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Comment Author"}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,jt.jsxs)("p",{children:[(0,jt.jsx)("strong",{children:"Name:"})," ",i]}),(0,jt.jsxs)("p",{children:[(0,jt.jsx)("strong",{children:"Role:"})," ",l]})]}),(0,jt.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"positive":default:return"bg-green-100 text-green-800";case"neutral":return"bg-gray-100 text-gray-800";case"negative":return"bg-red-100 text-red-800"}})(d)),children:(e=>{switch(e){case"positive":default:return"Positive";case"neutral":return"Neutral";case"negative":return"Negative"}})(d)})]})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"Comment Content"}),(0,jt.jsx)("div",{className:"bg-gray-50 rounded-lg p-4 border-l-4 border-blue-500",children:(0,jt.jsxs)("blockquote",{className:"text-gray-700 italic leading-relaxed",children:['"',n,'"']})})]}),(0,jt.jsx)("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:(0,jt.jsx)("button",{onClick:r,className:"px-6 py-3 text-base text-gray-600 hover:text-gray-800 transition-colors duration-200",children:"Close"})})]})})},nn=t=>{var r,o;let{notification:a,onNotificationClick:s,onReviewRequest:n,onCollaborationRequest:i,onMarkAsRead:l}=t;const[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(null);return e.useEffect(()=>{"review_request"===a.type?p("review"):"collaboration"===a.type&&p("collaboration")},[a.type]),(0,jt.jsxs)("div",{onClick:e=>{e.target.closest("button")||("final_comment"!==a.type?"review_request"!==a.type||a.isRead?(!a.isRead&&l&&l(a.id),s(a)):d(!0):h(!0))},className:"rounded-lg border p-6 hover:shadow-md transition-all duration-200 cursor-pointer ".concat(a.isRead?"bg-white border-gray-200":"collaboration"===a.type?"bg-purple-50 border-l-4 border-l-purple-500":"bg-blue-50 border-l-4 border-l-blue-500"),children:[(0,jt.jsxs)("div",{className:"flex items-start space-x-4",children:[!a.isRead&&(0,jt.jsx)("div",{className:"w-2 h-2 rounded-full mt-3 flex-shrink-0 ".concat("collaboration"===a.type?"bg-purple-500":"bg-blue-500")}),(0,jt.jsx)("div",{className:"flex-shrink-0",children:rn(a.type)}),(0,jt.jsx)("div",{className:"flex-1 min-w-0",children:(0,jt.jsxs)("div",{className:"flex items-start justify-between",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:a.title||a.content}),a.message&&(0,jt.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:a.message}),("review_request"===a.type&&!a.isRead||"collaboration"===a.type&&(null===(r=a.meta)||void 0===r?void 0:r.requestId)&&"pending"===(null===(o=a.meta)||void 0===o?void 0:o.status)&&!a.isRead)&&(0,jt.jsx)("div",{className:"mt-3",children:(0,jt.jsx)("p",{className:"text-xs text-gray-500 italic",children:"Click to approve or deny this request"})})]}),(0,jt.jsx)("span",{className:"text-xs text-gray-500 ml-4 flex-shrink-0",children:new Date(a.createdAt).toLocaleDateString()})]})})]}),(0,jt.jsx)(an,{isOpen:c,onClose:()=>{d(!1),p(null)},onConfirm:()=>{"review"===m?n(a,"approved"):"collaboration"===m&&i(a,"approve"),d(!1),p(null)},onDeny:()=>{"review"===m?n(a,"denied"):"collaboration"===m&&i(a,"deny"),d(!1),p(null)},notification:a,actionType:m}),(0,jt.jsx)(sn,{isOpen:u,onClose:()=>{h(!1),!a.isRead&&l&&l(a.id)},notification:a})]})},ln=e=>{let{isLoading:t,filteredNotifications:r,hasMore:o,onNotificationClick:a,onReviewRequest:s,onCollaborationRequest:n,onMarkAsRead:i,onLoadMore:l}=e;return t?(0,jt.jsxs)("div",{className:"text-center py-12",children:[(0,jt.jsx)(Wt,{}),(0,jt.jsx)("p",{className:"mt-2 text-gray-600",children:"Loading notifications..."})]}):(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,jt.jsx)("div",{className:"space-y-4",children:r.map(e=>(0,jt.jsx)(nn,{notification:e,onNotificationClick:a,onReviewRequest:s,onCollaborationRequest:n,onMarkAsRead:i},e.id))}),o&&!t&&(0,jt.jsx)("div",{className:"text-center mt-8",children:(0,jt.jsxs)("button",{onClick:l,className:"text-blue-600 hover:text-blue-700 font-medium flex items-center space-x-1 mx-auto transition-colors duration-200",children:[(0,jt.jsx)("span",{children:"Load more notifications"}),(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})]})},cn="tag.collaboration_requests",dn=()=>(new Date).toISOString(),un=()=>{try{if("undefined"===typeof window)return[];const e=window.localStorage.getItem(cn);return e?JSON.parse(e):[]}catch(e){return console.error("Error reading collaboration requests:",e),[]}},hn=e=>{try{if("undefined"===typeof window)return;window.localStorage.setItem(cn,JSON.stringify(e))}catch(t){console.error("Error writing collaboration requests:",t)}},mn=t=>{let{state:o,setters:a}=t;const{setItems:s,setFilteredNotifications:n,setIsLoading:i}=a,l=(0,e.useCallback)(async()=>{try{i(!0);const e=await Jr.getUserNotifications((0,Lr.WR)());if(e.success){const t=e.data||[];console.log("NotificationCenter: Loaded notifications:",t.length),s(t),console.log("NotificationCenter: Updated items state")}else console.error("Failed to load notifications:",e.error),s([])}catch(e){console.error("Error loading notifications:",e),s([])}finally{i(!1)}},[s,i]);(0,e.useEffect)(()=>{let e=!0;const t=async()=>{e&&await l()};t();const r=r=>{var o;const a=null===r||void 0===r||null===(o=r.detail)||void 0===o?void 0:o.userId;console.log("NotificationCenter: Received event:",r.type,"for user:",a,"current user:",(0,Lr.WR)()),a&&a!==(0,Lr.WR)()||(console.log("NotificationCenter: Reloading notifications due to change"),setTimeout(()=>{e&&t()},100))};return window.addEventListener("notif:unreadChanged",r),window.addEventListener("user:changed",t),()=>{e=!1,window.removeEventListener("notif:unreadChanged",r),window.removeEventListener("user:changed",t)}},[l]),(0,e.useEffect)(()=>{const e=((e,t)=>{let r=[...e];return"All"!==t&&(r=r.filter(e=>en(e.type)===t)),r})(o.items,o.activeTab,o.timeFilter);n(e)},[o.items,o.activeTab,o.timeFilter,n]);const c=(0,e.useCallback)(async e=>{if(console.log("Notification clicked:",e),"collaboration"===e.type){var t,r,o,a,s,n;const i=e.projectId||(null===(t=e.meta)||void 0===t?void 0:t.projectId)||(null===(r=e.meta)||void 0===r?void 0:r.requestId)||(null===(o=e.meta)||void 0===o?void 0:o.collaborationId);console.log("Notification projectId lookup:",{direct:e.projectId,metaProjectId:null===(a=e.meta)||void 0===a?void 0:a.projectId,metaRequestId:null===(s=e.meta)||void 0===s?void 0:s.requestId,metaCollaborationId:null===(n=e.meta)||void 0===n?void 0:n.collaborationId,final:i}),i?(console.log("Navigating to collaboration project:",i),window.location.href="/tagme/collaboration/".concat(i)):console.log("No projectId found in notification:",e)}else console.log("Notification clicked, marked as read:",e.type)},[]),d=(0,e.useCallback)(async e=>{try{await Jr.markAsRead(e),console.log("NotificationCenter: Marked notification as read:",e);const t=await Jr.getUserNotifications((0,Lr.WR)());t.success&&s(t.data||[])}catch(t){console.error("Error marking notification as read:",t)}},[s]),u=(0,e.useCallback)(async()=>{try{await Jr.markAllAsRead((0,Lr.WR)()),console.log("NotificationCenter: Marked all as read")}catch(e){console.error("Error marking notifications as read:",e)}},[]),h=(0,e.useCallback)(async(e,t)=>{console.log("Review request functionality has been replaced with Add Experience")},[]),m=(0,e.useCallback)(async(e,t)=>{try{const{requestId:o}=e.meta,a=(0,Lr.WR)();let n;if(console.log("Handling collaboration request:",{requestId:o,action:t,currentUserId:a}),"approve"===t?n=await(async(e,t)=>{const o=un(),a=o.findIndex(r=>r.id===e&&r.ownerId===t);if(-1===a)throw new Error("Request not found");const s=o[a];s.status="approved",s.updatedAt=dn(),hn(o);try{const{createGeneralNotification:e}=await Promise.resolve().then(r.bind(r,784));await e({userId:s.requesterId,type:"collaboration",title:"Collaboration Request Approved",message:'Your collaboration request for project "'.concat(s.projectName,'" has been approved by ').concat(s.ownerName,". You can now submit your final review."),projectId:s.projectId,meta:{requestId:s.id,status:"approved",projectName:s.projectName,ownerName:s.ownerName}})}catch(n){console.error("Error creating approval notification:",n)}return"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("collaboration:requestStatusChanged",{detail:{requestId:e,status:"approved",request:s}})),s})(o,a):"deny"===t&&(n=await(async(e,t)=>{const o=un(),a=o.findIndex(r=>r.id===e&&r.ownerId===t);if(-1===a)throw new Error("Request not found");const s=o[a];s.status="denied",s.updatedAt=dn(),hn(o);try{const{createGeneralNotification:e}=await Promise.resolve().then(r.bind(r,784));await e({userId:s.requesterId,type:"collaboration",title:"Collaboration Request Denied",message:'Your collaboration request for project "'.concat(s.projectName,'" has been denied by ').concat(s.ownerName,"."),projectId:s.projectId,meta:{requestId:s.id,status:"denied",projectName:s.projectName,ownerName:s.ownerName}})}catch(n){console.error("Error creating denial notification:",n)}return"undefined"!==typeof window&&window.dispatchEvent(new CustomEvent("collaboration:requestStatusChanged",{detail:{requestId:e,status:"denied",request:s}})),s})(o,a)),n){console.log("Collaboration request ".concat(t,":"),n),await Jr.markAsRead(e.id);const r=await Jr.getUserNotifications(a);r.success&&s(r.data||[])}}catch(o){console.error("Error handling collaboration request:",o)}},[s]);return{loadNotifications:l,handleNotificationClick:c,handleMarkAsRead:d,handleMarkAllAsRead:u,handleReviewRequest:h,handleCollaborationRequest:m}},pn=()=>{const[t,r]=(0,e.useState)([]),[o,a]=(0,e.useState)([]),[s,n]=(0,e.useState)("All"),[i,l]=(0,e.useState)("Last 7 days"),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!0);return(0,e.useMemo)(()=>({state:{items:t,filteredNotifications:o,activeTab:s,timeFilter:i,isLoading:c,hasMore:u},setters:{setItems:r,setFilteredNotifications:a,setActiveTab:n,setTimeFilter:l,setIsLoading:d,setHasMore:h}}),[t,o,s,i,c,u])},gn=()=>{const{state:e,setters:t}=pn(),r=mn({state:e,setters:t});return(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,jt.jsx)(on,{activeTab:e.activeTab,timeFilter:e.timeFilter,items:e.items,onTabChange:t.setActiveTab,onTimeFilterChange:t.setTimeFilter,onMarkAllAsRead:r.handleMarkAllAsRead}),(0,jt.jsx)(ln,{isLoading:e.isLoading,filteredNotifications:e.filteredNotifications,hasMore:e.hasMore,onNotificationClick:r.handleNotificationClick,onReviewRequest:r.handleReviewRequest,onCollaborationRequest:r.handleCollaborationRequest,onMarkAsRead:r.handleMarkAsRead,onLoadMore:()=>{}})]})},fn=e=>{let{children:t}=e;const{user:r,loading:o}=St();return o?(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-tag-blue mx-auto"}),(0,jt.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):r?t:(0,jt.jsx)(_e,{to:"/login",replace:!0})},vn=()=>(0,jt.jsxs)("div",{className:"text-center mb-8",children:[(0,jt.jsx)("img",{src:"/TAG_Logo.png",alt:"TAG Logo",className:"h-12 w-auto mx-auto mb-6"}),(0,jt.jsx)("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create your account"}),(0,jt.jsxs)("p",{className:"text-sm text-gray-600 mb-4 whitespace-nowrap",children:["Only ",(0,jt.jsx)("span",{className:"text-red-600 font-semibold",children:"scad.edu"})," emails are currently eligible for TAG registration."]})]}),xn=t=>{let{formData:r,errors:o,onInputChange:a,onSendCode:s,onSubmit:n,isLoading:i,isSendingCode:l}=t;!!(c=r.email)&&c.toLowerCase().endsWith("@scad.edu");var c;const[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(!1);return e.useEffect(()=>{const e=setTimeout(()=>{const e=document.getElementById("email"),t=document.getElementById("password"),r=document.getElementById("confirmPassword");e&&""!==e.value&&(e.value=""),t&&""!==t.value&&(t.value=""),r&&""!==r.value&&(r.value="")},100);return()=>clearTimeout(e)},[]),(0,jt.jsxs)("form",{onSubmit:n,className:"space-y-6",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student Email"}),(0,jt.jsxs)("div",{className:"flex space-x-2",children:[(0,jt.jsx)("div",{className:"relative flex-1",children:(0,jt.jsx)("input",{id:"email",name:"email",type:"email",required:!0,value:r.email,onChange:a,placeholder:"your.name@university.edu",autoComplete:"off",className:"block w-full px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm ".concat(o.email?"border-red-300":"border-gray-300")})}),(0,jt.jsx)("button",{type:"button",onClick:()=>s(r.email),disabled:l||!1,className:"px-4 py-3 text-sm font-medium rounded-md whitespace-nowrap transition-colors duration-200 ".concat(l?"text-gray-400 bg-gray-200 cursor-not-allowed":"text-white bg-tag-blue hover:bg-tag-dark-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue"),children:l?"Sending...":"Send Code"})]}),o.email&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o.email})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"verificationCode",className:"block text-sm font-medium text-gray-700 mb-2",children:"Verification Code"}),(0,jt.jsx)("div",{className:"relative",children:(0,jt.jsx)("input",{id:"verificationCode",name:"verificationCode",type:"text",required:!0,value:r.verificationCode,onChange:a,placeholder:"Enter 6-digit code",maxLength:"6",autoComplete:"off",className:"block w-full px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm ".concat(o.verificationCode?"border-red-300":"border-gray-300")})}),o.verificationCode&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o.verificationCode}),(0,jt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the 6-digit code sent to your email"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("input",{id:"password",name:"password",type:d?"text":"password",required:!0,value:r.password,onChange:a,placeholder:"Enter your password",autoComplete:"off",className:"block w-full pr-10 px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-tag-blue sm:text-sm ".concat(o.password?"border-red-300":"border-gray-300")}),(0,jt.jsx)("button",{type:"button",onClick:()=>u(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:d?(0,jt.jsx)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,jt.jsxs)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),o.password&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o.password}),(0,jt.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Password must be at least 6 characters"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:h?"text":"password",required:!0,value:r.confirmPassword,onChange:a,placeholder:"Confirm your password",autoComplete:"off",className:"block w-full pr-10 px-3 py-3 border rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:border-tag-blue focus:ring-2 focus:ring-tag-blue sm:text-sm ".concat(o.confirmPassword?"border-red-300":"border-gray-300")}),(0,jt.jsx)("button",{type:"button",onClick:()=>m(!h),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:h?(0,jt.jsx)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):(0,jt.jsxs)("svg",{className:"h-5 w-5 text-gray-400 hover:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]}),o.confirmPassword&&(0,jt.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o.confirmPassword})]}),o.general&&(0,jt.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,jt.jsxs)("div",{className:"flex",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("svg",{className:"h-5 w-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,jt.jsx)("div",{className:"ml-3",children:(0,jt.jsx)("h3",{className:"text-sm font-medium text-red-800",children:o.general})})]})}),(0,jt.jsx)("button",{type:"submit",disabled:i,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-tag-blue hover:bg-tag-dark-blue focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200",children:i?(0,jt.jsxs)("div",{className:"flex items-center",children:[(0,jt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,jt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,jt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating Account..."]}):"Create Account"})]})},bn=e=>{let{onLoginClick:t}=e;return(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("div",{className:"mt-6 flex justify-center",children:(0,jt.jsx)("button",{onClick:t,className:"w-full flex justify-center py-3 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue transition-colors duration-200",children:"Login"})}),(0,jt.jsx)("footer",{className:"bg-white border-t border-gray-200",children:(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,jt.jsxs)("div",{className:"flex justify-between items-center",children:[(0,jt.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,jt.jsx)("span",{className:"font-bold",children:"Tech Art Guide"}),(0,jt.jsx)("span",{className:"ml-2",children:"\xa9 2025 TAG. All rights reserved."})]}),(0,jt.jsxs)("div",{className:"flex space-x-6 text-sm text-gray-500",children:[(0,jt.jsx)("a",{href:"#",className:"hover:text-gray-700",children:"Privacy Policy"}),(0,jt.jsx)("a",{href:"#",className:"hover:text-gray-700",children:"Terms of Service"})]})]})})})]})},yn=()=>{const[t,r]=(0,e.useState)({email:"",verificationCode:"",password:"",confirmPassword:""}),[o,s]=(0,e.useState)({}),[n,i]=(0,e.useState)(!1),[l,c]=(0,e.useState)(!1),d=(0,e.useCallback)(e=>{const{name:t,value:n}=e.target;r(e=>(0,a.A)((0,a.A)({},e),{},{[t]:n})),o[t]&&s(e=>((e,t)=>{if(e[t]){const r=(0,a.A)({},e);return delete r[t],r}return e})(e,t))},[o]),u=(0,e.useCallback)(()=>{const e=(e=>{const t={};var r,o;return e.email?(r=e.email,/\S+@\S+\.\S+/.test(r)||(t.email="Please enter a valid email address")):t.email="Please enter your email address",e.verificationCode?(o=e.verificationCode,/^\d{6}$/.test(o)||(t.verificationCode="Verification code should be 6 digits")):t.verificationCode="Please enter verification code",e.password?e.password.length>=6||(t.password="Password must be at least 6 characters"):t.password="Please enter password",e.confirmPassword?(a=e.password,s=e.confirmPassword,a===s||(t.confirmPassword="Passwords do not match")):t.confirmPassword="Please confirm password",{isValid:0===Object.keys(t).length,errors:t};var a,s})(t);return s(e.errors),e.isValid},[t]),h=(0,e.useCallback)(()=>{r({email:"",verificationCode:"",password:"",confirmPassword:""}),s({}),i(!1),c(!1)},[]),m=(0,e.useCallback)(e=>{i(e)},[]),p=(0,e.useCallback)(e=>{c(e)},[]),g=(0,e.useCallback)((e,t)=>{s(r=>(0,a.A)((0,a.A)({},r),{},{[e]:t}))},[]),f=(0,e.useCallback)(e=>{s(t=>(0,a.A)((0,a.A)({},t),{},{general:e}))},[]);return{formData:t,errors:o,isLoading:n,isSendingCode:l,handleInputChange:d,validateForm:u,resetForm:h,setLoading:m,setSendingCode:p,setError:g,setGeneralError:f}},wn=e=>{const t=e.message.toLowerCase();return t.includes("already registered")?"This email is already registered. Please sign in or use a different email.":t.includes("expired")?"Verification code has expired. Please request a new one.":t.includes("invalid")?"Invalid verification code. Please try again.":t.includes("password")?"Password is not strong enough. Please use a more complex password.":t.includes("rate limit")||t.includes("too many requests")?"Too many attempts. Please wait a moment and try again.":t.includes("user not found")?"No account found with this email. Please sign up first.":t.includes("email not confirmed")?"Please verify your email address first.":t.includes("network")||t.includes("connection")?"Network error. Please check your connection and try again.":"Something went wrong. Please try again."},jn="This field is required.",kn=t=>{let{formData:r,validateForm:o,setLoading:a,setSendingCode:s,setError:n,setGeneralError:i,onStepChange:l}=t;const c=ce(),d=(0,e.useCallback)(async e=>{if(e){s(!0);try{const{success:t,error:r}=await(async e=>{try{const{data:t,error:r}=await wt.supabase.functions.invoke("send-verification-code",{body:{email:e}});return r?{success:!1,error:r.message||"Failed to send verification code"}:{success:!0,data:t}}catch(r){return{success:!1,error:r.message}}})(e);t?(s(!1),n("email","\u2705 Verification code sent! Please check your inbox."),l&&l("otp")):(s(!1),n("email",wn({message:r})))}catch(t){console.error("Failed to send verification code:",t),s(!1),n("email","Failed to send verification code, please try again")}}else n("email",jn)},[s,n]),u=(0,e.useCallback)(async e=>{if(e.preventDefault(),o()){a(!0);try{const{success:e,user:t,session:o,error:s}=await(async(e,t,r)=>{try{const{data:o,error:a}=await wt.supabase.functions.invoke("verify-code",{body:{email:e,code:t,password:r}});return a?{success:!1,error:a.message||"Failed to create user"}:{success:!0,user:o.user,session:o.session}}catch(o){return{success:!1,error:o.message}}})(r.email,r.verificationCode,r.password);if(!e)return a(!1),void i(wn({message:s}));console.log("Registration successful:",t),a(!1),alert("Registration successful! You are now logged in."),null!==t&&void 0!==t&&t.id?c("/artist/".concat(t.id)):c("/")}catch(t){console.error("Registration error:",t),a(!1),i("Registration failed, please try again")}}},[r,o,a,i,c]);return{sendVerificationCode:d,handleSubmit:u,handleLoginClick:(0,e.useCallback)(()=>{c("/login")},[c])}},Sn=()=>{const{formData:e,errors:t,isLoading:r,isSendingCode:o,handleInputChange:a,validateForm:s,setLoading:n,setSendingCode:i,setError:l,setGeneralError:c}=yn(),d=kn({formData:e,validateForm:s,setLoading:n,setSendingCode:i,setError:l,setGeneralError:c,onStepChange:e=>{console.log("Step changed to:",e)}});return(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:(0,jt.jsx)("div",{className:"flex-1 flex items-center justify-center px-4 sm:px-6 lg:px-8",children:(0,jt.jsx)("div",{className:"max-w-md w-full space-y-8",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,jt.jsx)(vn,{}),(0,jt.jsx)(xn,{formData:e,errors:t,onInputChange:a,onSendCode:d.sendVerificationCode,onSubmit:d.handleSubmit,isLoading:r,isSendingCode:o}),(0,jt.jsx)(bn,{onLoginClick:d.handleLoginClick})]})})})})},Nn=()=>{const[t,r]=(0,e.useState)("checking"),[o,a]=(0,e.useState)({}),[s,n]=(0,e.useState)({});(0,e.useEffect)(()=>{a({VITE_SUPABASE_URL:"https://ooaicpvsjmmxuccqlzuh.supabase.co",VITE_SUPABASE_ANON_KEY:"\u2705 \u5df2\u8a2d\u7f6e"});(async()=>{try{const e=await(0,wt.B)();r(e?"connected":"disconnected"),await i()}catch(e){console.error("Connection test failed:",e),r("error")}})()},[]);const i=async()=>{const e={};try{e.auth=!!wt.supabase.auth,e.from=!!wt.supabase.from,e.storage=!!wt.supabase.storage,n(e)}catch(t){console.error("Basic functions test failed:",t)}};return(0,jt.jsxs)("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Supabase \u9023\u63a5\u72c0\u614b\u6aa2\u67e5"}),(0,jt.jsxs)("div",{className:"mb-6 p-4 border rounded-lg",children:[(0,jt.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"\ud83d\udccb \u74b0\u5883\u8b8a\u91cf\u6aa2\u67e5"}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("strong",{children:"REACT_APP_SUPABASE_URL:"}),(0,jt.jsx)("div",{className:"text-gray-600 break-all",children:o.REACT_APP_SUPABASE_URL||"\u672a\u8a2d\u7f6e"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("strong",{children:"REACT_APP_SUPABASE_ANON_KEY:"}),(0,jt.jsx)("div",{className:"text-gray-600",children:o.REACT_APP_SUPABASE_ANON_KEY})]})]})]}),(0,jt.jsxs)("div",{className:"mb-6 p-4 border rounded-lg",children:[(0,jt.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"\ud83d\udd17 \u9023\u63a5\u72c0\u614b"}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("span",{children:"\u72c0\u614b:"}),(0,jt.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"connected":return"text-green-600 bg-green-100";case"disconnected":return"text-yellow-600 bg-yellow-100";case"error":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(t)),children:(e=>{switch(e){case"connected":return"\u2705 \u5df2\u9023\u63a5";case"disconnected":return"\u26a0\ufe0f \u9023\u63a5\u5931\u6557";case"error":return"\u274c \u9023\u63a5\u932f\u8aa4";default:return"\ud83d\udd04 \u6aa2\u67e5\u4e2d..."}})(t)})]})]}),(0,jt.jsxs)("div",{className:"mb-6 p-4 border rounded-lg",children:[(0,jt.jsx)("h2",{className:"text-lg font-semibold mb-3",children:"\ud83e\uddea \u57fa\u672c\u529f\u80fd\u6e2c\u8a66"}),(0,jt.jsxs)("div",{className:"space-y-2",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("strong",{children:"Auth \u529f\u80fd:"}),(0,jt.jsx)("span",{className:"ml-2 px-2 py-1 rounded text-sm ".concat(s.auth?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:s.auth?"\u2705 \u53ef\u7528":"\u274c \u4e0d\u53ef\u7528"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("strong",{children:"Database \u529f\u80fd:"}),(0,jt.jsx)("span",{className:"ml-2 px-2 py-1 rounded text-sm ".concat(s.from?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:s.from?"\u2705 \u53ef\u7528":"\u274c \u4e0d\u53ef\u7528"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("strong",{children:"Storage \u529f\u80fd:"}),(0,jt.jsx)("span",{className:"ml-2 px-2 py-1 rounded text-sm ".concat(s.storage?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:s.storage?"\u2705 \u53ef\u7528":"\u274c \u4e0d\u53ef\u7528"})]})]})]}),(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors",children:"\u91cd\u65b0\u6e2c\u8a66\u9023\u63a5"})}),(0,jt.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,jt.jsx)("h3",{className:"font-semibold mb-2",children:"\ud83d\udcdd \u8aaa\u660e"}),(0,jt.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,jt.jsx)("li",{children:"\u2022 \u5982\u679c\u74b0\u5883\u8b8a\u91cf\u672a\u8a2d\u7f6e\uff0c\u8acb\u6aa2\u67e5 .env.local \u6587\u4ef6"}),(0,jt.jsx)("li",{children:"\u2022 \u5982\u679c\u9023\u63a5\u5931\u6557\uff0c\u8acb\u6aa2\u67e5 Supabase \u9805\u76ee\u72c0\u614b\u548c\u7db2\u7d61\u9023\u63a5"}),(0,jt.jsx)("li",{children:"\u2022 \u9023\u63a5\u6210\u529f\u5f8c\uff0c\u7528\u6236\u8a8d\u8b49\u529f\u80fd\u5c07\u81ea\u52d5\u555f\u7528"}),(0,jt.jsx)("li",{children:"\u2022 \u8a2a\u554f\u8def\u5f91: /test-supabase"})]})]})]})},Cn=async(e,t)=>{if(!e)return null;try{if(e.startsWith("data:")){const a="collaboration_".concat(t,"_").concat(Date.now());try{const{imageStorage:t}=await Promise.resolve().then(r.bind(r,337));return t&&t.storeImage?(await t.storeImage(a,e),console.log("[Collaboration] Stored Data URL to IndexedDB with key: ".concat(a)),a):(console.warn("[Collaboration] imageStorage not available, using Data URL as fallback"),e)}catch(o){return console.warn("[Collaboration] IndexedDB storage failed, using Data URL as fallback:",o),e}}if(e.startsWith("blob:")){const a=await fetch(e),s=await a.blob(),n=await new Promise((e,t)=>{const r=new FileReader;r.onload=()=>e(r.result),r.onerror=()=>t(r.error),r.readAsDataURL(s)}),i="collaboration_".concat(t,"_").concat(Date.now());try{const{imageStorage:e}=await Promise.resolve().then(r.bind(r,337));return e&&e.storeImage?(await e.storeImage(i,n),console.log("[Collaboration] Stored Data URL to IndexedDB with key: ".concat(i)),i):(console.warn("[Collaboration] imageStorage not available, using Data URL as fallback"),n)}catch(o){return console.warn("[Collaboration] IndexedDB storage failed, using Data URL as fallback:",o),n}}return e}catch(a){return console.warn("[Collaboration] Failed to process image, returning original URL as fallback:",a),e}},_n=async e=>{var t,r,o,a,s,n,i,l,c,d,u,h,m,p;const g=(0,Lr.WR)(),f=await(0,Lr.HW)(),v="temp_".concat(Date.now());return{title:(null===(t=e.title)||void 0===t?void 0:t.trim())||"",description:(null===(r=e.description)||void 0===r?void 0:r.trim())||"",projectVision:(null===(o=e.projectVision)||void 0===o?void 0:o.trim())||"",whyThisMatters:(null===(a=e.whyThisMatters)||void 0===a?void 0:a.trim())||"",teamSize:e.teamSize||"",duration:e.duration||"",meetingSchedule:e.meetingSchedule||"",applicationDeadline:e.applicationDeadline||"",projectType:(null===(s=e.projectType)||void 0===s?void 0:s.trim())||"",posterPreview:await Cn(e.posterPreview,v),heroImage:await Cn(e.posterPreview,v),contactInfo:{email:(null===(n=e.contactEmail)||void 0===n?void 0:n.trim())||(null===(i=e.contactInfo)||void 0===i||null===(l=i.email)||void 0===l?void 0:l.trim())||"",discord:(null===(c=e.contactDiscord)||void 0===c?void 0:c.trim())||(null===(d=e.contactInfo)||void 0===d||null===(u=d.discord)||void 0===u?void 0:u.trim())||"",other:(null===(h=e.contactOther)||void 0===h?void 0:h.trim())||(null===(m=e.contactInfo)||void 0===m||null===(p=m.other)||void 0===p?void 0:p.trim())||""},roles:(t=>{console.log("[formatFormDataForAPI] Input formData.roles:",e.roles);const r=(null===(t=e.roles)||void 0===t?void 0:t.map(e=>{var t,r,o,a;console.log("[formatFormDataForAPI] Processing role:",e);const s={id:e.id||Date.now().toString(),title:(null===(t=e.customRole)||void 0===t?void 0:t.trim())||(null===(r=e.title)||void 0===r?void 0:r.trim())||"",description:(null===(o=e.roleDescription)||void 0===o?void 0:o.trim())||(null===(a=e.description)||void 0===a?void 0:a.trim())||"",requiredSkills:e.requiredSkills?Array.isArray(e.requiredSkills)?e.requiredSkills:"string"===typeof e.requiredSkills?e.requiredSkills.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]:[],status:"available"};return console.log("[formatFormDataForAPI] Processed role:",s),s}).filter(e=>{const t=e.title&&e.title.length>0;return console.log('[formatFormDataForAPI] Role "'.concat(e.title,'" has title: ').concat(t)),t}))||[];return console.log("[formatFormDataForAPI] Final processed roles:",r),r})(),author:{id:g,name:(null===f||void 0===f?void 0:f.displayName)||(null===f||void 0===f?void 0:f.name)||"Unknown",avatar:(null===f||void 0===f?void 0:f.avatar)||null,role:(null===f||void 0===f?void 0:f.role)||"Initiator"},status:"active",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),likes:0,views:0,applications:[]}},An=e=>{if(!e)return"Unknown date";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";const r=t.getFullYear(),o=t.toLocaleDateString("en-US",{month:"short"}),a=t.getDate();return"".concat(o," ").concat(a,", ").concat(r)},In=e=>{var t,r,o,a,s,n;const i={};null!==(t=e.title)&&void 0!==t&&t.trim()||(i.title="Project title is required"),null!==(r=e.description)&&void 0!==r&&r.trim()?e.description.length>1e3&&(i.description="Project description must be 1000 characters or less"):i.description="Project description is required",null!==(o=e.projectVision)&&void 0!==o&&o.trim()?e.projectVision.length>200&&(i.projectVision="Project vision must be 200 characters or less"):i.projectVision="Project vision is required",e.whyThisMatters&&e.whyThisMatters.length>1e3&&(i.whyThisMatters="Why This Matters must be 1000 characters or less"),e.teamSize||(i.teamSize="Team size is required"),e.duration||(i.duration="Duration is required"),e.meetingSchedule||(i.meetingSchedule="Meeting schedule is required"),e.applicationDeadline||(i.applicationDeadline="Application deadline is required");const l=(null===(a=e.contactInfo)||void 0===a||null===(s=a.email)||void 0===s?void 0:s.trim())||(null===(n=e.contactEmail)||void 0===n?void 0:n.trim());return l?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)||(i.contactEmail="Please enter a valid email address"):i.contactEmail="Email is required",e.roles&&0!==e.roles.length?e.roles.forEach((e,t)=>{var r,o,a,s;const n=(null===(r=e.title)||void 0===r?void 0:r.trim())||(null===(o=e.customRole)||void 0===o?void 0:o.trim()),l=(null===(a=e.description)||void 0===a?void 0:a.trim())||(null===(s=e.roleDescription)||void 0===s?void 0:s.trim());n||(i["role".concat(t)]="Role name is required"),l||(i["roleDescription".concat(t)]="Role description is required")}):i.roles="At least one role is required",{isValid:0===Object.keys(i).length,errors:i}},Pn=()=>"collab_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),En=[{id:Pn(),title:"Game Concept Design Collaboration",description:"Creating an innovative mobile game concept that combines puzzle mechanics with narrative storytelling. We're looking for talented artists and designers to help bring this vision to life.",projectVision:"Revolutionizing mobile gaming through innovative concept design and storytelling",whyThisMatters:"This project aims to push the boundaries of mobile game design by creating an experience that's both visually stunning and intellectually engaging. We believe in the power of games to tell meaningful stories and connect people.",teamSize:"4-5",duration:"3-4 months",meetingSchedule:"2-3 times/week",applicationDeadline:"2024-12-15",projectType:"Game Design, Concept Art",contactInfo:{email:"alex.chen@example.com",discord:"alexchen#1234",other:""},roles:[{id:"role_1",title:"Character Designer",description:"Create unique and memorable character designs that fit the game's aesthetic and narrative. Experience with character development and concept art required.",requiredSkills:"Character Design, Concept Art, Adobe Photoshop, Procreate",status:"available"},{id:"role_2",title:"Environment Artist",description:"Design immersive game environments that enhance the storytelling experience. Strong understanding of lighting, composition, and atmospheric design.",requiredSkills:"Environment Design, Digital Painting, 3D Modeling, Unity",status:"available"},{id:"role_3",title:"UI/UX Designer",description:"Design intuitive and visually appealing user interfaces that enhance the gaming experience. Focus on accessibility and user engagement.",requiredSkills:"UI Design, UX Research, Figma, Adobe XD",status:"filled"}],author:{id:"alex",name:"Alex Chen",avatar:null,role:"Concept Artist"},status:"active",createdAt:"2024-11-01T10:00:00Z",updatedAt:"2024-11-01T10:00:00Z",likes:24,views:156,applications:[]}],Dn=[{id:Pn(),title:"Digital Illustration Project",description:"Collaborative digital art project focused on creating a series of illustrations for a children's book. We're seeking artists who can bring warmth and imagination to storytelling through art.",projectVision:"Creating magical illustrations that inspire and delight young readers",whyThisMatters:"Children's books have the power to shape imaginations and create lasting memories. This project aims to create illustrations that not only tell a story but also inspire creativity and wonder in young minds.",teamSize:"2-3",duration:"1-2 months",meetingSchedule:"1-2 times/week",applicationDeadline:"2024-11-30",projectType:"Illustration, Children's Book",contactInfo:{email:"bryan.rodriguez@example.com",discord:"bryanrodriguez#5678",other:""},roles:[{id:"role_1",title:"Character Illustrator",description:"Create charming and expressive character illustrations that appeal to children. Ability to maintain consistent character designs across multiple scenes.",requiredSkills:"Character Illustration, Digital Art, Adobe Illustrator, Procreate",status:"available"},{id:"role_2",title:"Background Artist",description:"Design whimsical and engaging backgrounds that complement the story and characters. Strong sense of color and composition.",requiredSkills:"Background Art, Digital Painting, Color Theory, Adobe Photoshop",status:"available"}],author:{id:"bryan",name:"Bryan Rodriguez",avatar:null,role:"Illustrator"},status:"active",createdAt:"2024-10-25T14:30:00Z",updatedAt:"2024-10-25T14:30:00Z",likes:18,views:89,applications:[]},{id:Pn(),title:"Sci-Fi Concept Art Collection",description:"Creating a collection of sci-fi concept art pieces for a digital art portfolio. Looking for artists who can bring futuristic visions to life with attention to detail and technical accuracy.",projectVision:"Pushing the boundaries of sci-fi concept art through innovative design and storytelling",whyThisMatters:"Sci-fi art has the power to inspire technological innovation and explore the possibilities of the future. This collection aims to showcase the intersection of art and technology.",teamSize:"3-4",duration:"2-3 months",meetingSchedule:"2-3 times/week",applicationDeadline:"2024-12-20",projectType:"Concept Art, Sci-Fi",contactInfo:{email:"bryan.rodriguez@example.com",discord:"bryanrodriguez#5678",other:""},roles:[{id:"role_1",title:"Vehicle Designer",description:"Design futuristic vehicles and spacecraft with realistic engineering principles. Strong understanding of form, function, and aerodynamics.",requiredSkills:"Vehicle Design, Industrial Design, 3D Modeling, Blender",status:"available"},{id:"role_2",title:"Character Designer",description:"Create unique alien and humanoid character designs that fit the sci-fi aesthetic. Focus on diversity and creative anatomy.",requiredSkills:"Character Design, Anatomy, Digital Painting, ZBrush",status:"available"},{id:"role_3",title:"Environment Designer",description:"Design otherworldly environments and space stations with attention to scale and atmosphere. Strong lighting and composition skills.",requiredSkills:"Environment Design, Digital Painting, Lighting, Adobe Photoshop",status:"filled"}],author:{id:"bryan",name:"Bryan Rodriguez",avatar:null,role:"Illustrator"},status:"active",createdAt:"2024-10-20T09:15:00Z",updatedAt:"2024-10-20T09:15:00Z",likes:31,views:203,applications:[]}],Ln=[{id:Pn(),title:"Photography Portfolio Collaboration",description:"Creating a stunning photography portfolio that showcases urban life and human stories. We're looking for photographers who can capture authentic moments and tell compelling visual narratives.",projectVision:"Documenting the beauty and complexity of urban life through authentic photography",whyThisMatters:"Photography has the power to preserve moments, tell stories, and connect people across cultures and time. This project aims to create a visual record of urban life that resonates with viewers and preserves important cultural moments.",teamSize:"3-4",duration:"2-3 months",meetingSchedule:"1-2 times/week",applicationDeadline:"2024-11-15",projectType:"Photography, Street Photography",contactInfo:{email:"alice@example.com",discord:"alice_photo#9012",other:""},roles:[{id:"role_1",title:"Street Photographer",description:"Capture candid moments of urban life and human interaction. Strong understanding of composition, lighting, and timing.",requiredSkills:"Street Photography, Composition, Lighting, Adobe Lightroom",status:"available"},{id:"role_2",title:"Portrait Photographer",description:"Create compelling portraits that tell individual stories. Ability to work with diverse subjects and create comfortable shooting environments.",requiredSkills:"Portrait Photography, Lighting, Photoshop, Communication",status:"available"},{id:"role_3",title:"Photo Editor",description:"Edit and enhance photographs while maintaining authenticity. Strong post-processing skills and attention to detail.",requiredSkills:"Photo Editing, Adobe Photoshop, Color Grading, Attention to Detail",status:"filled"}],author:{id:"alice",name:"Alice",avatar:null,role:"Photographer"},status:"active",createdAt:"2024-10-28T16:45:00Z",updatedAt:"2024-10-28T16:45:00Z",likes:42,views:267,applications:[]}],Tn=[...En,...Dn,...Ln],Mn=((0,a.A)((0,a.A)({},{title:"",description:"",projectVision:"",whyThisMatters:"",teamSize:"",duration:"",meetingSchedule:"",applicationDeadline:"",projectType:"",contactInfo:{email:"",discord:"",other:""},roles:[]}),{},{status:"active"}),{page:1,limit:12,status:"active",authorId:null,searchTerm:"",sortBy:"createdAt",sortOrder:"desc"}),Fn={success:!0,data:null,error:null,message:"",pagination:{page:1,limit:12,total:0,totalPages:0,hasNext:!1,hasPrev:!1}},Rn="mock_collaborations",On=()=>{try{const t=localStorage.getItem(Rn),r=t?JSON.parse(t):Tn;var e;if(console.log("[getCollaborationsFromStorage] Retrieved collaborations:",r),r&&r.length>0)console.log("[getCollaborationsFromStorage] First collaboration roles:",null===(e=r[0])||void 0===e?void 0:e.roles);return r}catch(t){return console.error("Error reading collaborations from storage:",t),Tn}},Un=e=>{try{localStorage.setItem(Rn,JSON.stringify(e))}catch(t){console.error("Error saving collaborations to storage:",t)}},zn=async e=>{try{const o=In(e);if(!o.isValid)return(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:"Validation failed",data:o.errors});const s=await _n(e);if(s.id=Pn(),e.poster&&e.poster instanceof File){const o="collaboration_".concat(s.id,"_poster");try{const t=await Promise.resolve().then(r.bind(r,337));await t.default.storeImage(o,e.poster),s.heroImage=o,s.posterPreview=o,s.posterKey=o,console.log("[Collaboration] Stored image with key: ".concat(o))}catch(t){console.error("[Collaboration] Failed to store image:",t)}}const n=[s,...On()];return console.log("[createCollaboration] collaborationData to store:",s),console.log("[createCollaboration] collaborationData.roles:",s.roles),Un(n),(0,a.A)((0,a.A)({},Fn),{},{success:!0,data:s,message:"Collaboration created successfully"})}catch(t){return console.error("Error creating collaboration:",t),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:t.message||"Failed to create collaboration"})}},Wn=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{const t=(0,a.A)((0,a.A)({},Mn),e);let r=On();if(t.authorId&&(r=r.filter(e=>e.author.id===t.authorId)),t.status&&(r=r.filter(e=>e.status===t.status)),t.searchTerm){const e=t.searchTerm.toLowerCase();r=r.filter(t=>t.title.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.projectVision.toLowerCase().includes(e))}r.sort((e,r)=>{const o=e[t.sortBy],a=r[t.sortBy];return"desc"===t.sortOrder?new Date(a)-new Date(o):new Date(o)-new Date(a)});const o=r.length,s=Math.ceil(o/t.limit),n=(t.page-1)*t.limit,i=n+t.limit,l=r.slice(n,i),c=l.map(e=>{var t,r,o,a,s;return{id:e.id,title:e.title,subtitle:e.description,description:e.description,projectVision:e.projectVision,whyThisMatters:e.whyThisMatters,image:e.heroImage||null,posterPreview:e.posterPreview||e.heroImage||null,categories:[],author:{id:(null===(t=e.author)||void 0===t?void 0:t.id)||null,name:(null===(r=e.author)||void 0===r?void 0:r.name)||"Unknown",avatar:(null===(o=e.author)||void 0===o?void 0:o.avatar)||null},likes:e.likes||0,views:e.views||0,isLiked:!1,isBookmarked:!1,isInitiator:!1,role:(null===(a=e.author)||void 0===a?void 0:a.role)||"Initiator",duration:e.duration||"",meetingSchedule:e.meetingSchedule||"",applicationDeadline:e.applicationDeadline||"",status:"active"===e.status?"Open for Collaboration":"Closed",skills:(null===(s=e.roles)||void 0===s?void 0:s.map(e=>e.title))||[],teamSize:e.teamSize||"",currentMembers:0}});return(0,a.A)((0,a.A)({},Fn),{},{success:!0,data:c,pagination:{page:t.page,limit:t.limit,total:o,totalPages:s,hasNext:t.page<s,hasPrev:t.page>1}})}catch(t){return console.error("Error fetching collaborations:",t),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:t.message||"Failed to fetch collaborations"})}},Bn=async e=>{try{const t=On(),r=t.find(t=>t.id===e);if(!r)return(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:"Collaboration not found"});r.views=(r.views||0)+1,Un(t);const o=(e=>{var t,r,o,a,s,n;console.log("[formatAPIDataForDetail] Input apiData:",e),console.log("[formatAPIDataForDetail] Input apiData.roles:",null===e||void 0===e?void 0:e.roles);const i={id:e.id,title:e.title,author:{id:null===(t=e.author)||void 0===t?void 0:t.id,title:e.title,artist:(null===(r=e.author)||void 0===r?void 0:r.name)||"Unknown",artistAvatar:(null===(o=e.author)||void 0===o?void 0:o.avatar)||null,description:e.description,image:e.heroImage||null,category:e.projectType||"Project",likes:e.likes||0,views:e.views||0,timeAgo:An(e.createdAt),role:(null===(a=e.author)||void 0===a?void 0:a.role)||"Initiator"},duration:e.duration,teamSize:e.teamSize,postedTime:An(e.createdAt),tags:[],heroImage:e.heroImage||e.posterPreview||null,description:e.description,meetingFrequency:e.meetingSchedule,deadline:e.applicationDeadline||e.deadline,contactInfo:e.contactInfo,status:e.status,projectVision:e.projectVision,whyThisMatters:e.whyThisMatters,vision:{tagline:e.projectVision,narrative:e.whyThisMatters,lookingFor:(null===(s=e.roles)||void 0===s?void 0:s.map(e=>e.title))||[],hiringTargets:(null===(n=e.roles)||void 0===n?void 0:n.map(e=>e.title))||[],contact:e.contactInfo},milestones:[],roles:e.roles||[]};return console.log("[formatAPIDataForDetail] Output result.roles:",i.roles),i})(r);return(0,a.A)((0,a.A)({},Fn),{},{success:!0,data:o})}catch(t){return console.error("Error fetching collaboration details:",t),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:t.message||"Failed to fetch collaboration details"})}},Gn=async(e,t)=>{try{const r=On(),o=r.findIndex(t=>t.id===e);if(-1===o)return(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:"Collaboration not found"});const s=In(t);if(!s.isValid)return(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:"Validation failed",data:s.errors});const n=(e=>{var t,r,o,s,n,i,l,c,d,u,h,m;return(0,a.A)((0,a.A)({},e),{},{title:(null===(t=e.title)||void 0===t?void 0:t.trim())||"",description:(null===(r=e.description)||void 0===r?void 0:r.trim())||"",projectVision:(null===(o=e.projectVision)||void 0===o?void 0:o.trim())||"",whyThisMatters:(null===(s=e.whyThisMatters)||void 0===s?void 0:s.trim())||"",projectType:(null===(n=e.projectType)||void 0===n?void 0:n.trim())||"",contactInfo:{email:(null===(i=e.contactInfo)||void 0===i||null===(l=i.email)||void 0===l?void 0:l.trim())||"",discord:(null===(c=e.contactInfo)||void 0===c||null===(d=c.discord)||void 0===d?void 0:d.trim())||"",other:(null===(u=e.contactInfo)||void 0===u||null===(h=u.other)||void 0===h?void 0:h.trim())||""},roles:(null===(m=e.roles)||void 0===m?void 0:m.map(e=>{var t,r;return(0,a.A)((0,a.A)({},e),{},{title:(null===(t=e.title)||void 0===t?void 0:t.trim())||"",description:(null===(r=e.description)||void 0===r?void 0:r.trim())||"",requiredSkills:e.requiredSkills?Array.isArray(e.requiredSkills)?e.requiredSkills:"string"===typeof e.requiredSkills?e.requiredSkills.split(",").map(e=>e.trim()).filter(e=>e.length>0):[]:[]})}))||[]})})(t);return r[o]=(0,a.A)((0,a.A)((0,a.A)({},r[o]),n),{},{updatedAt:(new Date).toISOString()}),Un(r),(0,a.A)((0,a.A)({},Fn),{},{success:!0,data:r[o],message:"Collaboration updated successfully"})}catch(r){return console.error("Error updating collaboration:",r),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:r.message||"Failed to update collaboration"})}},Hn=async e=>{try{const t=On(),r=t.filter(t=>t.id!==e);return r.length===t.length?(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:"Collaboration not found"}):(Un(r),(0,a.A)((0,a.A)({},Fn),{},{success:!0,message:"Collaboration deleted successfully"}))}catch(t){return console.error("Error deleting collaboration:",t),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:t.message||"Failed to delete collaboration"})}},qn=async e=>{try{const t=On(),r=t.find(t=>t.id===e);return r?(r.likes=(r.likes||0)+1,Un(t),(0,a.A)((0,a.A)({},Fn),{},{success:!0,data:{likes:r.likes},message:"Collaboration liked successfully"})):(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:"Collaboration not found"})}catch(t){return console.error("Error liking collaboration:",t),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:t.message||"Failed to like collaboration"})}},Vn=async()=>{try{const e={total:Tn.length,byUser:{alex:En.length,bryan:Dn.length,alice:Ln.length},byStatus:{active:Tn.filter(e=>"active"===e.status).length,completed:Tn.filter(e=>"completed"===e.status).length,paused:Tn.filter(e=>"paused"===e.status).length}};return(0,a.A)((0,a.A)({},Fn),{},{success:!0,data:e})}catch(e){return console.error("Error fetching collaboration stats:",e),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:e.message||"Failed to fetch collaboration stats"})}},Jn=async()=>{try{return Un(Tn),(0,a.A)((0,a.A)({},Fn),{},{success:!0,message:"Mock data reset successfully"})}catch(e){return console.error("Error resetting mock data:",e),(0,a.A)((0,a.A)({},Fn),{},{success:!1,error:e.message||"Failed to reset mock data"})}},Zn=t=>{let{imageKey:r,alt:o="Collaboration image",className:a="w-full h-56 object-cover",fallbackClassName:s="w-full h-56 bg-gray-200 flex items-center justify-center"}=t;const[n,i]=(0,e.useState)(null),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{(async()=>{if(r){if(r.startsWith("blob:")||r.startsWith("data:")||r.startsWith("http"))return r.startsWith("blob:"),void i(r);if(r.startsWith("collaboration_")){c(!0),u(!1);try{const e=await Ha.default.getImageUrl(r);i(e)}catch(e){console.warn("[CollaborationImage] Failed to load image: ".concat(r),e),u(!0)}finally{c(!1)}}else i(r)}else i(null)})()},[r]),l?(0,jt.jsx)("div",{className:s,children:(0,jt.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})}):d||!n?(0,jt.jsx)("div",{className:s,children:(0,jt.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}):(0,jt.jsx)("img",{src:n,alt:o,className:a,onError:e=>{console.warn("[CollaborationImage] Image failed to load: ".concat(n)),e.target.style.display="none",d||u(!0)}})},Kn=t=>{let{onCollaborationClick:r,onBookmarkToggle:o}=t;const[s,n]=(0,e.useState)([]),[i,l]=(0,e.useState)(!0),[c,d]=(0,e.useState)(null),[u,h]=(0,e.useState)({});(0,e.useEffect)(()=>{const e=async()=>{try{l(!0);const e=await Wn();e.success?(n(e.data),await t(e.data)):d(e.error)}catch(e){d(e.message)}finally{l(!1)}},t=async e=>{try{const t=(0,Lr.HW)();if(console.log("[CollaborationGrid] \u5f53\u524d\u7528\u6237:",t),null===t||void 0===t||!t.id)return void console.warn("[CollaborationGrid] \u7528\u6237\u672a\u767b\u5f55\uff0c\u8df3\u8fc7\u6536\u85cf\u72b6\u6001\u68c0\u67e5");const r={};for(const o of e)try{console.log("[CollaborationGrid] \u68c0\u67e5\u534f\u4f5c ".concat(o.id," \u7684\u6536\u85cf\u72b6\u6001..."));const e=await Rr.checkFavoriteStatus("collaboration",o.id);e.success?(r[o.id]=e.data.isFavorited,console.log("[CollaborationGrid] \u534f\u4f5c ".concat(o.id," \u6536\u85cf\u72b6\u6001:"),e.data.isFavorited)):(console.error("[CollaborationGrid] \u68c0\u67e5\u534f\u4f5c ".concat(o.id," \u6536\u85cf\u72b6\u6001\u5931\u8d25:"),e.error),r[o.id]=!1)}catch(c){console.error("[CollaborationGrid] \u68c0\u67e5\u534f\u4f5c ".concat(o.id," \u6536\u85cf\u72b6\u6001\u65f6\u51fa\u9519:"),c),r[o.id]=!1}h(r),console.log("[CollaborationGrid] \u6240\u6709\u6536\u85cf\u72b6\u6001:",r)}catch(c){console.error("[CollaborationGrid] \u68c0\u67e5\u6536\u85cf\u72b6\u6001\u65f6\u51fa\u9519:",c)}};e();const r=()=>{e()};return window.addEventListener("collaboration:created",r),()=>{window.removeEventListener("collaboration:created",r)}},[]);return i?(0,jt.jsx)("div",{className:"flex-1 flex items-center justify-center py-12",children:(0,jt.jsx)("div",{className:"text-gray-500",children:"Loading collaborations..."})}):c?(0,jt.jsx)("div",{className:"flex-1 flex items-center justify-center py-12",children:(0,jt.jsxs)("div",{className:"text-red-500",children:["Error loading collaborations: ",c]})}):0===s.length?(0,jt.jsx)("div",{className:"flex-1 flex items-center justify-center py-12",children:(0,jt.jsx)("div",{className:"text-gray-500",children:"No collaborations found."})}):(0,jt.jsx)("div",{className:"flex-1",children:(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md hover:scale-105 transition-all duration-300",children:[(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("div",{onClick:()=>r&&r(e),className:"block cursor-pointer",children:(0,jt.jsx)(Zn,{imageKey:e.posterPreview,alt:e.title})}),(0,jt.jsx)("button",{onClick:t=>(async(e,t)=>{e.stopPropagation();try{const e=(0,Lr.HW)();if(null===e||void 0===e||!e.id)return void console.error("[CollaborationGrid] \u7528\u6237\u672a\u767b\u5f55\uff0c\u65e0\u6cd5\u6536\u85cf");const r=u[t]||!1;console.log("[CollaborationGrid] \u5207\u6362\u534f\u4f5c ".concat(t," \u6536\u85cf\u72b6\u6001\uff0c\u5f53\u524d\u72b6\u6001:"),r);const s=await Rr.toggleFavorite("collaboration",t,!r);if(s.success){const e=!r;h(r=>(0,a.A)((0,a.A)({},r),{},{[t]:e})),o&&o(t),console.log("[CollaborationGrid] \u534f\u4f5c ".concat(t," ").concat(e?"\u6536\u85cf":"\u53d6\u6d88\u6536\u85cf","\u6210\u529f")),setTimeout(async()=>{try{const e=await Rr.checkFavoriteStatus("collaboration",t);console.log("[CollaborationGrid] \u9a8c\u8bc1\u534f\u4f5c ".concat(t," \u6536\u85cf\u72b6\u6001:"),e.data.isFavorited)}catch(c){console.error("[CollaborationGrid] \u9a8c\u8bc1\u6536\u85cf\u72b6\u6001\u5931\u8d25:",c)}},100)}else console.error("[CollaborationGrid] \u6536\u85cf\u64cd\u4f5c\u5931\u8d25:",s.error)}catch(c){console.error("[CollaborationGrid] \u6536\u85cf\u64cd\u4f5c\u51fa\u9519:",c)}})(t,e.id),className:"absolute top-3 right-3 p-2 bg-white bg-opacity-90 rounded-full hover:bg-opacity-100 transition-all duration-200",title:u[e.id]?"\u53d6\u6d88\u6536\u85cf":"\u6536\u85cf",children:(0,jt.jsx)("svg",{className:"w-5 h-5 ".concat(u[e.id]?"text-purple-500 fill-current":"text-gray-400"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})})]}),(0,jt.jsxs)("div",{className:"p-3",children:[(0,jt.jsx)("div",{onClick:()=>r&&r(e),className:"block cursor-pointer",children:(0,jt.jsx)("h3",{className:"font-bold text-gray-900 mb-2 text-sm hover:text-purple-600 transition-colors duration-200",children:e.title})}),(0,jt.jsxs)("div",{className:"flex items-center",children:[e.author.avatar?(0,jt.jsx)("img",{src:e.author.avatar,alt:e.author.name,className:"w-6 h-6 rounded-full mr-2 object-cover",onError:e=>{e.target.style.display="none"}}):(0,jt.jsx)("div",{className:"w-6 h-6 rounded-full mr-2 bg-gray-300 flex items-center justify-center",children:(0,jt.jsx)("span",{className:"text-xs text-gray-600 font-medium",children:e.author.name.charAt(0).toUpperCase()})}),(0,jt.jsx)("span",{className:"text-xs font-medium text-gray-900",children:e.author.name})]})]})]},e.id))})})},Yn={categories:[{id:"thesis-project",name:"Thesis Project"},{id:"course-project",name:"Course Project"},{id:"studio-class",name:"Studio Class"},{id:"research-collaboration",name:"Research Collaboration"},{id:"internship-project",name:"Internship Project"},{id:"startup",name:"Startup"},{id:"student-club",name:"Student Club"},{id:"interdisciplinary-teamwork",name:"Interdisciplinary Teamwork"},{id:"international-exchange",name:"International Exchange"},{id:"others",name:"Others"}],majors:[{id:"accessory-design",name:"Accessory Design"},{id:"acting",name:"Acting"},{id:"advertising",name:"Advertising"},{id:"animation",name:"Animation"},{id:"architecture",name:"Architecture"},{id:"art-history",name:"Art History"},{id:"creative-business-leadership",name:"Creative Business Leadership"},{id:"fashion-design",name:"Fashion Design"},{id:"fibers",name:"Fibers"},{id:"film",name:"Film"},{id:"film-television",name:"Film/Television"},{id:"fine-art",name:"Fine Art"},{id:"game-design",name:"Game/ITGM"},{id:"graphic-design",name:"Graphic Design"},{id:"industrial-design",name:"Industrial Design"},{id:"illustration",name:"Illustration"},{id:"interior-design",name:"Interior Design"},{id:"jewelry",name:"Jewelry"},{id:"motion-design",name:"Motion Design"},{id:"painting",name:"Painting"},{id:"photography",name:"Photography"},{id:"service-design",name:"Service Design"},{id:"sequential-art",name:"Sequential Art"},{id:"ui-ux",name:"UI/UX"},{id:"visual-effects",name:"Visual Effects"}],tags:[{id:"typography",name:"Typography"},{id:"branding",name:"Branding"},{id:"editorial",name:"Editorial"},{id:"minimalist",name:"Minimalist"},{id:"experimental",name:"Experimental"},{id:"sustainable",name:"Sustainable"},{id:"interactive",name:"Interactive"},{id:"motion",name:"Motion"}]},Qn=[{id:1,title:"Fantasy Character Series",description:"Digital illustration project exploring mythical creatures",image:null,progress:75,tags:["Illustration","Character Design"],teamMembers:[{name:"Sarah Chen",avatar:null},{name:"Alex Kim",avatar:null}],timestamp:"3 hours ago"},{id:2,title:"Cyberpunk Game Environment",description:"3D environment design for indie game project",image:null,progress:60,tags:["Game Design","3D Modeling"],teamMembers:[{name:"Maya Rodriguez",avatar:null},{name:"David Lee",avatar:null},{name:"Emma Wilson",avatar:null}],timestamp:"5 hours ago"},{id:3,title:"Short Film Storyboard",description:"Pre-production planning for student film festival",image:null,progress:25,tags:["Film","Storyboard"],teamMembers:[{name:"Jordan Park",avatar:null},{name:"Sophie Davis",avatar:null}],timestamp:"1 day ago"},{id:4,title:"Music Festival Branding",description:"Complete visual identity for campus music festival",image:null,progress:80,tags:["Graphic Design","Branding"],teamMembers:[{name:"Mike Johnson",avatar:null},{name:"Lisa Chen",avatar:null},{name:"Tom Wilson",avatar:null}],timestamp:"6 hours ago"},{id:5,title:"Magic VFX Sequence",description:"Visual effects compositing for fantasy short film",image:null,progress:40,tags:["VFX","Compositing"],teamMembers:[{name:"Anna Smith",avatar:null},{name:"Chris Brown",avatar:null}],timestamp:"2 days ago"},{id:6,title:"2D Character Animation",description:"Walk cycle and expressions for animated short",image:null,progress:90,tags:["Animation","2D Art"],teamMembers:[{name:"Rachel Green",avatar:null},{name:"Kevin Lee",avatar:null},{name:"Maria Garcia",avatar:null},{name:"James Miller",avatar:null}],timestamp:"4 hours ago"}],$n=[{id:1,title:"Indie Horror Game",description:"Seeking talented artists for an atmospheric horror game project with unique visual style and immersive storytelling.",status:"Open",timePosted:"2 days ago",skills:["3D Artist","Concept Artist"],tools:["Unity","Blender"],recruiter:{name:"Alex Chen",avatar:null},applicants:5,dueDate:"March 15"},{id:2,title:"Animated Short Film",description:"Collaborative animation project for film festival submission. Looking for creative animators and sound designers.",status:"Open",timePosted:"1 week ago",skills:["Animator","Sound Designer"],tools:["After Effects","Premiere"],recruiter:{name:"Sarah Kim",avatar:null},applicants:12,dueDate:"April 2"},{id:3,title:"Mobile App UI Design",description:"Design intuitive and modern user interface for a productivity app targeting young professionals.",status:"Urgent",timePosted:"3 hours ago",skills:["UI Designer","UX Designer"],tools:["Figma","Sketch"],recruiter:{name:"Mike Rodriguez",avatar:null},applicants:8,dueDate:"Feb 28"},{id:4,title:"VR Experience Project",description:"Immersive virtual reality experience for educational purposes. Seeking developers with VR development experience.",status:"Open",timePosted:"5 days ago",skills:["Unity Developer","3D Artist"],tools:["Unity","Oculus SDK"],recruiter:{name:"Emma Johnson",avatar:null},applicants:3,dueDate:"May 10"},{id:5,title:"Podcast Series Design",description:"Create visual identity and promotional materials for a student-run podcast series about design and creativity.",status:"Open",timePosted:"1 day ago",skills:["Graphic Designer","Motion Designer"],tools:["Photoshop","After Effects"],recruiter:{name:"David Lee",avatar:null},applicants:6,dueDate:"March 20"}],Xn=e=>{let{onApplyJob:t}=e;return(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"text-center py-8 mb-8",children:[(0,jt.jsx)("h3",{className:"text-lg font-medium text-red-500 mb-2",children:"Jobs Coming Soon"}),(0,jt.jsx)("p",{className:"text-red-400",children:"Job opportunities and internships will be available here."})]}),(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:$n.map(e=>(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md transition-all duration-300",children:[(0,jt.jsxs)("div",{className:"p-4 border-b border-gray-100",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,jt.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat("Urgent"===e.status?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:e.status}),(0,jt.jsx)("span",{className:"text-xs text-gray-500",children:e.timePosted})]}),(0,jt.jsx)("h3",{className:"font-bold text-gray-900 text-lg mb-2",children:e.title}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 leading-relaxed",children:e.description})]}),(0,jt.jsxs)("div",{className:"p-4",children:[(0,jt.jsx)("div",{className:"mb-3",children:(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:e.skills.map((e,t)=>(0,jt.jsx)("span",{className:"px-3 py-1 text-xs bg-blue-100 text-blue-800 rounded-full font-medium",children:e},t))})}),(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:e.tools.map((e,t)=>(0,jt.jsx)("span",{className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded-full font-medium",children:e},t))})}),(0,jt.jsxs)("div",{className:"flex items-center mb-3",children:[(0,jt.jsx)("img",{src:e.recruiter.avatar,alt:e.recruiter.name,className:"w-8 h-8 rounded-full mr-3"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.recruiter.name}),(0,jt.jsxs)("p",{className:"text-xs text-gray-500",children:[e.applicants," applicants"]})]})]}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:["Due: ",e.dueDate]}),(0,jt.jsx)("button",{onClick:()=>t&&t(e.id),className:"bg-purple-500 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-purple-600 transition-colors duration-200",children:"Apply"})]})]})]},e.id))})]})},ei=e=>({Illustration:"bg-purple-200 text-purple-800","Character Design":"bg-blue-200 text-blue-800","Game Design":"bg-green-200 text-green-800","3D Modeling":"bg-purple-200 text-purple-800",Film:"bg-orange-200 text-orange-800",Storyboard:"bg-blue-200 text-blue-800","Graphic Design":"bg-pink-200 text-pink-800",Branding:"bg-blue-200 text-blue-800",VFX:"bg-purple-200 text-purple-800",Compositing:"bg-orange-200 text-orange-800",Animation:"bg-green-200 text-green-800","2D Art":"bg-pink-200 text-pink-800"}[e]||"bg-gray-200 text-gray-800"),ti=e=>{let{onMilestoneClick:t}=e;return(0,jt.jsx)("div",{className:"flex-1",children:(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Qn.map(e=>{return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden hover:shadow-md hover:scale-105 transition-all duration-300",children:[(0,jt.jsx)("div",{className:"relative",children:(0,jt.jsx)(mt,{to:"/tagme/milestone/".concat(e.id),className:"block",children:(0,jt.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover"})})}),(0,jt.jsxs)("div",{className:"p-4",children:[(0,jt.jsxs)(mt,{to:"/tagme/milestone/".concat(e.id),className:"block",children:[(0,jt.jsx)("h3",{className:"font-bold text-gray-900 mb-1 text-lg hover:text-purple-600 transition-colors duration-200",children:e.title}),(0,jt.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:e.description})]}),(0,jt.jsxs)("div",{className:"mb-4",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,jt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),(0,jt.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[e.progress,"%"]})]}),(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,jt.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat((t=e.tags[0],{Illustration:"bg-purple-500","Character Design":"bg-blue-500","Game Design":"bg-green-500","3D Modeling":"bg-purple-500",Film:"bg-orange-500",Storyboard:"bg-blue-500","Graphic Design":"bg-pink-500",Branding:"bg-blue-500",VFX:"bg-purple-500",Compositing:"bg-orange-500",Animation:"bg-green-500","2D Art":"bg-pink-500"}[t]||"bg-gray-500")),style:{width:"".concat(e.progress,"%")}})})]}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2 mb-4",children:e.tags.map((e,t)=>(0,jt.jsx)("span",{className:"px-3 py-1 text-xs rounded-full font-medium ".concat(ei(e)),children:e},t))}),(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{className:"flex items-center",children:[(0,jt.jsx)("div",{className:"flex -space-x-2 mr-3",children:e.teamMembers.slice(0,4).map((e,t)=>(0,jt.jsx)("img",{src:e.avatar,alt:e.name,className:"w-8 h-8 rounded-full border-2 border-white"},t))}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:[e.teamMembers.length," members"]})]}),(0,jt.jsx)("span",{className:"text-xs text-gray-500",children:e.timestamp})]})]})]},e.id);var t})})})},ri=e=>{let{children:t,activeTab:r,onTabChange:o,onCollaborationClick:a,onMilestoneClick:s}=e;return(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[(0,jt.jsxs)("div",{className:"flex flex-col mb-8","data-tagme-section":!0,children:[(0,jt.jsx)("h2",{className:"text-3xl font-bold text-gray-400 mb-6",children:"TAG Me"}),(0,jt.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,jt.jsx)("div",{className:"w-7/12",children:(0,jt.jsx)(_t,{onInputChange:e=>console.log("Search:",e.target.value),placeholder:"Search for Collaborations or Artists",className:"w-full"})}),(0,jt.jsx)("div",{className:"inline-flex rounded-full border border-gray-300 bg-white p-1",children:["Collaborations","Milestones","Jobs"].map(e=>(0,jt.jsxs)("button",{onClick:()=>o(e),className:"relative px-12 py-3 text-base font-semibold tracking-wide transition-all duration-300 ease-in-out ".concat(r===e?"text-white":"text-gray-700 hover:text-gray-900"),children:[r===e&&(0,jt.jsx)("div",{className:"absolute inset-0 bg-purple-500 rounded-full transition-all duration-300 ease-in-out"}),(0,jt.jsx)("span",{className:"relative z-10",children:e})]},e))})]})]}),(0,jt.jsx)("div",{className:"flex flex-col lg:flex-row gap-8",children:t})]})},oi=e=>{let{selectedCategories:t,selectedMajors:r,selectedTags:o,onCategoryToggle:a,onMajorToggle:s,onTagToggle:n}=e;return(0,jt.jsx)("div",{className:"lg:w-64 flex-shrink-0",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,jt.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"Filters"}),(0,jt.jsxs)("div",{className:"mb-8",children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-3",children:"Category"}),(0,jt.jsx)("div",{className:"space-y-2",children:Yn.categories.map(e=>(0,jt.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,jt.jsx)("input",{type:"checkbox",checked:t.includes(e.id),onChange:()=>a(e.id),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),(0,jt.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e.name})]},e.id))})]}),(0,jt.jsxs)("div",{className:"mb-8",children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-3",children:"Major"}),(0,jt.jsx)("div",{className:"space-y-2",children:Yn.majors.map(e=>(0,jt.jsxs)("label",{className:"flex items-center cursor-pointer",children:[(0,jt.jsx)("input",{type:"checkbox",checked:r.includes(e.id),onChange:()=>s(e.id),className:"rounded border-gray-300 text-purple-600 focus:ring-purple-500"}),(0,jt.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:e.name})]},e.id))})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"font-bold text-gray-900 mb-3",children:"Tags"}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:Yn.tags.map(e=>(0,jt.jsx)("button",{onClick:()=>n(e.id),className:"px-3 py-1 text-xs rounded-full transition-colors duration-200 ".concat(o.includes(e.id)?"bg-purple-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e.name},e.id))})]})]})})},ai=()=>(0,jt.jsx)(jt.Fragment,{children:(0,jt.jsx)("section",{className:"pt-20 pb-16 bg-white",children:(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[(0,jt.jsx)("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 mb-6",children:"Discover Amazing Student Creative Work"}),(0,jt.jsx)("p",{className:"text-lg md:text-xl text-gray-600 mb-8 max-w-3xl mx-auto leading-relaxed",children:"Explore thousands of inspiring projects from talented students across the globe. From 3D art to concept design, find your next creative inspiration."}),(0,jt.jsx)("button",{onClick:()=>{},className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-3 rounded-md text-lg font-medium hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-1",children:"About TAG"})]})})}),si=t=>{let{state:r,setters:o}=t;const{setSelectedCategories:a,setSelectedMajors:s,setSelectedTags:n}=o;return{handleCategoryToggle:(0,e.useCallback)(e=>{a(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[a]),handleMajorToggle:(0,e.useCallback)(e=>{s(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[s]),handleTagToggle:(0,e.useCallback)(e=>{n(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[n]),handleLikeToggle:(0,e.useCallback)(e=>{},[]),handleApplyJob:(0,e.useCallback)(e=>{},[]),handleBookmarkToggle:(0,e.useCallback)(async e=>{console.log("[useTAGMeActions] \u6536\u85cf\u72b6\u6001\u53d8\u5316\u901a\u77e5:",e)},[])}},ni=()=>{const[t,r]=(0,e.useState)("Collaborations"),[o,a]=(0,e.useState)([]),[s,n]=(0,e.useState)([]),[i,l]=(0,e.useState)([]);return(0,e.useMemo)(()=>({state:{activeTab:t,selectedCategories:o,selectedMajors:s,selectedTags:i},setters:{setActiveTab:r,setSelectedCategories:a,setSelectedMajors:n,setSelectedTags:l}}),[t,o,s,i])},ii=t=>{var r,o;let{onBackClick:a,onMilestoneClick:s,onCollaborationClick:n}=t;const i=ne(),{restoreScrollPosition:l}=Xo(),{state:c,actions:d}=Go(),{state:u,setters:h}=ni(),m=si({state:u,setters:h});return(0,e.useEffect)(()=>{var e,t;null!==(e=i.state)&&void 0!==e&&e.activeTab&&"upload-success"===(null===(t=i.state)||void 0===t?void 0:t.from)&&(h.setActiveTab(i.state.activeTab),window.history.replaceState({},document.title),setTimeout(()=>{const e=document.querySelector("[data-tagme-section]");if(e){const t=e.getBoundingClientRect(),r=window.pageYOffset+t.top-80;window.scrollTo({top:r,behavior:"auto"})}},100))},[null===(r=i.state)||void 0===r?void 0:r.activeTab,null===(o=i.state)||void 0===o?void 0:o.from,h.setActiveTab]),(0,e.useEffect)(()=>{const e=c.scrollPositions["/tagme-".concat(u.activeTab)];if(e&&c.navigationHistory.length>0){"tagme"===c.navigationHistory[c.navigationHistory.length-1].from&&requestAnimationFrame(()=>{window.scrollTo({top:e,behavior:"auto"})})}},[u.activeTab]),(0,e.useEffect)(()=>{if(c.navigationHistory.length>0){const e=c.navigationHistory[c.navigationHistory.length-1];"tagme"===e.from&&e.activeTab&&h.setActiveTab(e.activeTab)}},[c.navigationHistory,h.setActiveTab]),(0,e.useEffect)(()=>{const e=()=>{const e=window.pageYOffset;d.saveScrollPosition("/tagme-".concat(u.activeTab),e)},t=setInterval(e,1e3),r=e,o=()=>{"hidden"===document.visibilityState&&e()};return window.addEventListener("beforeunload",r),document.addEventListener("visibilitychange",o),()=>{e(),clearInterval(t),window.removeEventListener("beforeunload",r),document.removeEventListener("visibilitychange",o)}},[u.activeTab,d.saveScrollPosition]),(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50",style:{opacity:1,transition:"opacity 0.2s ease-in"},children:[(0,jt.jsx)(ai,{}),(0,jt.jsxs)(ri,{activeTab:u.activeTab,onTabChange:h.setActiveTab,onCollaborationClick:n,onMilestoneClick:s,children:[(0,jt.jsx)(oi,{selectedCategories:u.selectedCategories,selectedMajors:u.selectedMajors,selectedTags:u.selectedTags,onCategoryToggle:m.handleCategoryToggle,onMajorToggle:m.handleMajorToggle,onTagToggle:m.handleTagToggle}),"Collaborations"===u.activeTab&&(0,jt.jsx)(Kn,{onCollaborationClick:n,onBookmarkToggle:m.handleBookmarkToggle}),"Milestones"===u.activeTab&&(0,jt.jsx)(ti,{onMilestoneClick:s}),"Jobs"===u.activeTab&&(0,jt.jsx)(Xn,{onApplyJob:m.handleApplyJob})]})]})},li=()=>{const[t,r]=(0,e.useState)(null),[o,s]=(0,e.useState)(!1),[n,i]=(0,e.useState)(""),[l,c]=(0,e.useState)(!1),{collaborations:d,loading:u,error:h,createNewCollaboration:m,fetchCollaborations:p,resetData:g,stats:f}=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[r,o]=(0,e.useState)([]),[s,n]=(0,e.useState)(null),[i,l]=(0,e.useState)(null),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(null),[m,p]=(0,e.useState)({page:1,limit:12,total:0,totalPages:0,hasNext:!1,hasPrev:!1}),[g,f]=(0,e.useState)((0,a.A)({page:1,limit:12,status:"active",authorId:null,searchTerm:"",sortBy:"createdAt",sortOrder:"desc"},t)),v=(0,e.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};d(!0),h(null);try{const t=(0,a.A)((0,a.A)({},g),e);f(t);const r=await Wn(t);r.success?(o(r.data),p(r.pagination)):h(r.error)}catch(t){h(t.message||"Failed to fetch collaborations")}finally{d(!1)}},[g]),x=(0,e.useCallback)(async e=>{d(!0),h(null);try{const t=await Bn(e);t.success?n(t.data):h(t.error)}catch(t){h(t.message||"Failed to fetch collaboration details")}finally{d(!1)}},[]),b=(0,e.useCallback)(async e=>{d(!0),h(null);try{const t=await zn(e);return t.success?(await v({page:1}),{success:!0,data:t.data}):(h(t.error),{success:!1,errors:t.data})}catch(t){const e=t.message||"Failed to create collaboration";return h(e),{success:!1,error:e}}finally{d(!1)}},[v]),y=(0,e.useCallback)(async(e,t)=>{d(!0),h(null);try{const r=await Gn(e,t);return r.success?((null===s||void 0===s?void 0:s.id)===e&&n(r.data),await v(),{success:!0,data:r.data}):(h(r.error),{success:!1,errors:r.data})}catch(r){const e=r.message||"Failed to update collaboration";return h(e),{success:!1,error:e}}finally{d(!1)}},[s,v]),w=(0,e.useCallback)(async e=>{d(!0),h(null);try{const t=await Hn(e);return t.success?((null===s||void 0===s?void 0:s.id)===e&&n(null),await v(),{success:!0}):(h(t.error),{success:!1,error:t.error})}catch(t){const e=t.message||"Failed to delete collaboration";return h(e),{success:!1,error:e}}finally{d(!1)}},[s,v]),j=(0,e.useCallback)(async e=>{try{const t=await qn(e);return t.success?(o(r=>r.map(r=>r.id===e?(0,a.A)((0,a.A)({},r),{},{likes:t.data.likes}):r)),(null===s||void 0===s?void 0:s.id)===e&&n(e=>(0,a.A)((0,a.A)({},e),{},{likes:t.data.likes})),{success:!0,likes:t.data.likes}):{success:!1,error:t.error}}catch(t){return{success:!1,error:t.message||"Failed to like collaboration"}}},[s]),k=(0,e.useCallback)(async()=>{try{const e=await Vn();e.success&&l(e.data)}catch(e){console.error("Failed to fetch stats:",e)}},[]),S=(0,e.useCallback)(async()=>{d(!0),h(null);try{const e=await Jn();return e.success?(await v({page:1}),await k(),{success:!0}):(h(e.error),{success:!1,error:e.error})}catch(e){const t=e.message||"Failed to reset data";return h(t),{success:!1,error:t}}finally{d(!1)}},[v,k]),N=(0,e.useCallback)(e=>{v({searchTerm:e,page:1})},[v]),C=(0,e.useCallback)(e=>{v((0,a.A)((0,a.A)({},e),{},{page:1}))},[v]),_=(0,e.useCallback)(function(e){v({sortBy:e,sortOrder:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"desc",page:1})},[v]),A=(0,e.useCallback)(e=>{v({page:e})},[v]),I=(0,e.useCallback)(()=>{h(null)},[]),P=(0,e.useCallback)(()=>{n(null)},[]);return(0,e.useEffect)(()=>{v(),k()},[]),{collaborations:r,currentCollaboration:s,stats:i,loading:c,error:u,pagination:m,queryOptions:g,fetchCollaborations:v,fetchCollaborationById:x,createNewCollaboration:b,updateExistingCollaboration:y,deleteExistingCollaboration:w,likeExistingCollaboration:j,fetchStats:k,resetData:S,searchCollaborations:N,filterCollaborations:C,sortCollaborations:_,goToPage:A,clearError:I,clearCurrentCollaboration:P,hasNextPage:m.hasNext,hasPrevPage:m.hasPrev,currentPage:m.page,totalPages:m.totalPages,totalItems:m.total}}(),[v,x]=(0,e.useState)({title:"Manual Test Collaboration",description:"This is a manual test collaboration project.",projectVision:"Testing collaboration functionality manually",whyThisMatters:"This helps verify the collaboration system works correctly.",teamSize:"2-3",duration:"1-2 months",meetingSchedule:"1-2 times/week",applicationDeadline:"2024-12-31",projectType:"Test Project",contactEmail:"test@example.com",contactDiscord:"testuser#1234",contactOther:"",roles:[{id:1,customRole:"Test Role",roleDescription:"This is a test role for manual testing.",requiredSkills:"Testing, JavaScript, React"}]}),b=(e,t)=>{x(r=>(0,a.A)((0,a.A)({},r),{},{[e]:t}))},y=(e,t,r)=>{x(o=>(0,a.A)((0,a.A)({},o),{},{roles:o.roles.map((o,s)=>s===e?(0,a.A)((0,a.A)({},o),{},{[t]:r}):o)}))};return(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,jt.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,jt.jsxs)("div",{className:"text-center mb-8",children:[(0,jt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\ud83e\uddea Collaboration Service Test Page"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Test the collaboration functionality and verify all features work correctly"})]}),(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\ud83d\udcca Current Status"}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,jt.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,jt.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:d.length}),(0,jt.jsx)("div",{className:"text-sm text-blue-800",children:"Total Collaborations"})]}),(0,jt.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,jt.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null===f||void 0===f?void 0:f.total)||0}),(0,jt.jsx)("div",{className:"text-sm text-green-800",children:"Active Projects"})]}),(0,jt.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg",children:[(0,jt.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:u?"...":"Ready"}),(0,jt.jsx)("div",{className:"text-sm text-purple-800",children:"Service Status"})]}),(0,jt.jsxs)("div",{className:"bg-orange-50 p-4 rounded-lg",children:[(0,jt.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:h?"Error":"OK"}),(0,jt.jsx)("div",{className:"text-sm text-orange-800",children:"Error Status"})]})]})]}),(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\ud83d\udd27 Test Controls"}),(0,jt.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,jt.jsx)("button",{onClick:async()=>{s(!0),r(null),i("");try{console.log("\ud83e\uddea Starting automated tests...");const e=await(async()=>{const e={passed:0,failed:0,tests:[]};console.log("\ud83e\uddea Starting Collaboration Service Tests...");try{console.log("\ud83d\udccb Test 1: Reset Mock Data");const t=await Jn();t.success?(e.passed++,e.tests.push({name:"Reset Mock Data",status:"PASSED"}),console.log("\u2705 Reset Mock Data: PASSED")):(e.failed++,e.tests.push({name:"Reset Mock Data",status:"FAILED",error:t.error}),console.log("\u274c Reset Mock Data: FAILED",t.error)),console.log("\ud83d\udccb Test 2: Get Collaborations List");const r=await Wn();r.success&&r.data.length>0?(e.passed++,e.tests.push({name:"Get Collaborations List",status:"PASSED",count:r.data.length}),console.log("\u2705 Get Collaborations List: PASSED","(".concat(r.data.length," items)"))):(e.failed++,e.tests.push({name:"Get Collaborations List",status:"FAILED",error:r.error}),console.log("\u274c Get Collaborations List: FAILED",r.error)),console.log("\ud83d\udccb Test 3: Get Collaboration Stats");const o=await Vn();o.success&&o.data?(e.passed++,e.tests.push({name:"Get Collaboration Stats",status:"PASSED",stats:o.data}),console.log("\u2705 Get Collaboration Stats: PASSED",o.data)):(e.failed++,e.tests.push({name:"Get Collaboration Stats",status:"FAILED",error:o.error}),console.log("\u274c Get Collaboration Stats: FAILED",o.error)),console.log("\ud83d\udccb Test 4: Create New Collaboration");const a={title:"Test Collaboration Project",description:"This is a test collaboration project for testing purposes.",projectVision:"Testing the collaboration service functionality",whyThisMatters:"This test helps ensure the service works correctly.",teamSize:"2-3",duration:"1-2 months",meetingSchedule:"1-2 times/week",applicationDeadline:"2024-12-31",projectType:"Test Project",contactEmail:"test@example.com",contactDiscord:"testuser#1234",contactOther:"",roles:[{id:1,customRole:"Test Role",roleDescription:"This is a test role for testing purposes.",requiredSkills:"Testing, JavaScript, React"}]},s=await zn(a);if(s.success&&s.data.id){e.passed++,e.tests.push({name:"Create New Collaboration",status:"PASSED",id:s.data.id}),console.log("\u2705 Create New Collaboration: PASSED",s.data.id),console.log("\ud83d\udccb Test 5: Get Collaboration Details");const t=await Bn(s.data.id);if(t.success&&t.data){e.passed++,e.tests.push({name:"Get Collaboration Details",status:"PASSED",id:s.data.id}),console.log("\u2705 Get Collaboration Details: PASSED"),console.log("\ud83d\udccb Test 6: Like Collaboration");const t=await qn(s.data.id);if(t.success&&t.data.likes>0){e.passed++,e.tests.push({name:"Like Collaboration",status:"PASSED",likes:t.data.likes}),console.log("\u2705 Like Collaboration: PASSED",t.data.likes),console.log("\ud83d\udccb Test 7: Update Collaboration");const r={title:"Updated Test Collaboration Project",description:"This is an updated test collaboration project.",projectVision:"Updated testing vision",teamSize:"3-4",duration:"2-3 months",meetingSchedule:"2-3 times/week",applicationDeadline:"2024-12-31",contactEmail:"updated@example.com",contactDiscord:"updateduser#5678",contactOther:"",roles:[{id:1,customRole:"Updated Test Role",roleDescription:"This is an updated test role.",requiredSkills:"Updated Testing, JavaScript, React"}]},o=await Gn(s.data.id,r);if(o.success&&o.data.title===r.title){e.passed++,e.tests.push({name:"Update Collaboration",status:"PASSED"}),console.log("\u2705 Update Collaboration: PASSED"),console.log("\ud83d\udccb Test 8: Delete Collaboration");const t=await Hn(s.data.id);t.success?(e.passed++,e.tests.push({name:"Delete Collaboration",status:"PASSED"}),console.log("\u2705 Delete Collaboration: PASSED")):(e.failed++,e.tests.push({name:"Delete Collaboration",status:"FAILED",error:t.error}),console.log("\u274c Delete Collaboration: FAILED",t.error))}else e.failed++,e.tests.push({name:"Update Collaboration",status:"FAILED",error:o.error}),console.log("\u274c Update Collaboration: FAILED",o.error)}else e.failed++,e.tests.push({name:"Like Collaboration",status:"FAILED",error:t.error}),console.log("\u274c Like Collaboration: FAILED",t.error)}else e.failed++,e.tests.push({name:"Get Collaboration Details",status:"FAILED",error:t.error}),console.log("\u274c Get Collaboration Details: FAILED",t.error)}else e.failed++,e.tests.push({name:"Create New Collaboration",status:"FAILED",error:s.error}),console.log("\u274c Create New Collaboration: FAILED",s.error);console.log("\ud83d\udccb Test 9: Search Collaborations");const n=await Wn({searchTerm:"Game"});n.success?(e.passed++,e.tests.push({name:"Search Collaborations",status:"PASSED",count:n.data.length}),console.log("\u2705 Search Collaborations: PASSED","(".concat(n.data.length," results)"))):(e.failed++,e.tests.push({name:"Search Collaborations",status:"FAILED",error:n.error}),console.log("\u274c Search Collaborations: FAILED",n.error)),console.log("\ud83d\udccb Test 10: Pagination");const i=await Wn({page:1,limit:2});i.success&&i.pagination?(e.passed++,e.tests.push({name:"Pagination",status:"PASSED",pagination:i.pagination}),console.log("\u2705 Pagination: PASSED",i.pagination)):(e.failed++,e.tests.push({name:"Pagination",status:"FAILED",error:i.error}),console.log("\u274c Pagination: FAILED",i.error))}catch(h){console.error("\u274c Test Suite Error:",h),e.failed++,e.tests.push({name:"Test Suite",status:"ERROR",error:h.message})}return console.log("\n\ud83d\udcca Test Results Summary:"),console.log("\u2705 Passed: ".concat(e.passed)),console.log("\u274c Failed: ".concat(e.failed)),console.log("\ud83d\udcc8 Success Rate: ".concat((e.passed/(e.passed+e.failed)*100).toFixed(1),"%")),e})();r(e);const t=(e=>{const t=["# Collaboration Service Test Report","","## Summary","- **Total Tests**: ".concat(e.passed+e.failed),"- **Passed**: ".concat(e.passed),"- **Failed**: ".concat(e.failed),"- **Success Rate**: ".concat((e.passed/(e.passed+e.failed)*100).toFixed(1),"%"),"","## Test Details",""];return e.tests.forEach(e=>{const r="PASSED"===e.status?"\u2705":"\u274c";t.push("### ".concat(r," ").concat(e.name)),e.error&&t.push("**Error**: ".concat(e.error)),e.count&&t.push("**Count**: ".concat(e.count)),e.id&&t.push("**ID**: ".concat(e.id)),e.likes&&t.push("**Likes**: ".concat(e.likes)),e.stats&&t.push("**Stats**: ".concat(JSON.stringify(e.stats,null,2))),e.pagination&&t.push("**Pagination**: ".concat(JSON.stringify(e.pagination,null,2))),t.push("")}),t.join("\n")})(e);i(t),console.log("\u2705 Automated tests completed!")}catch(h){console.error("\u274c Test execution failed:",h),r({passed:0,failed:1,tests:[{name:"Test Execution",status:"ERROR",error:h.message}]})}finally{s(!1)}},disabled:o,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white px-6 py-2 rounded-lg font-medium",children:o?"\ud83d\udd04 Running Tests...":"\ud83e\uddea Run Automated Tests"}),(0,jt.jsx)("button",{onClick:()=>{const e=(()=>{const e={valid:!0,issues:[]};try{const t=localStorage.getItem(Rn);if(!t)return e.issues.push("No collaboration data found in localStorage"),e.valid=!1,e;JSON.parse(t).forEach((t,r)=>{const o=["id","title","description","projectVision","author","status"].filter(e=>!t[e]);o.length>0&&(e.issues.push("Collaboration ".concat(r,": Missing required fields: ").concat(o.join(", "))),e.valid=!1),!t.author||t.author.id&&t.author.name||(e.issues.push("Collaboration ".concat(r,": Invalid author information")),e.valid=!1),t.roles&&Array.isArray(t.roles)&&t.roles.forEach((t,o)=>{t.title&&t.description||(e.issues.push("Collaboration ".concat(r,", Role ").concat(o,": Missing title or description")),e.valid=!1)})}),console.log("\ud83d\udd0d Data Integrity Check:",e.valid?"PASSED":"FAILED"),e.issues.length>0&&console.log("\u26a0\ufe0f Issues found:",e.issues)}catch(h){e.valid=!1,e.issues.push("Data integrity check error: ".concat(h.message)),console.error("\u274c Data Integrity Check Error:",h)}return e})();console.log("\ud83d\udd0d Data Integrity Check Results:",e),e.valid?alert("\u2705 Data integrity check passed!"):alert("\u274c Data integrity check failed!\nIssues:\n".concat(e.issues.join("\n")))},className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium",children:"\ud83d\udd0d Check Data Integrity"}),(0,jt.jsx)("button",{onClick:async()=>{window.confirm("Are you sure you want to reset all collaboration data? This will restore the original mock data.")&&(await g(),alert("\u2705 Data reset successfully!"))},className:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg font-medium",children:"\ud83d\udd04 Reset Data"}),(0,jt.jsx)("button",{onClick:()=>c(!l),className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg font-medium",children:l?"\u274c Hide Manual Test":"\u270f\ufe0f Show Manual Test"})]})]}),l&&(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\u270f\ufe0f Manual Test - Create Collaboration"}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,jt.jsx)("input",{type:"text",value:v.title,onChange:e=>b("title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Type"}),(0,jt.jsx)("input",{type:"text",value:v.projectType,onChange:e=>b("projectType",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{className:"md:col-span-2",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,jt.jsx)("textarea",{value:v.description,onChange:e=>b("description",e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{className:"md:col-span-2",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Vision"}),(0,jt.jsx)("textarea",{value:v.projectVision,onChange:e=>b("projectVision",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Team Size"}),(0,jt.jsx)("input",{type:"text",value:v.teamSize,onChange:e=>b("teamSize",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),(0,jt.jsx)("input",{type:"text",value:v.duration,onChange:e=>b("duration",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Email"}),(0,jt.jsx)("input",{type:"email",value:v.contactEmail,onChange:e=>b("contactEmail",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discord"}),(0,jt.jsx)("input",{type:"text",value:v.contactDiscord,onChange:e=>b("contactDiscord",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),(0,jt.jsxs)("div",{className:"mt-6",children:[(0,jt.jsx)("h3",{className:"text-lg font-medium mb-3",children:"Roles"}),v.roles.map((e,t)=>(0,jt.jsx)("div",{className:"border border-gray-200 rounded-lg p-4 mb-4",children:(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Title"}),(0,jt.jsx)("input",{type:"text",value:e.customRole,onChange:e=>y(t,"customRole",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Required Skills"}),(0,jt.jsx)("input",{type:"text",value:e.requiredSkills,onChange:e=>y(t,"requiredSkills",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,jt.jsxs)("div",{className:"md:col-span-2",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role Description"}),(0,jt.jsx)("textarea",{value:e.roleDescription,onChange:e=>y(t,"roleDescription",e.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})},t))]}),(0,jt.jsx)("button",{onClick:async()=>{try{const e=await m(v);e.success?(alert("\u2705 Collaboration created successfully!\nID: ".concat(e.data.id)),await p()):alert("\u274c Failed to create collaboration:\n".concat(e.error||JSON.stringify(e.errors)))}catch(h){alert("\u274c Error creating collaboration: ".concat(h.message))}},className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium",children:"\ud83d\ude80 Create Collaboration"})]}),t&&(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\ud83d\udcca Test Results"}),(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsxs)("div",{className:"flex items-center gap-4",children:[(0,jt.jsx)("div",{className:"text-2xl font-bold text-green-600",children:t.passed}),(0,jt.jsx)("div",{className:"text-sm text-green-800",children:"Passed"}),(0,jt.jsx)("div",{className:"text-2xl font-bold text-red-600",children:t.failed}),(0,jt.jsx)("div",{className:"text-sm text-red-800",children:"Failed"}),(0,jt.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[(t.passed/(t.passed+t.failed)*100).toFixed(1),"%"]}),(0,jt.jsx)("div",{className:"text-sm text-blue-800",children:"Success Rate"})]})}),(0,jt.jsx)("div",{className:"space-y-2",children:t.tests.map((e,t)=>(0,jt.jsxs)("div",{className:"p-3 rounded-lg ".concat("PASSED"===e.status?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"),children:[(0,jt.jsxs)("div",{className:"flex items-center gap-2",children:[(0,jt.jsx)("span",{className:"PASSED"===e.status?"text-green-600":"text-red-600",children:"PASSED"===e.status?"\u2705":"\u274c"}),(0,jt.jsx)("span",{className:"font-medium",children:e.name})]}),e.error&&(0,jt.jsxs)("div",{className:"text-sm text-red-600 mt-1",children:["Error: ",e.error]}),e.count&&(0,jt.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["Count: ",e.count]})]},t))})]}),n&&(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"\ud83d\udccb Test Report"}),(0,jt.jsx)("pre",{className:"bg-gray-100 p-4 rounded-lg overflow-x-auto text-sm",children:n})]}),(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,jt.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["\ud83d\udccb Current Collaborations (",d.length,")"]}),u?(0,jt.jsx)("div",{className:"text-center py-8",children:(0,jt.jsx)("div",{className:"text-gray-600",children:"Loading collaborations..."})}):0===d.length?(0,jt.jsx)("div",{className:"text-center py-8",children:(0,jt.jsx)("div",{className:"text-gray-600",children:"No collaborations found."})}):(0,jt.jsxs)("div",{className:"space-y-4",children:[d.slice(0,5).map(e=>{var t;return(0,jt.jsx)("div",{className:"border border-gray-200 rounded-lg p-4",children:(0,jt.jsxs)("div",{className:"flex justify-between items-start",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h3",{className:"font-medium text-lg",children:e.title}),(0,jt.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:e.subtitle}),(0,jt.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500",children:[(0,jt.jsxs)("span",{children:["\ud83d\udc64 ",null===(t=e.author)||void 0===t?void 0:t.name]}),(0,jt.jsxs)("span",{children:["\u2764\ufe0f ",e.likes]}),(0,jt.jsxs)("span",{children:["\ud83d\udc41\ufe0f ",e.views]}),(0,jt.jsxs)("span",{children:["\ud83d\udcc5 ",e.dateRange]})]})]}),(0,jt.jsxs)("div",{className:"text-right",children:[(0,jt.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",e.id]}),(0,jt.jsx)("div",{className:"text-sm text-gray-500",children:e.status})]})]})},e.id)}),d.length>5&&(0,jt.jsxs)("div",{className:"text-center text-gray-600",children:["... and ",d.length-5," more collaborations"]})]})]})]})})};var ci=r(784);const di=()=>{const[t,r]=(0,e.useState)((0,Lr.HW)()),o=async e=>{await(0,Lr.Gr)(e),r((0,Lr.HW)()),window.dispatchEvent(new CustomEvent("user:changed"))};return(0,jt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[(0,jt.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"Review Request Test Tools"}),(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:"Current User:"}),(0,jt.jsxs)("p",{className:"font-medium text-gray-900",children:[t.name," (",t.id,")"]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Switch User:"}),(0,jt.jsxs)("div",{className:"flex space-x-2",children:[(0,jt.jsx)("button",{onClick:()=>o("alice"),className:"px-3 py-1 text-sm rounded-md transition-colors duration-200 ".concat("alice"===t.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Alice (Owner)"}),(0,jt.jsx)("button",{onClick:()=>o("bryan"),className:"px-3 py-1 text-sm rounded-md transition-colors duration-200 ".concat("bryan"===t.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Bryan (Collaborator)"}),(0,jt.jsx)("button",{onClick:()=>o("alex"),className:"px-3 py-1 text-sm rounded-md transition-colors duration-200 ".concat("alex"===t.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Alex (Default)"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Development Tools:"}),(0,jt.jsxs)("div",{className:"flex space-x-2",children:[(0,jt.jsx)("button",{onClick:()=>{console.log("Review requests functionality has been removed - replaced with Add Experience")},className:"px-3 py-1 text-sm bg-red-100 text-red-700 rounded-md hover:bg-red-200 transition-colors duration-200",children:"Cancel All Requests"}),(0,jt.jsx)("button",{onClick:()=>{console.log("Review requests functionality has been removed - replaced with Add Experience")},className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors duration-200",children:"Show Requests (Console)"}),(0,jt.jsx)("button",{onClick:async()=>{try{const e=await Jr.getUserNotifications(t.id);if(e.success){const r=e.data||[];console.log("Current notifications for",t.name,":",r),console.log("Notification count:",r.length),console.log("Unread count:",r.filter(e=>!e.isRead).length)}else console.log("No notifications found for",t.id)}catch(e){console.error("Error getting notifications:",e)}},className:"px-3 py-1 text-sm bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors duration-200",children:"Show Notifications (Console)"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Notification Test Tools:"}),(0,jt.jsxs)("div",{className:"flex space-x-2",children:[(0,jt.jsx)("button",{onClick:async()=>{try{const e=await(0,ci.fp)({userId:t.id,title:"Collaboration Request",message:'New collaboration request for project "Interactive Web Experience" from '.concat(t.name," at ").concat((new Date).toLocaleTimeString()),projectId:"collab_project_001"});console.log("Collaboration notification created:",e)}catch(e){console.error("Error creating collaboration notification:",e)}},className:"px-3 py-1 text-sm bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 transition-colors duration-200",children:"Create Collaboration Notification"}),(0,jt.jsx)("button",{onClick:async()=>{try{const e=await(0,ci.createGeneralNotification)({userId:t.id,type:"system",title:"System Update",message:"System maintenance completed for ".concat(t.name," at ").concat((new Date).toLocaleTimeString()),projectId:null});console.log("General notification created:",e)}catch(e){console.error("Error creating general notification:",e)}},className:"px-3 py-1 text-sm bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200 transition-colors duration-200",children:"Create General Notification"}),(0,jt.jsx)("button",{onClick:async()=>{try{const e=await Jr.getUserNotifications(t.id);if(e.success){const r=e.data||[];for(const e of r)await Jr.deleteNotification(e.id);window.dispatchEvent(new CustomEvent("notif:unreadChanged",{detail:{userId:t.id}})),console.log("All notifications cleared for ".concat(t.name))}}catch(e){console.error("Error clearing notifications:",e)}},className:"px-3 py-1 text-sm bg-orange-100 text-orange-700 rounded-md hover:bg-orange-200 transition-colors duration-200",children:"Clear Notifications"})]})]}),(0,jt.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg",children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"Test Steps:"}),(0,jt.jsxs)("ol",{className:"text-xs text-blue-800 space-y-1",children:[(0,jt.jsx)("li",{children:"1. Switch to Bryan \u2192 Go to Alice's collaboration project"}),(0,jt.jsx)("li",{children:'2. Click "Send Standard Request" \u2192 Should show "Pending Approval"'}),(0,jt.jsx)("li",{children:"3. Switch to Alice \u2192 Check Notification Center"}),(0,jt.jsx)("li",{children:'4. Click "Approve" or "Deny" on the review request'}),(0,jt.jsx)("li",{children:"5. Switch back to Bryan \u2192 Check if status changed"})]})]}),(0,jt.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg",children:[(0,jt.jsx)("p",{className:"text-sm font-medium text-green-900 mb-2",children:"Notification Test Steps:"}),(0,jt.jsxs)("ol",{className:"text-xs text-green-800 space-y-1",children:[(0,jt.jsx)("li",{children:'1. Select a user (e.g., Bryan) \u2192 Click "Create Collaboration Notification" (Purple theme)'}),(0,jt.jsx)("li",{children:'2. Click "Create General Notification" (Blue theme)'}),(0,jt.jsx)("li",{children:"3. Go to Notification Center \u2192 Check different color themes"}),(0,jt.jsx)("li",{children:'4. Click on notifications \u2192 Verify "mark as read" functionality'}),(0,jt.jsx)("li",{children:"5. Check unread count \u2192 Should decrease after marking as read"}),(0,jt.jsx)("li",{children:'6. Click "Clear Notifications" \u2192 Verify all notifications are removed'})]})]})]})]})},ui=()=>{const[t,r]=(0,e.useState)([]),[o,a]=(0,e.useState)(!1),[s,n]=(0,e.useState)(""),i=(0,Lr.HW)(),l=async()=>{a(!0),n("Loading portfolio...");try{const e=await(0,sr.BD)();console.log("Load result:",e),e.success?(r(e.data),n("Loaded ".concat(e.data.length," items successfully"))):n("Error: ".concat(e.error))}catch(e){n("Exception: ".concat(e.message))}finally{a(!1)}};return(0,e.useEffect)(()=>{l()},[]),(0,jt.jsxs)("div",{style:{padding:"20px",maxWidth:"600px",margin:"0 auto"},children:[(0,jt.jsx)("h2",{children:"Mock API \u6d4b\u8bd5"}),(0,jt.jsxs)("p",{children:["\u5f53\u524d\u7528\u6237: ",i.name," (ID: ",i.id,")"]}),(0,jt.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,jt.jsx)("button",{onClick:l,disabled:o,style:{marginRight:"10px"},children:"\u52a0\u8f7d\u4f5c\u54c1"}),(0,jt.jsx)("button",{onClick:async()=>{a(!0),n("Creating portfolio item...");try{const e={title:"Test Item ".concat(Date.now()),description:"This is a test item",category:"Test",tags:["test","mock"],imagePaths:["test/path/image.jpg"],thumbnailPath:"test/path/thumbnail.jpg",isPublic:!0},t=await(0,sr.qo)(e);console.log("Create result:",t),t.success?(n("Created successfully! Reloading portfolio..."),await l()):n("Error: ".concat(t.error))}catch(e){n("Exception: ".concat(e.message))}finally{a(!1)}},disabled:o,style:{marginRight:"10px"},children:"\u521b\u5efa\u6d4b\u8bd5\u4f5c\u54c1"}),(0,jt.jsx)("button",{onClick:async()=>{a(!0),n("Testing image upload...");try{const e=new File(["mock image data"],"test.jpg",{type:"image/jpeg"}),t=await(0,sr.jp)(e,i.id);console.log("Upload result:",t),t.success?n("Uploaded successfully! Path: ".concat(t.data.path)):n("Error: ".concat(t.error))}catch(e){n("Exception: ".concat(e.message))}finally{a(!1)}},disabled:o,style:{marginRight:"10px"},children:"\u6d4b\u8bd5\u4e0a\u4f20\u56fe\u7247"}),(0,jt.jsx)("button",{onClick:()=>{Object.keys(localStorage).forEach(e=>{e.startsWith("portfolio_")&&localStorage.removeItem(e)}),r([]),n("Cleared portfolio storage")},disabled:o,children:"\u6e05\u7a7a\u5b58\u50a8"})]}),(0,jt.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,jt.jsx)("strong",{children:"\u72b6\u6001:"})," ",s]}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("strong",{children:["\u4f5c\u54c1\u5217\u8868 (",t.length," \u4e2a):"]}),(0,jt.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",borderRadius:"4px",maxHeight:"300px",overflow:"auto"},children:JSON.stringify(t,null,2)})]}),(0,jt.jsxs)("div",{style:{marginTop:"20px"},children:[(0,jt.jsx)("strong",{children:"localStorage \u4e2d\u7684 portfolio \u952e:"}),(0,jt.jsx)("pre",{style:{background:"#f5f5f5",padding:"10px",borderRadius:"4px"},children:Object.keys(localStorage).filter(e=>e.startsWith("portfolio_")).join("\n")})]})]})},hi=e=>{let{onBackClick:t}=e;return(0,jt.jsx)("div",{className:"p-4",children:(0,jt.jsxs)("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Home"]})})},mi=()=>(0,jt.jsxs)("div",{className:"text-center mb-8",children:[(0,jt.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Posting Guidelines"}),(0,jt.jsx)("p",{className:"text-lg text-gray-600",children:"Artwork Submission Tips"})]}),pi=[{id:1,text:"Upload finished works only; images must be clear and legible",icon:"check"},{id:2,text:"Use descriptive titles that capture attention",icon:"check"},{id:3,text:"Add relevant tags to improve discoverability",icon:"check"},{id:4,text:"Images only for now (JPG / PNG)",icon:"check"},{id:5,text:"Max 10 MB per work (total of all images)",icon:"check"}],gi=[{id:1,text:"Avoid uploading work that isn't yours",icon:"x"},{id:2,text:"No blurry or heavily compressed/watermarked content",icon:"x"},{id:3,text:"Video uploads aren't supported yet",icon:"x"},{id:4,text:"Uploads to Jobs and ArtMarket are currently closed (in testing)",icon:"x"}],fi={good:{title:"\u2713 Good",description:"High quality, well-composed",className:"bg-green-500",content:{title:"STUP AI",icon:"w-16 h-16 bg-red-500 rounded-full mx-auto mb-2",bar:"w-32 h-4 bg-black rounded"}},bad:{title:"\xd7 Bad",description:"Low resolution, poor lighting",className:"bg-red-500",content:{title:"STUP AI",icon:"w-16 h-16 bg-red-400 rounded-full mx-auto mb-2 blur-sm",bar:"w-32 h-4 bg-gray-800 rounded blur-sm",containerClass:"opacity-60",titleClass:"blur-sm"}}},vi="Pro Tip",xi="Projects with visual examples receive 3x more collaboration requests than those without.",bi="community guidelines",yi="#",wi=()=>{const e=(e,t)=>e.map(e=>{return(0,jt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,jt.jsx)("div",{className:"flex-shrink-0 w-6 h-6 ".concat(t," rounded-full flex items-center justify-center"),children:(r=e.icon,"check"===r?(0,jt.jsx)("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):(0,jt.jsx)("svg",{className:"w-4 h-4 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})}))}),(0,jt.jsx)("p",{className:"text-gray-700 font-semibold",children:e.text})]},e.id);var r});return(0,jt.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"\u2705 Do's"}),(0,jt.jsx)("div",{className:"space-y-3",children:e(pi,"bg-green-100")})]}),(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"\u274c Don'ts"}),(0,jt.jsx)("div",{className:"space-y-3",children:e(gi,"bg-red-100")})]})]})},ji=()=>{const e=e=>{const t=fi[e],{content:r}=t;return(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsxs)("div",{className:"relative mb-4",children:[(0,jt.jsx)("div",{className:"w-full h-48 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center ".concat(r.containerClass||""),children:(0,jt.jsxs)("div",{className:"text-white text-center",children:[(0,jt.jsx)("div",{className:"text-2xl font-bold mb-2 ".concat(r.titleClass||""),children:r.title}),(0,jt.jsx)("div",{className:r.icon}),(0,jt.jsx)("div",{className:r.bar})]})}),(0,jt.jsx)("div",{className:"absolute -top-2 -right-2 ".concat(t.className," text-white px-2 py-1 rounded-full text-xs font-medium"),children:t.title})]}),(0,jt.jsx)("p",{className:"text-sm ".concat("good"===e?"text-green-600":"text-red-600"," font-medium"),children:t.description})]})};return(0,jt.jsxs)("div",{className:"border-t border-gray-200 pt-8",children:[(0,jt.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Visual Examples"}),(0,jt.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[e("good"),e("bad")]})]})},ki=()=>(0,jt.jsx)("div",{className:"border-t border-gray-200 pt-6",children:(0,jt.jsxs)("p",{className:"text-gray-600 text-center",children:["All uploads are subject to review by our"," ",(0,jt.jsx)("a",{href:yi,className:"text-tag-blue hover:text-tag-dark-blue font-medium",children:bi}),". Content that violates our community guidelines may be removed."]})}),Si=()=>(0,jt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,jt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,jt.jsx)("div",{className:"flex-shrink-0 w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{d:"M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z"})})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("p",{className:"font-semibold text-blue-900",children:vi}),(0,jt.jsx)("p",{className:"text-blue-800 text-sm",children:xi})]})]})}),Ni=e=>{let{guidelinesConfirmed:t,onCheckboxChange:r,onConfirm:o,user:a}=e;return(0,jt.jsxs)("div",{className:"border-t border-gray-200 pt-8 mt-8",children:[(0,jt.jsx)("div",{className:"flex items-center justify-center space-x-4",children:(0,jt.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,jt.jsx)("input",{type:"checkbox",checked:t,onChange:r,className:"h-5 w-5 text-tag-blue focus:ring-tag-blue border-gray-300 rounded"}),(0,jt.jsx)("span",{className:"text-gray-700 font-medium",children:"I understand and agree to follow these guidelines"})]})}),(0,jt.jsx)("div",{className:"mt-6 flex justify-center",children:(0,jt.jsx)("button",{onClick:o,disabled:!t,className:"px-8 py-3 bg-gradient-to-r from-tag-blue to-tag-purple text-white font-medium rounded-lg shadow-lg hover:from-tag-dark-blue hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-tag-blue disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105",children:a?"Proceed to Upload":"Continue to Login"})})]})},Ci=()=>{const[t,r]=(0,e.useState)(!1);return{guidelinesConfirmed:t,handleCheckboxChange:e=>{r(e.target.checked)},resetState:()=>{r(!1)}}},_i=t=>{let{guidelinesConfirmed:r,user:o}=t;const a=ce();return{handleConfirm:(0,e.useCallback)(()=>{r&&(localStorage.setItem("tag_guidelines_accepted","true"),a(o?"/upload/form":"/login"))},[r,o,a]),handleBackToHome:(0,e.useCallback)(()=>{a("/")},[a])}},Ai=()=>{const{user:e}=St(),{guidelinesConfirmed:t,handleCheckboxChange:r}=Ci(),{handleConfirm:o,handleBackToHome:a}=_i({guidelinesConfirmed:t,user:e});return(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[(0,jt.jsx)(hi,{onBackClick:a}),(0,jt.jsx)("div",{className:"flex-1 flex items-center justify-center px-4 sm:px-6 lg:px-8 py-8",children:(0,jt.jsx)("div",{className:"max-w-4xl w-full space-y-8",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[(0,jt.jsx)(mi,{}),(0,jt.jsxs)("div",{className:"space-y-8",children:[(0,jt.jsx)(wi,{}),(0,jt.jsx)(ji,{}),(0,jt.jsx)(ki,{}),(0,jt.jsx)(Si,{})]}),(0,jt.jsx)(Ni,{guidelinesConfirmed:t,onCheckboxChange:r,onConfirm:o,user:e})]})})})]})},Ii=e=>{let{children:t}=e;return"true"!==localStorage.getItem("tag_guidelines_accepted")?(0,jt.jsx)(_e,{to:"/upload/guidelines",replace:!0}):t},Pi=e=>{let{module:t="Milestones",title:r="Your milestone has been shared successfully!",subtitle:o="The community can now see your achievement and celebrate with you.",icon:a="\ud83c\udfc1",bannerSubtitle:s="Celebrate achievements and track creative journeys"}=e;const n=ce(),i=(e=>{const t={Milestones:{icon:"\ud83c\udfc1",bannerTitle:"Milestones Feed",bannerSubtitle:"Celebrate achievements and track creative journeys",successTitle:"Your milestone has been shared successfully!",successSubtitle:"The community can now see your achievement and celebrate with you."},"Art Market":{icon:"\ud83c\udfea",bannerTitle:"Art Market Feed",bannerSubtitle:"Showcase your artwork to the world",successTitle:"Your artwork has been published successfully!",successSubtitle:"Art lovers can now discover and appreciate your creation."},Portfolio:{icon:"\ud83d\udcc1",bannerTitle:"Portfolio Feed",bannerSubtitle:"Build your professional portfolio",successTitle:"Your portfolio has been updated successfully!",successSubtitle:"Your professional showcase is now live for the community."},Collaboration:{icon:"\ud83e\udd1d",bannerTitle:"Collaboration Feed",bannerSubtitle:"Connect and collaborate with fellow artists",successTitle:"Your collaboration has been shared successfully!",successSubtitle:"Other artists can now discover and join your project."},Jobs:{icon:"\ud83d\udcbc",bannerTitle:"Jobs Feed",bannerSubtitle:"Find opportunities and grow your career",successTitle:"Your job post has been published successfully!",successSubtitle:"Talented artists can now discover and apply for your opportunity."}};return t[e]||t.Milestones})(t),l="Portfolio"===t||"Art Market"===t,c=l?"bg-gradient-to-r from-[#3B82F6] to-[#1D4ED8]":"bg-gradient-to-r from-[#9333EA] to-[#7e22ce]",d=l?"bg-tag-blue":"bg-tag-purple",u=l?"hover:bg-blue-700":"hover:bg-purple-700",h=l?"border-tag-blue":"border-tag-purple",m=l?"text-tag-blue":"text-tag-purple",p=l?"hover:bg-blue-50":"hover:bg-purple-50";return(0,jt.jsxs)("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-y-auto",children:[(0,jt.jsxs)("div",{className:"".concat(c," h-48 flex flex-col items-center justify-center text-white"),children:[(0,jt.jsx)("div",{className:"text-4xl mb-4",children:i.icon}),(0,jt.jsx)("h1",{className:"text-2xl font-bold mb-2",children:i.bannerTitle}),(0,jt.jsx)("p",{className:"text-white/90 text-center max-w-md",children:i.bannerSubtitle})]}),(0,jt.jsx)("div",{className:"max-w-md mx-auto -mt-8 relative z-10",children:(0,jt.jsx)("div",{className:"bg-[#ECFDF5] rounded-lg shadow-lg p-6 border border-green-200",children:(0,jt.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,jt.jsx)("div",{className:"flex-shrink-0",children:(0,jt.jsx)("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("h2",{className:"text-lg font-bold text-green-800 mb-2",children:i.successTitle}),(0,jt.jsx)("p",{className:"text-green-700 text-sm leading-relaxed",children:i.successSubtitle})]})]})})}),(0,jt.jsxs)("div",{className:"max-w-md mx-auto mt-8 px-4 pb-8",children:[(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("button",{onClick:()=>{if(console.log("\ud83d\udd0d handleViewFeed called with module:",t),"Milestones"===t){console.log("\ud83c\udfaf Navigating to TAGMe with Milestones tab");const e={activeTab:"Milestones",from:"upload-success"};console.log("\ud83c\udfaf Navigation state being passed:",e),n("/tagme",{state:e})}else if("Collaboration"===t){console.log("\ud83c\udfaf Navigating to TAGMe with Collaborations tab");const e={activeTab:"Collaborations",from:"upload-success"};console.log("\ud83c\udfaf Navigation state being passed:",e),n("/tagme",{state:e})}else if("Jobs"===t){console.log("\ud83c\udfaf Navigating to TAGMe with Jobs tab");const e={activeTab:"Jobs",from:"upload-success"};console.log("\ud83c\udfaf Navigation state being passed:",e),n("/tagme",{state:e})}else if("Portfolio"===t){console.log("\ud83c\udfaf Navigating to Gallery with Works tab");const e={activeTab:"Works",from:"upload-success",scrollToGallery:!0};console.log("\ud83c\udfaf Navigation state being passed:",e),n("/",{state:e})}else if("Art Market"===t){console.log("\ud83c\udfaf Navigating to Gallery with Market tab");const e={activeTab:"Market",from:"upload-success",scrollToGallery:!0};console.log("\ud83c\udfaf Navigation state being passed:",e),n("/",{state:e})}else console.log("\ud83c\udfaf Navigating to home page"),n("/")},className:"w-full ".concat(d," text-white font-semibold py-3 rounded-lg ").concat(u," transition-colors duration-200 flex items-center justify-center"),children:[(0,jt.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"View ",t," Feed"]}),(0,jt.jsxs)("button",{onClick:()=>{console.log("\ud83d\udd0d handleUploadMore called with module:",t),console.log("\ud83d\udd0d Current module value:",t);try{"Milestones"===t?(console.log("\ud83c\udfaf Navigating back to upload page with Milestones tab"),window.location.href="/upload?tab=milestones"):"Collaboration"===t?(console.log("\ud83c\udfaf Navigating back to upload page with Collaboration tab"),window.location.href="/upload?tab=collaboration"):"Jobs"===t?(console.log("\ud83c\udfaf Navigating back to upload page with Jobs tab"),window.location.href="/upload?tab=jobs"):"Art Market"===t?(console.log("\ud83c\udfaf Navigating back to upload page with Art Market tab"),window.location.href="/upload?tab=art-market"):"Portfolio"===t?(console.log("\ud83c\udfaf Navigating back to upload page with Portfolio tab"),window.location.href="/upload?tab=portfolio"):(console.log("\ud83c\udfaf Navigating back to upload page with default tab"),console.log("\u26a0\ufe0f Unknown module type:",t),window.location.href="/upload")}catch(e){console.error("\u274c Error in handleUploadMore:",e),window.location.href="/upload"}},className:"w-full bg-white ".concat(m," font-semibold py-3 rounded-lg border-2 ").concat(h," ").concat(p," transition-colors duration-200 flex items-center justify-center"),children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Upload More Content"]})]}),(0,jt.jsx)("div",{className:"text-center mt-6",children:(0,jt.jsx)(mt,{to:"/",className:"text-gray-500 hover:text-gray-700 text-sm transition-colors duration-200",children:"\u2190 Back to Home"})})]})]})},Ei=[{value:"2-3",label:"Less than 3 people"},{value:"4-5",label:"4-5 people"},{value:"6-8",label:"6-8 people"},{value:"9+",label:"9+ people"}],Di=[{value:"1-2 weeks",label:"1-2 weeks"},{value:"3-4 weeks",label:"3-4 weeks"},{value:"1-2 months",label:"1-2 months"},{value:"3-4 months",label:"3-4 months"},{value:"5-6 months",label:"5-6 months"},{value:"6+ months",label:"6+ months"}],Li=[{value:"1-2 times/week",label:"1-2 times/week"},{value:"2-3 times/week",label:"2-3 times/week"},{value:"3-4 times/week",label:"3-4 times/week"},{value:"Daily",label:"Daily"},{value:"As needed",label:"As needed"}],Ti=e=>{var t,r,o,a,s,n;let{formData:i,onFormChange:l}=e;return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Basic Information"}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Title ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("input",{type:"text",name:"title",value:i.title,onChange:l,placeholder:"What's your project about?",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Expected Team Size"}),(0,jt.jsx)(Zo,{options:Ei,value:i.teamSize,onChange:l,name:"teamSize",placeholder:"Select size"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Duration"}),(0,jt.jsx)(Zo,{options:Di,value:i.duration,onChange:l,name:"duration",placeholder:"Select duration"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meeting Schedule"}),(0,jt.jsx)(Zo,{options:Li,value:i.meetingSchedule,onChange:l,name:"meetingSchedule",placeholder:"Select schedule"})]}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Information"}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Email ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("input",{type:"email",name:"contactEmail",value:i.contactEmail||"",onChange:l,placeholder:"your.email@example.com",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Discord"}),(0,jt.jsx)("input",{type:"text",name:"contactDiscord",value:i.contactDiscord||"",onChange:l,placeholder:"username#1234",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Other"}),(0,jt.jsx)("input",{type:"text",name:"contactOther",value:i.contactOther||"",onChange:l,placeholder:"Slack, Telegram, etc.",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Application Deadline ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("input",{type:"text",name:"applicationDeadline",value:i.applicationDeadline,onChange:l,placeholder:"e.g., Aug 31, 2025 or To be determined",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"}),(0,jt.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter deadline in any format you prefer"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Looking For"}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)("div",{className:"flex",children:[(0,jt.jsx)("input",{type:"text",name:"projectType",value:i.projectType,onChange:l,placeholder:"Tags",className:"flex-1 bg-gray-50 border border-gray-300 rounded-l px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple",onKeyPress:e=>{if("Enter"===e.key){var t;e.preventDefault();(i.projectType?i.projectType.split(",").map(e=>e.trim()).filter(e=>e):[]).length<6&&null!==(t=i.projectType)&&void 0!==t&&t.trim()&&l({target:{name:"projectType",value:i.projectType+", "}})}}}),(0,jt.jsx)("button",{type:"button",onClick:()=>{var e;(i.projectType?i.projectType.split(",").map(e=>e.trim()).filter(e=>e):[]).length<6&&null!==(e=i.projectType)&&void 0!==e&&e.trim()&&l({target:{name:"projectType",value:i.projectType+", "}})},disabled:!(null!==(t=i.projectType)&&void 0!==t&&t.trim())||!!i.projectType&&i.projectType.split(",").map(e=>e.trim()).filter(e=>e).length>=6,className:"bg-tag-purple text-white px-3 py-2 rounded-r hover:bg-purple-700 transition-colors duration-200 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"+"})]}),i.projectType&&(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:null===(r=i.projectType)||void 0===r?void 0:r.split(",").map((e,t)=>{const r=e.trim();return r?(0,jt.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm",children:[r,(0,jt.jsx)("button",{type:"button",onClick:()=>{var e;const r=(null===(e=i.projectType)||void 0===e?void 0:e.split(",").map(e=>e.trim()).filter(e=>e))||[];r.splice(t,1),l({target:{name:"projectType",value:r.join(", ")}})},className:"ml-1 text-purple-600 hover:text-purple-800",children:"\xd7"})]},t):null})}),(0,jt.jsxs)("p",{className:"text-xs text-gray-500",children:[i.projectType&&(null===(o=i.projectType)||void 0===o||null===(a=o.split(","))||void 0===a||null===(s=a.map(e=>e.trim()))||void 0===s||null===(n=s.filter(e=>e))||void 0===n?void 0:n.length)||0,"/6 tags"]})]})]})]}),(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Project Details"}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Description ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("textarea",{name:"description",value:i.description,onChange:l,placeholder:"Describe your project and what kind of help you need...",rows:4,maxLength:1e3,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"}),(0,jt.jsxs)("div",{className:"text-xs text-gray-500 mt-1 text-right",children:[i.description.length,"/1000 characters"]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Project Vision ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("textarea",{name:"projectVision",value:i.projectVision,onChange:l,placeholder:"In one or two sentences, explain why you started this project and what excites you about it.",rows:3,maxLength:200,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"}),(0,jt.jsxs)("div",{className:"text-xs text-gray-500 mt-1 text-right",children:[i.projectVision.length,"/200 characters"]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Why This Matters ",(0,jt.jsx)("span",{className:"text-gray-500",children:"(Optional)"})]}),(0,jt.jsx)("textarea",{name:"whyThisMatters",value:i.whyThisMatters,onChange:l,placeholder:"Describe the bigger impact of your project \u2014 why it's important, and what difference it could make.",rows:5,maxLength:1e3,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"}),(0,jt.jsxs)("div",{className:"text-xs text-gray-500 mt-1 text-right",children:[i.whyThisMatters.length,"/1000 characters"]})]})]})]})},Mi=()=>(0,jt.jsxs)("div",{className:"text-center mb-6",children:[(0,jt.jsx)("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-tag-purple",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Create Collaboration Post"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Post a collaboration request to find teammates and partners for your projects"})]}),Fi=t=>{let{roles:r,onAddRole:o,onRemoveRole:s,onRoleChange:n}=t;const[i,l]=(0,e.useState)({}),c=(e,t)=>{if(!t)return null;const o=t.split(",").map(e=>e.trim()).filter(e=>e);return(0,jt.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:o.map((t,o)=>(0,jt.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:[t,(0,jt.jsx)("button",{type:"button",onClick:()=>((e,t)=>{var o;const a=((null===(o=r.find(t=>t.id===e))||void 0===o?void 0:o.requiredSkills)||"").split(",").map(e=>e.trim()).filter(e=>e!==t);n(e,"requiredSkills",a.join(", "))})(e,t),className:"text-purple-600 hover:text-purple-800",children:(0,jt.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},o))})};return(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,jt.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["Team Roles Needed ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("button",{type:"button",onClick:o,className:"bg-tag-purple text-white px-3 py-1 rounded text-sm hover:bg-purple-700 transition-colors duration-200",children:"+ Add Role"})]}),(0,jt.jsx)("div",{className:"space-y-4",children:r.map((e,t)=>(0,jt.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,jt.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,jt.jsxs)("h4",{className:"text-sm font-medium text-gray-700",children:["Role #",t+1]}),r.length>1&&(0,jt.jsx)("button",{type:"button",onClick:()=>s(e.id),className:"text-red-500 hover:text-red-700",children:(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),(0,jt.jsxs)("div",{className:"space-y-3",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Role Name"}),(0,jt.jsx)("input",{type:"text",value:e.customRole,onChange:t=>n(e.id,"customRole",t.target.value),placeholder:"e.g., UI/UX Designer, Frontend Developer, Motion Designer",className:"w-full bg-white border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple text-sm"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Role Description"}),(0,jt.jsx)("textarea",{value:e.roleDescription,onChange:t=>n(e.id,"roleDescription",t.target.value),placeholder:"Describe responsibilities and expectations for this role...",rows:3,className:"w-full bg-white border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple text-sm"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Required Skills"}),(0,jt.jsx)("input",{type:"text",value:i[e.id]||"",onChange:t=>{return r=e.id,o=t.target.value,void l(e=>(0,a.A)((0,a.A)({},e),{},{[r]:o}));var r,o},onKeyDown:t=>((e,t)=>{if("Enter"===t.key){var o;t.preventDefault();const s=i[e]||"",c=(null===(o=r.find(t=>t.id===e))||void 0===o?void 0:o.requiredSkills)||"";if(s.trim()){const t=s.trim(),r=c?c.split(",").map(e=>e.trim()):[];if(!r.includes(t)){const o=[...r,t].join(", ");n(e,"requiredSkills",o)}l(t=>(0,a.A)((0,a.A)({},t),{},{[e]:""}))}}})(e.id,t),placeholder:"Type a skill and press Enter to add (e.g., Adobe Creative Suite, React Native)",className:"w-full bg-white border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple text-sm"}),(0,jt.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"Press Enter to add each skill."}),c(e.id,e.requiredSkills)]})]})]},e.id))})]})},Ri=e=>{let{isOpen:t,onClose:r}=e;return t?(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 transform transition-all",children:[(0,jt.jsx)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Draft Saved"})]})}),(0,jt.jsxs)("div",{className:"p-6",children:[(0,jt.jsx)("p",{className:"text-gray-600 mb-6",children:"Your collaboration draft has been saved successfully! You can continue editing later or publish when you're ready."}),(0,jt.jsx)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,jt.jsx)("span",{className:"text-sm text-purple-700 font-medium",children:"Draft saved to your profile"})]})})]}),(0,jt.jsx)("div",{className:"flex justify-end p-6 border-t border-gray-200",children:(0,jt.jsx)("button",{onClick:r,className:"bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700 transition-colors duration-200 font-medium",children:"Continue Editing"})})]})}):null},Oi=e=>{let{onFileUpload:t,posterPreview:r}=e;return(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recruitment Poster"}),r?(0,jt.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg bg-white p-4",children:[(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("img",{src:r,alt:"Recruitment Poster Preview",className:"w-full h-48 object-cover rounded-lg"}),(0,jt.jsx)("button",{type:"button",onClick:()=>{const e=document.getElementById("recruitment-poster-upload");e&&(e.value=""),t({target:{files:[]}})},className:"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors",children:"\xd7"})]}),(0,jt.jsx)("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Click the \xd7 button to remove and upload a new image"})]}):(0,jt.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg bg-white py-6 px-4 text-center",children:[(0,jt.jsx)("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,jt.jsx)("p",{className:"text-gray-600 mb-2",children:"Upload recruitment poster"}),(0,jt.jsx)("p",{className:"text-xs text-gray-400 mb-4",children:"JPG, PNG (Max 5MB) - Only one image allowed"}),(0,jt.jsx)("input",{type:"file",accept:".jpg,.jpeg,.png",onChange:t,multiple:!1,className:"hidden",id:"recruitment-poster-upload"}),(0,jt.jsx)("label",{htmlFor:"recruitment-poster-upload",className:"bg-tag-purple text-white px-4 py-2 rounded cursor-pointer hover:bg-purple-700 transition-colors duration-200",children:"Choose Image"})]})]})},Ui=t=>{let{state:r,setters:o}=t;const{setFormData:s,setIsSubmitting:n,setIsSaving:i}=o,[l,c]=(0,e.useState)(!1),d=(0,e.useCallback)(e=>{e&&e.startsWith("blob:")&&(URL.revokeObjectURL(e),console.log("[CollaborationActions] Revoked blob URL:",e))},[]);return{handleFormChange:(0,e.useCallback)(e=>{const{name:t,value:r}=e.target;s(e=>(0,a.A)((0,a.A)({},e),{},{[t]:r}))},[s]),handleFileUpload:(0,e.useCallback)(e=>{const t=e.target.files;if(console.log("Collaboration files selected:",t),t&&t.length>0){const e=t[0];if(!["image/jpeg","image/jpg","image/png"].includes(e.type))return void alert("Please select a valid image file (JPG, PNG)");const o=5242880;if(e.size>o)return void alert("File size must be less than 5MB");r.formData.posterPreview&&d(r.formData.posterPreview);const n=URL.createObjectURL(e);s(t=>(0,a.A)((0,a.A)({},t),{},{poster:e,posterPreview:n})),console.log("File uploaded successfully:",e.name)}else r.formData.posterPreview&&d(r.formData.posterPreview),s(e=>(0,a.A)((0,a.A)({},e),{},{poster:null,posterPreview:""}))},[s,r.formData,d]),handleSubmit:(0,e.useCallback)(async e=>{var t,s;e.preventDefault(),console.log("Collaboration form submitted:",r.formData),console.log("[useCollaborationActions] Form roles data:",r.formData.roles),console.log("[useCollaborationActions] Form roles structure:",null===(t=r.formData.roles)||void 0===t?void 0:t.map(e=>({customRole:e.customRole,roleDescription:e.roleDescription,requiredSkills:e.requiredSkills})));const i={title:"Project Title",description:"Project Description",projectVision:"Project Vision",contactEmail:"Contact Email",teamSize:"Team Size",meetingSchedule:"Meeting Schedule",applicationDeadline:"Application Deadline"},l=[];for(const[o,a]of Object.entries(i))r.formData[o]&&""!==r.formData[o].trim()||l.push(a);if(console.log("[CollaborationForm] \u5b57\u6bb5\u9a8c\u8bc1\u7ed3\u679c:",{requiredFields:i,missingFields:l,projectVisionValue:r.formData.projectVision,whyThisMattersValue:r.formData.whyThisMatters,projectVisionValid:!(!r.formData.projectVision||""===(null===(s=r.formData.projectVision)||void 0===s?void 0:s.trim())),whyThisMattersValid:!0}),r.formData.roles&&0!==r.formData.roles.length){r.formData.roles.filter(e=>!e.customRole||!e.roleDescription||!e.requiredSkills).length>0&&l.push("Complete Team Role information")}else l.push("At least one Team Role");if(l.length>0)return o.setValidationErrors(l),void o.setShowValidationModal(!0);if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.formData.contactEmail))return o.setValidationErrors(["Please enter a valid email address"]),void o.setShowValidationModal(!0);try{n(!0);const e=await _n(r.formData);console.log("[useCollaborationActions] Formatted data:",e);const t=(0,a.A)((0,a.A)({},e),{},{applicationDeadline:r.formData.applicationDeadline||"TEST DEADLINE",author:{id:"current_user",name:"Current User",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop&crop=face"},createdAt:(new Date).toISOString(),status:"active",likes:0,views:0});console.log("Submitting collaboration data:",t),console.log("Application Deadline check:",{applicationDeadline:t.applicationDeadline,formDataKeys:Object.keys(t)});const s=await zn(t);if(!s.success)throw new Error(s.error||"Failed to create collaboration");console.log("Collaboration posted successfully!",s.data),r.formData.posterPreview&&d(r.formData.posterPreview),window.dispatchEvent(new CustomEvent("collaboration:created",{detail:{collaboration:s.data}})),o.setShowSuccess(!0)}catch(c){console.error("Error posting collaboration:",c),console.error("Error details:",{message:c.message,stack:c.stack,formData:r.formData}),alert("Failed to post collaboration: ".concat(c.message))}finally{n(!1)}},[r.formData,o,d]),handleSaveDraft:(0,e.useCallback)(async e=>{e.preventDefault(),console.log("Saving collaboration draft:",r.formData);try{var t;i(!0);const e=new URLSearchParams(window.location.search).get("draftId")||(null===(t=window.location.state)||void 0===t?void 0:t.draftId);if(!e){const e=await zr.getDrafts({type:"collaboration"});if(e.success&&e.data.items.length>=3)return alert("You have reached the maximum limit of 3 drafts. Please delete an existing draft before saving a new one."),void i(!1)}const o={title:r.formData.title||"Untitled Draft",description:r.formData.description||"",projectVision:r.formData.projectVision||"",whyThisMatters:r.formData.whyThisMatters||"",teamSize:r.formData.teamSize||"",duration:r.formData.duration||"",meetingSchedule:r.formData.meetingSchedule||"",contactEmail:r.formData.contactEmail||"",contactDiscord:r.formData.contactDiscord||"",roles:r.formData.roles||[],tags:[],image:r.formData.posterPreview||null};let a;if(console.log("Saving draft data:",o),a=e?await zr.updateDraft(e,o):await zr.saveDraft("collaboration",o),!a.success)throw new Error(a.error||"Failed to save draft");console.log("Draft saved successfully!",a.data),window.dispatchEvent(new CustomEvent("draft:saved",{detail:{draft:a.data}})),c(!0)}catch(o){console.error("Error saving draft:",o),alert("Failed to save draft. Please try again.")}finally{i(!1)}},[r.formData,i]),handleAddRole:(0,e.useCallback)(()=>{const e={id:Date.now(),customRole:"",roleDescription:"",requiredSkills:""};s(t=>(0,a.A)((0,a.A)({},t),{},{roles:[...t.roles,e]}))},[s]),handleRemoveRole:(0,e.useCallback)(e=>{s(t=>(0,a.A)((0,a.A)({},t),{},{roles:t.roles.filter(t=>t.id!==e)}))},[s]),handleRoleChange:(0,e.useCallback)((e,t,r)=>{s(o=>(0,a.A)((0,a.A)({},o),{},{roles:o.roles.map(o=>o.id===e?(0,a.A)((0,a.A)({},o),{},{[t]:r}):o)}))},[s]),showDraftSavedModal:l,setShowDraftSavedModal:c}},zi=()=>{const[t,r]=(0,e.useState)(!1),[o,a]=(0,e.useState)(!1),[s,n]=(0,e.useState)(!1),[i,l]=(0,e.useState)({title:"",projectType:"",description:"",projectVision:"",whyThisMatters:"",teamSize:"",duration:"",meetingSchedule:"",contactEmail:"",contactDiscord:"",contactOther:"",applicationDeadline:"",poster:null,posterPreview:"",roles:[{id:1,customRole:"",roleDescription:"",requiredSkills:""}]}),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)([]);return(0,e.useMemo)(()=>({state:{showSuccess:t,isSubmitting:o,isSaving:s,formData:i,showValidationModal:c,validationErrors:u},setters:{setShowSuccess:r,setIsSubmitting:a,setIsSaving:n,setFormData:l,setShowValidationModal:d,setValidationErrors:h}}),[t,o,s,i,c,u])},Wi=()=>{var t,r,o;const a=ce(),s=ne(),n=(0,e.useRef)(!1),{state:i,setters:l}=zi(),c=Ui({state:i,setters:l});return(0,e.useEffect)(()=>{var e,t;if("draft-edit"===(null===(e=s.state)||void 0===e?void 0:e.from)&&null!==(t=s.state)&&void 0!==t&&t.draftData&&!n.current){console.log("Loading draft data:",s.state.draftData);const e=s.state.draftData;l.setFormData({title:e.title||"",description:e.description||"",projectVision:e.projectVision||"",whyThisMatters:e.whyThisMatters||"",teamSize:e.teamSize||"",duration:e.duration||"",meetingSchedule:e.meetingSchedule||"",contactEmail:e.contactEmail||"",contactDiscord:e.contactDiscord||"",roles:e.roles||[],poster:null,posterPreview:e.image||""}),n.current=!0,console.log("Draft data loaded successfully")}},[null===(t=s.state)||void 0===t?void 0:t.from,null===(r=s.state)||void 0===r?void 0:r.draftData]),(0,e.useEffect)(()=>()=>{i.formData.posterPreview&&i.formData.posterPreview.startsWith("blob:")&&(URL.revokeObjectURL(i.formData.posterPreview),console.log("[UploadCollaboration] Cleaned up blob URL on unmount"))},[i.formData.posterPreview]),i.showSuccess?(0,jt.jsx)(Pi,{module:"Collaboration"}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)(Yo,{isOpen:i.showValidationModal,onClose:()=>l.setShowValidationModal(!1),errors:i.validationErrors,title:"Please Complete Required Fields"}),(0,jt.jsx)(Ri,{isOpen:c.showDraftSavedModal,onClose:()=>c.setShowDraftSavedModal(!1)}),(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:["draft-edit"===(null===(o=s.state)||void 0===o?void 0:o.from)&&(0,jt.jsx)("div",{className:"mb-6",children:(0,jt.jsxs)("button",{onClick:()=>a(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 transition-colors duration-200 hover:bg-gray-50 px-3 py-2 rounded-md border border-gray-300",children:[(0,jt.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),(0,jt.jsx)("span",{className:"font-medium",children:"Back to Drafts"})]})}),(0,jt.jsx)(Mi,{}),(0,jt.jsxs)("form",{onSubmit:c.handleSubmit,className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)(Oi,{onFileUpload:c.handleFileUpload,posterPreview:i.formData.posterPreview}),(0,jt.jsx)(Ti,{formData:i.formData,onFormChange:c.handleFormChange})]}),(0,jt.jsx)(Fi,{roles:i.formData.roles,onAddRole:c.handleAddRole,onRemoveRole:c.handleRemoveRole,onRoleChange:c.handleRoleChange})]}),(0,jt.jsxs)("div",{className:"flex gap-4",children:[(0,jt.jsx)("button",{type:"button",onClick:c.handleSaveDraft,disabled:i.isSaving,className:"flex-1 font-semibold py-3 rounded-md transition-colors duration-200 flex items-center justify-center ".concat(i.isSaving?"bg-gray-400 cursor-not-allowed":"bg-purple-200 text-purple-700 hover:bg-purple-300"),children:i.isSaving?(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-purple-700",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,jt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,jt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save Draft"]})}),(0,jt.jsx)("button",{type:"submit",disabled:i.isSubmitting,className:"flex-1 font-semibold py-3 rounded-md transition-colors duration-200 flex items-center justify-center ".concat(i.isSubmitting?"bg-gray-400 cursor-not-allowed":"bg-tag-purple text-white hover:bg-purple-700"),children:i.isSubmitting?(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,jt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,jt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Posting..."]}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),"Post Collaboration TAGMe!"]})})]})]})]})]})},Bi=()=>{const t=ce(),[r,o]=(0,e.useState)({title:"",company:"",location:"",jobType:"",salary:"",description:"",requirements:"",contactEmail:""}),s=e=>{const{name:t,value:r}=e.target;o(e=>(0,a.A)((0,a.A)({},e),{},{[t]:r}))};return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,jt.jsxs)("div",{className:"text-center mb-6",children:[(0,jt.jsx)("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-tag-purple",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7a2 2 0 012-2h12a2 2 0 012 2v2H4V7zM4 9h16v10a2 2 0 01-2 2H6a2 2 0 01-2-2V9z"})})}),(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Post Job Opportunity"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Share creative job opportunities with the TAG community"})]}),(0,jt.jsxs)("form",{onSubmit:e=>{e.preventDefault(),console.log("Jobs form submitted:",r),alert("Job posting created successfully on TAGMe!"),t("/")},className:"space-y-6",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Title"}),(0,jt.jsx)("input",{type:"text",name:"title",value:r.title,onChange:s,placeholder:"e.g., Senior UI/UX Designer",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),(0,jt.jsx)("input",{type:"text",name:"company",value:r.company,onChange:s,placeholder:"Company name",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),(0,jt.jsx)("input",{type:"text",name:"location",value:r.location,onChange:s,placeholder:"City, Country or Remote",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Type"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsxs)("select",{name:"jobType",value:r.jobType,onChange:s,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 pr-10 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple appearance-none",children:[(0,jt.jsx)("option",{value:"",children:"Select type"}),(0,jt.jsx)("option",{value:"full-time",children:"Full-time"}),(0,jt.jsx)("option",{value:"part-time",children:"Part-time"}),(0,jt.jsx)("option",{value:"contract",children:"Contract"}),(0,jt.jsx)("option",{value:"freelance",children:"Freelance"}),(0,jt.jsx)("option",{value:"internship",children:"Internship"})]}),(0,jt.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary Range"}),(0,jt.jsx)("input",{type:"text",name:"salary",value:r.salary,onChange:s,placeholder:"e.g., $50k-$80k",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Description"}),(0,jt.jsx)("textarea",{name:"description",value:r.description,onChange:s,placeholder:"Describe the role, responsibilities, and what you're looking for...",rows:6,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Requirements"}),(0,jt.jsx)("textarea",{name:"requirements",value:r.requirements,onChange:s,placeholder:"List required skills, experience, and qualifications...",rows:4,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Email"}),(0,jt.jsx)("input",{type:"email",name:"contactEmail",value:r.contactEmail,onChange:s,placeholder:"hr@company.com",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("button",{type:"submit",className:"w-full bg-tag-purple text-white font-semibold py-3 rounded-md hover:bg-purple-700 transition-colors duration-200 flex items-center justify-center",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2-2v2m8 0V6a2 2 0 012 2v6.5M8 6V4a2 2 0 00-2-2H4a2 2 0 00-2 2v2m8 0V6a2 2 0 012 2v6.5"})}),"Post Job TAGMe!"]})]})]})},Gi=()=>(0,jt.jsxs)("div",{className:"text-center mb-8",children:[(0,jt.jsx)("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-tag-purple",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 3v18m0-16h12l-2 4 2 4H6"})})}),(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Share Your Milestone Stages"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"You can only share your work in progress in milestone stages after publishing a collaboration post and linking it to your existing collaboration project."})]}),Hi=e=>{let{stage:t,index:r,isLast:o,onStageNameChange:a,onProgressChange:s,onFileUpload:n,onFieldChange:i,onRemoveStage:l,onAddNewStage:c,onKeyDown:d}=e;return(0,jt.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:[(0,jt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,jt.jsxs)("h3",{className:"text-lg font-semibold text-gray-800",children:["Milestone Stage ",r+1]}),(0,jt.jsx)("button",{type:"button",onClick:()=>l(t.id),className:"text-red-500 hover:text-red-700 text-sm transition-colors",children:"Delete Stage"})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Stage Name ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("input",{type:"text",value:t.stageName,onChange:e=>a(t.id,e.target.value),onKeyDown:d,placeholder:"e.g., Initial Design, Production, Final Review",className:"w-full bg-white border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:["Stage Progress ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("input",{type:"number",min:"0",max:"100",value:t.progress,onChange:e=>s(t.id,e.target.value),onKeyDown:d,className:"w-16 bg-white border border-gray-300 rounded px-2 py-1 text-sm text-center focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"}),(0,jt.jsx)("span",{className:"text-sm text-gray-600",children:"%"})]})]}),(0,jt.jsx)(er,{progress:t.progress})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Milestone Poster"}),(0,jt.jsxs)(rr,{onFileUpload:e=>n(t.id,e),id:"milestone-poster-upload-".concat(t.id),children:[(0,jt.jsx)("p",{className:"text-gray-600 mb-2",children:"Upload a representative image for this stage"}),(0,jt.jsx)("p",{className:"text-xs text-gray-400 mb-4",children:"Only JPG or PNG, max 2MB - Single image only"})]}),t.posterFiles.length>0&&(0,jt.jsx)("div",{className:"mt-3",children:(0,jt.jsxs)("p",{className:"text-sm text-gray-600",children:[t.posterFiles.length," image selected"]})})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Stage Due Date ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("input",{type:"date",value:t.dateAchieved,onChange:e=>i(t.id,"dateAchieved",e.target.value),onKeyDown:d,className:"w-full bg-white border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Related Skills ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,jt.jsx)("input",{type:"text",value:t.relatedSkills,onChange:e=>i(t.id,"relatedSkills",e.target.value),onKeyDown:d,placeholder:"Skills you developed or used in this stage",className:"w-full bg-white border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple"})]}),(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Introduction"}),(0,jt.jsx)("textarea",{name:"introduction-".concat(t.id),value:t.introduction||"",onChange:e=>i(t.id,"introduction",e.target.value),onKeyDown:d,placeholder:"Brief introduction about this stage (max 200 characters)",rows:3,maxLength:200,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-purple focus:border-tag-purple resize-none"}),(0,jt.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,jt.jsx)("span",{className:"text-xs text-gray-500",children:"Brief introduction about this stage"}),(0,jt.jsxs)("span",{className:"text-xs text-gray-500",children:[(t.introduction||"").length,"/200"]})]})]}),o&&(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsxs)("button",{type:"button",onClick:c,className:"bg-tag-purple text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors duration-200 flex items-center justify-center mx-auto",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Next Stage"]})})]})},qi=e=>{let{relatedProject:t}=e;return(0,jt.jsxs)("div",{className:"mb-8",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Related Collaboration Project"}),(0,jt.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,jt.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"font-medium text-gray-800",children:t.name}),(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:t.description})]}),(0,jt.jsx)("button",{type:"button",className:"text-tag-purple text-sm hover:text-purple-700 transition-colors",children:"View Project"})]}),(0,jt.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-3",children:[(0,jt.jsxs)("span",{children:["Team: ",t.teamSize," members"]}),(0,jt.jsxs)("span",{children:["Deadline: ",t.deadline]})]}),(0,jt.jsx)("button",{type:"button",className:"text-tag-purple text-sm hover:text-purple-700 transition-colors",children:"Link Different Project"})]})]})},Vi=t=>{let{state:r,setters:o}=t;const{setMilestoneStages:s}=o;return{handleStageNameChange:(0,e.useCallback)((e,t)=>{s(r=>r.map(r=>r.id===e?(0,a.A)((0,a.A)({},r),{},{stageName:t}):r))},[s]),handleProgressChange:(0,e.useCallback)((e,t)=>{s(r=>r.map(r=>r.id===e?(0,a.A)((0,a.A)({},r),{},{progress:parseInt(t)}):r))},[s]),handleFileUpload:(0,e.useCallback)((e,t)=>{const r=Array.from(t.target.files),o=r.length>0?[r[0]]:[];s(t=>t.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{posterFiles:o}):t))},[s]),handleFieldChange:(0,e.useCallback)((e,t,r)=>{s(o=>o.map(o=>o.id===e?(0,a.A)((0,a.A)({},o),{},{[t]:r}):o))},[s]),addNewStage:(0,e.useCallback)(()=>{const e={id:Date.now(),stageName:"",progress:20,posterFiles:[],dateAchieved:"",relatedSkills:"",whatsNext:""};s(t=>[...t,e])},[s]),removeStage:(0,e.useCallback)(e=>{r.milestoneStages.length>1&&s(t=>t.filter(t=>t.id!==e))},[r.milestoneStages.length,s]),handleKeyDown:(0,e.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation())},[]),handleSubmit:(0,e.useCallback)(e=>{e.preventDefault(),console.log("Milestones stages submitted:",r.milestoneStages),o.setShowSuccess(!0)},[r.milestoneStages,o])}},Ji=()=>{const[t,r]=(0,e.useState)(!1),[o,a]=(0,e.useState)([{id:1,stageName:"",progress:20,posterFiles:[],dateAchieved:"",relatedSkills:"",whatsNext:""}]);return(0,e.useMemo)(()=>({state:{showSuccess:t,milestoneStages:o},setters:{setShowSuccess:r,setMilestoneStages:a}}),[t,o])},Zi=()=>{ce();const{state:e,setters:t}=Ji(),r=Vi({state:e,setters:t}),o={name:"Mobile App Design Collaboration",description:"Fintech app needs UI/UX designer",teamSize:4,deadline:"Dec 15, 2024"};return e.showSuccess?(0,jt.jsx)(Pi,{module:"Milestones"}):(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,jt.jsx)(Gi,{}),(0,jt.jsx)(qi,{relatedProject:o}),(0,jt.jsxs)("form",{onSubmit:r.handleSubmit,className:"space-y-8",children:[e.milestoneStages.map((t,o)=>(0,jt.jsx)(Hi,{stage:t,index:o,isLast:o===e.milestoneStages.length-1,onStageNameChange:r.handleStageNameChange,onProgressChange:r.handleProgressChange,onFileUpload:r.handleFileUpload,onFieldChange:r.handleFieldChange,onRemoveStage:r.removeStage,onAddNewStage:r.addNewStage,onKeyDown:r.handleKeyDown},t.id)),(0,jt.jsxs)("button",{type:"submit",className:"w-full bg-tag-purple text-white font-semibold py-3 rounded-md hover:bg-purple-700 transition-colors duration-200 flex items-center justify-center",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Share All Milestone Stages TAGMe!"]})]})]})},Ki=()=>(0,jt.jsxs)("div",{className:"text-center mb-6",children:[(0,jt.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-tag-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})}),(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Sell Your Art Assets"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Upload digital assets to the marketplace and earn from your creative work"})]}),Yi=e=>{let{onFileUpload:t}=e;return(0,jt.jsxs)("div",{className:"space-y-6",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Files"}),(0,jt.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg bg-white py-6 px-4 text-center",children:[(0,jt.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,jt.jsx)("p",{className:"text-gray-600 mb-2",children:"Drag files here or click to browse"}),(0,jt.jsx)("p",{className:"text-xs text-gray-400 mb-4",children:"JPG, PNG, AI, PSD, SVG, EPS (Max 25MB)"}),(0,jt.jsx)("input",{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.ai,.psd,.svg,.eps",onChange:t,className:"hidden",id:"art-market-file-upload"}),(0,jt.jsx)("label",{htmlFor:"art-market-file-upload",className:"bg-tag-blue text-white px-4 py-2 rounded cursor-pointer hover:bg-blue-700 transition-colors duration-200",children:"Choose Files"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview Images"}),(0,jt.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg bg-white py-6 px-4 text-center",children:[(0,jt.jsx)("svg",{className:"w-8 h-8 text-gray-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,jt.jsx)("p",{className:"text-gray-600 mb-2",children:"Upload preview images to showcase your asset"}),(0,jt.jsx)("p",{className:"text-xs text-gray-400 mb-4",children:"JPG, PNG (Max 5MB each)"}),(0,jt.jsx)("input",{type:"file",multiple:!0,accept:".jpg,.jpeg,.png",onChange:t,className:"hidden",id:"preview-images-upload"}),(0,jt.jsx)("label",{htmlFor:"preview-images-upload",className:"bg-blue-100 text-blue-800 font-semibold py-2 px-4 rounded cursor-pointer hover:bg-blue-200 transition-colors duration-200",children:"Add Previews"})]})]})]})},Qi=e=>{let{formData:t,onFormChange:r,errors:o=[]}=e;const a=[{value:"",label:"Select category"},{value:"graphics",label:"Graphics"},{value:"illustrations",label:"Illustrations"},{value:"templates",label:"Templates"},{value:"icons",label:"Icons"},{value:"fonts",label:"Fonts"},{value:"textures",label:"Textures"}],s=[{value:"Standard License",label:"Standard License"},{value:"Extended License",label:"Extended License"},{value:"Commercial License",label:"Commercial License"}];return(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asset Title"}),(0,jt.jsx)("input",{type:"text",name:"title",value:t.title,onChange:r,placeholder:"Name your digital asset...",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("select",{name:"category",value:t.category,onChange:r,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 pr-10 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue appearance-none",children:a.map(e=>(0,jt.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,jt.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,jt.jsx)("textarea",{name:"description",value:t.description,onChange:r,placeholder:"Describe your asset, what's included, and how it can be used...",rows:4,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue"})]}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price"}),(0,jt.jsx)("input",{type:"number",name:"price",value:t.price,onChange:r,placeholder:"0.00",step:"0.01",min:"0",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"License Type"}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsx)("select",{name:"licenseType",value:t.licenseType,onChange:r,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 pr-10 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue appearance-none",children:s.map(e=>(0,jt.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,jt.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"File Format"}),(0,jt.jsx)("input",{type:"text",name:"fileFormat",value:t.fileFormat,onChange:r,placeholder:"e.g., AI, PSD, SVG",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue"})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,jt.jsx)("input",{type:"text",name:"tags",value:t.tags,onChange:r,placeholder:"Add relevant tags (e.g., minimal, vector, business)",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Software Used"}),(0,jt.jsx)("input",{type:"text",name:"softwareUsed",value:t.softwareUsed,onChange:r,placeholder:"e.g., Adobe Illustrator, Photoshop",className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue"})]}),o.length>0&&(0,jt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:(0,jt.jsxs)("div",{className:"flex items-start",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-red-600 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-sm font-semibold text-red-800 mb-1",children:"Please fix the following errors:"}),(0,jt.jsx)("ul",{className:"text-sm text-red-800 list-disc list-inside",children:o.map((e,t)=>(0,jt.jsx)("li",{children:e},t))})]})]})})]})},$i=e=>{let{formData:t,onFormChange:r,onSubmit:o,isSubmitting:a=!1}=e;return(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,jt.jsxs)("div",{className:"flex items-start",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h4",{className:"text-sm font-semibold text-blue-800 mb-1",children:"Marketplace Guidelines"}),(0,jt.jsx)("p",{className:"text-sm text-blue-800",children:"All assets must be original work. We take 30% commission on sales. Assets are reviewed before going live."})]})]})}),(0,jt.jsxs)("div",{className:"flex items-start",children:[(0,jt.jsx)("input",{type:"checkbox",name:"agreeToTerms",checked:t.agreeToTerms,onChange:r,className:"mt-1 h-4 w-4 text-tag-blue focus:ring-tag-blue border-gray-300 rounded"}),(0,jt.jsx)("label",{className:"ml-2 text-sm text-gray-700",children:"I agree to the marketplace terms and confirm this is my original work"})]}),(0,jt.jsx)("button",{type:"submit",disabled:!t.agreeToTerms||a,onClick:o,className:"w-full font-semibold py-3 rounded-md transition-colors duration-200 flex items-center justify-center ".concat(t.agreeToTerms&&!a?"bg-tag-blue text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:a?(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,jt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,jt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),"List on TAG!"]})})]})},Xi=()=>{const[t,r]=(0,e.useState)({title:"",category:"",description:"",tags:"",price:"0.00",licenseType:"Standard License",fileFormat:"",softwareUsed:"",agreeToTerms:!1}),[o,s]=(0,e.useState)([]),[n,i]=(0,e.useState)(!1),l=(0,e.useCallback)(e=>{const{name:t,value:n,type:i,checked:l}=e.target,c="checkbox"===i?l:n;r(e=>(0,a.A)((0,a.A)({},e),{},{[t]:c})),o.length>0&&s(e=>e.filter(e=>!e.includes(t)))},[o]),c=(0,e.useCallback)(e=>{const t=e.target.files;console.log("Art Market files selected:",t)},[]),d=(0,e.useCallback)(()=>{const e=(e=>{const t=[];return e.title.trim()||t.push("Title is required"),e.category||t.push("Category is required"),e.description.trim()||t.push("Description is required"),parseFloat(e.price)<0&&t.push("Price must be non-negative"),e.agreeToTerms||t.push("You must agree to the terms"),{isValid:0===t.length,errors:t}})(t);return s(e.errors),e.isValid},[t]),u=(0,e.useCallback)(()=>{r({title:"",category:"",description:"",tags:"",price:"0.00",licenseType:"Standard License",fileFormat:"",softwareUsed:"",agreeToTerms:!1}),s([]),i(!1)},[]),h=(0,e.useCallback)(e=>{i(e)},[]);return{formData:t,errors:o,isSubmitting:n,handleFormChange:l,handleFileUpload:c,validateForm:d,resetForm:u,setSubmitting:h}},el=t=>{let{formData:r,validateForm:o,setSubmitting:s,onSuccess:n}=t;const i=ce(),l=(0,e.useCallback)(async e=>{if(e.preventDefault(),o()){s(!0);try{const e=(e=>(0,a.A)((0,a.A)({},e),{},{price:parseFloat(e.price)||0,tags:e.tags.split(",").map(e=>e.trim()).filter(e=>e),submittedAt:(new Date).toISOString()}))(r);console.log("Art Market form submitted:",e),await new Promise(e=>setTimeout(e,1e3)),n&&n()}catch(t){console.error("Error submitting form:",t)}finally{s(!1)}}},[r,o,s,n]);return{handleSubmit:l,handleCancel:(0,e.useCallback)(()=>{i("/upload/form")},[i])}},tl=()=>{const[t,r]=(0,e.useState)(!1),{formData:o,errors:a,isSubmitting:s,handleFormChange:n,handleFileUpload:i,validateForm:l,setSubmitting:c}=Xi(),d=el({formData:o,validateForm:l,setSubmitting:c,onSuccess:()=>{r(!0)}});return t?(0,jt.jsx)(Pi,{module:"Art Market"}):(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,jt.jsx)(Ki,{}),(0,jt.jsxs)("form",{className:"space-y-6",children:[(0,jt.jsx)(Yi,{onFileUpload:i}),(0,jt.jsx)(Qi,{formData:o,onFormChange:n,errors:a}),(0,jt.jsx)($i,{formData:o,onFormChange:n,onSubmit:d.handleSubmit,isSubmitting:s})]})]})},rl=e=>e.type.startsWith("image/")?URL.createObjectURL(e):null,ol=e=>{let{selectedFiles:t,onFileUpload:r,onRemoveFile:o,isSubmitting:a,uploadProgress:s,errors:n}=e;return(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg bg-white py-6 px-4 text-center mb-6",children:[(0,jt.jsx)("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,jt.jsx)("p",{className:"text-gray-600 mb-2",children:"Drag files here or click to browse"}),(0,jt.jsx)("p",{className:"text-xs text-gray-400 mb-4",children:"JPG, PNG, GIF, PDF (Max 10MB)"}),(0,jt.jsx)("input",{type:"file",multiple:!0,accept:".jpg,.jpeg,.png,.gif,.pdf",onChange:e=>{const t=Array.from(e.target.files),{validFiles:o,errors:a}=(e=>{const t=[],r=[];return e.forEach(e=>{const o=(e=>["image/jpeg","image/png","image/gif","application/pdf"].includes(e.type)?e.size>10485760?{isValid:!1,error:"File too large: ".concat(e.name,". Maximum size is 10MB.")}:{isValid:!0,error:null}:{isValid:!1,error:"Invalid file type: ".concat(e.name,". Please upload JPG, PNG, GIF, or PDF files.")})(e);o.isValid?t.push(e):r.push(o.error)}),{validFiles:t,errors:r}})(t);a.length>0?alert(a[0]):r({target:{files:o}})},className:"hidden",id:"portfolio-file-upload",disabled:a}),(0,jt.jsx)("label",{htmlFor:"portfolio-file-upload",className:"bg-tag-blue text-white px-4 py-2 rounded cursor-pointer hover:bg-blue-700 transition-colors duration-200 ".concat(a?"opacity-50 cursor-not-allowed":""),children:t.length>0?"Selected ".concat(t.length," files"):"Choose Files"})]}),t.length>0&&(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Selected Files:"}),(0,jt.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:t.map((e,t)=>(0,jt.jsxs)("div",{className:"relative group",children:[(0,jt.jsx)("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:e.type.startsWith("image/")?(0,jt.jsx)("img",{src:rl(e),alt:e.name,className:"w-full h-full object-cover"}):(0,jt.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})})}),(0,jt.jsx)("p",{className:"text-xs text-gray-600 mt-1 truncate",children:e.name}),(0,jt.jsx)("button",{type:"button",onClick:()=>o(t),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600 transition-colors",children:"\xd7"})]},t))}),n.files&&(0,jt.jsx)("p",{className:"text-red-600 text-sm mt-2",children:n.files})]}),a&&(0,jt.jsxs)("div",{className:"mb-6",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,jt.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Uploading..."}),(0,jt.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(s),"%"]})]}),(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,jt.jsx)("div",{className:"bg-tag-blue h-2 rounded-full transition-all duration-300",style:{width:"".concat(s,"%")}})})]})]})},al=e=>{let{formData:t,tagInput:r,onFormChange:o,onTagInputChange:a,onTagInputKeyDown:s,onRemoveSoftware:n,onRemoveTag:i,onShowCustomSoftwareModal:l,isSubmitting:c,errors:d}=e;const u=["3D-Coat","3ds Max","After Effects","Blender","Cinema 4D","DaVinci Resolve","Figma","Gaea","Houdini","Illustrator","InDesign","JavaScript","Maya","Nuke","Photoshop","Python","Substance Designer","Substance Painter","Unity","Unreal Engine","ZBrush","Other"];return(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),(0,jt.jsx)("input",{type:"text",name:"title",value:t.title,onChange:o,placeholder:"Give your work a title...",disabled:c,className:"w-full bg-gray-50 border rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue ".concat(d.title?"border-red-300":"border-gray-300"," ").concat(c?"opacity-50 cursor-not-allowed":"")}),d.title&&(0,jt.jsx)("p",{className:"text-red-600 text-sm mt-1",children:d.title})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Software Used"}),t.software.length>0&&(0,jt.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:t.software.map((e,t)=>(0,jt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800",children:[e,(0,jt.jsx)("button",{type:"button",onClick:()=>n(e),className:"ml-2 text-blue-600 hover:text-blue-800",children:"\xd7"})]},t))}),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsxs)("select",{name:"software",value:"",onChange:e=>{const t=o(e);"showCustomSoftwareModal"===(null===t||void 0===t?void 0:t.action)&&l()},disabled:c,className:"w-full bg-gray-50 border rounded px-3 py-2 pr-10 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue appearance-none ".concat(d.software?"border-red-300":"border-gray-300"," ").concat(c?"opacity-50 cursor-not-allowed":""),children:[(0,jt.jsx)("option",{value:"",children:"Add software"}),u.map(e=>(0,jt.jsx)("option",{value:e,children:e},e))]}),(0,jt.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),d.software&&(0,jt.jsx)("p",{className:"text-red-600 text-sm mt-1",children:d.software})]})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,jt.jsx)("textarea",{name:"description",value:t.description,onChange:o,placeholder:"Describe your work...",rows:6,disabled:c,className:"w-full bg-gray-50 border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue h-24 ".concat(c?"opacity-50 cursor-not-allowed":"")})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tags ",(0,jt.jsx)("span",{className:"text-red-500",children:"*"})]}),t.tags.length>0&&(0,jt.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:t.tags.map((e,t)=>(0,jt.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-green-100 text-green-800",children:[e,(0,jt.jsx)("button",{type:"button",onClick:()=>i(e),className:"ml-2 text-green-600 hover:text-green-800",children:"\xd7"})]},t))}),(0,jt.jsx)("input",{type:"text",value:r,onChange:a,onKeyDown:s,placeholder:t.tags.length>=10?"Maximum 10 tags reached":"Type # to add tags (e.g., #design #illustration)",disabled:c||t.tags.length>=10,className:"w-full bg-gray-50 border rounded px-3 py-2 focus:outline-none focus:ring-1 ".concat(t.tags.length>=10?"border-red-300 bg-red-50 text-gray-400":"border-gray-300 focus:ring-tag-blue focus:border-tag-blue"," ").concat(c?"opacity-50 cursor-not-allowed":"")}),(0,jt.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,jt.jsx)("p",{className:"text-xs text-gray-500",children:"Start with # and use lowercase letters only. Press space, comma, or enter to add tags."}),(0,jt.jsxs)("p",{className:"text-xs ".concat(t.tags.length>=10?"text-red-500":t.tags.length>=8?"text-yellow-600":"text-gray-400"),children:[t.tags.length,"/10 tags"]})]}),t.tags.length>=10&&(0,jt.jsx)("p",{className:"text-xs text-red-500 mt-1",children:"\u26a0\ufe0f Maximum of 10 tags allowed. Remove some tags to add new ones."}),d.tags&&(0,jt.jsx)("p",{className:"text-red-600 text-sm mt-1",children:d.tags})]})]})},sl=t=>{let{isOpen:r,onClose:o,onAdd:a}=t;const[s,n]=(0,e.useState)(""),i=()=>{if(s.trim()){a(s.trim())&&(n(""),o())}};return r?(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Add Custom Software"}),(0,jt.jsx)("input",{type:"text",value:s,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"===e.key&&i()},placeholder:"Enter software name...",className:"w-full border border-gray-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-1 focus:ring-tag-blue focus:border-tag-blue"}),(0,jt.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,jt.jsx)("button",{type:"button",onClick:()=>{n(""),o()},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,jt.jsx)("button",{type:"button",onClick:i,disabled:!s.trim(),className:"px-4 py-2 bg-tag-blue text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Add"})]})]})}):null},nl=e=>{let{isOpen:t,onClose:r,onConfirm:o}=e;return t?(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsx)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-tag-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Confirm Upload"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to publish this work to TAG? This action cannot be undone."}),(0,jt.jsxs)("div",{className:"flex space-x-3",children:[(0,jt.jsx)("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,jt.jsx)("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 bg-tag-blue text-white rounded-md hover:bg-blue-700 transition-colors",children:"Confirm Upload"})]})]})})}):null},il=e=>{let{isSubmitting:t,onSubmit:r}=e;return(0,jt.jsx)("button",{type:"submit",disabled:t,onClick:r,className:"w-full font-semibold py-3 rounded-md transition-colors duration-200 flex items-center justify-center ".concat(t?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-tag-blue text-white hover:bg-blue-700"),children:t?(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-gray-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,jt.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,jt.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Publishing..."]}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Publish to TAG!"]})})},ll=e=>{if(!e||"string"!==typeof e)return[];const t=e.match(/#([a-zA-Z0-9_-]{1,50})/g);if(!t)return[];const r=new Set,o=[];return t.forEach(e=>{const t=e.slice(1),a=t.toLowerCase().trim();cl(a)&&!r.has(a)&&(r.add(a),o.push({name:t,slug:a}))}),o},cl=e=>e.length>=2&&!["the","and","or","but","in","on","at","to","for","of","with","by","from","up","about","into","through","during","before","after","above","below","between","among","within","without","this","that","these","those","is","are","was","were","be","been","being","have","has","had","do","does","did","will","would","could","should","may","might","can","must","shall"].includes(e),dl=()=>{const[t,r]=(0,e.useState)({title:"",software:[],description:"",tags:[]}),[o,s]=(0,e.useState)(""),[n,i]=(0,e.useState)({}),l=(0,e.useCallback)(e=>{const{name:o,value:s}=e.target;if("software"===o){if("Other"===s)return{action:"showCustomSoftwareModal"};s&&!t.software.includes(s)&&r(e=>(0,a.A)((0,a.A)({},e),{},{software:[...e.software,s]}))}else r(e=>(0,a.A)((0,a.A)({},e),{},{[o]:s}));return n[o]&&i(e=>((e,t)=>{const r=(0,a.A)({},e);return r[t]&&delete r[t],r})(e,o)),{action:"none"}},[t.software,n]),c=(0,e.useCallback)(e=>!(!e.trim()||t.software.includes(e.trim()))&&(r(t=>(0,a.A)((0,a.A)({},t),{},{software:[...t.software,e.trim()]})),!0),[t.software]),d=(0,e.useCallback)(e=>{r(t=>(0,a.A)((0,a.A)({},t),{},{software:t.software.filter(t=>t!==e)}))},[]),u=(0,e.useCallback)(e=>{const o=e.target.value;if(s(o),!o.startsWith("#")&&o.length>0)return;if([" ",",","\n"].some(e=>o.includes(e))){if(t.tags.length>=10)return void s("");const e=o.split(/[\s,\n]/)[0].toLowerCase(),n=ll(e);if(n.length>0){const e="#".concat(n[0].slug);t.tags.includes(e)||r(t=>(0,a.A)((0,a.A)({},t),{},{tags:[...t.tags,e]}))}s("")}},[t.tags]),h=(0,e.useCallback)(e=>{if("Enter"===e.key||","===e.key){if(e.preventDefault(),t.tags.length>=10)return void s("");const n=o.trim();if(n.startsWith("#")){const e=ll(n);if(e.length>0){const o="#".concat(e[0].slug);t.tags.includes(o)||r(e=>(0,a.A)((0,a.A)({},e),{},{tags:[...e.tags,o]}))}}s("")}},[o,t.tags]),m=(0,e.useCallback)(e=>{r(t=>(0,a.A)((0,a.A)({},t),{},{tags:t.tags.filter(t=>t!==e)}))},[]),p=(0,e.useCallback)(e=>{const r=((e,t)=>{const r={};return e.title.trim()||(r.title="Title is required"),0===e.tags.length&&(r.tags="At least one tag is required"),0===t.length&&(r.files="Please select at least one file"),r})(t,e);return i(r),0===Object.keys(r).length},[t]),g=(0,e.useCallback)(()=>{r({title:"",software:[],description:"",tags:[]}),s(""),i({})},[]);return{formData:t,tagInput:o,errors:n,handleFormChange:l,handleAddCustomSoftware:c,handleRemoveSoftware:d,handleTagInputChange:u,handleTagInputKeyDown:h,handleRemoveTag:m,validateForm:p,resetForm:g,setErrors:i}},ul=()=>{const{formData:t,tagInput:r,errors:o,handleFormChange:a,handleAddCustomSoftware:s,handleRemoveSoftware:n,handleTagInputChange:i,handleTagInputKeyDown:l,handleRemoveTag:c,validateForm:d,setErrors:u}=dl(),{selectedFiles:h,isSubmitting:m,uploadProgress:p,showSuccessModal:g,showErrorModal:f,errorMessage:v,showConfirmModal:x,handleFileUpload:b,handleRemoveFile:y,handleSubmit:w,handleConfirmUpload:j,handleCloseSuccessModal:k,handleCloseErrorModal:S,handleCloseConfirmModal:N}=(()=>{const t=ce(),{user:r}=St(),[o,a]=(0,e.useState)([]),[s,n]=(0,e.useState)(!1),[i,l]=(0,e.useState)(0),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(!1),[m,p]=(0,e.useState)(""),[g,f]=(0,e.useState)(!1),v=(0,e.useCallback)(e=>{const t=Array.from(e.target.files);console.log("Portfolio files selected:",t),a(t)},[]),x=(0,e.useCallback)(e=>{a(t=>t.filter((t,r)=>r!==e))},[]),b=(0,e.useCallback)(async()=>{const e=[];for(let t=0;t<o.length;t++){const a=o[t];l(t/o.length*100);const s=await(0,sr.jp)(a,r.id);if(!s.success)throw new Error("Failed to upload ".concat(a.name,": ").concat(s.error));e.push(s.data)}return l(100),e},[o,r.id]),y=(0,e.useCallback)(async(e,t,a)=>{if(e.preventDefault(),a(o))return r?void f(!0):(p("Please log in to upload artwork"),void h(!0))},[o,r]),w=(0,e.useCallback)(async e=>{f(!1),n(!0);try{const a=await b();console.log("[UploadPortfolio] Form data tags:",e.tags),console.log("[UploadPortfolio] Form data software:",e.software);const s=((e,t,r)=>{var o,a;return{userId:r,title:e.title.trim(),category:"design",description:e.description.trim(),tags:[...e.tags,...e.software],imagePaths:t.map(e=>e.path),thumbnailPath:(null===(o=t[0])||void 0===o?void 0:o.path)||"",imageKey:(null===(a=t[0])||void 0===a?void 0:a.path)||"",isPublic:!0}})(e,a,null===r||void 0===r?void 0:r.id);console.log("[UploadPortfolio] Final portfolio data tags:",s.tags);const n=await(0,sr.qo)(s);if(!n.success)throw new Error(n.error||"Failed to save artwork");if(r&&r.id)try{await Sr.ensureArtistIndexed(r.id),console.log("[UploadPortfolio] Artist indexed successfully")}catch(o){console.warn("[UploadPortfolio] Failed to index artist:",o)}d(!0),setTimeout(()=>{t("/")},2e3)}catch(a){console.error("Upload error:",a),p("Upload failed. Please try again."),h(!0)}finally{n(!1),l(0)}},[b,t]),j=(0,e.useCallback)(()=>{d(!1)},[]),k=(0,e.useCallback)(()=>{h(!1)},[]),S=(0,e.useCallback)(()=>{f(!1)},[]);return{selectedFiles:o,isSubmitting:s,uploadProgress:i,showSuccessModal:c,showErrorModal:u,errorMessage:m,showConfirmModal:g,handleFileUpload:v,handleRemoveFile:x,handleSubmit:y,handleConfirmUpload:w,handleCloseSuccessModal:j,handleCloseErrorModal:k,handleCloseConfirmModal:S}})(),[C,_]=(0,e.useState)(!1),A=()=>{_(!1)},I=e=>{w(e,t,d)};return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,jt.jsxs)("div",{className:"text-center mb-6",children:[(0,jt.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,jt.jsx)("svg",{className:"w-8 h-8 text-tag-blue",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Share Your Portfolio Work"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"Upload your creative work to the gallery for everyone to see and get inspired"})]}),o.general&&(0,jt.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,jt.jsx)("p",{className:"text-red-600 text-sm",children:o.general})}),(0,jt.jsx)(ol,{selectedFiles:h,onFileUpload:b,onRemoveFile:y,isSubmitting:m,uploadProgress:p,errors:o}),(0,jt.jsxs)("form",{onSubmit:I,className:"space-y-4",children:[(0,jt.jsx)(al,{formData:t,tagInput:r,onFormChange:a,onTagInputChange:i,onTagInputKeyDown:l,onRemoveSoftware:n,onRemoveTag:c,onShowCustomSoftwareModal:()=>{_(!0)},isSubmitting:m,errors:o}),(0,jt.jsx)(il,{isSubmitting:m,onSubmit:I})]}),(0,jt.jsx)(sl,{isOpen:C,onClose:A,onAdd:e=>{s(e)&&A()}}),(0,jt.jsx)(nl,{isOpen:x,onClose:N,onConfirm:()=>{j(t)}}),(0,jt.jsx)(zt,{isOpen:g,title:"\ud83c\udf89 Success!",message:"Portfolio work published successfully to TAG!",onClose:k}),(0,jt.jsx)(Ut,{isOpen:f,title:"\u26a0\ufe0f Error",message:v,onClose:S})]})},hl=()=>{const t=ne(),[r,o]=(0,e.useState)("portfolio"),[a,s]=(0,e.useState)(!1),[n,i]=(0,e.useState)(""),[l,c]=(0,e.useState)(null);(0,e.useEffect)(()=>{var e,r,a;const s=new URLSearchParams(t.search).get("tab");if(s){o(s);const e=window.location.pathname;window.history.replaceState({},document.title,e)}else null===(e=t.state)||void 0===e||!e.activeUploadType||"upload-success"!==(null===(r=t.state)||void 0===r?void 0:r.from)&&"draft-edit"!==(null===(a=t.state)||void 0===a?void 0:a.from)||(o(t.state.activeUploadType),window.history.replaceState({},document.title))},[t.state,t.search]);const d=[{id:"art-market",name:"Art Market",theme:"blue",icon:(0,jt.jsx)("svg",{className:"w-6 h-6 text-current",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})})},{id:"portfolio",name:"Portfolio",theme:"blue",icon:(0,jt.jsx)("svg",{className:"w-6 h-6 text-current",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{id:"collaboration",name:"Collaboration",theme:"purple",icon:(0,jt.jsx)("svg",{className:"w-6 h-6 text-current",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})},{id:"milestones",name:"Milestones",theme:"purple",icon:(0,jt.jsx)("svg",{className:"w-6 h-6 text-current",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 3v18m0-16h12l-2 4 2 4H6"})})},{id:"jobs",name:"Jobs",theme:"purple",icon:(0,jt.jsx)("svg",{className:"w-6 h-6 text-current",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 7a2 2 0 012-2h12a2 2 0 012 2v2H4V7zM4 9h16v10a2 2 0 01-2 2H6a2 2 0 01-2-2V9z"})})}],u=e=>{const t=r===e.id,o="blue"===e.theme,a="purple"===e.theme;if(t){if(o)return"border-tag-blue bg-blue-50 text-tag-blue ring-2 ring-tag-blue/20";if(a)return"border-tag-purple bg-purple-50 text-tag-purple ring-2 ring-tag-purple/20"}return"text-gray-600 hover:text-gray-800"},h=e=>{const t=r===e.id,o="blue"===e.theme,a="purple"===e.theme;if(t){if(o)return"text-tag-blue";if(a)return"text-tag-purple"}return"text-gray-400"};return(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50 pt-16",children:[(0,jt.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-10",children:[(0,jt.jsxs)("div",{className:"text-center mb-8",children:[(0,jt.jsx)("h1",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"What would you like to upload?"}),(0,jt.jsx)("p",{className:"text-base text-gray-500",children:"Choose the type of content you want to share with the community"})]}),(0,jt.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4 mb-8",children:d.map(e=>(0,jt.jsx)("button",{onClick:()=>{return t=e.id,r=e.name,void("art-market"===t||"jobs"===t?(i("".concat(r," upload is currently in testing phase and not available yet.")),s(!0),c(t)):o(t));var t,r},className:"bg-white border border-gray-200 rounded-lg px-4 py-3 text-center transition-all duration-200 hover:shadow ".concat("blue"===e.theme?"hover:border-tag-blue":"hover:border-tag-purple"," ").concat(u(e)),children:(0,jt.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[(0,jt.jsx)("div",{className:h(e),children:e.icon}),(0,jt.jsx)("span",{className:"text-sm font-medium",children:e.name})]})},e.id))}),(0,jt.jsxs)("div",{className:"mt-8 rounded-lg p-6 ".concat("portfolio"===r||"art-market"===r?"bg-blue-50":"bg-purple-50"),children:[console.log("\ud83d\udd0d Rendering uploadType:",r),"portfolio"===r&&(0,jt.jsx)(ul,{}),"art-market"===r&&(0,jt.jsx)(tl,{}),"collaboration"===r&&(0,jt.jsx)(Wi,{}),"jobs"===r&&(0,jt.jsx)(Bi,{}),"milestones"===r&&(0,jt.jsx)(Zi,{})]})]}),a&&(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-sm w-full",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:"Feature Under Development"}),(0,jt.jsx)("p",{className:"text-sm text-gray-800 mb-4",children:n}),(0,jt.jsx)("div",{className:"flex justify-end space-x-2",children:(0,jt.jsx)("button",{onClick:()=>{s(!1),l&&(o(l),c(null))},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"OK"})})]})})]})},ml=()=>({id:"default",title:"Untitled Work",description:"No description available",category:"Design",date:(new Date).toLocaleDateString(),likes:0,views:0,tags:[],mainImage:"",allImages:[],author:pl()}),pl=()=>({id:"unknown",name:"Unknown Artist",role:"Design",avatar:"",works:0,followers:"0",following:0}),gl=t=>{let{imageUrl:r,imageAlt:o="Image",isOpen:a=!1,onClose:s,className:n=""}=t;const[i,l]=(0,e.useState)(1),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)({x:0,y:0}),[m,p]=(0,e.useState)({x:0,y:0}),g=(0,e.useCallback)(e=>{e.preventDefault();const t=e.deltaY>0?-.2:.2,r=Math.max(.5,Math.min(5,i+t));l(r)},[i]),f=(0,e.useCallback)(()=>{l(1),p({x:0,y:0})},[]),v=(0,e.useCallback)(e=>{i>1&&(d(!0),h({x:e.clientX-m.x,y:e.clientY-m.y}))},[i,m]),x=(0,e.useCallback)(e=>{c&&i>1&&p({x:e.clientX-u.x,y:e.clientY-u.y})},[c,i,u]),b=(0,e.useCallback)(()=>{d(!1)},[]);return(0,e.useEffect)(()=>{const e=e=>{"Escape"===e.key&&s()};return a&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[a,s]),(0,e.useEffect)(()=>{a&&(l(1),p({x:0,y:0}),d(!1))},[a]),a?(0,jt.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm ".concat(n),onClick:s,onWheel:g,onMouseMove:x,onMouseUp:b,onMouseLeave:b,children:[(0,jt.jsx)("button",{onClick:s,className:"absolute top-4 right-4 z-10 w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white/30 transition-colors duration-200","aria-label":"Close image viewer",children:(0,jt.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),1!==i&&(0,jt.jsx)("button",{onClick:f,className:"absolute top-4 left-4 z-10 w-10 h-10 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-white/30 transition-colors duration-200","aria-label":"Reset zoom",children:(0,jt.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),(0,jt.jsx)("div",{className:"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center",onClick:e=>e.stopPropagation(),onMouseDown:v,style:{cursor:i>1?c?"grabbing":"grab":"default"},children:(0,jt.jsx)("img",{src:r,alt:o,className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl transition-transform duration-200",loading:"eager",onDoubleClick:f,style:{transform:"scale(".concat(i,") translate(").concat(m.x/i,"px, ").concat(m.y/i,"px)"),transformOrigin:"center"}})}),1!==i&&(0,jt.jsxs)("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-white/20 backdrop-blur-sm rounded-full px-3 py-1 text-white text-sm",children:[Math.round(100*i),"%"]}),(0,jt.jsx)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 text-white/70 text-sm",children:"Scroll to zoom \u2022 Double-click to reset \u2022 ESC to close"})]}):null},fl=t=>{let{images:r=[],workTitle:o="Work",className:a=""}=t;const[s,n]=(0,e.useState)(!1),[i,l]=(0,e.useState)(0),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(async()=>{if(!r||0===r.length)return d([]),void h(!1);try{h(!0);const o=[];console.log("[WorkImageGallery] Processing images:",r);for(const a of r)if("string"===typeof a)if(a.startsWith("data:image/")||a.startsWith("blob:")||a.startsWith("http"))"/assets/placeholder.svg"!==a&&""!==a.trim()?(console.log("[WorkImageGallery] Using direct URL:",a.substring(0,50)+"..."),o.push(a)):console.log("[WorkImageGallery] Skipping placeholder path:",a);else{console.log("[WorkImageGallery] Converting file path to URL:",a);try{var e;const t=await(0,sr.getPortfolioImageUrl)(a);console.log("[WorkImageGallery] getPortfolioImageUrl result:",t),t.success&&null!==(e=t.data)&&void 0!==e&&e.url?(console.log("[WorkImageGallery] Successfully converted path to URL:",t.data.url.substring(0,50)+"..."),o.push(t.data.url)):(console.warn("[WorkImageGallery] Failed to convert path to URL:",a,t.error),console.log("[WorkImageGallery] Checking if image exists in IndexedDB..."))}catch(t){console.error("[WorkImageGallery] Error converting path to URL:",a,t)}}else console.log("[WorkImageGallery] Skipping non-string: ".concat(typeof a," - ").concat(a));console.log("[WorkImageGallery] Final URLs count: ".concat(o.length),o.map(e=>(null===e||void 0===e?void 0:e.substring(0,30))+"...")),d(o)}catch(o){console.error("Error loading image URLs:",o),d([])}finally{h(!1)}})()},[r]);return u?(0,jt.jsx)("div",{className:"".concat(a),children:(0,jt.jsx)("div",{className:"relative aspect-square bg-gray-100 rounded-lg flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center text-gray-500",children:[(0,jt.jsx)("svg",{className:"w-8 h-8 mx-auto mb-2 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),(0,jt.jsx)("p",{children:"Loading images..."})]})})}):c&&0!==c.length?(0,jt.jsxs)("div",{className:"".concat(a),children:[(0,jt.jsx)("div",{className:"space-y-4",children:c.map((e,t)=>(0,jt.jsx)("div",{className:"relative",children:(0,jt.jsxs)("div",{className:"relative aspect-square bg-white rounded-lg shadow-sm overflow-hidden",children:[e?(0,jt.jsx)("img",{src:e,alt:"".concat(o," - ").concat(t+1),className:"w-full h-full object-cover cursor-pointer hover:opacity-90 transition-opacity duration-200",onClick:()=>(e=>{l(e),n(!0)})(t)}):(0,jt.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center text-gray-500",children:[(0,jt.jsx)("svg",{className:"w-12 h-12 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,jt.jsx)("p",{className:"text-sm",children:"Image not found"})]})}),c.length>1&&(0,jt.jsxs)("div",{className:"absolute top-4 left-4 bg-black/50 text-white px-2 py-1 rounded text-sm",children:[t+1," / ",c.length]})]})},t))}),s&&c[i]&&(0,jt.jsx)(gl,{imageUrl:c[i],imageAlt:"".concat(o," - ").concat(i+1),isOpen:s,onClose:()=>{n(!1)}})]}):(0,jt.jsx)("div",{className:"".concat(a),children:(0,jt.jsx)("div",{className:"relative aspect-square bg-gray-100 rounded-lg flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center text-gray-500",children:[(0,jt.jsx)("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,jt.jsx)("p",{children:"No images available"})]})})})},vl=e=>{let{workData:t,onBackClick:r,onImageNavigation:o,navigationState:a,className:s=""}=e;return(0,jt.jsxs)("div",{className:"".concat(s),children:[(0,jt.jsxs)("button",{onClick:r,className:"flex items-center text-gray-600 hover:text-gray-900 mb-6 transition-colors duration-200 relative z-10 bg-white px-4 py-2 rounded-lg shadow-sm hover:shadow-md",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),(0,jt.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,jt.jsxs)("button",{onClick:null===a||void 0===a?void 0:a.navigateToPrevious,disabled:!(null!==a&&void 0!==a&&a.hasPrevious)&&(null===a||void 0===a?void 0:a.totalWorks)<=1,className:"flex items-center px-4 py-2 bg-white rounded-lg shadow-sm hover:shadow-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous work (\u2190)",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous Work"]}),(0,jt.jsxs)("button",{onClick:null===a||void 0===a?void 0:a.navigateToNext,disabled:!(null!==a&&void 0!==a&&a.hasNext)&&(null===a||void 0===a?void 0:a.totalWorks)<=1,className:"flex items-center px-4 py-2 bg-white rounded-lg shadow-sm hover:shadow-md transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Next work (\u2192)",children:["Next Work",(0,jt.jsx)("svg",{className:"w-5 h-5 ml-2 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),(0,jt.jsx)("div",{className:"mb-6",children:(0,jt.jsx)(fl,{images:t.allImages||[t.mainImage],workTitle:t.title})})]})},xl=e=>{let{tag:t,onClick:r,children:o}=e;return(0,jt.jsx)("a",{href:"/t/".concat(t.slug),onClick:e=>{r&&(e.preventDefault(),r(t))},target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline cursor-pointer",title:"View all content tagged with ".concat(t.name),children:o})},bl=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e&&0!==e.length?(0,jt.jsx)("div",{className:"flex flex-wrap gap-2 ".concat(r),children:e.map((e,r)=>(0,jt.jsxs)(xl,{tag:e,onClick:t,children:["#",e.name]},"".concat(e.slug,"-").concat(r)))}):null},yl=e=>{const t="flex items-center px-4 py-2 rounded-lg transition-colors duration-200";return"".concat(t,e?" bg-red-50 text-red-600":" bg-gray-100 text-gray-700 hover:bg-gray-200")},wl=e=>{let{workData:t,isLiked:r,isSaved:o,onLikeClick:a,onSaveClick:s,className:n=""}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 ".concat(n),children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,jt.jsxs)("button",{onClick:a,className:yl(r),children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2 ".concat(r?"fill-current":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),t.likes]}),(0,jt.jsx)(Rt,{isFavorited:o,itemType:"work",itemId:t.id,onToggle:s,size:"md"})]}),(0,jt.jsxs)("div",{className:"flex items-center text-gray-500",children:[(0,jt.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),(i=t.views,i.toLocaleString())]})]}),(0,jt.jsx)("div",{className:"flex flex-wrap gap-2",children:t.tags&&t.tags.length>0?t.tags.map((e,t)=>{if(e.startsWith("#")){const r=ll(e);if(r.length>0)return(0,jt.jsx)("div",{className:"inline-block",children:bl(r,null,"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium")},t)}return(0,jt.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium",children:e},t)}):(0,jt.jsx)("span",{className:"text-gray-500 text-sm",children:"No tags"})})]});var i},jl=t=>{let{parentId:r,parentAuthorName:o,draft:a,onChange:s,onSubmit:n,onCancel:i,className:l=""}=t;const[c,d]=(0,e.useState)(null),[u,h]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(async()=>{try{h(!0);const e=await(0,Lr.ou)();d(e)}catch(e){console.warn("[CommentReplyForm] Failed to load avatar:",e),d(null)}finally{h(!1)}})()},[]);return(0,jt.jsx)("div",{className:"mt-2 pl-10 ".concat(l),children:(0,jt.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,jt.jsx)("img",{src:c||"/default-avatar.png",alt:"Your avatar",className:"w-8 h-8 rounded-full flex-shrink-0"}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("textarea",{value:a||"",onChange:e=>s(r,e.target.value),placeholder:"Reply to ".concat(o,"\u2026"),rows:2,className:"w-full p-2 border border-gray-300 rounded-md text-sm resize-none focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-transparent",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n(r))}}),(0,jt.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,jt.jsx)("button",{className:"px-3 py-1 rounded bg-tag-blue text-white text-sm hover:bg-tag-dark-blue transition-colors duration-200",onClick:()=>n(r),children:"Post"}),(0,jt.jsx)("button",{className:"px-3 py-1 rounded border border-gray-300 text-sm hover:bg-gray-50 transition-colors duration-200",onClick:i,children:"Cancel"})]})]})]})})},kl=t=>{var r,o;let{reply:a,currentUser:s,onUserClick:n,onLikeClick:i,onDeleteClick:l,formatTime:c}=t;const{user:d}=St(),[u,h]=(0,e.useState)(null),[m,p]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(async()=>{if(a.authorId)try{p(!0);const e=await pa(a.authorId);h(e)}catch(e){console.warn("[ReplyItem] Failed to get reply author info for ".concat(a.authorId,":"),e),h(null)}finally{p(!1)}else p(!1)})()},[a.authorId]);return(0,jt.jsxs)("div",{className:"flex space-x-3",children:[(0,jt.jsx)("img",{src:m?(null===u||void 0===u?void 0:u.avatar)||"/default-avatar.png":null!==u&&void 0!==u&&u.avatar?u.avatar:"/default-avatar.png",alt:a.authorName||"Reply author",className:"w-8 h-8 rounded-full cursor-pointer hover:opacity-80 transition-opacity duration-200",onClick:()=>n(a.authorId)}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,jt.jsx)("span",{className:"font-medium text-gray-900 cursor-pointer hover:text-tag-blue transition-colors duration-200",onClick:()=>n(a.authorId),children:a.authorName}),(0,jt.jsx)("span",{className:"text-sm text-gray-500",children:c(a.createdAt)})]}),(0,jt.jsx)("p",{className:"text-gray-700",children:a.text||a.content})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[(0,jt.jsxs)("button",{onClick:()=>i(a.id),className:"flex items-center gap-1 ".concat(null!==(r=a.likedBy)&&void 0!==r&&r.includes(null===s||void 0===s?void 0:s.id)?"text-red-500":"text-gray-500 hover:text-gray-700"),children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:null!==(o=a.likedBy)&&void 0!==o&&o.includes(null===s||void 0===s?void 0:s.id)?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,jt.jsx)("span",{children:a.likes||0})]}),s&&a.authorId===s.id&&(0,jt.jsx)("button",{onClick:()=>l(a.id),className:"text-red-500 hover:text-red-700",children:"Delete"})]})]})]})},Sl=t=>{var r,o;let{comment:a,comments:s,onUserClick:n,onLikeClick:i,onReplyClick:l,onDeleteClick:c,replyingTo:d,replyDrafts:u,onStartReply:h,onCancelReply:m,onSetReplyDraft:p,onSubmitReply:g,className:f=""}=t;const{user:v}=St(),x=v&&a.authorId===v.id,b=(null===d||void 0===d?void 0:d.parentId)===a.id,y=(0,e.useMemo)(()=>s.filter(e=>String(e.parentId)===String(a.id)).sort((e,t)=>e.createdAt-t.createdAt),[s,a.id]),[w,j]=(0,e.useState)(null),[k,S]=(0,e.useState)(!0);(0,e.useEffect)(()=>{(async()=>{if(a.authorId)try{S(!0);const e=await pa(a.authorId);j(e)}catch(e){console.warn("[CommentItem] Failed to get author info for ".concat(a.authorId,":"),e),j(null)}finally{S(!1)}else S(!1)})()},[a.authorId]);const N=()=>k?a.authorName||"Loading...":null!==w&&void 0!==w&&w.name?w.name:a.authorName||"Unknown User",C=e=>{const t="string"===typeof e?new Date(e).getTime():e,r=new Date(t),o=new Date,a=Math.floor((o-r)/6e4);return a<1?"Just now":a<60?"".concat(a,"m ago"):a<1440?"".concat(Math.floor(a/60),"h ago"):"".concat(Math.floor(a/1440),"d ago")};return(0,jt.jsxs)("div",{className:"flex space-x-3 ".concat(f),children:[(0,jt.jsx)("img",{src:k?(null===w||void 0===w?void 0:w.avatar)||"/default-avatar.png":null!==w&&void 0!==w&&w.avatar?w.avatar:"/default-avatar.png",alt:N(),className:"w-10 h-10 rounded-full cursor-pointer hover:opacity-80 transition-opacity duration-200",onClick:()=>n(a.authorId)}),(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,jt.jsx)("span",{className:"font-medium text-gray-900 cursor-pointer hover:text-tag-blue transition-colors duration-200",onClick:()=>n(a.authorId),children:N()}),(0,jt.jsx)("span",{className:"text-sm text-gray-500",children:C(a.createdAt)})]}),(0,jt.jsx)("p",{className:"text-gray-700",children:a.text||a.content||""})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[(0,jt.jsxs)("button",{onClick:()=>i(a.id),className:"flex items-center gap-1 ".concat(null!==(r=a.likedBy)&&void 0!==r&&r.includes(null===v||void 0===v?void 0:v.id)?"text-red-500":"text-gray-500 hover:text-gray-700"),children:[(0,jt.jsx)("svg",{className:"w-4 h-4",fill:null!==(o=a.likedBy)&&void 0!==o&&o.includes(null===v||void 0===v?void 0:v.id)?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),(0,jt.jsx)("span",{children:a.likes||0})]}),!x&&(0,jt.jsx)("button",{onClick:()=>h(a),className:"text-gray-500 hover:text-gray-700",children:"Reply"}),x&&(0,jt.jsx)("button",{onClick:()=>c(a.id),className:"text-red-500 hover:text-red-700",children:"Delete"})]}),b&&(0,jt.jsx)(jl,{parentId:a.id,parentAuthorName:N(),draft:(null===u||void 0===u?void 0:u[a.id])||"",onChange:p,onSubmit:g,onCancel:m}),y.length>0&&(0,jt.jsx)("div",{className:"mt-3 border-l-2 border-gray-200 pl-4 space-y-3",children:y.map(e=>(0,jt.jsx)(kl,{reply:e,currentUser:v,onUserClick:n,onLikeClick:i,onDeleteClick:c,formatTime:C},e.id))})]})]})},Nl=t=>{let{comment:r,onCommentChange:o,onCommentSubmit:a,replyTo:s,onCancelReply:n,className:i=""}=t;const[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(!0);return(0,e.useEffect)(()=>{(async()=>{try{u(!0);const e=await(0,Lr.ou)();c(e)}catch(e){console.warn("[CommentInput] Failed to load avatar:",e),c(null)}finally{u(!1)}})()},[]),(0,jt.jsxs)("div",{className:"flex items-start space-x-3 mb-6 ".concat(i),children:[(0,jt.jsx)("img",{src:l||"/default-avatar.png",alt:"Your avatar",className:"w-10 h-10 rounded-full"}),(0,jt.jsxs)("div",{className:"flex-1",children:[s&&(0,jt.jsx)("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsx)("span",{className:"text-sm text-blue-700",children:"Replying to a comment"}),(0,jt.jsx)("button",{onClick:n,className:"text-blue-500 hover:text-blue-700 text-sm",children:"Cancel"})]})}),(0,jt.jsx)("textarea",{value:r,onChange:o,placeholder:s?"Write your reply...":"Add a comment...",className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-tag-blue focus:border-transparent",rows:"3"}),(0,jt.jsx)("div",{className:"flex justify-end mt-2",children:(0,jt.jsx)("button",{onClick:a,className:"px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-tag-dark-blue transition-colors duration-200",children:s?"Reply":"Post"})})]})]})},Cl=t=>{let{comments:r,comment:o,onCommentChange:a,onCommentSubmit:s,onCommentUserClick:n,onCommentLike:i,onCommentReply:l,onCommentDelete:c,replyingTo:d,replyDrafts:u,onStartReply:h,onCancelReply:m,onSetReplyDraft:p,onSubmitReply:g,replyTo:f,onCancelReplyOld:v,className:x=""}=t;const b=(0,e.useMemo)(()=>r.filter(e=>!e.parentId).sort((e,t)=>e.createdAt-t.createdAt),[r]);return(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 ".concat(x),children:[(0,jt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Comments (",r.length,")"]}),(0,jt.jsx)(Nl,{comment:o,onCommentChange:a,onCommentSubmit:s,replyTo:f,onCancelReply:v}),(0,jt.jsx)("div",{className:"space-y-4",children:b.map(e=>(0,jt.jsx)(Sl,{comment:e,comments:r,onUserClick:n,onLikeClick:i,onReplyClick:l,onDeleteClick:c,replyingTo:d,replyDrafts:u,onStartReply:h,onCancelReply:m,onSetReplyDraft:p,onSubmitReply:g},e.id))})]})},_l=e=>{let{author:t,isFollowing:r=!1,followersCount:o=0,onAuthorClick:a,onFollowClick:s,className:n=""}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 ".concat(n),children:[(0,jt.jsxs)(mt,{to:"/artist/".concat(t.id),className:"flex items-center mb-4 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors duration-200 block",children:[(0,jt.jsx)("img",{src:t.avatar,alt:t.name,className:"w-16 h-16 rounded-full mr-4"}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900 hover:text-tag-blue transition-colors duration-200",children:t.name}),(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:t.role})]})]}),(0,jt.jsxs)("div",{className:"flex justify-between mb-4 text-sm",children:[(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"font-semibold text-gray-900",children:t.works}),(0,jt.jsx)("div",{className:"text-gray-500",children:"Works"})]}),(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"font-semibold text-gray-900",children:o}),(0,jt.jsx)("div",{className:"text-gray-500",children:"Followers"})]}),(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"font-semibold text-gray-900",children:t.following}),(0,jt.jsx)("div",{className:"text-gray-500",children:"Following"})]})]}),(0,jt.jsx)("div",{className:"flex",children:(0,jt.jsx)("button",{onClick:s,className:"w-full px-4 py-2 rounded-lg transition-colors duration-200 ".concat(r?"bg-gray-500 text-white hover:bg-gray-600":"bg-tag-blue text-white hover:bg-tag-dark-blue"),children:r?"Following":"Follow"})})]})},Al=e=>{let{workData:t,className:r=""}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 mb-6 ".concat(r),children:[(0,jt.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:t.title}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:t.description}),(0,jt.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,jt.jsxs)("div",{className:"flex justify-between",children:[(0,jt.jsx)("span",{className:"text-gray-500",children:"Category:"}),(0,jt.jsx)("span",{className:"text-gray-900",children:t.category})]}),(0,jt.jsxs)("div",{className:"flex justify-between",children:[(0,jt.jsx)("span",{className:"text-gray-500",children:"Date:"}),(0,jt.jsx)("span",{className:"text-gray-900",children:t.date})]})]})]})},Il=e=>{let{relatedWorks:t,authorName:r,onAuthorClick:o,onWorkClick:a,loading:s=!1,className:n=""}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 ".concat(n),children:[(0,jt.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 cursor-pointer hover:text-tag-blue transition-colors duration-200",onClick:o,children:["More from ",r]}),s?(0,jt.jsx)("div",{className:"grid grid-cols-2 gap-2",children:[1,2,3,4].map(e=>(0,jt.jsx)("div",{className:"aspect-square rounded-lg bg-gray-200 animate-pulse"},e))}):t.length>0?(0,jt.jsx)("div",{className:"grid grid-cols-2 gap-2",children:t.map(e=>(0,jt.jsx)("div",{className:"aspect-square rounded-lg overflow-hidden cursor-pointer hover:opacity-80 transition-opacity duration-200",onClick:()=>a(e.id),children:(0,jt.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=200&h=200&fit=crop"}})},e.id))}):(0,jt.jsx)("div",{className:"text-center py-4",children:(0,jt.jsx)("p",{className:"text-gray-500 text-sm",children:"No other works available"})})]})},Pl=()=>{const[t,r]=(0,e.useState)(!1),[o,s]=(0,e.useState)(!1),[n,i]=(0,e.useState)(""),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)([]),[h,m]=(0,e.useState)(null),[p,g]=(0,e.useState)(null),[f,v]=(0,e.useState)({}),{id:x}=de(),[b,y]=(0,e.useState)(null),[w,j]=(0,e.useState)(!0),[k,S]=(0,e.useState)(null);return(0,e.useEffect)(()=>{(async()=>{if(!x)return S("No work ID provided"),void j(!1);try{j(!0),S(null);const e=await(async e=>{try{var t,r,o,a,s,n,i,l,c,d,u,h,m,p,g,f,v,x,b,y,w;console.log("[WorkDetail] Loading work data for ID: ".concat(e));const j=await vr.getWorkById(e);if(!j.success)return console.error("[WorkDetail] Failed to load work data:",j.error),null;const S=j.data;if(!S)return console.warn("[WorkDetail] Work not found with ID: ".concat(e)),null;console.log("[WorkDetail] Found work:",S);const N=(null===(t=S.author)||void 0===t?void 0:t.id)||(null===(r=S.profiles)||void 0===r?void 0:r.id)||S.userId;let C=null,_=null,A=null;if(N)try{const e=await vr.getUserWorks(N);e.success&&(A=e.data,console.log("[WorkDetail] Retrieved ".concat(A.length," works for ").concat(N)));const t=await po(N);t.success&&(_=t.data,console.log("[WorkDetail] Retrieved profile data for ".concat(N))),C=await pa(N),console.log("[WorkDetail] Retrieved author info for ".concat(N))}catch(k){console.warn("[WorkDetail] Failed to get author info for ".concat(N,":"),k)}const I={id:S.id,title:S.title||"Untitled",description:S.description||"",category:S.category||"Design",date:S.createdAt?new Date(S.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Unknown",likes:124,views:1247,tags:S.tags||[],mainImage:S.mainImageUrl||S.thumbnailPath||S.imagePaths&&S.imagePaths[0]||"",allImages:S.allImages||S.imagePaths||[],author:{id:N||"unknown",name:(null===(o=C)||void 0===o?void 0:o.name)||(null===(a=S.author)||void 0===a?void 0:a.name)||(null===(s=S.profiles)||void 0===s?void 0:s.full_name)||"Unknown Artist",role:(null===(n=C)||void 0===n?void 0:n.title)||(null===(i=S.author)||void 0===i?void 0:i.role)||S.category||"Design",avatar:(null===(l=C)||void 0===l?void 0:l.avatar)||(null===(c=S.author)||void 0===c?void 0:c.avatar)||(null===(d=S.profiles)||void 0===d?void 0:d.avatar_url)||"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",works:(null===(u=A)||void 0===u?void 0:u.length)||(null===(h=_)||void 0===h||null===(m=h.portfolio)||void 0===m?void 0:m.length)||(null===(p=C)||void 0===p||null===(g=p.works)||void 0===g?void 0:g.length)||0,followers:(null===(f=C)||void 0===f||null===(v=f.stats)||void 0===v||null===(x=v.followers)||void 0===x?void 0:x.toString())||"0",following:(null===(b=C)||void 0===b||null===(y=b.stats)||void 0===y||null===(w=y.following)||void 0===w?void 0:w.toString())||0},relatedWorks:[]};return console.log("[WorkDetail] Transformed work data:",I),console.log("[WorkDetail] Tags data:",I.tags),I}catch(k){return console.error("[WorkDetail] Error loading work data:",k),null}})(x);e?y(e):S("Work not found")}catch(e){console.error("Error loading work data:",e),S("Failed to load work data")}finally{j(!1)}})()},[x]),(0,e.useEffect)(()=>{window.scrollTo({top:0,behavior:"auto"})},[]),(0,e.useEffect)(()=>{if(!b)return;(async()=>{const e=((e,t)=>{var r,o;const a=[null===e||void 0===e?void 0:e.mainImage,null===e||void 0===e||null===(r=e.author)||void 0===r?void 0:r.avatar,...(null===e||void 0===e||null===(o=e.relatedWorks)||void 0===o?void 0:o.map(e=>e.image))||[],...(null===t||void 0===t?void 0:t.map(e=>e.avatar))||[]].filter(e=>"string"===typeof e&&(e.startsWith("data:image/")||e.startsWith("http")||e.startsWith("blob:")));return console.log("[WorkDetail] Preloading ".concat(a.length," images")),a})(b,d);await(async e=>{try{const t=e.filter(e=>e&&""!==e.trim()&&(e.startsWith("blob:")||e.startsWith("http")||e.startsWith("data:")));return 0===t.length?(console.log("[WorkDetail] No valid image URLs to preload"),!0):(console.log("[WorkDetail] Preloading ".concat(t.length," images:"),t),await Promise.all(t.map(e=>new Promise((t,r)=>{const o=new Image;o.onload=()=>{const r=e.split("/").pop()||e.substring(0,30);console.log("[WorkDetail] Preloaded: ".concat(r)),t()},o.onerror=r=>{const o=e.split("/").pop()||e.substring(0,30);console.warn("[WorkDetail] Failed to preload: ".concat(o)),t()},o.src=e}))),!0)}catch(k){return console.error("[WorkDetail] Failed to preload images:",k),!1}})(e);c(!0)})()},[d,b]),(0,e.useEffect)(()=>{if(!x)return;(async()=>{try{const e=await io.getWorkComments(x);e.success?u(e.data):console.error("[WorkDetail] Failed to load comments:",e.error)}catch(k){console.error("[WorkDetail] Error loading comments:",k)}})()},[x]),(0,e.useEffect)(()=>{if(null===b||void 0===b||!b.id)return;(async()=>{try{const e=await Rr.checkFavoriteStatus("work",b.id);e.success&&s(e.data.isFavorited)}catch(k){console.error("Failed to check favorite status:",k)}})()},[null===b||void 0===b?void 0:b.id]),{liked:t,saved:o,comment:n,imagesLoaded:l,comments:d,workData:b,loading:w,error:k,setLiked:r,setSaved:s,setComment:i,setImagesLoaded:c,setComments:u,setReplyTo:m,replyingTo:p,replyDrafts:f,setReplyingTo:g,setReplyDrafts:v,toggleLike:()=>{r(!t)},toggleSave:()=>{s(!o)},startReply:e=>{e&&g({parentId:e.id,parentAuthorId:e.authorId,parentAuthorName:e.authorName})},cancelReply:()=>{g(null)},setReplyDraft:(e,t)=>{v(r=>(0,a.A)((0,a.A)({},r),{},{[e]:t}))},addCommentOptimistic:e=>{u(t=>[...t,e])},replaceTempComment:e=>{let{tempId:t,saved:r}=e;u(e=>e.map(e=>e.id===t?r:e))},removeTempComment:e=>{u(t=>t.filter(t=>t.id!==e))},loadComments:async()=>{if(x)try{const e=await io.getWorkComments(x);e.success?u(e.data):console.error("[WorkDetail] Failed to reload comments:",e.error)}catch(k){console.error("[WorkDetail] Error reloading comments:",k)}},clearComment:()=>{i("")}}};function El(t){let{isOpen:r,onClose:o,onLoginSuccess:s}=t;const n=ce(),{login:i}=St(),[l,c]=(0,e.useState)({email:"",password:""}),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(""),p=e=>{const{name:t,value:r}=e.target;c(e=>(0,a.A)((0,a.A)({},e),{},{[t]:r}))};return(0,jt.jsx)(Mt,{isOpen:r,onClose:o,title:"Sign In Required",maxWidth:"max-w-sm",children:(0,jt.jsxs)("div",{className:"space-y-4",children:[(0,jt.jsx)("p",{className:"text-sm text-gray-600",children:"Please sign in to save favorites and access all features."}),(0,jt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0),m("");try{const e=await i(l.email,l.password);e.success?(console.log("[LoginModal] Login successful"),o(),s&&s()):(m(e.error||"Login failed"),console.error("[LoginModal] Login failed:",e.error))}catch(t){m("An unexpected error occurred"),console.error("[LoginModal] Login error:",t)}finally{u(!1)}},className:"space-y-4",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,jt.jsx)("input",{type:"email",id:"email",name:"email",value:l.email,onChange:p,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your email"})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,jt.jsx)("input",{type:"password",id:"password",name:"password",value:l.password,onChange:p,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your password"})]}),h&&(0,jt.jsx)("div",{className:"text-sm text-red-600 bg-red-50 p-2 rounded",children:h}),(0,jt.jsxs)("div",{className:"flex space-x-3",children:[(0,jt.jsx)("button",{type:"submit",disabled:d,className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Signing In...":"Sign In"}),(0,jt.jsx)("button",{type:"button",onClick:o,className:"px-4 py-2 text-gray-600 hover:text-gray-800 focus:outline-none",children:"Cancel"})]})]}),(0,jt.jsx)("div",{className:"text-center",children:(0,jt.jsxs)("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",(0,jt.jsx)("button",{type:"button",onClick:()=>{o(),n("/register")},className:"text-blue-600 hover:text-blue-800 focus:outline-none",children:"Sign up"})]})})]})})}const Dl=t=>{var r,o,a,s,n,i;let{state:l,setters:c}=t;const{goBack:d,navigateToArtist:u,navigateToWork:h}=Xo(),{user:m}=St(),[p,g]=(0,e.useState)(!1),[f,v]=(0,e.useState)(null),x=(0,e.useCallback)(()=>{d()},[d]),b=(0,e.useCallback)(()=>{c.toggleLike()},[c]),y=(0,e.useCallback)(async(e,t,r)=>{console.log("[Favorites] Save toggle payload:",{itemType:e,itemId:t,shouldFavorite:r});try{const o=await Rr.toggleFavorite(e,t,r);if(console.log("[Favorites] Save toggle result:",o),o.needAuth)return console.log("[Favorites] Authentication required, showing login modal"),v({itemType:e,itemId:t,shouldFavorite:r}),void g(!0);o.success?(c.toggleSave(),console.log("[Favorites] Save toggle successful")):console.error("[Favorites] Save toggle failed:",o.error)}catch(o){console.error("[Favorites] Failed to toggle favorite:",o)}},[c]),w=(0,e.useCallback)(async()=>{f&&(console.log("[Favorites] Retrying save action after login"),await y(f.itemType,f.itemId,f.shouldFavorite),v(null))},[f,y]),j=(0,e.useCallback)(()=>{g(!1),v(null)},[]),k=(0,e.useCallback)(async()=>{if(l.comment.trim())if(m)try{const t=await pa(m.id),r=(null===t||void 0===t?void 0:t.name)||m.name,o=await io.createComment(l.workData.id,m.id,r,l.comment.trim(),l.replyTo);if(o.success){if(console.log("[WorkDetail] Comment created successfully:",o.data),m.id!==l.workData.author.id)try{await Jr.createCommentNotification(m.id,r,l.workData.id,l.workData.title,l.workData.author.id,l.comment.trim()),console.log("[WorkDetail] Comment notification created successfully")}catch(e){console.warn("[WorkDetail] Failed to create comment notification:",e)}c.setComment(""),c.setReplyTo(null),c.loadComments()}else console.error("[WorkDetail] Failed to create comment:",o.error)}catch(t){console.error("[WorkDetail] Error creating comment:",t)}else console.warn("[WorkDetail] No current user found");else console.warn("[WorkDetail] Comment is empty")},[c,l.comment,null===(r=l.workData)||void 0===r?void 0:r.id,l.replyTo,null===(o=l.workData)||void 0===o||null===(a=o.author)||void 0===a?void 0:a.id,null===(s=l.workData)||void 0===s?void 0:s.title]),S=(0,e.useCallback)(async e=>{const t=(l.replyDrafts[e]||"").trim();if(!t)return;if(!m)return void console.warn("[WorkDetail] No current user found for reply");const r=l.comments.find(t=>t.id===e);if(!r)return void console.warn("[WorkDetail] Parent comment not found");const o=await pa(m.id),a=(null===o||void 0===o?void 0:o.name)||m.name,s="tmp_".concat(Date.now()),n={id:s,workId:r.workId,authorId:m.id,authorName:a,text:t,parentId:r.id,rootId:r.rootId||r.id,likes:0,replies:[],isDeleted:!1,createdAt:Date.now(),updatedAt:Date.now()};c.addCommentOptimistic(n);try{const o=await io.createComment(r.workId,m.id,a,t,r.id);o.success?(c.replaceTempComment({tempId:s,saved:o.data}),c.setReplyDraft(e,""),c.cancelReply(),console.log("[WorkDetail] Reply submitted successfully")):(c.removeTempComment(s),console.error("[WorkDetail] Failed to submit reply:",o.error))}catch(i){c.removeTempComment(s),console.error("[WorkDetail] Error submitting reply:",i)}},[c,l.replyDrafts,l.comments]),N=(0,e.useCallback)(e=>{c.startReply(e)},[c]),C=(0,e.useCallback)(()=>{c.cancelReply()},[c]),_=(0,e.useCallback)((e,t)=>{c.setReplyDraft(e,t)},[c]),A=(0,e.useCallback)(e=>{c.setComment(e.target.value)},[c]),I=(0,e.useCallback)(()=>{var e,t;const r=null===(e=l.workData)||void 0===e||null===(t=e.author)||void 0===t?void 0:t.id;r?(console.log("[WorkDetail] Navigating to artist: ".concat(r)),u(r,"gallery","Works")):console.warn("[WorkDetail] No author ID found for navigation")},[u,null===(n=l.workData)||void 0===n||null===(i=n.author)||void 0===i?void 0:i.id]),P=(0,e.useCallback)(e=>{u(e)},[u]),E=(0,e.useCallback)(e=>{e&&(console.log("[WorkDetail] Navigating to related work:",e),h(e))},[h]),D=(0,e.useCallback)(e=>{console.log("Image navigation:",e)},[]),L=(0,e.useCallback)(async e=>{if(m)try{const t=await io.likeComment(e,m.id);t.success?(console.log("[WorkDetail] Comment like toggled:",t.data),c.loadComments()):console.error("[WorkDetail] Failed to like comment:",t.error)}catch(t){console.error("[WorkDetail] Error liking comment:",t)}else console.warn("[WorkDetail] No current user found for comment like")},[c]),T=(0,e.useCallback)(e=>{c.setReplyTo(e),console.log("[WorkDetail] Reply to comment:",e)},[c]),M=(0,e.useCallback)(async e=>{if(m)try{const t=await io.deleteComment(e,m.id);t.success?(console.log("[WorkDetail] Comment deleted successfully"),c.loadComments()):console.error("[WorkDetail] Failed to delete comment:",t.error)}catch(t){console.error("[WorkDetail] Error deleting comment:",t)}else console.warn("[WorkDetail] No current user found for comment delete")},[c]);return{handleBackClick:x,handleAuthorClick:I,handleCommentUserClick:P,handleRelatedWorkClick:E,handleLikeClick:b,handleSaveClick:y,handleCommentSubmit:k,handleCommentChange:A,handleCommentLike:L,handleCommentReply:T,handleCommentDelete:M,handleCancelReply:C,handleImageNavigation:D,handleStartReply:N,handleSubmitReply:S,handleSetReplyDraft:_,isLoginModalOpen:p,handleLoginModalClose:j,handleLoginSuccess:w,LoginModalComponent:()=>(0,jt.jsx)(El,{isOpen:p,onClose:j,onLoginSuccess:w})}},Ll="tag_artwork_views",Tl="tag_user_fingerprint",Ml=()=>{let e=0;const t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,(new Date).getTimezoneOffset()].join("|");for(let r=0;r<t.length;r++){e=(e<<5)-e+t.charCodeAt(r),e&=e}return Math.abs(e).toString(36)},Fl=()=>{try{const e=localStorage.getItem(Ll);return e?JSON.parse(e):{}}catch(e){return console.warn("Failed to get stored view data:",e),{}}},Rl=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{userId:r=null,visitorFingerprint:o=null}=t;r&&o&&console.warn("[MockViewCount] Warning: Both userId and visitorFingerprint provided, using userId only");const a=Fl();a[e]||(a[e]={totalViews:0,userViews:[],visitorViews:[]});const s=a[e];let n=!1;return r?s.userViews.includes(r)?console.log("[MockViewCount] User already viewed: ".concat(r)):(s.userViews.push(r),s.totalViews++,n=!0,console.log("[MockViewCount] New user view recorded for user: ".concat(r))):o?s.visitorViews.includes(o)?console.log("[MockViewCount] Visitor already viewed: ".concat(o)):(s.visitorViews.push(o),s.totalViews++,n=!0,console.log("[MockViewCount] New visitor view recorded for fingerprint: ".concat(o))):console.warn("[MockViewCount] No userId or visitorFingerprint provided"),(e=>{try{localStorage.setItem(Ll,JSON.stringify(e))}catch(t){console.warn("Failed to save view data:",t)}})(a),console.log("[MockViewCount] ".concat(n?"New view recorded":"View already exists"," for artwork: ").concat(e)),{success:!0,viewCount:s.totalViews,isNewView:n}}catch(r){return console.error("[MockViewCount] Error recording view:",r),{success:!1,error:r.message}}},Ol=()=>(()=>{try{let e=localStorage.getItem(Tl);return e||(e=Ml(),localStorage.setItem(Tl,e)),e}catch(e){return console.warn("Failed to access localStorage for fingerprint:",e),Ml()}})(),Ul=()=>{try{const e=document.createElement("canvas"),t=e.getContext("2d"),r=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,screen.colorDepth,(new Date).getTimezoneOffset(),navigator.hardwareConcurrency||"",navigator.deviceMemory||"",navigator.platform,navigator.cookieEnabled,navigator.doNotTrack||"",window.devicePixelRatio||"",navigator.maxTouchPoints||""];t.textBaseline="top",t.font="14px Arial",t.fillText("User fingerprint",2,2);const o=e.toDataURL();r.push(o);const a=r.join("|");return zl(a)}catch(e){return console.warn("Failed to generate user fingerprint:",e),zl(Date.now().toString()+Math.random().toString())}},zl=e=>{let t=0;if(0===e.length)return t.toString();for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return Math.abs(t).toString(36)},Wl=()=>{const e="tag_user_fingerprint";try{let t=localStorage.getItem(e);return t||(t=Ul(),localStorage.setItem(e,t)),t}catch(t){return console.warn("Failed to access localStorage:",t),Ul()}},Bl=function(t){const{user:r}=St(),[o,a]=(0,e.useState)(0),[s,n]=(0,e.useState)(!1),[i,l]=(0,e.useState)(!1),c=!(null===r||void 0===r||!r.id),d=(0,e.useCallback)(async()=>{if(t)try{const e=await(0,wt.B)(),r=e?await(async e=>{try{const{data:t,error:r}=await wt.supabase.rpc("get_artwork_view_count",{p_artwork_id:e});return r?(console.error("Failed to get artwork view count:",r),{success:!1,error:r.message}):{success:!0,viewCount:("object"===typeof t&&null!==t?t.count:t)||0}}catch(t){return console.error("Error getting artwork view count:",t),{success:!1,error:t.message}}})(t):await(async e=>{try{const t=Fl()[e];return{success:!0,viewCount:t?t.totalViews:0}}catch(t){return console.error("[MockViewCount] Error getting view count:",t),{success:!1,error:t.message}}})(t);if(r.success){const t=r.count||r.viewCount||0;a(t),console.log("[ViewCount] Refreshed view count:",t,"(Mode: ".concat(e?"Supabase":"Mock",")"))}else console.error("[ViewCount] Failed to refresh view count:",r.error)}catch(e){console.error("[ViewCount] Error refreshing view count:",e)}},[t]),u=(0,e.useCallback)(async()=>{if(!t||s)return;const e=c?null===r||void 0===r?void 0:r.id:"visitor",o="hasRecorded_".concat(t,"_").concat(e);let i=!1;try{i="true"===localStorage.getItem(o)}catch(u){console.warn("[ViewCount] Failed to check recorded status:",u)}if(i)console.log("[ViewCount] Already recorded for user: ".concat(e," on artwork: ").concat(t));else try{n(!0);const s=await(0,wt.B)(),i={userId:c?r.id:null,visitorFingerprint:c?null:s?Wl():Ol(),userAgent:navigator.userAgent};c?i.visitorFingerprint=null:i.userId=null,console.log("[ViewCount] Recording view for artwork:",t,i,"(Mode: ".concat(s?"Supabase":"Mock",")")),console.log("[ViewCount] Current user info:",{isLoggedIn:c,userId:null===r||void 0===r?void 0:r.id,userName:null===r||void 0===r?void 0:r.name});const h=s?await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{const{userId:r=null,visitorFingerprint:o=null,ipAddress:a=null,userAgent:s=null}=t,{data:n,error:i}=await wt.supabase.rpc("increment_artwork_views",{p_artwork_id:e,p_user_id:r,p_visitor_fingerprint:o,p_ip_address:a,p_user_agent:s});if(i)return console.error("Failed to record artwork view:",i),{success:!1,error:i.message};if(n){const e=Array.isArray(n)?n[0]:n;return{success:e.success,viewCount:e.view_count||e.count,error:e.error_message}}return{success:!1,error:"No data returned from database function"}}catch(u){return console.error("Error recording artwork view:",u),{success:!1,error:u.message}}}(t,i):await Rl(t,i);if(h.success){a(h.viewCount),l(!0);try{localStorage.setItem(o,"true"),console.log("[ViewCount] Saved recorded status for ".concat(e," on ").concat(t))}catch(u){console.warn("[ViewCount] Failed to save recorded status:",u)}console.log("[ViewCount] View recorded successfully, new count:",h.viewCount,"(Mode: ".concat(s?"Supabase":"Mock",")")),s||(e=>{try{const t=Fl()[e];return t?(console.log("[Debug] View stats for artwork: ".concat(e)),console.log("  Total views: ".concat(t.totalViews)),console.log("  User views: ".concat(t.userViews.join(", "))),console.log("  Visitor views: ".concat(t.visitorViews.join(", "))),t):void console.log("[Debug] No view data for artwork: ".concat(e))}catch(u){console.error("[Debug] Error getting view stats:",u)}})(t),setTimeout(()=>{d()},100)}else console.error("[ViewCount] Failed to record view:",h.error)}catch(u){console.error("[ViewCount] Error recording view:",u)}finally{n(!1)}},[t,c,null===r||void 0===r?void 0:r.id,d,null===r||void 0===r?void 0:r.name,s]);return(0,e.useEffect)(()=>{t&&(d(),u())},[t,u,d]),(0,e.useEffect)(()=>{l(!1),n(!1)},[t,null===r||void 0===r?void 0:r.id]),{viewCount:o,isRecording:s,hasRecorded:i,recordView:u,refreshViewCount:d}},Gl=function(t){var r;let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{user:s}=St(),[n,i]=(0,e.useState)(o),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),h=!(null===s||void 0===s||!s.id),m=(0,e.useCallback)(async()=>{if(t&&h&&!d)try{u(!0),console.log("[LikeCount] Toggling like for artwork:",t,"User:",s.id);const o=await Ir(t,s.id);if(o.success){if(i(o.data.likes),c(o.data.liked),console.log("[LikeCount] Like toggled successfully:",o.data.liked?"Liked":"Unliked","Total likes:",o.data.likes),o.data.liked&&a)try{var e;const r=await po(s.id),o=r.success&&r.data.fullName?r.data.fullName:s.name||s.username||"Unknown User";await Jr.createLikeNotification(s.id,o,t,a.title||"Untitled",(null===(e=a.author)||void 0===e?void 0:e.id)||a.authorId),console.log("[LikeCount] Created like notification")}catch(r){console.error("[LikeCount] Failed to create like notification:",r)}console.log("[LikeCount] Debug: Artwork ".concat(t," total likes: ").concat(o.data.likes))}else console.error("[LikeCount] Failed to toggle like:",o.error)}catch(r){console.error("[LikeCount] Error toggling like:",r)}finally{u(!1)}},[t,h,null===s||void 0===s?void 0:s.id,null===a||void 0===a?void 0:a.title,null===a||void 0===a||null===(r=a.author)||void 0===r?void 0:r.id,null===a||void 0===a?void 0:a.authorId,d,a]),p=(0,e.useCallback)(async()=>{if(t&&h)try{const e=await Pr(t,s.id);e.success?(i(e.data.likes),c(e.data.liked),console.log("[LikeCount] Refreshed like status:",e.data.liked?"Liked":"Not liked","Total likes:",e.data.likes)):console.error("[LikeCount] Failed to refresh like status:",e.error)}catch(e){console.error("[LikeCount] Error refreshing like status:",e)}},[t,h,null===s||void 0===s?void 0:s.id,null===s||void 0===s?void 0:s.name,null===s||void 0===s?void 0:s.username]),g=(0,e.useCallback)(async()=>{if(t)try{const e=await Er(t);e.success?(i(e.data.likes),console.log("[LikeCount] Refreshed like count:",e.data.likes)):console.error("[LikeCount] Failed to refresh like count:",e.error)}catch(e){console.error("[LikeCount] Error refreshing like count:",e)}},[t]);return(0,e.useEffect)(()=>{t&&h&&p()},[t,h,p]),(0,e.useEffect)(()=>{c(!1),u(!1)},[t,null===s||void 0===s?void 0:s.id]),{likeCount:n,isLiked:l,isToggling:d,toggleLike:m,refreshLikeStatus:p,refreshLikeCount:g}},Hl=t=>{const r=ce(),[o,a]=(0,e.useState)([]),[s,n]=(0,e.useState)(-1),[i,l]=(0,e.useState)(!0),[c,d]=(0,e.useState)(null),u=(0,e.useCallback)(async()=>{try{l(!0),d(null);const e=await vr.getAllPublicWorks();if(e.success&&e.data){const r=e.data.sort((e,t)=>{const r=new Date(e.createdAt||e.date||0);return new Date(t.createdAt||t.date||0)-r});a(r);const o=r.findIndex(e=>e.id===t);n(o),console.log("[WorkNavigation] Loaded ".concat(r.length," works, current index: ").concat(o))}else d("Failed to load works")}catch(e){console.error("[WorkNavigation] Error loading works:",e),d("Failed to load works")}finally{l(!1)}},[t]);(0,e.useEffect)(()=>{t&&u()},[t,u]);const h=(0,e.useCallback)(()=>{if(0===o.length||-1===s)return;let e;e=0===s?o.length-1:s-1;const t=o[e];t&&(console.log("[WorkNavigation] Navigating to previous work: ".concat(t.id)),r("/work/".concat(t.id)))},[o,s,r]),m=(0,e.useCallback)(()=>{if(0===o.length||-1===s)return;let e;e=s===o.length-1?0:s+1;const t=o[e];t&&(console.log("[WorkNavigation] Navigating to next work: ".concat(t.id)),r("/work/".concat(t.id)))},[o,s,r]);return(0,e.useEffect)(()=>{const e=e=>{"ArrowLeft"===e.key?(e.preventDefault(),h()):"ArrowRight"===e.key&&(e.preventDefault(),m())};return document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[h,m]),{allWorks:o,currentIndex:s,loading:i,error:c,hasPrevious:o.length>0&&s>0,hasNext:o.length>0&&s<o.length-1,totalWorks:o.length,currentWorkNumber:s>=0?s+1:0,navigateToPrevious:h,navigateToNext:m,reloadWorks:u}},ql=function(t,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;const[a,s]=(0,e.useState)([]),[n,i]=(0,e.useState)(!0),[l,c]=(0,e.useState)(null),d=(0,e.useCallback)(async()=>{if(!t)return s([]),void i(!1);try{i(!0),c(null);const e=await vr.getUserWorks(t);if(e.success&&e.data){const a=e.data.filter(e=>e.id!==r);if(0===a.length)return void s([]);const n=[...a].sort(()=>.5-Math.random()).slice(0,Math.min(o,a.length)),i=await Promise.all(n.map(async e=>{const t=e.thumbnailPath||e.imagePaths&&e.imagePaths[0]||null;let r="";if(t)try{console.log("[RelatedWorks] Converting image path: ".concat(t));const e=await(0,sr.getPortfolioImageUrl)(t);console.log("[RelatedWorks] Image conversion result:",e),e&&e.success&&e.data&&e.data.url?(r=e.data.url,console.log("[RelatedWorks] Successfully converted to: ".concat(r))):console.warn("[RelatedWorks] Invalid image result:",e)}catch(l){console.warn("[RelatedWorks] Failed to convert image path ".concat(t,":"),l)}return{id:e.id,title:e.title||"Untitled",image:r,category:e.category||"Design"}}));s(i),console.log("[RelatedWorks] Loaded ".concat(i.length," related works for artist ").concat(t))}else c("Failed to load related works"),s([])}catch(e){console.error("[RelatedWorks] Error loading related works:",e),c("Failed to load related works"),s([])}finally{i(!1)}},[t,r,o]);return(0,e.useEffect)(()=>{d()},[d]),{relatedWorks:a,loading:n,error:l,reloadWorks:d}},Vl=()=>{var e,t,r,o,s,n,i,l,c,d,u,h,m,p;const{state:g}=Go(),f=Pl(),v=Dl({state:f,setters:{toggleLike:f.toggleLike,toggleSave:f.toggleSave,setComment:f.setComment,setReplyTo:f.setReplyTo,loadComments:f.loadComments,startReply:f.startReply,cancelReply:f.cancelReply,setReplyDraft:f.setReplyDraft,addCommentOptimistic:f.addCommentOptimistic,replaceTempComment:f.replaceTempComment,removeTempComment:f.removeTempComment}}),x=Bl((null===(e=f.workData)||void 0===e?void 0:e.id)||null,(null===(t=f.workData)||void 0===t?void 0:t.views)||0),b=Gl((null===(r=f.workData)||void 0===r?void 0:r.id)||null,(null===(o=f.workData)||void 0===o?void 0:o.likes)||0,f.workData||{}),y=Ea((null===(s=f.workData)||void 0===s||null===(n=s.author)||void 0===n?void 0:n.id)||null,(null===(i=f.workData)||void 0===i||null===(l=i.author)||void 0===l?void 0:l.followers)||0),w=Da((null===(c=f.workData)||void 0===c||null===(d=c.author)||void 0===d?void 0:d.id)||null),j=Hl((null===(u=f.workData)||void 0===u?void 0:u.id)||null),k=ql((null===(h=f.workData)||void 0===h||null===(m=h.author)||void 0===m?void 0:m.id)||null,(null===(p=f.workData)||void 0===p?void 0:p.id)||null,4),S=(e=>{if(!e)return{isValid:!1,error:"Work data is null or undefined",fallbackData:ml()};const t=["id","title","author"].filter(t=>!e[t]);return t.length>0?{isValid:!1,error:"Missing required fields: ".concat(t.join(", ")),fallbackData:ml()}:e.author&&"object"===typeof e.author?{isValid:!0,error:null,fallbackData:null}:{isValid:!1,error:"Author data is invalid",fallbackData:ml()}})(f.workData),N=S.isValid?f.workData:S.fallbackData;return f.loading?(0,jt.jsx)(Wt,{}):f.error?(0,jt.jsx)("main",{className:"max-w-7xl mx-auto pt-4 px-4 bg-gray-50 min-h-screen",children:(0,jt.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:f.error}),(0,jt.jsx)("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-blue-600",children:"Go Back"})]})})}):f.workData?g.isLoading||!f.imagesLoaded?(0,jt.jsx)(Wt,{}):(0,jt.jsx)("main",{className:"max-w-7xl mx-auto pt-4 px-4 bg-gray-50 min-h-screen",children:(0,jt.jsxs)("div",{className:"flex flex-col lg:flex-row gap-8 py-0",children:[(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)(vl,{workData:N,onBackClick:v.handleBackClick,onImageNavigation:v.handleImageNavigation,navigationState:j}),(0,jt.jsx)(wl,{workData:(0,a.A)((0,a.A)({},N),{},{views:x.viewCount,likes:b.likeCount}),isLiked:b.isLiked,isSaved:f.saved,onLikeClick:b.toggleLike,onSaveClick:v.handleSaveClick}),(0,jt.jsx)(Cl,{comments:f.comments,comment:f.comment,onCommentChange:v.handleCommentChange,onCommentSubmit:v.handleCommentSubmit,onCommentUserClick:v.handleCommentUserClick,onCommentLike:v.handleCommentLike,onCommentReply:v.handleCommentReply,onCommentDelete:v.handleCommentDelete,replyingTo:f.replyingTo,replyDrafts:f.replyDrafts,onStartReply:v.handleStartReply,onCancelReply:v.handleCancelReply,onSetReplyDraft:v.handleSetReplyDraft,onSubmitReply:v.handleSubmitReply,replyTo:f.replyTo,onCancelReplyOld:v.handleCancelReply})]}),(0,jt.jsxs)("div",{className:"lg:w-80 flex-shrink-0",children:[(0,jt.jsx)(_l,{author:(0,a.A)((0,a.A)({},N.author),{},{following:w.followingCount}),isFollowing:y.isFollowing,followersCount:y.followersCount,onAuthorClick:v.handleAuthorClick,onFollowClick:y.toggleFollow}),(0,jt.jsx)(Al,{workData:N}),(0,jt.jsx)(Il,{relatedWorks:k.relatedWorks,authorName:N.author.name,onAuthorClick:v.handleAuthorClick,onWorkClick:v.handleRelatedWorkClick,loading:k.loading})]})]})}):(0,jt.jsx)("main",{className:"max-w-7xl mx-auto pt-4 px-4 bg-gray-50 min-h-screen",children:(0,jt.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Work Not Found"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:"The requested work could not be found."}),(0,jt.jsx)("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-tag-blue text-white rounded-lg hover:bg-blue-600",children:"Go Back"})]})})})},Jl=t=>{let{onLoginSuccess:r}=t;const[o,a]=(0,e.useState)(""),[s,n]=(0,e.useState)(""),[i,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(!1),u="shuwang09",h="139680";return(0,jt.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md w-full",children:[(0,jt.jsxs)("div",{className:"text-center mb-8",children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"\ud83d\udd10 \u7ba1\u7406\u5458\u767b\u5f55"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"\u8bf7\u8f93\u5165\u7ba1\u7406\u5458\u51ed\u636e\u4ee5\u8bbf\u95ee\u7ba1\u7406\u9762\u677f"})]}),(0,jt.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(""),d(!0),await new Promise(e=>setTimeout(e,500));try{if(o===u&&s===h){const e={isAuthenticated:!0,username:o,loginTime:(new Date).toISOString(),token:"admin_auth_"+Date.now(),userAgent:navigator.userAgent,loginIP:"local",sessionId:Math.random().toString(36).substring(2)};localStorage.setItem("admin_auth_data",JSON.stringify(e)),console.log("[Admin Login] \u7ba1\u7406\u5458 ".concat(o," \u767b\u5f55\u6210\u529f - ").concat((new Date).toLocaleString())),r(e)}else l("\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef"),console.warn("[Admin Login] \u767b\u5f55\u5931\u8d25\u5c1d\u8bd5 - \u7528\u6237\u540d: ".concat(o," - ").concat((new Date).toLocaleString()))}catch(i){l("\u767b\u5f55\u8fc7\u7a0b\u4e2d\u53d1\u751f\u9519\u8bef"),console.error("[Admin Login] \u767b\u5f55\u9519\u8bef:",i)}finally{d(!1)}},className:"space-y-6",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"\u7528\u6237\u540d"}),(0,jt.jsx)("input",{id:"username",type:"text",value:o,onChange:e=>a(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",required:!0})]}),(0,jt.jsxs)("div",{children:[(0,jt.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"\u5bc6\u7801"}),(0,jt.jsx)("input",{id:"password",type:"password",value:s,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",required:!0})]}),i&&(0,jt.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:(0,jt.jsx)("p",{className:"text-red-600 text-sm",children:i})}),(0,jt.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?(0,jt.jsxs)("div",{className:"flex items-center justify-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"\u767b\u5f55\u4e2d..."]}):"\u767b\u5f55"})]}),(0,jt.jsx)("div",{className:"mt-6 text-center",children:(0,jt.jsx)("p",{className:"text-xs text-gray-500",children:"\u26a0\ufe0f \u6b64\u9875\u9762\u4ec5\u4f9b\u7ba1\u7406\u5458\u4f7f\u7528\uff0c\u8bf7\u52ff\u6cc4\u9732\u51ed\u636e"})})]})})},Zl=e=>{let{isOpen:t,onClose:r,onConfirm:o,title:a,message:s,confirmText:n="\u786e\u8ba4",cancelText:i="\u53d6\u6d88",type:l="danger"}=e;if(!t)return null;const c=(()=>{switch(l){case"danger":return{icon:"\u26a0\ufe0f",bgColor:"bg-red-50",borderColor:"border-red-200",iconColor:"text-red-600",buttonColor:"bg-red-600 hover:bg-red-700"};case"warning":return{icon:"\u26a0\ufe0f",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",iconColor:"text-yellow-600",buttonColor:"bg-yellow-600 hover:bg-yellow-700"};case"info":return{icon:"\u2139\ufe0f",bgColor:"bg-blue-50",borderColor:"border-blue-200",iconColor:"text-blue-600",buttonColor:"bg-blue-600 hover:bg-blue-700"};default:return{icon:"\u2753",bgColor:"bg-gray-50",borderColor:"border-gray-200",iconColor:"text-gray-600",buttonColor:"bg-gray-600 hover:bg-gray-700"}}})();return(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e=>{e.target===e.currentTarget&&r()},children:(0,jt.jsxs)("div",{className:"".concat(c.bgColor," border ").concat(c.borderColor," rounded-lg shadow-xl max-w-md w-full mx-4"),children:[(0,jt.jsxs)("div",{className:"flex items-center p-4 border-b border-gray-200",children:[(0,jt.jsx)("span",{className:"text-2xl mr-3 ".concat(c.iconColor),children:c.icon}),(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a})]}),(0,jt.jsx)("div",{className:"p-4",children:(0,jt.jsx)("p",{className:"text-gray-700 whitespace-pre-wrap",children:s})}),(0,jt.jsxs)("div",{className:"flex justify-end space-x-3 p-4 border-t border-gray-200",children:[(0,jt.jsx)("button",{onClick:()=>{r()},className:"px-4 py-2 text-gray-700 bg-gray-200 hover:bg-gray-300 rounded transition-colors",children:i}),(0,jt.jsx)("button",{onClick:()=>{o(),r()},className:"px-4 py-2 text-white ".concat(c.buttonColor," rounded transition-colors"),children:n})]})]})})},Kl=e=>{let{authData:t,onLogout:r}=e;return(0,jt.jsx)("div",{className:"bg-red-600 text-white p-4",children:(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto flex justify-between items-center",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-2xl font-bold",children:"\ud83d\udd27 \u8d85\u7ea7\u7ba1\u7406\u5458\u6d4b\u8bd5\u9762\u677f"}),(0,jt.jsx)("p",{className:"text-red-100",children:"\u5177\u6709\u6700\u9ad8\u6743\u9650\u7684\u6570\u636e\u7ba1\u7406\u5de5\u5177"})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,jt.jsxs)("span",{className:"text-red-100",children:["\u6b22\u8fce\uff0c",(null===t||void 0===t?void 0:t.username)||"\u7ba1\u7406\u5458"]}),(0,jt.jsx)("button",{onClick:r,className:"bg-red-700 hover:bg-red-800 text-white px-4 py-2 rounded transition-colors",children:"\ud83d\udeaa \u9000\u51fa\u767b\u5f55"})]})]})})},Yl=e=>{let{selectedItems:t,sortedItems:r,toggleSelectAll:o,handleDeleteSelected:a}=e;return(0,jt.jsx)("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,jt.jsxs)("label",{className:"flex items-center",children:[(0,jt.jsx)("input",{type:"checkbox",checked:t.length===r.length&&r.length>0,onChange:o,className:"mr-2"}),"\u5168\u9009"]}),(0,jt.jsxs)("span",{className:"text-sm text-gray-600",children:["\u5df2\u9009\u62e9 ",t.length," \u9879"]})]}),(0,jt.jsxs)("button",{onClick:a,disabled:0===t.length,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:["\ud83d\uddd1\ufe0f \u5220\u9664\u9009\u4e2d (",t.length,")"]})]})})},Ql=e=>{let{items:t,selectedItems:r,toggleItemSelection:o,viewMode:a}=e;return 0===t.length?(0,jt.jsx)("div",{className:"p-8 text-center text-gray-500",children:"\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u9879\u76ee"}):"table"===a?(0,jt.jsx)("div",{className:"overflow-x-auto",children:(0,jt.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,jt.jsx)("thead",{className:"bg-gray-50",children:(0,jt.jsxs)("tr",{children:[(0,jt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\u9009\u62e9"}),(0,jt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\u6807\u9898"}),(0,jt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\u521b\u5efa\u8005"}),(0,jt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\u521b\u5efa\u65f6\u95f4"}),(0,jt.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"\u5927\u5c0f"})]})}),(0,jt.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(e=>(0,jt.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,jt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,jt.jsx)("input",{type:"checkbox",checked:r.includes(e.id),onChange:()=>o(e.id),className:"mr-2"})}),(0,jt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.title}),(0,jt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.creator}),(0,jt.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.createdAt}),(0,jt.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.size," B"]})]},e.id))})]})}):(0,jt.jsx)("div",{className:"divide-y divide-gray-200",children:t.map(e=>(0,jt.jsxs)("div",{className:"p-4 hover:bg-gray-50 flex items-center space-x-4",children:[(0,jt.jsx)("input",{type:"checkbox",checked:r.includes(e.id),onChange:()=>o(e.id),className:"mr-2"}),(0,jt.jsx)("div",{className:"flex-1 min-w-0",children:(0,jt.jsx)("div",{className:"flex items-center justify-between",children:(0,jt.jsxs)("div",{className:"flex-1",children:[(0,jt.jsx)("h4",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),(0,jt.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,jt.jsxs)("span",{children:["\u521b\u5efa\u8005: ",e.creator]}),(0,jt.jsxs)("span",{children:["\u65f6\u95f4: ",e.createdAt]}),(0,jt.jsxs)("span",{children:["\u5927\u5c0f: ",e.size," B"]})]})]})})})]},e.id))})},$l=e=>{let{dataType:t,totalItems:r,searchTerm:o,setSearchTerm:a,sortBy:s,setSortBy:n,sortOrder:i,toggleSortOrder:l,viewMode:c,toggleViewMode:d}=e;return(0,jt.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,jt.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,jt.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:(()=>{switch(t){case"collaborations":return"\u534f\u4f5c\u9879\u76ee\u6570\u636e\u7ba1\u7406";case"portfolios":return"\u4f5c\u54c1\u6570\u636e\u7ba1\u7406";case"comments":return"\u8bc4\u8bba\u6570\u636e\u7ba1\u7406";case"notifications":return"\u901a\u77e5\u6570\u636e\u7ba1\u7406";case"likes":return"\u70b9\u8d5e\u6570\u636e\u7ba1\u7406";case"views":return"\u6d4f\u89c8\u7edf\u8ba1\u6570\u636e\u7ba1\u7406";case"drafts":return"\u534f\u4f5c\u8349\u7a3f\u6570\u636e\u7ba1\u7406";default:return"\u6570\u636e\u7ba1\u7406"}})()}),(0,jt.jsxs)("span",{className:"text-sm text-gray-500",children:["\u5171 ",r," \u4e2a\u9879\u76ee"]})]}),(0,jt.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,jt.jsx)("input",{type:"text",placeholder:"\u641c\u7d22\u9879\u76ee...",value:o,onChange:e=>a(e.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm"}),(0,jt.jsxs)("select",{value:s,onChange:e=>n(e.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm",children:[(0,jt.jsx)("option",{value:"title",children:"\u6309\u6807\u9898"}),(0,jt.jsx)("option",{value:"creator",children:"\u6309\u521b\u5efa\u8005"}),(0,jt.jsx)("option",{value:"createdAt",children:"\u6309\u65f6\u95f4"}),(0,jt.jsx)("option",{value:"size",children:"\u6309\u5927\u5c0f"})]}),(0,jt.jsx)("button",{onClick:l,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50",children:"asc"===i?"\u2191":"\u2193"}),(0,jt.jsx)("button",{onClick:d,className:"px-3 py-1 border border-gray-300 rounded text-sm hover:bg-gray-50",children:"list"===c?"\ud83d\udccb \u8868\u683c":"\ud83d\udcdd \u5217\u8868"})]})]})})},Xl=(e,t,r)=>{var o,a,s,n,i,l;const c={title:"\u9879\u76ee ".concat(r+1),creator:"\u672a\u77e5",createdAt:"\u672a\u77e5",size:0};if(!e||"object"!==typeof e)return c;switch(t){case"collaborations":return{title:e.title||e.name||e.collaborationTitle||"\u534f\u4f5c\u9879\u76ee ".concat(r+1),creator:(null===(o=e.author)||void 0===o?void 0:o.name)||(null===(a=e.author)||void 0===a?void 0:a.id)||e.creator||e.owner||e.userId||e.createdBy||"\u672a\u77e5",createdAt:e.createdAt||e.createdDate||e.date||"\u672a\u77e5",size:JSON.stringify(e).length};case"portfolios":return{title:e.title||e.name||e.workTitle||"\u4f5c\u54c1 ".concat(r+1),creator:(null===(s=e.author)||void 0===s?void 0:s.name)||e.artist||e.creator||e.userId||"\u672a\u77e5",createdAt:e.createdAt||e.uploadDate||e.date||"\u672a\u77e5",size:JSON.stringify(e).length};case"comments":return{title:e.text||e.content?(e.text||e.content).substring(0,30)+"...":"\u8bc4\u8bba ".concat(r+1),creator:e.authorName||(null===(n=e.author)||void 0===n?void 0:n.name)||e.author||e.userId||e.commenter||"\u672a\u77e5",createdAt:e.createdAt||e.commentDate||e.date||"\u672a\u77e5",size:JSON.stringify(e).length};case"notifications":return{title:e.title||e.message||e.content||"\u901a\u77e5 ".concat(r+1),creator:e.senderName||(null===(i=e.sender)||void 0===i?void 0:i.name)||e.senderId||e.userId||"\u672a\u77e5",createdAt:e.createdAt||e.date||"\u672a\u77e5",size:JSON.stringify(e).length};case"likes":return{title:e.workTitle||e.title||e.artworkTitle||"\u70b9\u8d5e\u8bb0\u5f55 ".concat(r+1),creator:e.userName||(null===(l=e.user)||void 0===l?void 0:l.name)||e.userId||e.likerId||"\u672a\u77e5",createdAt:e.createdAt||e.likedAt||e.date||"\u672a\u77e5",size:JSON.stringify(e).length};case"views":var d,u;return"object"===typeof e&&void 0!==e.totalViews?{title:"\u4f5c\u54c1\u6d4f\u89c8\u7edf\u8ba1 (ID: ".concat(r+1,")"),creator:"\u603b\u6d4f\u89c8\u91cf: ".concat(e.totalViews),createdAt:"\u767b\u5f55\u7528\u6237: ".concat((null===(d=e.userViews)||void 0===d?void 0:d.length)||0,", \u8bbf\u5ba2: ").concat((null===(u=e.visitorViews)||void 0===u?void 0:u.length)||0),size:JSON.stringify(e).length}:{title:"\u6d4f\u89c8\u8bb0\u5f55 ".concat(r+1),creator:"\u7edf\u8ba1\u6570\u636e",createdAt:"N/A",size:JSON.stringify(e).length};case"drafts":var h;return{title:e.title||e.draftTitle||e.name||e.projectTitle||e.collaborationTitle||"\u8349\u7a3f ".concat(r+1),creator:e.userId||(null===(h=e.author)||void 0===h?void 0:h.name)||e.author||e.creator||e.owner||"\u672a\u77e5",createdAt:e.createdAt||e.updatedAt||e.date||"\u672a\u77e5",size:JSON.stringify(e).length};default:return{title:e.title||e.name||"\u9879\u76ee ".concat(r+1),creator:e.creator||e.author||"\u672a\u77e5",createdAt:e.createdAt||e.date||"\u672a\u77e5",size:JSON.stringify(e).length}}},ec=t=>{const[r,o]=(0,e.useState)([]),[s,n]=(0,e.useState)(!0),[i,l]=(0,e.useState)(null),c=(0,e.useCallback)(()=>{try{n(!0),l(null);const e=(e=>{const t=Object.keys(localStorage);let r=[];switch(e){case"collaborations":r=t.filter(e=>e.toLowerCase().includes("collaboration")&&!e.includes("draft"));break;case"portfolios":r=t.filter(e=>e.startsWith("portfolio_"));break;case"comments":r=t.filter(e=>e.includes("comment"));break;case"notifications":r=t.filter(e=>e.includes("notification"));break;case"likes":r=t.filter(e=>e.includes("like"));break;case"views":r=t.filter(e=>e.includes("view"));break;case"drafts":r=t.filter(e=>e.includes("draft"));break;default:r=t}return r})(t),r=((e,t)=>e.map(e=>{const r=localStorage.getItem(e);let o=null,s=0,n="",l=[];try{if(o=JSON.parse(r),Array.isArray(o))s=o.length,n="\u6570\u7ec4\uff0c\u5305\u542b ".concat(s," \u9879"),l=o.map((r,o)=>{const s=Xl(r,t,o);return(0,a.A)((0,a.A)({id:r.id||r.collaborationId||"item_".concat(o),groupKey:e},s),{},{rawData:r})});else if("object"===typeof o)if(s=Object.keys(o).length,n="\u5bf9\u8c61\uff0c\u5305\u542b ".concat(s," \u4e2a\u5c5e\u6027"),"drafts"===t&&e.includes("draft")){const r=[];Object.entries(o).forEach(o=>{let[s,n]=o;Array.isArray(n)&&n.forEach((o,n)=>{const i=Xl(o,t,n);r.push((0,a.A)((0,a.A)({id:o.id||"draft_".concat(s,"_").concat(n),groupKey:e},i),{},{rawData:o,userId:s,title:"".concat(i.title," (\u7528\u6237: ").concat(s,")")}))})}),l=r}else l=Object.entries(o).map((r,o)=>{let[s,n]=r;const i=Xl(n,t,o);return(0,a.A)((0,a.A)({id:s||"item_".concat(o),groupKey:e},i),{},{rawData:n})});else n="\u7b80\u5355\u6570\u636e: ".concat(typeof o),l=[{id:e,groupKey:e,title:e,creator:"\u7cfb\u7edf",createdAt:"\u672a\u77e5",size:JSON.stringify(o).length,rawData:o}]}catch(i){console.error("\u89e3\u6790\u6570\u636e\u5931\u8d25:",e,i),n="\u89e3\u6790\u5931\u8d25",l=[{id:e,groupKey:e,title:e,creator:"\u89e3\u6790\u5931\u8d25",createdAt:"\u672a\u77e5",size:0,rawData:null}]}return{key:e,preview:n,itemCount:s,items:l}}))(e,t);o(r)}catch(e){console.error("\u52a0\u8f7d\u6570\u636e\u5217\u8868\u5931\u8d25:",e),l(e.message)}finally{n(!1)}},[t]),d=(0,e.useCallback)(()=>{c()},[c]);return(0,e.useEffect)(()=>{c()},[c]),{dataList:r,loading:s,error:i,reloadData:d}},tc=t=>{let{dataType:r,onDeleteSelected:o}=t;const{dataList:a,loading:s,error:n,reloadData:i}=ec(r),{searchTerm:l,setSearchTerm:c,sortBy:d,setSortBy:u,sortOrder:h,toggleSortOrder:m,viewMode:p,toggleViewMode:g,allItems:f,sortedItems:v}=(t=>{const[r,o]=(0,e.useState)(""),[a,s]=(0,e.useState)("title"),[n,i]=(0,e.useState)("asc"),[l,c]=(0,e.useState)("list"),d=(0,e.useMemo)(()=>t.flatMap(e=>e.items||[]),[t]),u=(0,e.useMemo)(()=>{let e=d;if(r.trim()){const t=r.toLowerCase();e=e.filter(e=>{var r,o,a;return(null===(r=e.title)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(o=e.creator)||void 0===o?void 0:o.toLowerCase().includes(t))||(null===(a=e.createdAt)||void 0===a?void 0:a.toLowerCase().includes(t))})}return e.sort((e,t)=>{let r=e[a],o=t[a];return"size"===a?(r=parseInt(r)||0,o=parseInt(o)||0):(r=String(r||"").toLowerCase(),o=String(o||"").toLowerCase()),"asc"===n?r>o?1:-1:r<o?1:-1}),e},[d,r,a,n]);return{searchTerm:r,setSearchTerm:o,sortBy:a,setSortBy:s,sortOrder:n,setSortOrder:i,viewMode:l,setViewMode:c,allItems:d,sortedItems:u,toggleSortOrder:()=>{i(e=>"asc"===e?"desc":"asc")},toggleViewMode:()=>{c(e=>"list"===e?"table":"list")}}})(a),{selectedItems:x,showConfirmDialog:b,toggleItemSelection:y,toggleSelectAll:w,handleDeleteSelected:j,confirmDelete:k,cancelDelete:S}=((t,r,o)=>{const[a,s]=(0,e.useState)([]),[i,l]=(0,e.useState)(!1),c=(0,e.useCallback)(e=>{s(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},[]),d=(0,e.useCallback)(()=>{a.length===t.length&&t.length>0?s([]):s(t.map(e=>e.id))},[a.length,t]),u=(0,e.useCallback)(()=>{a.length>0&&l(!0)},[a.length]),h=(0,e.useCallback)(()=>{a.length>0&&(a.map(e=>({groupKey:t.find(t=>t.id===e).groupKey,itemId:e})).forEach(e=>{let{groupKey:t,itemId:r}=e;try{const e=JSON.parse(localStorage.getItem(t));if(t.includes("draft")&&"object"===typeof e){let o=!1;Object.keys(e).forEach(t=>{const a=e[t];if(Array.isArray(a)){const s=a.length,n=a.filter(e=>e.id!==r);n.length<s&&(e[t]=n,o=!0,console.log("\u5220\u9664\u4e86\u7528\u6237 ".concat(t," \u7684\u8349\u7a3f ").concat(r)))}}),o&&localStorage.setItem(t,JSON.stringify(e))}else if(Array.isArray(e)){const o=e.filter(e=>(e.id||e.collaborationId)!==r);localStorage.setItem(t,JSON.stringify(o))}}catch(n){console.error("Error deleting item:",n)}}),o&&o(),s([]),r&&r(a.length)),l(!1)},[a,r,o,t]),m=(0,e.useCallback)(()=>{l(!1)},[]),p=(0,e.useCallback)(()=>{s([])},[]);return{selectedItems:a,showConfirmDialog:i,toggleItemSelection:c,toggleSelectAll:d,handleDeleteSelected:u,confirmDelete:h,cancelDelete:m,clearSelection:p}})(v,o,i);return s?(0,jt.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,jt.jsx)("div",{className:"p-8 text-center text-gray-500",children:"\u52a0\u8f7d\u4e2d..."})}):n?(0,jt.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,jt.jsxs)("div",{className:"p-8 text-center text-red-500",children:["\u52a0\u8f7d\u5931\u8d25: ",n]})}):(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,jt.jsx)($l,{dataType:r,totalItems:f.length,searchTerm:l,setSearchTerm:c,sortBy:d,setSortBy:u,sortOrder:h,toggleSortOrder:m,viewMode:p,toggleViewMode:g}),(0,jt.jsx)(Yl,{selectedItems:x,sortedItems:v,toggleSelectAll:w,handleDeleteSelected:j}),(0,jt.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,jt.jsx)(Ql,{items:v,selectedItems:x,toggleItemSelection:y,viewMode:p})}),(0,jt.jsx)(Zl,{isOpen:b,onClose:S,onConfirm:k,title:"\u786e\u8ba4\u5220\u9664",message:"\u786e\u5b9a\u8981\u5220\u9664\u9009\u4e2d\u7684 ".concat(x.length," \u4e2a\u9879\u76ee\u5417\uff1f\n\n\u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u9500\uff01"),confirmText:"\u786e\u8ba4\u5220\u9664",cancelText:"\u53d6\u6d88",type:"danger"})]})},rc=e=>{let{showDataManager:t,currentDataType:r,onClose:o,onDeleteSelected:a}=e;if(!t)return null;return(0,jt.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[(0,jt.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:(()=>{switch(r){case"collaborations":return"\u534f\u4f5c\u9879\u76ee\u6570\u636e\u7ba1\u7406";case"portfolios":return"\u4f5c\u54c1\u6570\u636e\u7ba1\u7406";case"comments":return"\u8bc4\u8bba\u6570\u636e\u7ba1\u7406";case"notifications":return"\u901a\u77e5\u6570\u636e\u7ba1\u7406";case"likes":return"\u70b9\u8d5e\u6570\u636e\u7ba1\u7406";case"views":return"\u6d4f\u89c8\u7edf\u8ba1\u6570\u636e\u7ba1\u7406";case"drafts":return"\u534f\u4f5c\u8349\u7a3f\u6570\u636e\u7ba1\u7406";default:return"\u6570\u636e\u7ba1\u7406"}})()}),(0,jt.jsx)("button",{onClick:o,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"\xd7"})]}),(0,jt.jsx)("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-80px)]",children:(0,jt.jsx)(tc,{dataType:r,onDeleteSelected:a})})]})})},oc=e=>{let{dataOverview:t}=e;return(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,jt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\u603b\u6570\u636e\u9879"}),(0,jt.jsx)("p",{className:"text-3xl font-bold text-blue-600",children:t.totalKeys||0})]}),(0,jt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\u4f5c\u54c1\u96c6"}),(0,jt.jsx)("p",{className:"text-3xl font-bold text-green-600",children:t.portfolios||0})]}),(0,jt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\u534f\u4f5c\u9879\u76ee"}),(0,jt.jsx)("p",{className:"text-3xl font-bold text-purple-600",children:t.collaborations||0})]}),(0,jt.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"\u5176\u4ed6\u6570\u636e"}),(0,jt.jsx)("p",{className:"text-3xl font-bold text-orange-600",children:t.other||0})]})]})},ac=e=>{let{openDataManager:t}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow mb-8",children:[(0,jt.jsxs)("div",{className:"p-6 border-b",children:[(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"\u8be6\u7ec6\u6570\u636e\u7ba1\u7406"}),(0,jt.jsx)("p",{className:"text-gray-600 mt-2",children:"\u67e5\u770b\u548c\u9009\u62e9\u6027\u5220\u9664\u7279\u5b9a\u6570\u636e\u9879"})]}),(0,jt.jsx)("div",{className:"p-6",children:(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,jt.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors",onClick:()=>t("collaborations"),children:"\ud83d\udccb \u7ba1\u7406\u534f\u4f5c\u9879\u76ee\u6570\u636e"}),(0,jt.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors",onClick:()=>t("portfolios"),children:"\ud83d\udccb \u7ba1\u7406\u4f5c\u54c1\u6570\u636e"}),(0,jt.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors",onClick:()=>t("comments"),children:"\ud83d\udccb \u7ba1\u7406\u8bc4\u8bba\u6570\u636e"}),(0,jt.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors",onClick:()=>t("notifications"),children:"\ud83d\udccb \u7ba1\u7406\u901a\u77e5\u6570\u636e"}),(0,jt.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors",onClick:()=>t("likes"),children:"\ud83d\udccb \u7ba1\u7406\u70b9\u8d5e\u6570\u636e"}),(0,jt.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors",onClick:()=>t("views"),children:"\ud83d\udccb \u7ba1\u7406\u6d4f\u89c8\u8bb0\u5f55\u6570\u636e"}),(0,jt.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded transition-colors",onClick:()=>t("drafts"),children:"\ud83d\udccb \u7ba1\u7406\u534f\u4f5c\u8349\u7a3f\u6570\u636e"})]})})]})},sc=async()=>{try{const e=["mock_collaborations","mock_collaboration_applications","mock_collaboration_likes","mock_collaboration_views","mock_collaboration_favorites","tag.collaboration_requests"];let t=0;e.forEach(e=>{localStorage.getItem(e)&&(localStorage.removeItem(e),t++)});const r=Object.keys(localStorage);return r.filter(t=>t.toLowerCase().includes("collaboration")&&!e.includes(t)).forEach(e=>{localStorage.removeItem(e),t++}),{success:!0,clearedCount:t,message:"\u6210\u529f\u6e05\u7406 ".concat(t," \u4e2aCollaborations\u76f8\u5173\u6570\u636e\u9879")}}catch(e){return console.error("Error clearing collaborations:",e),{success:!1,error:e.message}}},nc=async()=>{try{const e=Object.keys(localStorage).filter(e=>e.startsWith("portfolio_"));let t=0;return e.forEach(e=>{localStorage.removeItem(e),t++}),{success:!0,clearedCount:t,message:"\u6210\u529f\u6e05\u7406 ".concat(t," \u4e2a\u4f5c\u54c1\u6570\u636e\u9879")}}catch(e){return console.error("Error clearing portfolios:",e),{success:!1,error:e.message}}},ic=async()=>{try{const e=Object.keys(localStorage).filter(e=>e.includes("comment"));let t=0;return e.forEach(e=>{localStorage.removeItem(e),t++}),{success:!0,clearedCount:t,message:"\u6210\u529f\u6e05\u7406 ".concat(t," \u4e2a\u8bc4\u8bba\u6570\u636e\u9879")}}catch(e){return console.error("Error clearing comments:",e),{success:!1,error:e.message}}},lc=async()=>{try{const e=Object.keys(localStorage).filter(e=>e.includes("notification"));let t=0;return e.forEach(e=>{localStorage.removeItem(e),t++}),{success:!0,clearedCount:t,message:"\u6210\u529f\u6e05\u7406 ".concat(t," \u4e2a\u901a\u77e5\u6570\u636e\u9879")}}catch(e){return console.error("Error clearing notifications:",e),{success:!1,error:e.message}}},cc=async()=>{try{const e=Object.keys(localStorage).filter(e=>e.includes("like"));let t=0;return e.forEach(e=>{localStorage.removeItem(e),t++}),{success:!0,clearedCount:t,message:"\u6210\u529f\u6e05\u7406 ".concat(t," \u4e2a\u70b9\u8d5e\u6570\u636e\u9879")}}catch(e){return console.error("Error clearing likes:",e),{success:!1,error:e.message}}},dc=async()=>{try{const e=Object.keys(localStorage).filter(e=>e.includes("view"));let t=0;return e.forEach(e=>{localStorage.removeItem(e),t++}),{success:!0,clearedCount:t,message:"\u6210\u529f\u6e05\u7406 ".concat(t," \u4e2a\u6d4f\u89c8\u8bb0\u5f55\u6570\u636e\u9879")}}catch(e){return console.error("Error clearing views:",e),{success:!1,error:e.message}}},uc=async e=>{try{const t=Object.keys(localStorage).filter(t=>t.includes(e)||t.startsWith("portfolio_".concat(e)));let r=0;return t.forEach(e=>{localStorage.removeItem(e),r++}),{success:!0,clearedCount:r,message:"\u6210\u529f\u6e05\u7406\u7528\u6237 ".concat(e," \u7684 ").concat(r," \u4e2a\u6570\u636e\u9879")}}catch(t){return console.error("Error clearing user data:",t),{success:!1,error:t.message}}},hc=async()=>{try{const e=Object.keys(localStorage).filter(e=>e.startsWith("tag.")||e.startsWith("user_")||e.startsWith("artist_")||e.startsWith("portfolio_")||e.startsWith("tag_favorites")||e.startsWith("tag_follows")||e.startsWith("tag_service_data")||e.includes("comment")||e.includes("notification")||e.includes("view")||e.includes("like")||e.includes("review")||e.includes("collaboration")||e.includes("avatar")||e.includes("mock_"));let t=0;return e.forEach(e=>{localStorage.removeItem(e),t++}),{success:!0,clearedCount:t,message:"\u6210\u529f\u6e05\u7406 ".concat(t," \u4e2aTAG\u76f8\u5173\u6570\u636e\u9879")}}catch(e){return console.error("Error clearing all TAG data:",e),{success:!1,error:e.message}}},mc=e=>{let{isOperating:t,showConfirm:r,openDataManager:o}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow mb-8",children:[(0,jt.jsx)("div",{className:"p-6 border-b",children:(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"\u6279\u91cf\u6e05\u7406\u529f\u80fd"})}),(0,jt.jsxs)("div",{className:"p-6",children:[(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,jt.jsx)("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>r(sc,"\u6e05\u7406\u6240\u6709Collaborations","\u786e\u5b9a\u8981\u5220\u9664\u6240\u6709\u534f\u4f5c\u9879\u76ee\u6570\u636e\u5417\uff1f\n\n\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u6240\u6709\u534f\u4f5c\u9879\u76ee\u3001\u7533\u8bf7\u3001\u70b9\u8d5e\u7b49\u76f8\u5173\u6570\u636e\u3002"),children:"\ud83d\uddd1\ufe0f \u6e05\u7406\u6240\u6709Collaborations"}),(0,jt.jsx)("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>r(nc,"\u6e05\u7406\u6240\u6709\u4f5c\u54c1","\u786e\u5b9a\u8981\u5220\u9664\u6240\u6709\u4f5c\u54c1\u6570\u636e\u5417\uff1f\n\n\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u6240\u6709\u7528\u6237\u7684\u4f5c\u54c1\u96c6\u6570\u636e\u3002"),children:"\ud83d\uddd1\ufe0f \u6e05\u7406\u6240\u6709\u4f5c\u54c1"}),(0,jt.jsx)("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>r(ic,"\u6e05\u7406\u6240\u6709\u8bc4\u8bba","\u786e\u5b9a\u8981\u5220\u9664\u6240\u6709\u8bc4\u8bba\u6570\u636e\u5417\uff1f\n\n\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u6240\u6709\u4f5c\u54c1\u7684\u8bc4\u8bba\u6570\u636e\u3002"),children:"\ud83d\uddd1\ufe0f \u6e05\u7406\u6240\u6709\u8bc4\u8bba"}),(0,jt.jsx)("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>r(lc,"\u6e05\u7406\u6240\u6709\u901a\u77e5","\u786e\u5b9a\u8981\u5220\u9664\u6240\u6709\u901a\u77e5\u6570\u636e\u5417\uff1f\n\n\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u6240\u6709\u7528\u6237\u7684\u901a\u77e5\u6570\u636e\u3002"),children:"\ud83d\uddd1\ufe0f \u6e05\u7406\u6240\u6709\u901a\u77e5"}),(0,jt.jsx)("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>r(cc,"\u6e05\u7406\u6240\u6709\u70b9\u8d5e","\u786e\u5b9a\u8981\u5220\u9664\u6240\u6709\u70b9\u8d5e\u6570\u636e\u5417\uff1f\n\n\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u6240\u6709\u4f5c\u54c1\u7684\u70b9\u8d5e\u8bb0\u5f55\u3002"),children:"\ud83d\uddd1\ufe0f \u6e05\u7406\u6240\u6709\u70b9\u8d5e"}),(0,jt.jsx)("button",{className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>r(dc,"\u6e05\u7406\u6240\u6709\u6d4f\u89c8\u8bb0\u5f55","\u786e\u5b9a\u8981\u5220\u9664\u6240\u6709\u6d4f\u89c8\u8bb0\u5f55\u6570\u636e\u5417\uff1f\n\n\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u6240\u6709\u4f5c\u54c1\u7684\u6d4f\u89c8\u7edf\u8ba1\u3002"),children:"\ud83d\uddd1\ufe0f \u6e05\u7406\u6240\u6709\u6d4f\u89c8\u8bb0\u5f55"})]}),(0,jt.jsxs)("div",{className:"mt-6 pt-6 border-t border-red-200",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-red-700 mb-4",children:"\u26a0\ufe0f \u5371\u9669\u64cd\u4f5c"}),(0,jt.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,jt.jsx)("button",{className:"bg-red-700 hover:bg-red-800 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>r(hc,"\u6e05\u7406\u6240\u6709TAG\u6570\u636e","\u26a0\ufe0f \u5371\u9669\u64cd\u4f5c\uff01\n\n\u786e\u5b9a\u8981\u5220\u9664\u6240\u6709TAG\u76f8\u5173\u6570\u636e\u5417\uff1f\n\n\u8fd9\u5c06\u5220\u9664\uff1a\n\u2022 \u6240\u6709\u7528\u6237\u6570\u636e\n\u2022 \u6240\u6709\u4f5c\u54c1\u6570\u636e\n\u2022 \u6240\u6709\u8bc4\u8bba\u6570\u636e\n\u2022 \u6240\u6709\u901a\u77e5\u6570\u636e\n\u2022 \u6240\u6709\u70b9\u8d5e\u6570\u636e\n\u2022 \u6240\u6709\u6d4f\u89c8\u8bb0\u5f55\n\u2022 \u6240\u6709\u534f\u4f5c\u9879\u76ee\n\n\u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u9500\uff01"),children:"\ud83d\udca5 \u6e05\u7406\u6240\u6709TAG\u6570\u636e"}),(0,jt.jsx)("button",{className:"bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded transition-colors disabled:opacity-50",disabled:t,onClick:()=>{const e=prompt("\u8bf7\u8f93\u5165\u8981\u6e05\u7406\u7684\u7528\u6237ID (alice/bryan/alex):");e&&["alice","bryan","alex"].includes(e)&&r(()=>uc(e),"\u6e05\u7406\u7528\u6237 ".concat(e," \u7684\u6570\u636e"),"\u786e\u5b9a\u8981\u5220\u9664\u7528\u6237 ".concat(e," \u7684\u6240\u6709\u6570\u636e\u5417\uff1f\n\n\u8fd9\u5c06\u5220\u9664\u8be5\u7528\u6237\u7684\u6240\u6709\u4f5c\u54c1\u3001\u8bc4\u8bba\u3001\u901a\u77e5\u7b49\u76f8\u5173\u6570\u636e\u3002"))},children:"\ud83d\udc64 \u6e05\u7406\u7279\u5b9a\u7528\u6237\u6570\u636e"})]})]})]})]})},pc=e=>{let{operationLog:t}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,jt.jsx)("div",{className:"p-6 border-b",children:(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"\u64cd\u4f5c\u65e5\u5fd7"})}),(0,jt.jsx)("div",{className:"p-6",children:(0,jt.jsx)("div",{className:"max-h-64 overflow-y-auto",children:0===t.length?(0,jt.jsx)("p",{className:"text-gray-500 text-center py-4",children:"\u6682\u65e0\u64cd\u4f5c\u8bb0\u5f55"}):(0,jt.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>(0,jt.jsxs)("div",{className:"flex items-start space-x-2 text-sm",children:[(0,jt.jsx)("span",{className:"text-gray-500 min-w-[60px]",children:e.timestamp}),(0,jt.jsx)("span",{className:"flex-1 ".concat("success"===e.type?"text-green-600":"error"===e.type?"text-red-600":"text-gray-700"),children:e.message})]},t))})})})]})},gc=e=>{let{dataOverview:t}=e;return(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow mb-8",children:[(0,jt.jsx)("div",{className:"p-6 border-b",children:(0,jt.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"\u7528\u6237\u6570\u636e\u6982\u89c8"})}),(0,jt.jsx)("div",{className:"p-6",children:(0,jt.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(t.users||{}).map(e=>{let[t,r]=e;return(0,jt.jsxs)("div",{className:"flex justify-between items-center p-4 bg-gray-50 rounded",children:[(0,jt.jsx)("span",{className:"font-medium text-gray-700 capitalize",children:t}),(0,jt.jsx)("span",{className:"text-lg font-bold text-blue-600",children:r})]},t)})})})]})},fc=()=>{const[t,r]=(0,e.useState)(!1),[o,a]=(0,e.useState)(null),[s,n]=(0,e.useState)(!0),i=()=>{localStorage.removeItem("admin_auth_data"),localStorage.removeItem("admin_super_token"),localStorage.removeItem("admin_token_timestamp"),r(!1),a(null),console.log("[Admin Logout] \u7ba1\u7406\u5458\u9000\u51fa\u767b\u5f55 - ".concat((new Date).toLocaleString()))},l=()=>{console.warn("[Admin] \u65e7\u7684\u6fc0\u6d3b\u65b9\u5f0f\u5df2\u5e9f\u5f03\uff0c\u8bf7\u4f7f\u7528\u5bc6\u7801\u767b\u5f55"),alert("\u8bf7\u4f7f\u7528\u7528\u6237\u540d\u548c\u5bc6\u7801\u767b\u5f55\u7ba1\u7406\u5458\u9762\u677f")};return(0,e.useEffect)(()=>{(()=>{try{const e=localStorage.getItem("admin_auth_data");if(e){const t=JSON.parse(e),o=new Date(t.loginTime),s=(new Date-o)/36e5;if(t.isAuthenticated&&s<24)return r(!0),a(t),!0;localStorage.removeItem("admin_auth_data"),localStorage.removeItem("admin_super_token"),localStorage.removeItem("admin_token_timestamp")}return!1}catch(e){return console.error("Admin validation error:",e),!1}})();n(!1),window.activateAdminMode=l;const e=setInterval(()=>{const e=localStorage.getItem("admin_auth_data");if(e)try{const t=JSON.parse(e),r=new Date(t.loginTime),o=new Date;(o-r)/36e5>=24&&(i(),alert("\u4f1a\u8bdd\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"))}catch(t){console.error("Session check error:",t)}},36e5);return()=>clearInterval(e)},[]),{isAuthorized:t,authData:o,loading:s,handleLoginSuccess:e=>{a(e),r(!0)},handleLogout:i,activateAdminMode:l}},vc=t=>{const[r,o]=(0,e.useState)([]),[a,s]=(0,e.useState)(!1),[n,i]=(0,e.useState)(!1),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(null),[h,m]=(0,e.useState)(!1),p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";const r={timestamp:(new Date).toLocaleTimeString(),message:e,type:t};o(e=>[r,...e.slice(0,49)])};return{operationLog:r,isOperating:a,showConfirmDialog:n,currentDataType:d,showDataManager:h,addLog:p,showConfirm:(e,r,o)=>{c(()=>()=>(async(e,r)=>{if(!a){s(!0),p("\u5f00\u59cb\u6267\u884c: ".concat(r),"info");try{const r=await e();r.success?(p("\u2705 ".concat(r.message),"success"),t()):p("\u274c \u64cd\u4f5c\u5931\u8d25: ".concat(r.error),"error")}catch(o){p("\u274c \u64cd\u4f5c\u5f02\u5e38: ".concat(o.message),"error")}finally{s(!1)}}})(e,r)),i(!0)},handleConfirm:()=>{l&&l()},openDataManager:e=>{u(e),m(!0)},handleDataManagerDelete:e=>{p("\u2705 \u901a\u8fc7\u6570\u636e\u7ba1\u7406\u5668\u5220\u9664\u4e86 ".concat(e," \u9879\u6570\u636e"),"success"),t()},setShowConfirmDialog:i,setShowDataManager:m}},xc=()=>{const[t,r]=(0,e.useState)({}),o=()=>{const e=(()=>{try{const e=Object.keys(localStorage),t={totalKeys:e.length,users:{alice:0,bryan:0,alex:0},collaborations:0,portfolios:0,comments:0,notifications:0,likes:0,views:0,favorites:0,other:0};return e.forEach(e=>{if(e.includes("portfolio_")){t.portfolios++;const r=e.replace("portfolio_","");void 0!==t.users[r]&&t.users[r]++}else e.includes("collaboration")?t.collaborations++:e.includes("comment")?t.comments++:e.includes("notification")?t.notifications++:e.includes("like")?t.likes++:e.includes("view")?t.views++:e.includes("favorite")?t.favorites++:t.other++}),t}catch(e){return console.error("Error getting data overview:",e),{}}})();r(e)};return(0,e.useEffect)(()=>{o()},[]),{dataOverview:t,refreshDataOverview:o}},bc=()=>{const{isAuthorized:e,authData:t,loading:r,handleLoginSuccess:o,handleLogout:a}=fc(),{dataOverview:s,refreshDataOverview:n}=xc(),{operationLog:i,isOperating:l,showConfirmDialog:c,currentDataType:d,showDataManager:u,showConfirm:h,handleConfirm:m,openDataManager:p,handleDataManagerDelete:g,setShowConfirmDialog:f,setShowDataManager:v}=vc(n);return r?(0,jt.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,jt.jsx)("p",{className:"mt-4 text-gray-600",children:"\u9a8c\u8bc1\u7ba1\u7406\u5458\u6743\u9650..."})]})}):e?(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,jt.jsx)(Kl,{authData:t,onLogout:a}),(0,jt.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,jt.jsx)(oc,{dataOverview:s}),(0,jt.jsx)(gc,{dataOverview:s}),(0,jt.jsx)(mc,{isOperating:l,showConfirm:h,openDataManager:p}),(0,jt.jsx)(ac,{openDataManager:p}),(0,jt.jsx)(pc,{operationLog:i})]}),(0,jt.jsx)(Zl,{isOpen:c,onClose:()=>f(!1),onConfirm:m,title:"\u786e\u8ba4\u64cd\u4f5c",message:"\u786e\u5b9a\u8981\u6267\u884c\u6b64\u64cd\u4f5c\u5417\uff1f\\n\\n\u6b64\u64cd\u4f5c\u4e0d\u53ef\u64a4\u9500\uff01",confirmText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",type:"danger"}),(0,jt.jsx)(rc,{showDataManager:u,currentDataType:d,onClose:()=>v(!1),onDeleteSelected:g})]}):(0,jt.jsx)(Jl,{onLoginSuccess:o})},yc=vs("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),wc=vs("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),jc=vs("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),kc=vs("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),Sc=vs("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Nc=vs("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),Cc=vs("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),_c=vs("pen-tool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),Ac=vs("box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Ic=vs("gamepad",[["line",{x1:"6",x2:"10",y1:"12",y2:"12",key:"161bw2"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"15",x2:"15.01",y1:"13",y2:"13",key:"dqpgro"}],["line",{x1:"18",x2:"18.01",y1:"11",y2:"11",key:"meh2c"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]]),Pc=vs("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ec=vs("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Dc=vs("handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]),Lc=vs("building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),Tc=vs("hammer",[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]]),Mc=vs("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Fc=vs("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Rc={container:"CoFuture2025_container__ZK5Ze",hero:"CoFuture2025_hero__OU85u",heroContent:"CoFuture2025_heroContent__K38iO",title:"CoFuture2025_title__Ag7cX",titlePrefix:"CoFuture2025_titlePrefix__zCITE",gradientText:"CoFuture2025_gradientText__VpOpM",subtitle:"CoFuture2025_subtitle__SIZMK",primaryBtn:"CoFuture2025_primaryBtn__x4ztR",processStrip:"CoFuture2025_processStrip__6w4ED",step:"CoFuture2025_step__Bulkv",stepIcon:"CoFuture2025_stepIcon__cKdgR",stepText:"CoFuture2025_stepText__QeDUr",stepSeparator:"CoFuture2025_stepSeparator__3Vc4r",about:"CoFuture2025_about__tOwZV",aboutContent:"CoFuture2025_aboutContent__ix1Il",aboutTitle:"CoFuture2025_aboutTitle__6XfGp",aboutDescription:"CoFuture2025_aboutDescription__SfTCe",quote:"CoFuture2025_quote__0RS3l",features:"CoFuture2025_features__oE2az",feature:"CoFuture2025_feature__p9lyH",iconCircle:"CoFuture2025_iconCircle__9ooh7",iconBlue:"CoFuture2025_iconBlue__YtD2l",iconPurple:"CoFuture2025_iconPurple__VDYJy",iconBluePurple:"CoFuture2025_iconBluePurple__mhl+J",featureIcon:"CoFuture2025_featureIcon__lDobi",featureTitle:"CoFuture2025_featureTitle__7xMuY",featureDescription:"CoFuture2025_featureDescription__aaFJT",sectionTitle:"CoFuture2025_sectionTitle__fTNpT",tracks:"CoFuture2025_tracks__PyO0P",tracksContent:"CoFuture2025_tracksContent__iz1N0",tracksGrid:"CoFuture2025_tracksGrid__EfbsC",trackCard:"CoFuture2025_trackCard__Of4Cr",trackIcon:"CoFuture2025_trackIcon__Ay5dz",trackTitle:"CoFuture2025_trackTitle__Rvim7",trackDescription:"CoFuture2025_trackDescription__T3--3",trackButton:"CoFuture2025_trackButton__MZdfx",buttonBlue:"CoFuture2025_buttonBlue__3o30o",buttonPurple:"CoFuture2025_buttonPurple__2sr1U",buttonGreen:"CoFuture2025_buttonGreen__w8YvR",awards:"CoFuture2025_awards__82z4d",awardsContent:"CoFuture2025_awardsContent__hSWNC",awardsGrid:"CoFuture2025_awardsGrid__DpIMv",awardItem:"CoFuture2025_awardItem__C+hbd",awardIcon:"CoFuture2025_awardIcon__UcH+h",awardYellow:"CoFuture2025_awardYellow__hopvc",awardBlue:"CoFuture2025_awardBlue__ZDDyU",awardPurple:"CoFuture2025_awardPurple__AFTPo",awardGreen:"CoFuture2025_awardGreen__zmT2X",awardIconText:"CoFuture2025_awardIconText__ukZpZ",awardTitle:"CoFuture2025_awardTitle__zzPao",awardDescription:"CoFuture2025_awardDescription__4t7tg",howToJoin:"CoFuture2025_howToJoin__edHAM",howToJoinContent:"CoFuture2025_howToJoinContent__aOq0j",stepsGrid:"CoFuture2025_stepsGrid__gjajo",stepItem:"CoFuture2025_stepItem__KBZVQ",stepNumber:"CoFuture2025_stepNumber__NizGo",stepTitle:"CoFuture2025_stepTitle__yqtrb",stepDescription:"CoFuture2025_stepDescription__AyUIr",ctaContainer:"CoFuture2025_ctaContainer__XaGfV",ctaButton:"CoFuture2025_ctaButton__Ntg3q",timeline:"CoFuture2025_timeline__iqBiD",timelineContent:"CoFuture2025_timelineContent__lBrHt",timelineContainer:"CoFuture2025_timelineContainer__oU9V2",timelineEvent:"CoFuture2025_timelineEvent__MX89R",timelineIcon:"CoFuture2025_timelineIcon__e8uul",timelineDate:"CoFuture2025_timelineDate__QmZfI",timelineTitle:"CoFuture2025_timelineTitle__LpcpN",timelineLine:"CoFuture2025_timelineLine__Bxw3B",gallery:"CoFuture2025_gallery__cBNQg",galleryContent:"CoFuture2025_galleryContent__paSYN",galleryCard:"CoFuture2025_galleryCard__7nNio",galleryIcon:"CoFuture2025_galleryIcon__QY0Xa",galleryComingSoon:"CoFuture2025_galleryComingSoon__MYi6B",galleryDescription:"CoFuture2025_galleryDescription__XpeEq",faq:"CoFuture2025_faq__BjYt2",faqContent:"CoFuture2025_faqContent__geJNg",faqList:"CoFuture2025_faqList__SVbhC",faqItem:"CoFuture2025_faqItem__YPMrZ",faqQuestion:"CoFuture2025_faqQuestion__j4oT8",faqIcon:"CoFuture2025_faqIcon__pNQa5",faqIconRotated:"CoFuture2025_faqIconRotated__4QtS5",faqAnswer:"CoFuture2025_faqAnswer__y+MiQ"},Oc={title:{prefix:"TAGMe:",main:"Co-Future"},subtitle:"Student Competitions 2025",button:{text:"Join the Challenge",href:"/tagme/co-future-2025#apply"},steps:[{icon:yc,text:"Team Up"},{icon:wc,text:"Co-Create"},{icon:jc,text:"Submit"},{icon:kc,text:"Celebrate"}],about:{title:"About Co-Future",description:"Co-Future is TAG's official global art competition, inviting creative students from all over the world to team up and design what the future could be \u2014 together.",quote:'"The future is designed together."',features:[{title:"Global Collaboration",description:"Connect with creative minds from around the world.",icon:Sc,gradientClass:"iconBlue"},{title:"Cross-Disciplinary",description:"Blend 2D, 3D, interactive media, and storytelling.",icon:Nc,gradientClass:"iconPurple"},{title:"Future-Focused",description:"Design innovative solutions for tomorrow's challenges.",icon:Cc,gradientClass:"iconBluePurple"}]},tracks:{title:"Competition Tracks",items:[{title:"2D Visual Design",description:"Create stunning illustrations, graphics, and visual narratives that bring the future to life.",icon:_c,buttonText:"Explore Track",buttonColor:"blue"},{title:"3D Visual Design",description:"Build immersive 3D environments, characters, and objects that define tomorrow's world.",icon:Ac,buttonText:"Explore Track",buttonColor:"purple"},{title:"Game & Interactive Media",description:"Design interactive experiences, games, and digital media that engage and inspire.",icon:Ic,buttonText:"Explore Track",buttonColor:"green"}]},awards:{title:"Awards & Recognition",items:[{title:"Best Visual Presentation",description:"Outstanding aesthetic quality",icon:kc,gradientClass:"awardYellow"},{title:"Best Concept Development",description:"Innovative thinking and ideation",icon:wc,gradientClass:"awardBlue"},{title:"Best Technical Execution",description:"Superior craftsmanship and skill",icon:Pc,gradientClass:"awardPurple"},{title:"Rising Star Award",description:"Outstanding emerging talent",icon:Ec,gradientClass:"awardGreen"}]},howToJoin:{title:"How to Join",steps:[{number:"1",title:"Build or Join a Team",description:"Connect with collaborators via TAGMe platform",icon:yc},{number:"2",title:"Choose a Track",description:"Select your preferred competition category",icon:Nc},{number:"3",title:"Collaborate & Co-Create",description:"Work together to bring your vision to life",icon:Dc},{number:"4",title:"Submit Your Work",description:"Upload before February 10 deadline",icon:jc}],ctaButton:{text:"Start on TAGMe",href:"/tagme"}},timeline:{title:"Competition Timeline",events:[{date:"October",title:"Registration Opens",icon:Lc},{date:"November \u2013 January",title:"Creation Phase",icon:Tc},{date:"February 10",title:"Submission Deadline",icon:jc},{date:"February 20",title:"Awards & Showcase",icon:kc}]},gallery:{title:"Submission Gallery",comingSoon:"Coming Soon",description:"This space will showcase the most inspiring submissions from each track. Check back during the creation phase to see amazing work from teams worldwide."},faq:{title:"Frequently Asked Questions",items:[{question:"Who can join?",answer:"Any student currently enrolled in an educational institution worldwide can participate."},{question:"Can I submit solo?",answer:"While we encourage collaboration, solo submissions are welcome in all tracks."},{question:"What file types are accepted?",answer:"We accept various formats including images, videos, interactive files, and project documentation."},{question:"Do I need specific software?",answer:"No, you can use any tools or software you prefer to create your submission."},{question:"How are awards judged?",answer:"Submissions are evaluated by industry professionals based on creativity, technical skill, and concept development."}]}},Uc=()=>{const[t,r]=(0,e.useState)(null);return(0,jt.jsxs)("div",{className:Rc.container,children:[(0,jt.jsx)("section",{className:Rc.hero,children:(0,jt.jsxs)("div",{className:Rc.heroContent,children:[(0,jt.jsxs)("h1",{className:Rc.title,children:[(0,jt.jsx)("span",{className:Rc.titlePrefix,children:Oc.title.prefix}),(0,jt.jsx)("span",{className:Rc.gradientText,children:Oc.title.main})]}),(0,jt.jsx)("p",{className:Rc.subtitle,children:Oc.subtitle}),(0,jt.jsx)("a",{href:Oc.button.href,className:Rc.primaryBtn,"aria-label":"Join the Co-Future challenge",children:Oc.button.text}),(0,jt.jsx)("div",{className:Rc.processStrip,"aria-label":"Competition process steps",children:Oc.steps.map((t,r)=>(0,jt.jsxs)(e.Fragment,{children:[(0,jt.jsxs)("span",{className:Rc.step,children:[(0,jt.jsx)("span",{className:Rc.stepIcon,children:(0,jt.jsx)(t.icon,{size:18})}),(0,jt.jsx)("span",{className:Rc.stepText,children:t.text})]}),r<Oc.steps.length-1&&(0,jt.jsx)("span",{className:Rc.stepSeparator,children:"\u2022"})]},t.text))})]})}),(0,jt.jsx)("section",{className:Rc.about,children:(0,jt.jsxs)("div",{className:Rc.aboutContent,children:[(0,jt.jsx)("h2",{className:Rc.aboutTitle,children:Oc.about.title}),(0,jt.jsx)("p",{className:Rc.aboutDescription,children:Oc.about.description}),(0,jt.jsx)("blockquote",{className:Rc.quote,children:Oc.about.quote}),(0,jt.jsx)("div",{className:Rc.features,children:Oc.about.features.map(e=>(0,jt.jsxs)("div",{className:Rc.feature,children:[(0,jt.jsx)("div",{className:"".concat(Rc.iconCircle," ").concat(Rc[e.gradientClass]),children:(0,jt.jsx)("span",{className:Rc.featureIcon,children:(0,jt.jsx)(e.icon,{size:32})})}),(0,jt.jsx)("h3",{className:Rc.featureTitle,children:e.title}),(0,jt.jsx)("p",{className:Rc.featureDescription,children:e.description})]},e.title))})]})}),(0,jt.jsx)("section",{className:Rc.tracks,children:(0,jt.jsxs)("div",{className:Rc.tracksContent,children:[(0,jt.jsx)("h2",{className:Rc.sectionTitle,children:Oc.tracks.title}),(0,jt.jsx)("div",{className:Rc.tracksGrid,children:Oc.tracks.items.map(e=>(0,jt.jsxs)("div",{className:Rc.trackCard,children:[(0,jt.jsx)("div",{className:Rc.trackIcon,children:(0,jt.jsx)(e.icon,{size:48})}),(0,jt.jsx)("h3",{className:Rc.trackTitle,children:e.title}),(0,jt.jsx)("p",{className:Rc.trackDescription,children:e.description}),(0,jt.jsx)("button",{className:"".concat(Rc.trackButton," ").concat(Rc["button".concat(e.buttonColor.charAt(0).toUpperCase()+e.buttonColor.slice(1))]),children:e.buttonText})]},e.title))})]})}),(0,jt.jsx)("section",{className:Rc.awards,children:(0,jt.jsxs)("div",{className:Rc.awardsContent,children:[(0,jt.jsx)("h2",{className:Rc.sectionTitle,children:Oc.awards.title}),(0,jt.jsx)("div",{className:Rc.awardsGrid,children:Oc.awards.items.map(e=>(0,jt.jsxs)("div",{className:Rc.awardItem,children:[(0,jt.jsx)("div",{className:"".concat(Rc.awardIcon," ").concat(Rc[e.gradientClass]),children:(0,jt.jsx)("span",{className:Rc.awardIconText,children:(0,jt.jsx)(e.icon,{size:24})})}),(0,jt.jsx)("h3",{className:Rc.awardTitle,children:e.title}),(0,jt.jsx)("p",{className:Rc.awardDescription,children:e.description})]},e.title))})]})}),(0,jt.jsx)("section",{className:Rc.howToJoin,children:(0,jt.jsxs)("div",{className:Rc.howToJoinContent,children:[(0,jt.jsx)("h2",{className:Rc.sectionTitle,children:Oc.howToJoin.title}),(0,jt.jsx)("div",{className:Rc.stepsGrid,children:Oc.howToJoin.steps.map(e=>(0,jt.jsxs)("div",{className:Rc.stepItem,children:[(0,jt.jsx)("div",{className:Rc.stepNumber,children:(0,jt.jsx)(e.icon,{size:20})}),(0,jt.jsx)("h3",{className:Rc.stepTitle,children:e.title}),(0,jt.jsx)("p",{className:Rc.stepDescription,children:e.description})]},e.number))}),(0,jt.jsx)("div",{className:Rc.ctaContainer,children:(0,jt.jsx)("a",{href:Oc.howToJoin.ctaButton.href,className:Rc.ctaButton,children:Oc.howToJoin.ctaButton.text})})]})}),(0,jt.jsx)("section",{className:Rc.timeline,children:(0,jt.jsxs)("div",{className:Rc.timelineContent,children:[(0,jt.jsx)("h2",{className:Rc.sectionTitle,children:Oc.timeline.title}),(0,jt.jsx)("div",{className:Rc.timelineContainer,children:Oc.timeline.events.map((e,t)=>(0,jt.jsxs)("div",{className:Rc.timelineEvent,children:[(0,jt.jsx)("div",{className:Rc.timelineIcon,children:(0,jt.jsx)(e.icon,{size:24})}),(0,jt.jsxs)("div",{className:Rc.timelineContent,children:[(0,jt.jsx)("div",{className:Rc.timelineDate,children:e.date}),(0,jt.jsx)("div",{className:Rc.timelineTitle,children:e.title})]}),t<Oc.timeline.events.length-1&&(0,jt.jsx)("div",{className:Rc.timelineLine})]},e.date))})]})}),(0,jt.jsx)("section",{className:Rc.gallery,children:(0,jt.jsxs)("div",{className:Rc.galleryContent,children:[(0,jt.jsx)("h2",{className:Rc.sectionTitle,children:Oc.gallery.title}),(0,jt.jsxs)("div",{className:Rc.galleryCard,children:[(0,jt.jsx)("div",{className:Rc.galleryIcon,children:(0,jt.jsx)(Mc,{size:64})}),(0,jt.jsx)("h3",{className:Rc.galleryComingSoon,children:Oc.gallery.comingSoon}),(0,jt.jsx)("p",{className:Rc.galleryDescription,children:Oc.gallery.description})]})]})}),(0,jt.jsx)("section",{className:Rc.faq,children:(0,jt.jsxs)("div",{className:Rc.faqContent,children:[(0,jt.jsx)("h2",{className:Rc.sectionTitle,children:Oc.faq.title}),(0,jt.jsx)("div",{className:Rc.faqList,children:Oc.faq.items.map((e,o)=>(0,jt.jsxs)("div",{className:Rc.faqItem,children:[(0,jt.jsxs)("button",{className:Rc.faqQuestion,onClick:()=>(e=>{r(t===e?null:e)})(o),"aria-expanded":t===o,children:[(0,jt.jsx)("span",{children:e.question}),(0,jt.jsx)(Fc,{size:20,className:"".concat(Rc.faqIcon," ").concat(t===o?Rc.faqIconRotated:"")})]}),t===o&&(0,jt.jsx)("div",{className:Rc.faqAnswer,children:(0,jt.jsx)("p",{children:e.answer})})]},o))})]})})]})},zc=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{var t;const{majors:o=[],software:s=[],sortBy:n="latest",limit:i=12,cursor:l=null}=e;console.log("[majorService] Filtering by:",{majors:o,software:s,sortBy:n});const c=[],d=["alice","bryan","alex"];for(const e of d)try{const t=await(0,sr.ep)(e);if(t.success&&t.data){const r=await pa(e),o=t.data.map(t=>(0,a.A)((0,a.A)({},t),{},{author:{id:(null===r||void 0===r?void 0:r.id)||e,name:(null===r||void 0===r?void 0:r.name)||e,majors:(null===r||void 0===r?void 0:r.majors)||[],minors:(null===r||void 0===r?void 0:r.minors)||[]}}));c.push(...o)}}catch(r){console.warn("[majorService] Failed to get works for artist ".concat(e,":"),r)}let u=c;o.length>0&&(u=u.filter(e=>{const t=[...e.author.majors||[],...e.author.minors||[]];return o.every(e=>t.some(t=>t.toLowerCase()===e.toLowerCase()))})),s.length>0&&(u=u.filter(e=>{const t=e.tags||[];return s.every(e=>t.some(t=>t.toLowerCase().includes(e.toLowerCase())))})),("latest"===n||"popular"===n)&&u.sort((e,t)=>new Date(t.createdAt)-new Date(e.createdAt));let h=0;if(l){h=u.findIndex(e=>e.id===l)+1}const m=h+i,p=u.slice(h,m),g=p.map(e=>({id:e.id,title:e.title,image:e.thumbnailPath||e.imagePaths&&e.imagePaths[0]||"/assets/placeholder.svg",author:e.author,category:e.category,tags:e.tags||[],description:e.description,createdAt:e.createdAt})),f=m<u.length,v=f?null===(t=p[p.length-1])||void 0===t?void 0:t.id:null;return console.log("[majorService] Found ".concat(u.length," works, returning ").concat(g.length)),{items:g,cursor:v,hasMore:f,total:u.length}}catch(r){throw console.error("[majorService] Error getting works by major:",r),r}},Wc=()=>{var t,r;const[o]=vt(),[a,s]=(ce(),(0,e.useState)([])),[n,i]=(0,e.useState)(!0),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(!0),[h,m]=(0,e.useState)(null),p=(null===(t=o.get("categories"))||void 0===t?void 0:t.split(","))||[],g=(null===(r=o.get("software"))||void 0===r?void 0:r.split(","))||[],f=o.get("sort")||"latest",v=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{i(!0);const t=await zc({majors:p,software:g,sortBy:f,limit:12,cursor:e});s(e?e=>[...e,...t.items]:t.items),m(t.cursor),u(t.hasMore),c(null)}catch(l){console.error("Error loading works by major:",l),c("Failed to load works")}finally{i(!1)}};(0,e.useEffect)(()=>{v()},[p.join(","),g.join(","),f]);return n&&0===a.length?(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,jt.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading works..."})]})}):l&&0===a.length?(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"text-red-600 text-lg font-semibold mb-2",children:"Error"}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:l}),(0,jt.jsx)("button",{onClick:()=>v(),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Try Again"})]})}):(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,jt.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,jt.jsxs)("div",{className:"flex items-center justify-between",children:[(0,jt.jsxs)("div",{children:[(0,jt.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:(()=>{if(0===p.length&&0===g.length)return"All Works";const e=[];return p.length>0&&e.push("Major: ".concat(p.join(", "))),g.length>0&&e.push("Software: ".concat(g.join(", "))),e.join(" | ")})()}),(0,jt.jsx)("p",{className:"text-gray-600 mt-2",children:0===a.length?"0 works":1===a.length?"1 work":"".concat(a.length," works")}),(p.length>0||g.length>0)&&(0,jt.jsxs)("div",{className:"flex flex-wrap gap-2 mt-3",children:[p.map(e=>(0,jt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e},e)),g.map(e=>(0,jt.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:e},e))]})]}),(0,jt.jsxs)("button",{onClick:()=>window.history.back(),className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[(0,jt.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back"]})]})})}),(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:0===a.length?(0,jt.jsxs)("div",{className:"text-center py-12",children:[(0,jt.jsx)("div",{className:"text-gray-400 text-6xl mb-4",children:"\ud83c\udfa8"}),(0,jt.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No works found"}),(0,jt.jsx)("p",{className:"text-gray-600",children:"No works match the selected criteria. Try adjusting your filters."})]}):(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:a.map(e=>(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer",onClick:()=>window.open("/work/".concat(e.id),"_blank"),children:[(0,jt.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-gray-200 rounded-t-lg",children:(0,jt.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover rounded-t-lg",onError:e=>{e.target.src="/assets/placeholder.svg"}})}),(0,jt.jsxs)("div",{className:"p-4",children:[(0,jt.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,jt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["by ",e.author.name]}),e.author.majors&&e.author.majors.length>0&&(0,jt.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:e.author.majors.slice(0,2).map(e=>(0,jt.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:e},e))})]})]},e.id))}),d&&(0,jt.jsx)("div",{className:"text-center mt-8",children:(0,jt.jsx)("button",{onClick:()=>{d&&v(h)},disabled:n,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200",children:n?"Loading...":"Load More Works"})})]})})]})},Bc="EditProfile_container__IkubN",Gc="EditProfile_header__K3AJ7",Hc="EditProfile_headerLeft__Cf4sl",qc="EditProfile_backButton__mrj22",Vc="EditProfile_backIcon__CFjC9",Jc="EditProfile_pageTitle__C2f+e",Zc="EditProfile_headerRight__RhuX-",Kc="EditProfile_cancelButton__2s1x1",Yc="EditProfile_saveButton__Wayap",Qc="EditProfile_successMessage__npX8G",$c="EditProfile_successIcon__ezwUa",Xc="EditProfile_grid__mrd1a",ed="EditProfile_leftCol__iTTBq",td="EditProfile_rightCol__Tgyti",rd="EditProfile_card__JLxMq",od="EditProfile_cardTitle__gOJEN",ad="EditProfile_avatarSection__SBCYc",sd="EditProfile_avatarContainer__JGWTL",nd="EditProfile_avatar__JfBVT",id="EditProfile_avatarActions__fhG0j",ld="EditProfile_changePhotoButton__Uvyeb",cd="EditProfile_cameraIcon__nPnd3",dd="EditProfile_formField__-xQhQ",ud="EditProfile_basicInfoGrid__L8Uqd",hd="EditProfile_fullRow__gMTKI",md="EditProfile_bioTextarea__26OTA",pd="EditProfile_inputError__h+bTv",gd="EditProfile_bioFooter__9rTtO",fd="EditProfile_label__Dt+aP",vd="EditProfile_input__rW7WI",xd="EditProfile_textarea__9NKl2",bd="EditProfile_errorMessage__jReZa",yd="EditProfile_charCount__uvzqh",wd="EditProfile_charCountWarning__HnCvV",jd="EditProfile_socialInputContainer__BgFPk",kd="EditProfile_socialIconContainer__hkUKi",Sd="EditProfile_socialIcon__Cq5Cj",Nd="EditProfile_socialInput__lAUZL",Cd="EditProfile_socialLinksContainer__0h9be",_d="EditProfile_socialSection__zbU2v",Ad="EditProfile_sectionHeader__wX01L",Id="EditProfile_sectionTitle__qY0N6",Pd="EditProfile_otherLinksList__cM-3T",Ed="EditProfile_otherLinkRow__IK+VN",Dd="EditProfile_otherLinkInfo__XvxYR",Ld="EditProfile_otherLinkLabel__vKKtD",Td="EditProfile_otherLinkUrl__eu-3g",Md="EditProfile_removeLinkButton__Ytti9",Fd="EditProfile_addLinkSection__GQNZW",Rd="EditProfile_addLinkRow__okDDd",Od="EditProfile_addLinkInputGroup__9pboc",Ud="EditProfile_addLinkInput__qcDkf",zd="EditProfile_addLinkButton__+80nZ",Wd="EditProfile_suggestions__6dQob",Bd="EditProfile_suggestionButton__4FsVN",Gd="EditProfile_maxLinksMessage__qadHX",Hd="EditProfile_skillsContainer__zTdNo",qd="EditProfile_skillsList__CqxMp",Vd="EditProfile_skillTag__BYLvV",Jd="EditProfile_skillText__KF2Mn",Zd="EditProfile_removeSkillButton__QgK83",Kd="EditProfile_removeIcon__0wB4r",Yd="EditProfile_addSkillContainer__TWSXM",Qd="EditProfile_addSkillInputGroup__GPOwF",$d="EditProfile_addSkillInput__3vkFF",Xd="EditProfile_addSkillButton__Y-e-W",eu="EditProfile_addIcon__LK-oP",tu="EditProfile_helpText__QLYpo",ru="EditProfile_majorsContainer__y+v-i",ou="EditProfile_majorsList__nro4w",au="EditProfile_majorTag__+62bm",su="EditProfile_majorText__1NwOV",nu="EditProfile_removeMajorButton__-0lfq",iu="EditProfile_addMajorContainer__7hcG6",lu="EditProfile_uploadArea__RBBIb",cu="EditProfile_uploadAreaClickable__UhlWL",du="EditProfile_uploadIcon__Uu4Do",uu="EditProfile_uploadText__DyRAA",hu="EditProfile_uploadSubtext__Vv8hF",mu="EditProfile_chooseFilesButton__RdltH",pu="EditProfile_publicNotice__D7tuk",gu="EditProfile_publicIcon__KSjhS",fu="EditProfile_portfolioGrid__Nxc06",vu="EditProfile_portfolioItem__G9AjO",xu="EditProfile_portfolioImageContainer__Yc1la",bu="EditProfile_portfolioImage__EdMj7",yu="EditProfile_publicBadge__vDOWI",wu="EditProfile_modalOverlay__zOlaL",ju="EditProfile_modal__V5yfn",ku="EditProfile_modalHeader__8WA4B",Su="EditProfile_modalTitle__8dRQl",Nu="EditProfile_modalContent__wpgwQ",Cu="EditProfile_modalWarning__RRbh8",_u="EditProfile_modalActions__0ErUX",Au="EditProfile_modalCancelButton__MY1ND",Iu="EditProfile_modalDeleteButton__NrN69",Pu="EditProfile_portfolioOverlay__wHCNS",Eu="EditProfile_visibilityButton__a-Mcb",Du="EditProfile_removeButton__hTjYd",Lu="EditProfile_public__jweuU",Tu="EditProfile_private__VNZqB",Mu="EditProfile_editButton__4V9ef",Fu="EditProfile_portfolioStatus__+zH7y",Ru="EditProfile_statusBadge__DdUpb",Ou="EditProfile_privateBadge__a2mPn",Uu="EditProfile_portfolioInfo__Yzmbj",zu="EditProfile_portfolioTitle__5mStV",Wu="EditProfile_emptyState__BytyE",Bu="EditProfile_emptyIcon__cIyOv",Gu="EditProfile_emptyText__c+EDW",Hu="EditProfile_emptySubtext__n3em7",qu="EditProfile_portfolioModalContent__xcTAE",Vu="EditProfile_portfolioModalHeader__LC6BZ",Ju="EditProfile_portfolioCloseButton__IXIC-",Zu="EditProfile_portfolioModalBody__w5jQ-",Ku="EditProfile_formGroup__Y521H",Yu="EditProfile_required__zObno",Qu="EditProfile_error__VwHJg",$u="EditProfile_errorText__kwONd",Xu="EditProfile_portfolioModalFooter__-6agc",eh=["Accessory Design","Acting","Advertising","Animation","Architecture","Art History","Creative Business Leadership","Fashion Design","Fibers","Film","Film/Television","Fine Art","Game/ITGM","Graphic Design","Industrial Design","Illustration","Interior Design","Jewelry","Motion Design","Painting","Photography","Service Design","Sequential Art","UI/UX","Visual Effects"],th=t=>{let{onAddMajor:r,disabled:o=!1}=t;const[a,s]=(0,e.useState)(""),[n,i]=(0,e.useState)(!1),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)(-1),[h,m]=(0,e.useState)(""),p=(0,e.useRef)(null),g=(0,e.useRef)(null);(0,e.useEffect)(()=>{if(a.trim()){const e=eh.filter(e=>e.toLowerCase().includes(a.toLowerCase()));c(e)}else c(eh);u(-1)},[a]);const f=e=>{s(e),i(!1),u(-1),r(e)},v=()=>{const e=a.trim();if(!e)return void m("Please enter a major or minor");const t=eh.find(t=>t.toLowerCase()===e.toLowerCase());t?(r(t),s(""),m(""),i(!1)):m("Please select a valid major or minor from the list")};return(0,e.useEffect)(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&p.current&&!p.current.contains(e.target)&&(i(!1),u(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,jt.jsxs)("div",{className:"relative",children:[(0,jt.jsxs)("div",{className:"flex gap-2",children:[(0,jt.jsxs)("div",{className:"relative flex-1",children:[(0,jt.jsx)("input",{ref:p,type:"text",value:a,onChange:e=>{const t=e.target.value;s(t),m(""),i(!0)},onKeyDown:e=>{"ArrowDown"===e.key?(e.preventDefault(),u(e=>e<l.length-1?e+1:0)):"ArrowUp"===e.key?(e.preventDefault(),u(e=>e>0?e-1:l.length-1)):"Enter"===e.key?(e.preventDefault(),d>=0&&d<l.length?f(l[d]):a.trim()&&v()):"Escape"===e.key&&(i(!1),u(-1))},onFocus:()=>i(!0),placeholder:"Type to search majors...",disabled:o,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 disabled:bg-gray-100 disabled:cursor-not-allowed"}),(0,jt.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,jt.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),n&&l.length>0&&(0,jt.jsx)("div",{ref:g,className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:l.map((e,t)=>(0,jt.jsx)("div",{className:"px-3 py-2 cursor-pointer hover:bg-purple-50 ".concat(t===d?"bg-purple-100":""),onClick:()=>f(e),children:e},e))})]}),(0,jt.jsx)("button",{type:"button",onClick:v,disabled:!a.trim()||o,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-1 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors duration-200",children:(0,jt.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),h&&(0,jt.jsx)("div",{className:"mt-1 text-sm text-red-600",children:h}),(0,jt.jsx)("div",{className:"mt-1 text-xs text-gray-500",children:"Type to search and select from the list. Maximum 3 majors & minors."})]})},rh=t=>{var r,o;let{data:a,onChange:s,onMajorsChange:n,onMinorsChange:i,errors:l}=t;const c=(e,t)=>{s(e,t)},d=(0,e.useCallback)(e=>{const t=e.toLowerCase();if([...a.majors||[],...a.minors||[]].some(e=>e.toLowerCase()===t))return;const r=a.majors||[],o=a.minors||[];if(r.length<3){const t=[...r,e];n(t)}else if(o.length<3){const t=[...o,e];i(t)}},[a.majors,a.minors,n,i]),u=(0,e.useCallback)(e=>{const t=(a.majors||[]).filter(t=>t!==e);n(t)},[a.majors,n]),h=(0,e.useCallback)(e=>{const t=(a.minors||[]).filter(t=>t!==e);i(t)},[a.minors,i]);return(0,jt.jsxs)("div",{className:rd,children:[(0,jt.jsx)("h3",{className:od,children:"Basic Information"}),(0,jt.jsxs)("div",{className:ud,children:[(0,jt.jsxs)("div",{className:dd,children:[(0,jt.jsx)("label",{htmlFor:"fullName",className:fd,children:"Full Name *"}),(0,jt.jsx)("input",{id:"fullName",type:"text",value:a.fullName,onChange:e=>c("fullName",e.target.value),className:"".concat(vd," ").concat(l.fullName?pd:""),placeholder:"Enter your full name","aria-describedby":l.fullName?"fullName-error":void 0}),l.fullName&&(0,jt.jsx)("div",{id:"fullName-error",className:bd,children:l.fullName})]}),(0,jt.jsxs)("div",{className:dd,children:[(0,jt.jsx)("label",{htmlFor:"title",className:fd,children:"Title"}),(0,jt.jsx)("input",{id:"title",type:"text",value:a.title,onChange:e=>c("title",e.target.value),className:vd,placeholder:"e.g., Visual Designer, UI/UX Designer"})]}),(0,jt.jsxs)("div",{className:dd,children:[(0,jt.jsx)("label",{htmlFor:"school",className:fd,children:"School"}),(0,jt.jsx)("input",{id:"school",type:"text",value:a.school,onChange:e=>c("school",e.target.value),className:vd,placeholder:"e.g., Art Institute of Chicago, Parsons School of Design"})]}),(0,jt.jsxs)("div",{className:dd,children:[(0,jt.jsx)("label",{htmlFor:"pronouns",className:fd,children:"Pronouns"}),(0,jt.jsx)("input",{id:"pronouns",type:"text",value:a.pronouns,onChange:e=>c("pronouns",e.target.value),className:vd,placeholder:"e.g., she/her, they/them, he/him"})]}),(0,jt.jsxs)("div",{className:hd,children:[(0,jt.jsx)("label",{className:fd,children:"Major & Minor"}),(0,jt.jsxs)("div",{className:ru,children:[(0,jt.jsxs)("div",{className:ou,children:[null===(r=a.majors)||void 0===r?void 0:r.map((e,t)=>(0,jt.jsxs)("div",{className:au,children:[(0,jt.jsx)("span",{className:su,children:e}),(0,jt.jsx)("button",{type:"button",onClick:()=>u(e),className:nu,"aria-label":"Remove ".concat(e," major"),children:(0,jt.jsx)("svg",{className:Kd,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},"major-".concat(t))),null===(o=a.minors)||void 0===o?void 0:o.map((e,t)=>(0,jt.jsxs)("div",{className:au,children:[(0,jt.jsx)("span",{className:su,children:e}),(0,jt.jsx)("button",{type:"button",onClick:()=>h(e),className:nu,"aria-label":"Remove ".concat(e," minor"),children:(0,jt.jsx)("svg",{className:Kd,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},"minor-".concat(t)))]}),(0,jt.jsx)("div",{className:iu,children:(0,jt.jsx)(th,{onAddMajor:d,disabled:!1})})]})]}),(0,jt.jsxs)("div",{className:hd,children:[(0,jt.jsx)("label",{htmlFor:"bio",className:fd,children:"About"}),(0,jt.jsx)("textarea",{id:"bio",value:a.bio,onChange:e=>c("bio",e.target.value),className:"".concat(md," ").concat(l.bio?pd:""),placeholder:"Tell us about yourself...",rows:4,maxLength:280,"aria-describedby":l.bio?"bio-error":"bio-counter"}),(0,jt.jsxs)("div",{className:gd,children:[(0,jt.jsxs)("div",{id:"bio-counter",className:"".concat(yd," ").concat(a.bio.length>250?wd:""),children:[a.bio.length,"/280"]}),l.bio&&(0,jt.jsx)("div",{id:"bio-error",className:bd,children:l.bio})]})]})]})]})},oh=t=>{let{isOpen:r,onClose:o,onSave:s,initialData:n={},fileName:i=""}=t;const[l,c]=(0,e.useState)({title:"",description:"",software:[],tags:[]}),[d,u]=(0,e.useState)({});(0,e.useEffect)(()=>{if(r){const e=i.replace(/\.[^/.]+$/,"")||"";c({title:n.title||e,description:n.description||"",software:Array.isArray(n.software)?n.software:[],tags:Array.isArray(n.tags)?n.tags:[]}),u({})}},[r,i,n]);const h=(e,t)=>{c(r=>(0,a.A)((0,a.A)({},r),{},{[e]:t})),d[e]&&u(t=>(0,a.A)((0,a.A)({},t),{},{[e]:""}))},m=()=>{o()};return r?(0,jt.jsx)("div",{className:wu,children:(0,jt.jsxs)("div",{className:qu,children:[(0,jt.jsxs)("div",{className:Vu,children:[(0,jt.jsx)("h2",{children:"Edit Portfolio Item"}),(0,jt.jsx)("button",{type:"button",className:Ju,onClick:m,children:"\xd7"})]}),(0,jt.jsxs)("div",{className:Zu,children:[(0,jt.jsxs)("div",{className:Ku,children:[(0,jt.jsxs)("label",{htmlFor:"title",className:fd,children:["Title ",(0,jt.jsx)("span",{className:Yu,children:"*"})]}),(0,jt.jsx)("input",{type:"text",id:"title",value:l.title,onChange:e=>h("title",e.target.value),className:"".concat(vd," ").concat(d.title?Qu:""),placeholder:"Enter your artwork title"}),d.title&&(0,jt.jsx)("span",{className:$u,children:d.title})]}),(0,jt.jsxs)("div",{className:Ku,children:[(0,jt.jsx)("label",{htmlFor:"description",className:fd,children:"Description"}),(0,jt.jsx)("textarea",{id:"description",value:l.description,onChange:e=>h("description",e.target.value),className:xd,placeholder:"Describe your artwork, concept, or inspiration...",rows:4})]})]}),(0,jt.jsxs)("div",{className:Xu,children:[(0,jt.jsx)("button",{type:"button",className:Kc,onClick:m,children:"Cancel"}),(0,jt.jsx)("button",{type:"button",className:Yc,onClick:()=>{(()=>{const e={};return l.title.trim()||(e.title="Title is required"),u(e),0===Object.keys(e).length})()&&(s(l),o())},children:"Save"})]})]})}):null},ah=t=>{let{items:o,onChange:s,onDelete:n,onToggleVisibility:i}=t;const[l,c]=(0,e.useState)({isOpen:!1,itemId:null,itemTitle:""}),[d,u]=(0,e.useState)({isOpen:!1,itemId:null,itemData:null}),h=()=>{c({isOpen:!1,itemId:null,itemTitle:""})},m=()=>{u({isOpen:!1,itemId:null,itemData:null})};return(0,jt.jsxs)("div",{className:rd,children:[(0,jt.jsx)("h3",{className:od,children:"Portfolio"}),0===o.length?(0,jt.jsxs)("div",{className:Wu,children:[(0,jt.jsx)("div",{className:Bu,children:(0,jt.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[(0,jt.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,jt.jsx)("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),(0,jt.jsx)("polyline",{points:"21,15 16,10 5,21"})]})}),(0,jt.jsx)("p",{className:Gu,children:"No works uploaded yet"}),(0,jt.jsx)("p",{className:Hu,children:"Upload your first work to start building your portfolio"})]}):(0,jt.jsx)("div",{className:fu,children:o.map(e=>(0,jt.jsxs)("div",{className:vu,children:[(0,jt.jsxs)("div",{className:xu,children:[(0,jt.jsx)("img",{src:e.image,alt:e.title,className:bu}),(0,jt.jsxs)("div",{className:Pu,children:[(0,jt.jsx)("button",{type:"button",onClick:()=>(e=>{let t=[],r=[];e.tags&&Array.isArray(e.tags)&&(t=e.tags.filter(e=>["Photoshop","Illustrator","Blender","Maya","3ds Max","Cinema 4D","After Effects","Premiere Pro","Figma","Sketch","Procreate","ZBrush","Substance Painter","Unity","Unreal Engine"].includes(e)),r=e.tags.filter(e=>e.startsWith("@"))),u({isOpen:!0,itemId:e.id,itemData:{title:e.title||"",description:e.description||"",software:t,tags:r}})})(e),className:Mu,title:"Edit work details",children:(0,jt.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})})}),(0,jt.jsx)("button",{type:"button",onClick:()=>(e=>{const t=o.find(t=>t.id===e);if(t&&i)i(e,t.isPublic);else{const t=o.map(t=>t.id===e?(0,a.A)((0,a.A)({},t),{},{isPublic:!t.isPublic}):t);s(t)}})(e.id),className:"".concat(Eu," ").concat(e.isPublic?Lu:Tu),title:e.isPublic?"Make Private":"Make Public",children:e.isPublic?(0,jt.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"})}):(0,jt.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"})})}),(0,jt.jsx)("button",{type:"button",onClick:()=>{return t=e.id,r=e.title,void c({isOpen:!0,itemId:t,itemTitle:r});var t,r},className:Du,title:"Remove from portfolio",children:(0,jt.jsx)("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]}),(0,jt.jsx)("div",{className:Fu,children:(0,jt.jsx)("span",{className:"".concat(Ru," ").concat(e.isPublic?yu:Ou),children:e.isPublic?"Public":"Private"})})]}),(0,jt.jsx)("div",{className:Uu,children:(0,jt.jsx)("h4",{className:zu,children:e.title})})]},e.id))}),l.isOpen&&(0,jt.jsx)("div",{className:wu,onClick:h,children:(0,jt.jsxs)("div",{className:ju,onClick:e=>e.stopPropagation(),children:[(0,jt.jsx)("div",{className:ku,children:(0,jt.jsx)("h3",{className:Su,children:"Delete Work"})}),(0,jt.jsxs)("div",{className:Nu,children:[(0,jt.jsxs)("p",{children:["Are you sure you want to delete"," ",(0,jt.jsxs)("strong",{children:['"',l.itemTitle,'"']})," from your portfolio?"]}),(0,jt.jsx)("p",{className:Cu,children:"This action cannot be undone."})]}),(0,jt.jsxs)("div",{className:_u,children:[(0,jt.jsx)("button",{type:"button",onClick:h,className:Au,children:"Cancel"}),(0,jt.jsx)("button",{type:"button",onClick:()=>{if(l.itemId){if(n)n(l.itemId);else{const e=o.filter(e=>e.id!==l.itemId);s(e)}h()}},className:Iu,children:"Delete"})]})]})}),(0,jt.jsx)(oh,{isOpen:d.isOpen,onClose:m,onSave:async e=>{if(d.itemId)try{const{updatePortfolioItem:t}=await Promise.resolve().then(r.bind(r,200)),n=await t(d.itemId,{title:e.title,description:e.description,tags:[...e.software,...e.tags,"uploaded"]});if(n.success){const t=o.map(t=>t.id===d.itemId?(0,a.A)((0,a.A)({},t),{},{title:e.title,description:e.description,software:e.software,tags:[...e.software,...e.tags,"uploaded"]}):t);s(t),m()}else console.error("Failed to update portfolio item:",n.error),alert("Failed to update work details. Please try again.")}catch(t){console.error("Error updating portfolio item:",t),alert("Failed to update work details. Please try again.")}},initialData:d.itemData||{}})]})},sh=1.375,nh=.5,ih=4,lh=.1,ch=1,dh=.1,uh="Update Profile Photo",hh="Choose Photo",mh="Upload Successful!",ph="Your profile photo has been updated.",gh="Done",fh="Cancel",vh="Save",xh="Uploading...",bh="Zoom",yh="Choose a new profile photo",wh="Current avatar",jh={CROPPER:{containerStyle:{width:"100%",height:"100%",backgroundColor:"#f3f4f6"},cropAreaStyle:{border:"2px solid #8b5cf6",borderRadius:"50%",boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.3)"},mediaStyle:{width:"100%",height:"100%",objectFit:"contain"}}},kh=e=>{let{onCancel:t,error:r}=e;return(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,jt.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:uh}),(0,jt.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:(0,jt.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),r&&(0,jt.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,jt.jsx)("p",{className:"text-red-600 text-sm",children:r})})]})},Sh=e=>{let{currentAvatar:t,onUploadClick:r,onFileChange:o,fileInputRef:a}=e;return(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("img",{src:t,alt:wh,className:"w-24 h-24 rounded-full mx-auto border-2 border-gray-200",onError:e=>{e.target.style.display="none",e.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB4PSIzMiIgeT0iMjQiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEM5Q0E2Ij4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+",e.target.style.display="block"}})}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:yh}),(0,jt.jsx)("button",{onClick:r,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors",children:hh}),(0,jt.jsx)("input",{ref:a,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:o,className:"hidden"})]})};var Nh=function(e,t){return Nh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},Nh(e,t)};function Ch(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Nh(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var _h=function(){return _h=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},_h.apply(this,arguments)};Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var Ah=r(185),Ih=r.n(Ah);function Ph(e,t,r,o,a){void 0===a&&(a=0);var s=Rh(t.width,t.height,a),n=s.width,i=s.height;return{x:Eh(e.x,n,r.width,o),y:Eh(e.y,i,r.height,o)}}function Eh(e,t,r,o){var a=t*o/2-r/2;return Oh(e,-a,a)}function Dh(e,t){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function Lh(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}function Th(e,t){return Math.min(e,Math.max(0,t))}function Mh(e,t){return t}function Fh(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function Rh(e,t,r){var o=r*Math.PI/180;return{width:Math.abs(Math.cos(o)*e)+Math.abs(Math.sin(o)*t),height:Math.abs(Math.sin(o)*e)+Math.abs(Math.cos(o)*t)}}function Oh(e,t,r){return Math.min(Math.max(e,t),r)}function Uh(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return"string"===typeof e&&e.length>0}).join(" ").trim()}var zh=function(t){function r(){var o=null!==t&&t.apply(this,arguments)||this;return o.cropperRef=e.createRef(),o.imageRef=e.createRef(),o.videoRef=e.createRef(),o.containerPosition={x:0,y:0},o.containerRef=null,o.styleRef=null,o.containerRect=null,o.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},o.dragStartPosition={x:0,y:0},o.dragStartCrop={x:0,y:0},o.gestureZoomStart=0,o.gestureRotationStart=0,o.isTouching=!1,o.lastPinchDistance=0,o.lastPinchRotation=0,o.rafDragTimeout=null,o.rafPinchTimeout=null,o.wheelTimer=null,o.currentDoc="undefined"!==typeof document?document:null,o.currentWindow="undefined"!==typeof window?window:null,o.resizeObserver=null,o.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},o.initResizeObserver=function(){if("undefined"!==typeof window.ResizeObserver&&o.containerRef){var e=!0;o.resizeObserver=new window.ResizeObserver(function(t){e?e=!1:o.computeSizes()}),o.resizeObserver.observe(o.containerRef)}},o.preventZoomSafari=function(e){return e.preventDefault()},o.cleanEvents=function(){o.currentDoc&&(o.currentDoc.removeEventListener("mousemove",o.onMouseMove),o.currentDoc.removeEventListener("mouseup",o.onDragStopped),o.currentDoc.removeEventListener("touchmove",o.onTouchMove),o.currentDoc.removeEventListener("touchend",o.onDragStopped),o.currentDoc.removeEventListener("gesturechange",o.onGestureChange),o.currentDoc.removeEventListener("gestureend",o.onGestureEnd),o.currentDoc.removeEventListener("scroll",o.onScroll))},o.clearScrollEvent=function(){o.containerRef&&o.containerRef.removeEventListener("wheel",o.onWheel),o.wheelTimer&&clearTimeout(o.wheelTimer)},o.onMediaLoad=function(){var e=o.computeSizes();e&&(o.emitCropData(),o.setInitialCrop(e)),o.props.onMediaLoaded&&o.props.onMediaLoaded(o.mediaSize)},o.setInitialCrop=function(e){if(o.props.initialCroppedAreaPercentages){var t=function(e,t,r,o,a,s){var n=Rh(t.width,t.height,r),i=Oh(o.width/n.width*(100/e.width),a,s);return{crop:{x:i*n.width/2-o.width/2-n.width*i*(e.x/100),y:i*n.height/2-o.height/2-n.height*i*(e.y/100)},zoom:i}}(o.props.initialCroppedAreaPercentages,o.mediaSize,o.props.rotation,e,o.props.minZoom,o.props.maxZoom),r=t.crop,a=t.zoom;o.props.onCropChange(r),o.props.onZoomChange&&o.props.onZoomChange(a)}else if(o.props.initialCroppedAreaPixels){var s=function(e,t,r,o,a,s){void 0===r&&(r=0);var n=Rh(t.naturalWidth,t.naturalHeight,r),i=Oh(function(e,t,r){var o=function(e){return e.width>e.height?e.width/e.naturalWidth:e.height/e.naturalHeight}(t);return r.height>r.width?r.height/(e.height*o):r.width/(e.width*o)}(e,t,o),a,s),l=o.height>o.width?o.height/e.height:o.width/e.width;return{crop:{x:((n.width-e.width)/2-e.x)*l,y:((n.height-e.height)/2-e.y)*l},zoom:i}}(o.props.initialCroppedAreaPixels,o.mediaSize,o.props.rotation,e,o.props.minZoom,o.props.maxZoom);r=s.crop,a=s.zoom;o.props.onCropChange(r),o.props.onZoomChange&&o.props.onZoomChange(a)}},o.computeSizes=function(){var e,t,r,a,s,n,i=o.imageRef.current||o.videoRef.current;if(i&&o.containerRef){o.containerRect=o.containerRef.getBoundingClientRect(),o.saveContainerPosition();var l=o.containerRect.width/o.containerRect.height,c=(null===(e=o.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=o.videoRef.current)||void 0===t?void 0:t.videoWidth)||0,d=(null===(r=o.imageRef.current)||void 0===r?void 0:r.naturalHeight)||(null===(a=o.videoRef.current)||void 0===a?void 0:a.videoHeight)||0,u=c/d,h=void 0;if(i.offsetWidth<c||i.offsetHeight<d)switch(o.state.mediaObjectFit){default:case"contain":h=l>u?{width:o.containerRect.height*u,height:o.containerRect.height}:{width:o.containerRect.width,height:o.containerRect.width/u};break;case"horizontal-cover":h={width:o.containerRect.width,height:o.containerRect.width/u};break;case"vertical-cover":h={width:o.containerRect.height*u,height:o.containerRect.height}}else h={width:i.offsetWidth,height:i.offsetHeight};o.mediaSize=_h(_h({},h),{naturalWidth:c,naturalHeight:d}),o.props.setMediaSize&&o.props.setMediaSize(o.mediaSize);var m=o.props.cropSize?o.props.cropSize:function(e,t,r,o,a,s){void 0===s&&(s=0);var n=Rh(e,t,s),i=n.width,l=n.height,c=Math.min(i,r),d=Math.min(l,o);return c>d*a?{width:d*a,height:d}:{width:c,height:c/a}}(o.mediaSize.width,o.mediaSize.height,o.containerRect.width,o.containerRect.height,o.props.aspect,o.props.rotation);return(null===(s=o.state.cropSize)||void 0===s?void 0:s.height)===m.height&&(null===(n=o.state.cropSize)||void 0===n?void 0:n.width)===m.width||o.props.onCropSizeChange&&o.props.onCropSizeChange(m),o.setState({cropSize:m},o.recomputeCropPosition),o.props.setCropSize&&o.props.setCropSize(m),m}},o.saveContainerPosition=function(){if(o.containerRef){var e=o.containerRef.getBoundingClientRect();o.containerPosition={x:e.left,y:e.top}}},o.onMouseDown=function(e){o.currentDoc&&(e.preventDefault(),o.currentDoc.addEventListener("mousemove",o.onMouseMove),o.currentDoc.addEventListener("mouseup",o.onDragStopped),o.saveContainerPosition(),o.onDragStart(r.getMousePoint(e)))},o.onMouseMove=function(e){return o.onDrag(r.getMousePoint(e))},o.onScroll=function(e){o.currentDoc&&(e.preventDefault(),o.saveContainerPosition())},o.onTouchStart=function(e){o.currentDoc&&(o.isTouching=!0,o.props.onTouchRequest&&!o.props.onTouchRequest(e)||(o.currentDoc.addEventListener("touchmove",o.onTouchMove,{passive:!1}),o.currentDoc.addEventListener("touchend",o.onDragStopped),o.saveContainerPosition(),2===e.touches.length?o.onPinchStart(e):1===e.touches.length&&o.onDragStart(r.getTouchPoint(e.touches[0]))))},o.onTouchMove=function(e){e.preventDefault(),2===e.touches.length?o.onPinchMove(e):1===e.touches.length&&o.onDrag(r.getTouchPoint(e.touches[0]))},o.onGestureStart=function(e){o.currentDoc&&(e.preventDefault(),o.currentDoc.addEventListener("gesturechange",o.onGestureChange),o.currentDoc.addEventListener("gestureend",o.onGestureEnd),o.gestureZoomStart=o.props.zoom,o.gestureRotationStart=o.props.rotation)},o.onGestureChange=function(e){if(e.preventDefault(),!o.isTouching){var t=r.getMousePoint(e),a=o.gestureZoomStart-1+e.scale;if(o.setNewZoom(a,t,{shouldUpdatePosition:!0}),o.props.onRotationChange){var s=o.gestureRotationStart+e.rotation;o.props.onRotationChange(s)}}},o.onGestureEnd=function(e){o.cleanEvents()},o.onDragStart=function(e){var t,r,a=e.x,s=e.y;o.dragStartPosition={x:a,y:s},o.dragStartCrop=_h({},o.props.crop),null===(r=(t=o.props).onInteractionStart)||void 0===r||r.call(t)},o.onDrag=function(e){var t=e.x,r=e.y;o.currentWindow&&(o.rafDragTimeout&&o.currentWindow.cancelAnimationFrame(o.rafDragTimeout),o.rafDragTimeout=o.currentWindow.requestAnimationFrame(function(){if(o.state.cropSize&&void 0!==t&&void 0!==r){var e=t-o.dragStartPosition.x,a=r-o.dragStartPosition.y,s={x:o.dragStartCrop.x+e,y:o.dragStartCrop.y+a},n=o.props.restrictPosition?Ph(s,o.mediaSize,o.state.cropSize,o.props.zoom,o.props.rotation):s;o.props.onCropChange(n)}}))},o.onDragStopped=function(){var e,t;o.isTouching=!1,o.cleanEvents(),o.emitCropData(),null===(t=(e=o.props).onInteractionEnd)||void 0===t||t.call(e)},o.onWheel=function(e){if(o.currentWindow&&(!o.props.onWheelRequest||o.props.onWheelRequest(e))){e.preventDefault();var t=r.getMousePoint(e),a=Ih()(e).pixelY,s=o.props.zoom-a*o.props.zoomSpeed/200;o.setNewZoom(s,t,{shouldUpdatePosition:!0}),o.state.hasWheelJustStarted||o.setState({hasWheelJustStarted:!0},function(){var e,t;return null===(t=(e=o.props).onInteractionStart)||void 0===t?void 0:t.call(e)}),o.wheelTimer&&clearTimeout(o.wheelTimer),o.wheelTimer=o.currentWindow.setTimeout(function(){return o.setState({hasWheelJustStarted:!1},function(){var e,t;return null===(t=(e=o.props).onInteractionEnd)||void 0===t?void 0:t.call(e)})},250)}},o.getPointOnContainer=function(e,t){var r=e.x,a=e.y;if(!o.containerRect)throw new Error("The Cropper is not mounted");return{x:o.containerRect.width/2-(r-t.x),y:o.containerRect.height/2-(a-t.y)}},o.getPointOnMedia=function(e){var t=e.x,r=e.y,a=o.props,s=a.crop,n=a.zoom;return{x:(t+s.x)/n,y:(r+s.y)/n}},o.setNewZoom=function(e,t,r){var a=(void 0===r?{}:r).shouldUpdatePosition,s=void 0===a||a;if(o.state.cropSize&&o.props.onZoomChange){var n=Oh(e,o.props.minZoom,o.props.maxZoom);if(s){var i=o.getPointOnContainer(t,o.containerPosition),l=o.getPointOnMedia(i),c={x:l.x*n-i.x,y:l.y*n-i.y},d=o.props.restrictPosition?Ph(c,o.mediaSize,o.state.cropSize,n,o.props.rotation):c;o.props.onCropChange(d)}o.props.onZoomChange(n)}},o.getCropData=function(){return o.state.cropSize?function(e,t,r,o,a,s,n){void 0===s&&(s=0),void 0===n&&(n=!0);var i=n?Th:Mh,l=Rh(t.width,t.height,s),c=Rh(t.naturalWidth,t.naturalHeight,s),d={x:i(100,((l.width-r.width/a)/2-e.x/a)/l.width*100),y:i(100,((l.height-r.height/a)/2-e.y/a)/l.height*100),width:i(100,r.width/l.width*100/a),height:i(100,r.height/l.height*100/a)},u=Math.round(i(c.width,d.width*c.width/100)),h=Math.round(i(c.height,d.height*c.height/100)),m=c.width>=c.height*o?{width:Math.round(h*o),height:h}:{width:u,height:Math.round(u/o)};return{croppedAreaPercentages:d,croppedAreaPixels:_h(_h({},m),{x:Math.round(i(c.width-m.width,d.x*c.width/100)),y:Math.round(i(c.height-m.height,d.y*c.height/100))})}}(o.props.restrictPosition?Ph(o.props.crop,o.mediaSize,o.state.cropSize,o.props.zoom,o.props.rotation):o.props.crop,o.mediaSize,o.state.cropSize,o.getAspect(),o.props.zoom,o.props.rotation,o.props.restrictPosition):null},o.emitCropData=function(){var e=o.getCropData();if(e){var t=e.croppedAreaPercentages,r=e.croppedAreaPixels;o.props.onCropComplete&&o.props.onCropComplete(t,r),o.props.onCropAreaChange&&o.props.onCropAreaChange(t,r)}},o.emitCropAreaChange=function(){var e=o.getCropData();if(e){var t=e.croppedAreaPercentages,r=e.croppedAreaPixels;o.props.onCropAreaChange&&o.props.onCropAreaChange(t,r)}},o.recomputeCropPosition=function(){if(o.state.cropSize){var e=o.props.restrictPosition?Ph(o.props.crop,o.mediaSize,o.state.cropSize,o.props.zoom,o.props.rotation):o.props.crop;o.props.onCropChange(e),o.emitCropData()}},o.onKeyDown=function(e){var t,r,a=o.props,s=a.crop,n=a.onCropChange,i=a.keyboardStep,l=a.zoom,c=a.rotation,d=i;if(o.state.cropSize){e.shiftKey&&(d*=.2);var u=_h({},s);switch(e.key){case"ArrowUp":u.y-=d,e.preventDefault();break;case"ArrowDown":u.y+=d,e.preventDefault();break;case"ArrowLeft":u.x-=d,e.preventDefault();break;case"ArrowRight":u.x+=d,e.preventDefault();break;default:return}o.props.restrictPosition&&(u=Ph(u,o.mediaSize,o.state.cropSize,l,c)),e.repeat||null===(r=(t=o.props).onInteractionStart)||void 0===r||r.call(t),n(u)}},o.onKeyUp=function(e){var t,r;switch(e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":e.preventDefault();break;default:return}o.emitCropData(),null===(r=(t=o.props).onInteractionEnd)||void 0===r||r.call(t)},o}return Ch(r,t),r.prototype.componentDidMount=function(){this.currentDoc&&this.currentWindow&&(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),"undefined"===typeof window.ResizeObserver&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=".reactEasyCrop_Container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  user-select: none;\n  touch-action: none;\n  cursor: move;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.reactEasyCrop_Image,\n.reactEasyCrop_Video {\n  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */\n}\n\n.reactEasyCrop_Contain {\n  max-width: 100%;\n  max-height: 100%;\n  margin: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.reactEasyCrop_Cover_Horizontal {\n  width: 100%;\n  height: auto;\n}\n.reactEasyCrop_Cover_Vertical {\n  width: auto;\n  height: 100%;\n}\n\n.reactEasyCrop_CropArea {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  box-sizing: border-box;\n  box-shadow: 0 0 0 9999em;\n  color: rgba(0, 0, 0, 0.5);\n  overflow: hidden;\n}\n\n.reactEasyCrop_CropAreaRound {\n  border-radius: 50%;\n}\n\n.reactEasyCrop_CropAreaGrid::before {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 0;\n  bottom: 0;\n  left: 33.33%;\n  right: 33.33%;\n  border-top: 0;\n  border-bottom: 0;\n}\n\n.reactEasyCrop_CropAreaGrid::after {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 33.33%;\n  bottom: 33.33%;\n  left: 0;\n  right: 0;\n  border-left: 0;\n  border-right: 0;\n}\n",this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},r.prototype.componentWillUnmount=function(){var e,t;this.currentDoc&&this.currentWindow&&("undefined"===typeof window.ResizeObserver&&this.currentWindow.removeEventListener("resize",this.computeSizes),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&(null===(t=this.styleRef.parentNode)||void 0===t||t.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},r.prototype.componentDidUpdate=function(e){var t,r,o,a,s,n,i,l,c;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect||e.objectFit!==this.props.objectFit?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():(null===(t=e.cropSize)||void 0===t?void 0:t.height)!==(null===(r=this.props.cropSize)||void 0===r?void 0:r.height)||(null===(o=e.cropSize)||void 0===o?void 0:o.width)!==(null===(a=this.props.cropSize)||void 0===a?void 0:a.width)?this.computeSizes():(null===(s=e.crop)||void 0===s?void 0:s.x)===(null===(n=this.props.crop)||void 0===n?void 0:n.x)&&(null===(i=e.crop)||void 0===i?void 0:i.y)===(null===(l=this.props.crop)||void 0===l?void 0:l.y)||this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),e.video!==this.props.video&&(null===(c=this.videoRef.current)||void 0===c||c.load());var d=this.getObjectFit();d!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:d},this.computeSizes)},r.prototype.getAspect=function(){var e=this.props,t=e.cropSize,r=e.aspect;return t?t.width/t.height:r},r.prototype.getObjectFit=function(){var e,t,r,o;if("cover"===this.props.objectFit){if((this.imageRef.current||this.videoRef.current)&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var a=this.containerRect.width/this.containerRect.height;return((null===(e=this.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=this.videoRef.current)||void 0===t?void 0:t.videoWidth)||0)/((null===(r=this.imageRef.current)||void 0===r?void 0:r.naturalHeight)||(null===(o=this.videoRef.current)||void 0===o?void 0:o.videoHeight)||0)<a?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},r.prototype.onPinchStart=function(e){var t=r.getTouchPoint(e.touches[0]),o=r.getTouchPoint(e.touches[1]);this.lastPinchDistance=Dh(t,o),this.lastPinchRotation=Lh(t,o),this.onDragStart(Fh(t,o))},r.prototype.onPinchMove=function(e){var t=this;if(this.currentDoc&&this.currentWindow){var o=r.getTouchPoint(e.touches[0]),a=r.getTouchPoint(e.touches[1]),s=Fh(o,a);this.onDrag(s),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var e=Dh(o,a),r=t.props.zoom*(e/t.lastPinchDistance);t.setNewZoom(r,s,{shouldUpdatePosition:!1}),t.lastPinchDistance=e;var n=Lh(o,a),i=t.props.rotation+(n-t.lastPinchRotation);t.props.onRotationChange&&t.props.onRotationChange(i),t.lastPinchRotation=n})}},r.prototype.render=function(){var t,r=this,o=this.props,a=o.image,s=o.video,n=o.mediaProps,i=o.cropperProps,l=o.transform,c=o.crop,d=c.x,u=c.y,h=o.rotation,m=o.zoom,p=o.cropShape,g=o.showGrid,f=o.roundCropAreaPixels,v=o.style,x=v.containerStyle,b=v.cropAreaStyle,y=v.mediaStyle,w=o.classes,j=w.containerClassName,k=w.cropAreaClassName,S=w.mediaClassName,N=null!==(t=this.state.mediaObjectFit)&&void 0!==t?t:this.getObjectFit();return e.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(e){return r.containerRef=e},"data-testid":"container",style:x,className:Uh("reactEasyCrop_Container",j)},a?e.createElement("img",_h({alt:"",className:Uh("reactEasyCrop_Image","contain"===N&&"reactEasyCrop_Contain","horizontal-cover"===N&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===N&&"reactEasyCrop_Cover_Vertical",S)},n,{src:a,ref:this.imageRef,style:_h(_h({},y),{transform:l||"translate(".concat(d,"px, ").concat(u,"px) rotate(").concat(h,"deg) scale(").concat(m,")")}),onLoad:this.onMediaLoad})):s&&e.createElement("video",_h({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Uh("reactEasyCrop_Video","contain"===N&&"reactEasyCrop_Contain","horizontal-cover"===N&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===N&&"reactEasyCrop_Cover_Vertical",S)},n,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:_h(_h({},y),{transform:l||"translate(".concat(d,"px, ").concat(u,"px) rotate(").concat(h,"deg) scale(").concat(m,")")}),controls:!1}),(Array.isArray(s)?s:[{src:s}]).map(function(t){return e.createElement("source",_h({key:t.src},t))})),this.state.cropSize&&e.createElement("div",_h({ref:this.cropperRef,style:_h(_h({},b),{width:f?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:f?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Uh("reactEasyCrop_CropArea","round"===p&&"reactEasyCrop_CropAreaRound",g&&"reactEasyCrop_CropAreaGrid",k)},i)))},r.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:3,minZoom:1,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:1},r.getMousePoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},r.getTouchPoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},r}(e.Component);const Wh=e=>{let{previewUrl:t,crop:r,zoom:o,isUploading:a,uploadProgress:s,croppedAreaPixels:n,onCropChange:i,onZoomChange:l,onCropComplete:c,onCancel:d,onConfirmCrop:u}=e;return(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("div",{className:"relative w-full h-64 bg-gray-100 rounded-lg overflow-hidden",children:(0,jt.jsx)(zh,{image:t,crop:r,zoom:o,aspect:ch,onCropChange:i,onZoomChange:l,onCropComplete:c,showGrid:!1,objectFit:"contain",minZoom:nh,maxZoom:ih,wheelZoomRatio:dh,style:jh.CROPPER})})}),(0,jt.jsxs)("div",{className:"mb-4",children:[(0,jt.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:bh}),(0,jt.jsx)("input",{type:"range",min:nh,max:ih,step:lh,value:o,onChange:e=>l(Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),a&&(0,jt.jsxs)("div",{className:"mb-4",children:[(0,jt.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-1",children:[(0,jt.jsx)("span",{children:xh}),(0,jt.jsxs)("span",{children:[s,"%"]})]}),(0,jt.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,jt.jsx)("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(s,"%")}})})]}),(0,jt.jsxs)("div",{className:"flex gap-3",children:[(0,jt.jsx)("button",{onClick:d,disabled:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:fh}),(0,jt.jsx)("button",{onClick:u,disabled:a||!n,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:a?xh:vh})]})]})},Bh=e=>{let{onComplete:t}=e;return(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"mb-4",children:(0,jt.jsx)("div",{className:"w-24 h-24 rounded-full mx-auto border-2 border-green-200 bg-green-50 flex items-center justify-center",children:(0,jt.jsx)("svg",{className:"w-12 h-12 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),(0,jt.jsx)("p",{className:"text-green-600 font-medium mb-2",children:mh}),(0,jt.jsx)("p",{className:"text-gray-600 mb-4",children:ph}),(0,jt.jsx)("button",{onClick:t,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:gh})]})},Gh=()=>{const[t,r]=(0,e.useState)(!1),[o,a]=(0,e.useState)(0),[s,n]=(0,e.useState)(null);return{isUploading:t,uploadProgress:o,error:s,handleFileSelect:(0,e.useCallback)(async e=>{try{n(null),(e=>{if(!["image/jpeg","image/png","image/webp"].includes(e.type))throw new Error("Please select a valid image file (JPG, PNG, WebP)");if(e.size>5242880)throw new Error("File size must be less than 5MB")})(e);const t=await new Promise((t,r)=>{const o=new FileReader;o.onload=()=>t(o.result),o.onerror=()=>r(new Error("Failed to read file")),o.readAsDataURL(e)});return console.log("[handleFileSelect] Generated preview URL:",null===t||void 0===t?void 0:t.substring(0,30)),{file:e,previewUrl:t}}catch(t){return n(t.message),null}},[]),handleCropComplete:(0,e.useCallback)(async(e,t,o)=>{try{r(!0),a(10),console.log("[handleCropComplete] Input parameters:",{imageNaturalWidth:e.naturalWidth,imageNaturalHeight:e.naturalHeight,crop:t,pixelCrop:o});const s=function(e,t,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:512;const a=document.createElement("canvas"),s=a.getContext("2d");return a.width=o,a.height=o,s.drawImage(e,r.x,r.y,r.width,r.height,0,0,o,o),console.log("[cropImageToCanvas] Image dimensions:",{naturalWidth:e.naturalWidth,naturalHeight:e.naturalHeight}),console.log("[cropImageToCanvas] Pixel crop:",r),console.log("[cropImageToCanvas] Output size:",o),a}(e,t,o,512);a(30);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.85;const r=e.toDataURL("image/webp",t);return console.log("[exportToDataURL] Canvas dimensions:",{width:e.width,height:e.height}),console.log("[exportToDataURL] Generated dataURL length:",null===r||void 0===r?void 0:r.length),console.log("[exportToDataURL] Generated dataURL preview:",null===r||void 0===r?void 0:r.substring(0,50)),r}(s,.85);a(50),console.log("[useAvatarUpload] Generated dataURL:",null===n||void 0===n?void 0:n.substring(0,30));const i=await(0,Lr.QU)();if(!i)throw new Error("User not authenticated. Please log in again.");a(80);const l=await vo(n,i);if(a(100),await new Promise(e=>setTimeout(e,500)),!l.success)throw new Error(l.error);return console.log("[useAvatarUpload] Upload successful, returning:",l.data),l.data}catch(s){throw console.error("[useAvatarUpload] Upload failed:",s),n(s.message),s}finally{r(!1),a(0)}},[]),cleanup:(0,e.useCallback)(e=>{console.log("[cleanup] Data URL cleanup completed")},[])}},Hh=t=>{let{isOpen:r,onClose:o,onAvatarUpdate:a,currentAvatar:s}=t;const n=(t=>{const[r,o]=(0,e.useState)({x:0,y:0}),[a,s]=(0,e.useState)(sh),[n,i]=(0,e.useState)(null),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(null),[h,m]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{t&&(o({x:0,y:0}),s(sh),i(null),c(null),u(null),m(!1))},[t]),{crop:r,zoom:a,croppedAreaPixels:n,selectedImage:l,previewUrl:d,uploadCompleted:h,setCrop:o,setZoom:s,setCroppedAreaPixels:i,setSelectedImage:c,setPreviewUrl:u,setUploadCompleted:m,resetState:()=>{o({x:0,y:0}),s(sh),i(null),c(null),u(null),m(!1)}}})(r),{crop:i,zoom:l,croppedAreaPixels:c,selectedImage:d,previewUrl:u,uploadCompleted:h,setCrop:m,setZoom:p}=n,g=((t,r,o,a)=>{const{selectedImage:s,previewUrl:n,croppedAreaPixels:i,crop:l}=t,{setSelectedImage:c,setPreviewUrl:d,setCrop:u,setZoom:h,setCroppedAreaPixels:m,setUploadCompleted:p,resetState:g}=r,f=(0,e.useRef)(null),{isUploading:v,uploadProgress:x,error:b,handleFileSelect:y,handleCropComplete:w,cleanup:j}=Gh(),k=(0,e.useCallback)(async e=>{var t;const r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!r)return;const o=await y(r);o&&(c(o.file),d(o.previewUrl),u({x:0,y:0}),h(sh))},[y,c,d,u,h]),S=(0,e.useCallback)((e,t)=>{m(t)},[m]),N=(0,e.useCallback)(async()=>{if(console.log("[AvatarCropModal] handleConfirmCrop called"),console.log("[AvatarCropModal] selectedImage:",!!s),console.log("[AvatarCropModal] croppedAreaPixels:",!!i),s&&i)try{var e;const t=new Image;t.src=n,await new Promise(e=>{t.onload=e}),console.log("[AvatarCropModal] Image loaded, calling handleCropComplete");const r=await w(t,l,i);if(console.log("[AvatarCropModal] Crop result:",r),!r.avatarUrl||!r.avatarUrl.startsWith("data:image/")&&!r.avatarUrl.startsWith("http"))throw console.error("[AvatarCropModal] Invalid avatarUrl format:",r.avatarUrl),new Error("Invalid avatar URL format");console.log("[AvatarCropModal] Calling onAvatarUpdate with:",null===(e=r.avatarUrl)||void 0===e?void 0:e.substring(0,30)),a(r.avatarUrl,r.avatarUpdatedAt),j(n),p(!0)}catch(t){console.error("Crop failed:",t)}else console.error("[AvatarCropModal] Missing required data for crop")},[s,i,l,w,a,j,n,p]),C=(0,e.useCallback)(()=>{j(n),g(),o()},[j,n,g,o]),_=(0,e.useCallback)(()=>{p(!1),o()},[p,o]),A=(0,e.useCallback)(()=>{var e;null===(e=f.current)||void 0===e||e.click()},[]);return{fileInputRef:f,isUploading:v,uploadProgress:x,error:b,handleFileChange:k,onCropComplete:S,handleConfirmCrop:N,handleCancel:C,handleComplete:_,handleUploadClick:A}})(n,n,o,a),{fileInputRef:f,isUploading:v,uploadProgress:x,error:b,handleFileChange:y,onCropComplete:w,handleConfirmCrop:j,handleCancel:k,handleComplete:S,handleUploadClick:N}=g;return r?(0,jt.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,jt.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[(0,jt.jsx)(kh,{onCancel:k,error:b}),h?(0,jt.jsx)(Bh,{onComplete:S}):d?(0,jt.jsx)(Wh,{previewUrl:u,crop:i,zoom:l,isUploading:v,uploadProgress:x,croppedAreaPixels:c,onCropChange:m,onZoomChange:p,onCropComplete:w,onCancel:k,onConfirmCrop:j}):(0,jt.jsx)(Sh,{currentAvatar:s,onUploadClick:N,onFileChange:y,fileInputRef:f})]})}):null},qh=t=>{let{avatar:r,onAvatarChange:o}=t;const[a,s]=(0,e.useState)(!1),[n,i]=(0,e.useState)(null),[l,c]=(0,e.useState)(r);(0,e.useEffect)(()=>{r&&r!==l&&(console.log("[ProfilePhotoCard] Avatar prop changed:",null===r||void 0===r?void 0:r.substring(0,30)),c(r))},[r,l]),(0,e.useEffect)(()=>{if(!l&&"undefined"!==typeof window)try{const t=(0,Lr.WR)();if(t){const r=window.localStorage.getItem("tag.avatars.".concat(t));if(r){const t=JSON.parse(r);var e;if(t&&t.avatarUrl)console.log("[ProfilePhotoCard] Initialized from localStorage:",null===(e=t.avatarUrl)||void 0===e?void 0:e.substring(0,30)),c(t.avatarUrl)}}}catch(t){console.warn("[ProfilePhotoCard] Failed to read avatar from localStorage:",t)}},[]);const d="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiNGM0Y0RjYiLz4KPHN2ZyB4PSIzMiIgeT0iMjQiIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjOEM5Q0E2Ij4KPHBhdGggZD0iTTEyIDEyYzIuMjEgMCA0LTEuNzkgNC00cy0xLjc5LTQtNC00LTQgMS43OS00IDQgMS43OSA0IDQgNHptMCAyYy0yLjY3IDAtOCAxLjM0LTggNHYyaDE2di0yYzAtMi42Ni01LjMzLTQtOC00eiIvPgo8L3N2Zz4KPC9zdmc+",[u,h]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{if(l)if(l.startsWith("data:image/"))h(l);else try{const e=await(0,Lr.WR)();if(e){const t=await xo(e);h(t||l)}else h(l)}catch(e){console.error("[ProfilePhotoCard] Failed to get avatar URL:",e),h(l)}else h(null)})()},[l]);const m=(0,e.useCallback)(async(e,t)=>{if(console.log("[ProfilePhotoCard] Received new avatar URL:",null===e||void 0===e?void 0:e.substring(0,30)),console.log("[ProfilePhotoCard] Avatar URL type:",typeof e),console.log("[ProfilePhotoCard] Full avatar URL:",e),e&&(e.startsWith("data:image/")||e.startsWith("http"))){c(e),i(t),o(e);try{await(0,At.$u)(e)?console.log("[ProfilePhotoCard] Successfully updated unified avatar"):console.error("[ProfilePhotoCard] Failed to update unified avatar")}catch(r){console.error("[ProfilePhotoCard] Error updating unified avatar:",r)}console.log("[onAvatarUpdate] prefix:",null===e||void 0===e?void 0:e.substring(0,4)),console.log("[ProfilePhotoCard] Successfully updated avatar"),s(!1)}else console.error("[ProfilePhotoCard] Invalid avatar URL format:",e)},[o]),p=(0,e.useCallback)(()=>{s(!0)},[]),g=(0,e.useCallback)(()=>{s(!1)},[]);return(0,jt.jsxs)("div",{className:rd,children:[(0,jt.jsx)("h3",{className:od,children:"Profile Photo"}),(0,jt.jsxs)("div",{className:ad,children:[(0,jt.jsx)("div",{className:sd,children:u?(0,jt.jsx)("img",{src:u,alt:"Profile avatar",className:nd,onError:e=>{let{currentTarget:t}=e;t.onerror=null,t.src=d}}):(0,jt.jsx)("img",{src:d,alt:"Default profile avatar",className:nd})}),(0,jt.jsx)("div",{className:id,children:(0,jt.jsxs)("button",{type:"button",onClick:p,className:ld,"aria-label":"Change profile photo",children:[(0,jt.jsxs)("svg",{className:cd,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Change Photo"]})})]}),(0,jt.jsx)(Hh,{isOpen:a,onClose:g,onAvatarUpdate:m,currentAvatar:u||d})]})},Vh=t=>{let{skills:r,onChange:o}=t;const[a,s]=(0,e.useState)(""),[n,i]=(0,e.useState)(""),l=(0,e.useCallback)(()=>{const e=a.trim();if(!e)return void i("Please enter a skill");if(e.length>20)return void i("Skill name must be 20 characters or less");if(e.length<2)return void i("Skill name must be at least 2 characters");const t=e.toLowerCase();if(r.some(e=>e.toLowerCase()===t))return void i("This skill already exists");if(r.length>=12)return void i("Maximum 12 skills allowed");const n=[...r,e];o(n),s(""),i("")},[a,r,o]),c=(0,e.useCallback)(e=>{const t=r.filter(t=>t!==e);o(t)},[r,o]),d=(0,e.useCallback)(e=>{"Enter"===e.key&&(e.preventDefault(),l())},[l]),u=(0,e.useCallback)(e=>{s(e.target.value),n&&i("")},[n]);return(0,jt.jsxs)("div",{className:rd,children:[(0,jt.jsx)("h3",{className:od,children:"Skills"}),(0,jt.jsxs)("div",{className:Hd,children:[(0,jt.jsx)("div",{className:qd,children:r.map((e,t)=>(0,jt.jsxs)("div",{className:Vd,children:[(0,jt.jsx)("span",{className:Jd,children:e}),(0,jt.jsx)("button",{type:"button",onClick:()=>c(e),className:Zd,"aria-label":"Remove ".concat(e," skill"),children:(0,jt.jsx)("svg",{className:Kd,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t))}),(0,jt.jsxs)("div",{className:Yd,children:[(0,jt.jsxs)("div",{className:Qd,children:[(0,jt.jsx)("input",{type:"text",value:a,onChange:u,onKeyPress:d,className:"".concat($d," ").concat(n?pd:""),placeholder:"Add a skill...",maxLength:20,"aria-describedby":n?"skill-error":"skill-help"}),(0,jt.jsx)("button",{type:"button",onClick:l,className:Xd,disabled:!a.trim()||r.length>=12,"aria-label":"Add skill",children:(0,jt.jsx)("svg",{className:eu,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})]}),n&&(0,jt.jsx)("div",{id:"skill-error",className:bd,children:n}),(0,jt.jsx)("div",{id:"skill-help",className:tu,children:"Press Enter or click + to add. Maximum 12 skills."})]})]})]})},Jh=[{label:"ArtStation",placeholder:"artstation.com/yourname"},{label:"Behance",placeholder:"behance.net/yourname"}],Zh=e=>e.trim()?e.match(/^https?:\/\//i)?e:(e.match(/^www\./i),"https://".concat(e)):e,Kh=e=>{if(!e.trim())return!0;try{return new URL(e),!0}catch(t){try{return new URL(Zh(e)),!0}catch(r){return!1}}},Yh=t=>{let{links:r,onChange:o,onOtherLinksChange:a}=t;const[s,n]=(0,e.useState)(""),[i,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(""),u=(0,e.useCallback)(()=>{const e=s.trim(),t=i.trim();if(!e)return void d("Please enter a website name");if(!t)return void d("Please enter a URL");if(!Kh(t))return void d("Please enter a valid website address");const o=(e=>e.trim()?Zh(e):e)(t);try{const e=new URL(o).hostname.toLowerCase();if((r.otherLinks||[]).some(t=>{try{return new URL(t.url).hostname.toLowerCase()===e}catch(r){return!1}}))return void d("This website is already added")}catch(u){return void d("Please enter a valid website address")}if((r.otherLinks||[]).length>=5)return void d("Maximum of 5 links");const c={id:crypto.randomUUID(),label:e,url:o};a([...r.otherLinks||[],c]),n(""),l(""),d("")},[s,i,r,a]),h=(0,e.useCallback)(e=>{a((r.otherLinks||[]).filter(t=>t.id!==e))},[r,a]),m=(0,e.useCallback)(e=>{n(e.label),l(""),d("")},[]),p=e=>{const t=e.toLowerCase();return t.includes("artstation")?(0,jt.jsx)("svg",{className:Sd,viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm0 2.25c5.385 0 9.75 4.365 9.75 9.75s-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12 6.615 2.25 12 2.25zm0 3.75c-3.314 0-6 2.686-6 6s2.686 6 6 6 6-2.686 6-6-2.686-6-6-6zm0 2.25c2.071 0 3.75 1.679 3.75 3.75s-1.679 3.75-3.75 3.75S8.25 14.821 8.25 12.75 9.929 9 12 9z"})}):t.includes("behance")?(0,jt.jsx)("svg",{className:Sd,viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M22 7h-7V5h7v2zm1.726 10c-.442 1.297-2.029 3-5.101 3-3.074 0-5.564-1.729-5.564-5.675 0-3.91 2.561-5.92 5.466-5.92 3.082 0 4.588 1.837 5.038 4.426l.332 1.906H17.19l-.23-1.518c-.245-1.332-1.104-1.804-2.13-1.804-1.245 0-2.916.988-2.916 3.368 0 2.507 1.688 3.716 3.111 3.716 1.149 0 1.955-.518 2.19-1.138h1.701zM11.649 9.413c0-1.288.875-2.013 1.857-2.013.983 0 1.857.725 1.857 2.013 0 1.287-.874 2.013-1.857 2.013-.982 0-1.857-.726-1.857-2.013zM8.14 12.213c0-1.634.893-2.6 2.072-2.6 1.179 0 2.072.966 2.072 2.6 0 1.635-.893 2.6-2.072 2.6-1.179 0-2.072-.965-2.072-2.6z"})}):(0,jt.jsx)("svg",{className:Sd,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9m0 9c-5 0-9-4-9-9s4-9 9-9"})})},g=[{key:"instagram",label:"Instagram URL",placeholder:"instagram.com/yourusername",icon:(0,jt.jsx)("svg",{className:Sd,viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})},{key:"portfolio",label:"Portfolio URL",placeholder:"your-portfolio.com",icon:(0,jt.jsx)("svg",{className:Sd,fill:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})})},{key:"discord",label:"Discord URL",placeholder:"discord.gg/yourname",icon:(0,jt.jsx)("svg",{className:Sd,viewBox:"0 0 24 24",fill:"currentColor",children:(0,jt.jsx)("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.019 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})})}];return(0,jt.jsxs)("div",{className:rd,children:[(0,jt.jsx)("h3",{className:od,children:"Social Links"}),(0,jt.jsxs)("div",{className:Cd,children:[(0,jt.jsx)("div",{className:_d,children:g.map(e=>{const t=r[e.key],a="string"===typeof t?t:"";return(0,jt.jsxs)("div",{className:dd,children:[(0,jt.jsx)("label",{htmlFor:e.key,className:fd,children:e.label}),(0,jt.jsxs)("div",{className:jd,children:[(0,jt.jsx)("div",{className:kd,children:e.icon}),(0,jt.jsx)("input",{id:e.key,type:"url",value:a,onChange:t=>((e,t)=>{o(e,t)})(e.key,t.target.value),className:"".concat(Nd," ").concat(a&&!Kh(a)?pd:""),placeholder:e.placeholder,"aria-describedby":"".concat(e.key,"-error")})]}),a&&!Kh(a)&&(0,jt.jsx)("div",{id:"".concat(e.key,"-error"),className:bd,children:"Please enter a valid website address"})]},e.key)})}),(0,jt.jsxs)("div",{className:_d,children:[(0,jt.jsx)("div",{className:Ad,children:(0,jt.jsx)("h4",{className:Id,children:"Other Websites"})}),(0,jt.jsx)("div",{className:Pd,children:(r.otherLinks||[]).map(e=>(0,jt.jsxs)("div",{className:Ed,children:[(0,jt.jsx)("div",{className:kd,children:p(e.label)}),(0,jt.jsxs)("div",{className:Dd,children:[(0,jt.jsx)("div",{className:Ld,children:e.label}),(0,jt.jsx)("div",{className:Td,children:e.url})]}),(0,jt.jsx)("button",{type:"button",onClick:()=>h(e.id),className:Md,"aria-label":"Remove ".concat(e.label," website"),children:(0,jt.jsx)("svg",{className:Kd,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e.id))}),(r.otherLinks||[]).length<5&&(0,jt.jsxs)("div",{className:Fd,children:[(0,jt.jsx)("div",{className:Rd,children:(0,jt.jsxs)("div",{className:Od,children:[(0,jt.jsx)("input",{type:"text",value:s,onChange:e=>{n(e.target.value),d("")},placeholder:"Website name",className:Ud}),(0,jt.jsx)("input",{type:"url",value:i,onChange:e=>{l(e.target.value),d("")},placeholder:"example.com",className:Ud}),(0,jt.jsx)("button",{type:"button",onClick:u,className:zd,disabled:!s.trim()||!i.trim(),children:"Add"})]})}),(0,jt.jsx)("div",{className:Wd,children:Jh.map(e=>(0,jt.jsx)("button",{type:"button",onClick:()=>m(e),className:Bd,children:e.label},e.label))}),c&&(0,jt.jsx)("div",{className:bd,children:c})]}),(r.otherLinks||[]).length>=5&&(0,jt.jsx)("div",{className:Gd,children:"Maximum of 5 links reached."})]})]})]})},Qh=()=>{const e=ce(),t=()=>{e("/upload/guidelines")};return(0,jt.jsxs)("div",{className:rd,children:[(0,jt.jsx)("h3",{className:od,children:"Upload New Work"}),(0,jt.jsxs)("div",{className:"".concat(lu," ").concat(cu),onClick:t,style:{cursor:"pointer"},children:[(0,jt.jsx)("svg",{className:du,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,jt.jsx)("p",{className:uu,children:"Click to upload new work"}),(0,jt.jsx)("p",{className:hu,children:"You'll be redirected to the upload guidelines"}),(0,jt.jsx)("button",{type:"button",className:mu,onClick:t,children:"Upload New Work"})]}),(0,jt.jsxs)("div",{className:pu,children:[(0,jt.jsx)("svg",{className:gu,fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),(0,jt.jsx)("span",{children:"Click to start the upload process"})]})]})},$h=()=>{var t,o,s,n;const i=ce(),{user:l}=St(),c={fullName:(null===l||void 0===l?void 0:l.name)||"",title:(null===l||void 0===l?void 0:l.role)||"",school:(null===l||void 0===l?void 0:l.school)||"",pronouns:(null===l||void 0===l?void 0:l.pronouns)||"",majors:(null===l||void 0===l?void 0:l.majors)||[],minors:[],bio:(null===l||void 0===l?void 0:l.bio)||"",avatar:(null===l||void 0===l?void 0:l.avatar)||null,socialLinks:{instagram:(null===l||void 0===l||null===(t=l.socialLinks)||void 0===t?void 0:t.instagram)||"",portfolio:(null===l||void 0===l||null===(o=l.socialLinks)||void 0===o?void 0:o.portfolio)||"",discord:(null===l||void 0===l||null===(s=l.socialLinks)||void 0===s?void 0:s.discord)||"",otherLinks:(null===l||void 0===l||null===(n=l.socialLinks)||void 0===n?void 0:n.otherLinks)||[]},skills:(null===l||void 0===l?void 0:l.skills)||[]},d=(0,a.A)({},c),[u,h]=(0,e.useState)((0,a.A)((0,a.A)({},d),{},{socialLinks:(0,a.A)((0,a.A)({},d.socialLinks),{},{otherLinks:[]})}));(0,e.useEffect)(()=>{l&&(async()=>{try{const e=null===l||void 0===l?void 0:l.id;if(!e)return;const t=await po(e);t.success&&t.data&&h(e=>(0,a.A)((0,a.A)({},e),{},{fullName:t.data.fullName,title:t.data.title,school:t.data.school,pronouns:t.data.pronouns,majors:t.data.majors,minors:t.data.minors||[],skills:t.data.skills||[],bio:t.data.bio||"",avatar:t.data.avatar||e.avatar,socialLinks:t.data.socialLinks||e.socialLinks}))}catch(e){console.error("Error loading user profile:",e)}})()},[l]);const[m,p]=(0,e.useState)([]),[g,f]=(0,e.useState)(!1),[v,x]=(0,e.useState)(!1),[b,y]=(0,e.useState)({}),w=(0,e.useCallback)(async()=>{console.log("[EditProfile] Loading portfolio from Supabase...");try{const e=await(0,sr.BD)();if(console.log("[EditProfile] Portfolio load result:",e),e.success){const t=await Promise.all(e.data.map(async e=>{let t="";const o=e.thumbnailPath||e.imagePaths&&e.imagePaths[0];if(o)try{const{getPortfolioImageUrl:e}=await Promise.resolve().then(r.bind(r,200)),a=await e(o);a.success&&a.data&&(t=a.data.url)}catch(a){console.warn("[EditProfile] Failed to get image URL for:",o,a)}return{id:e.id,title:e.title,description:e.description||"",image:t||"/assets/placeholder.svg",isPublic:e.isPublic,tags:e.tags||[]}}));console.log("[EditProfile] Setting portfolio items:",t),p(t)}else console.log("[EditProfile] Failed to load portfolio, using empty array"),p([])}catch(e){console.error("Error loading portfolio:",e),p([])}},[]);(0,e.useEffect)(()=>{w()},[w]);const j=(0,e.useCallback)(async e=>{try{const t=await(0,sr.zB)(e);t.success?w():console.error("Failed to delete portfolio item:",t.error)}catch(t){console.error("Error deleting portfolio item:",t)}},[w]),k=(0,e.useCallback)(async(e,t)=>{try{const r=await(0,sr.updatePortfolioItem)(e,{isPublic:!t});r.success?w():console.error("Failed to update portfolio visibility:",r.error)}catch(r){console.error("Error updating portfolio visibility:",r)}},[w]),S=(0,e.useCallback)(()=>{const e={};return u.fullName.trim()||(e.fullName="Full name is required"),u.bio.length>280&&(e.bio="Bio must be 280 characters or less"),{isValid:0===Object.keys(e).length,errors:e}},[u]),N=(0,e.useCallback)((e,t)=>{h(r=>(0,a.A)((0,a.A)({},r),{},{[e]:t})),f(!0)},[]),C=(0,e.useCallback)((e,t)=>{const r=(o=t).trim()?o.match(/^https?:\/\//i)?o:(o.match(/^www\./i),"https://".concat(o)):o;var o;h(t=>(0,a.A)((0,a.A)({},t),{},{socialLinks:(0,a.A)((0,a.A)({},t.socialLinks),{},{[e]:r})})),f(!0)},[]),_=(0,e.useCallback)(e=>{h(t=>(0,a.A)((0,a.A)({},t),{},{socialLinks:(0,a.A)((0,a.A)({},t.socialLinks),{},{otherLinks:e})})),f(!0)},[]),A=(0,e.useCallback)(e=>{h(t=>(0,a.A)((0,a.A)({},t),{},{skills:e})),f(!0)},[]),I=(0,e.useCallback)(e=>{h(t=>(0,a.A)((0,a.A)({},t),{},{majors:e})),f(!0)},[]),P=(0,e.useCallback)(e=>{h(t=>(0,a.A)((0,a.A)({},t),{},{minors:e})),f(!0)},[]),E=(0,e.useCallback)(e=>{p(e)},[]),D=(0,e.useCallback)(()=>{h(c),w(),f(!1),y({})},[w]),L=(0,e.useCallback)(async()=>{const e=S();if(y(e.errors),e.isValid)try{const e=(null===l||void 0===l?void 0:l.id)||"alice",r=await go(e,{fullName:u.fullName,title:u.title,school:u.school,pronouns:u.pronouns,majors:u.majors,minors:u.minors||[],skills:u.skills||[],bio:u.bio||"",avatar:u.avatar||null,socialLinks:u.socialLinks});if(r.success){if(console.log("Profile saved successfully:",r.data),ha(["artist",e]),u.avatar&&u.avatar.startsWith("data:image/"))try{await(0,At.$u)(u.avatar)?console.log("[EditProfile] Successfully updated unified avatar"):console.error("[EditProfile] Failed to update unified avatar")}catch(t){console.error("[EditProfile] Error updating unified avatar:",t)}f(!1),x(!0),setTimeout(()=>{x(!1)},3e3)}else console.error("Failed to save profile:",r.error)}catch(t){console.error("Error saving profile:",t)}},[u,m,S,l]),T=(0,e.useCallback)(()=>{i(-1)},[i]),M=(0,e.useCallback)(e=>{if(console.log("[EditProfile] handleAvatarChange called with:",typeof e),"string"===typeof e)console.log("[EditProfile] Setting new avatar:",null===e||void 0===e?void 0:e.substring(0,30)),console.log("[EditProfile] Avatar type:",typeof e),h(t=>(0,a.A)((0,a.A)({},t),{},{avatar:e})),f(!0);else if(e instanceof File){const t=new FileReader;t.onload=e=>{var t;const r=null===(t=e.target)||void 0===t?void 0:t.result;console.log("[EditProfile] Converted File to data URL:",null===r||void 0===r?void 0:r.substring(0,30)),h(e=>(0,a.A)((0,a.A)({},e),{},{avatar:r})),f(!0)},t.readAsDataURL(e)}},[]);return(0,jt.jsxs)("div",{className:Bc,children:[(0,jt.jsxs)("div",{className:Gc,children:[(0,jt.jsxs)("div",{className:Hc,children:[(0,jt.jsxs)("button",{onClick:T,className:qc,"aria-label":"Go back",children:[(0,jt.jsx)("svg",{className:Vc,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,jt.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),(0,jt.jsx)("h1",{className:Jc,children:"Edit Profile"})]}),(0,jt.jsxs)("div",{className:Zc,children:[(0,jt.jsx)("button",{onClick:D,className:Kc,disabled:!g,children:"Cancel"}),(0,jt.jsx)("button",{onClick:L,className:Yc,disabled:!g,children:"Save Changes"})]})]}),v&&(0,jt.jsxs)("div",{className:Qc,children:[(0,jt.jsx)("svg",{className:$c,fill:"currentColor",viewBox:"0 0 20 20",children:(0,jt.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Saved successfully!"]}),(0,jt.jsxs)("div",{className:Xc,children:[(0,jt.jsxs)("div",{className:ed,children:[(0,jt.jsx)(qh,{avatar:u.avatar,onAvatarChange:M}),(0,jt.jsx)(rh,{data:u,onChange:N,onMajorsChange:I,onMinorsChange:P,errors:b}),(0,jt.jsx)(Yh,{links:u.socialLinks,onChange:C,onOtherLinksChange:_})]}),(0,jt.jsxs)("div",{className:td,children:[(0,jt.jsx)(Vh,{skills:u.skills,onChange:A}),(0,jt.jsx)(Qh,{}),(0,jt.jsx)(ah,{items:m,onChange:E,onDelete:j,onToggleVisibility:k})]})]})]})},Xh="tag_service_data",em=async e=>{try{const r=["alice","bryan","alex"];for(const o of r){const r="portfolio_".concat(o),s=await xr.IG.getItem(r);if(s)try{const t=JSON.parse(s);if(Array.isArray(t)){const r=t.find(t=>t.id===e);if(r){const e=ar.o1[o];return(0,a.A)((0,a.A)({},r),{},{userId:o,authorName:(null===e||void 0===e?void 0:e.displayName)||o})}}}catch(t){console.warn("Failed to parse portfolio data for ".concat(o,":"),t)}}return null}catch(r){return console.error("Error getting portfolio data by ID:",r),null}},tm=async()=>{await(async()=>{if(!await xr.IG.getItem(Xh)){const e={tagStats:{design:{works:15,users:8,projects:3},illustration:{works:12,users:6,projects:2},photography:{works:8,users:4,projects:1},"3d":{works:6,users:3,projects:2},animation:{works:4,users:2,projects:1},ui:{works:10,users:5,projects:4},ux:{works:7,users:4,projects:3},branding:{works:9,users:5,projects:2},typography:{works:5,users:3,projects:1},"digital-art":{works:11,users:6,projects:2},photo:{works:1,users:1,projects:0},landscape:{works:1,users:1,projects:0}},workTags:{work1:["design","ui","branding"],work2:["illustration","digital-art"],work3:["photography","design"],work4:["3d","animation"],work5:["ux","ui","design"],pf_alice_01:["photo","landscape"],pf_bryan_01:["illustration","digital-art"],pf_alex_01:["design","ui"]},userTags:{alex:["design","ui","ux"],bryan:["illustration","digital-art","typography"],alice:["photography","design","branding","photo","landscape"]},projectTags:{project1:["design","ui","branding"],project2:["illustration","digital-art"],project3:["3d","animation"]}};await xr.IG.setItem(Xh,JSON.stringify(e))}})();const e=await xr.IG.getItem(Xh);return e?JSON.parse(e):null},rm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:300;return new Promise(t=>setTimeout(t,e))},om=()=>{const{slug:t}=de(),[r,o]=(ce(),(0,e.useState)(null)),[a,s]=(0,e.useState)([]),[n,i]=(0,e.useState)(!0),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(!0),h=async()=>{try{const e=await(async e=>{await rm();let t=0;const r=["alice","bryan","alex"];for(const s of r){const r="portfolio_".concat(s),o=await xr.IG.getItem(r);if(o)try{const r=JSON.parse(o);if(Array.isArray(r))for(const o of r)o.tags&&o.tags.some(t=>t.toLowerCase()===e.toLowerCase()||t.toLowerCase().includes(e.toLowerCase()))&&t++}catch(a){console.warn("Failed to parse portfolio data for ".concat(s,":"),a)}}if(0===t){var o;const t=await tm();return(null===t||void 0===t||null===(o=t.tagStats)||void 0===o?void 0:o[e])||{works:0,users:0,projects:0}}return{works:t,users:0,projects:0}})(t);o(e)}catch(e){console.error("Error loading tag stats:",e)}},m=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const r=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};await rm();const{limit:r=10,cursor:o=null}=t,a=[],s=["alice","bryan","alex"];for(const u of s){const t="portfolio_".concat(u),r=await xr.IG.getItem(t);if(r)try{const t=JSON.parse(r);if(Array.isArray(t)){const r=ar.o1[u];for(const o of t)if(o.tags&&o.tags.some(t=>t.toLowerCase()===e.toLowerCase()||t.toLowerCase().includes(e.toLowerCase()))){let t="";o.imageKey?t=await Ha.default.getImageUrl(o.imageKey):o.thumbnailPath?t=await Ha.default.getImageUrl(o.thumbnailPath):o.imagePaths&&o.imagePaths[0]&&(t=await Ha.default.getImageUrl(o.imagePaths[0])),a.push({id:o.id,title:o.title,description:o.description||"Tagged with #".concat(e),author:{id:u,name:(null===r||void 0===r?void 0:r.displayName)||u},image:t||""})}}}catch(d){console.warn("Failed to parse portfolio data for ".concat(u,":"),d)}}if(0===a.length){const t=await tm(),r=Object.entries((null===t||void 0===t?void 0:t.workTags)||{}).filter(t=>{let[r,o]=t;return o.includes(e)}).map(e=>{let[t]=e;return t});for(const o of r){const t=await em(o);if(t){let r="";t.imageKey?r=await Ha.default.getImageUrl(t.imageKey):t.thumbnailPath?r=await Ha.default.getImageUrl(t.thumbnailPath):t.imagePaths&&t.imagePaths[0]&&(r=await Ha.default.getImageUrl(t.imagePaths[0])),a.push({id:t.id,title:t.title,description:t.description||"Tagged with #".concat(e),author:{id:t.userId,name:t.authorName},image:r||""})}}}const n=o?parseInt(o):0,i=n+r,l=a.slice(n,i),c=i<a.length;return{items:l,hasMore:c,cursor:c?i.toString():null}}(t,{limit:12,cursor:e});s(e?e=>[...e,...r.items]:r.items),c(r.cursor),u(r.hasMore)}catch(r){console.error("Error loading works:",r)}};return(0,e.useEffect)(()=>{(async()=>{i(!0),await Promise.all([h(),m()]),i(!1)})()},[t]),n?(0,jt.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,jt.jsxs)("div",{className:"text-center",children:[(0,jt.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,jt.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading tag content..."})]})}):(0,jt.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,jt.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,jt.jsxs)("div",{children:[(0,jt.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["#",t]}),r&&(0,jt.jsxs)("p",{className:"text-gray-600 mt-2",children:[r.works," works"]})]})})}),(0,jt.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,jt.jsxs)("div",{children:[(0,jt.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:a.map(e=>(0,jt.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer",onClick:()=>window.open("/work/".concat(e.id),"_blank"),children:[(0,jt.jsx)("div",{className:"aspect-w-16 aspect-h-9 bg-gray-200 rounded-t-lg",children:(0,jt.jsx)("img",{src:e.image,alt:e.title,className:"w-full h-48 object-cover rounded-t-lg"})}),(0,jt.jsxs)("div",{className:"p-4",children:[(0,jt.jsx)("h3",{className:"font-medium text-gray-900 truncate",children:e.title}),(0,jt.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["by ",e.author.name]})]})]},e.id))}),d&&(0,jt.jsx)("div",{className:"text-center mt-8",children:(0,jt.jsx)("button",{onClick:()=>{d&&m(l)},className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700",children:"Load More Works"})})]})})]})},am=()=>(0,jt.jsxs)(jt.Fragment,{children:[(0,jt.jsx)(Rs,{}),(0,jt.jsx)(Ta,{}),(0,jt.jsx)(Es,{}),(0,jt.jsx)(Fs,{})]}),sm=()=>{const{navigateToCollaboration:e,navigateToMilestone:t}=Xo();return(0,jt.jsxs)(Pe,{children:[(0,jt.jsx)(Ae,{path:"/login",element:(0,jt.jsx)(Bs,{})}),(0,jt.jsx)(Ae,{path:"/register",element:(0,jt.jsx)(Sn,{})}),(0,jt.jsx)(Ae,{path:"/",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(am,{})})}),(0,jt.jsx)(Ae,{path:"/about",element:(0,jt.jsx)(ra,{})}),(0,jt.jsx)(Ae,{path:"/me",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(La,{})})}),(0,jt.jsx)(Ae,{path:"/work/:id",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(Vl,{})})}),(0,jt.jsx)(Ae,{path:"/artist/:id",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(La,{})})}),(0,jt.jsx)(Ae,{path:"/tagme",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(ii,{onCollaborationClick:t=>{e(t)},onMilestoneClick:e=>{t(e)}})})}),(0,jt.jsx)(Ae,{path:"/tagme/milestone/:id",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(Qs,{})})}),(0,jt.jsx)(Ae,{path:"/tagme/collaboration/:id",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(ds,{})})}),(0,jt.jsx)(Ae,{path:"/tagme/co-future-2025",element:(0,jt.jsx)(Uc,{})}),(0,jt.jsx)(Ae,{path:"/upload/guidelines",element:(0,jt.jsx)(Ai,{})}),(0,jt.jsx)(Ae,{path:"/upload/form",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(Ii,{children:(0,jt.jsx)(hl,{})})})}),(0,jt.jsx)(Ae,{path:"/upload",element:(0,jt.jsx)(Ai,{})}),(0,jt.jsx)(Ae,{path:"/notifications",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(gn,{})})}),(0,jt.jsx)(Ae,{path:"/notification-test",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(di,{})})}),(0,jt.jsx)(Ae,{path:"/settings/edit-profile",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)($h,{})})}),(0,jt.jsx)(Ae,{path:"/test-mock-api",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(ui,{})})}),(0,jt.jsx)(Ae,{path:"/test-collaboration",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(li,{})})}),(0,jt.jsx)(Ae,{path:"/test-supabase",element:(0,jt.jsx)(Nn,{})}),(0,jt.jsx)(Ae,{path:"/t/:slug",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(om,{})})}),(0,jt.jsx)(Ae,{path:"/major-aggregation",element:(0,jt.jsx)(fn,{children:(0,jt.jsx)(Wc,{})})}),(0,jt.jsx)(Ae,{path:"/admin-panel",element:(0,jt.jsx)(bc,{})}),(0,jt.jsx)(Ae,{path:"*",element:(0,jt.jsx)(_e,{to:"/",replace:!0})})]})};const nm=new class{constructor(){this.quotaThreshold=.8,this.cleanupInterval=3e4,this.maxRetries=3,this.isCleaning=!1,this.cleanupStrategies={avatarCache:{priority:1,pattern:/\.avatarCache|\.avatar/,description:"Avatar Cache"},tempImages:{priority:2,pattern:/temp_|_temp/,description:"Temporary Images"},oldCollaborations:{priority:3,pattern:/collaboration_old|old_collaboration/,description:"Old Collaborations"},draftData:{priority:4,pattern:/draft_|_draft/,description:"Draft Data"},portfolioCache:{priority:5,pattern:/portfolio_cache|portfolio_alice|portfolio_bryan/,description:"Portfolio Cache"},notificationCache:{priority:6,pattern:/notification_cache|notifications_old/,description:"Notification Cache"},generalCache:{priority:7,pattern:/cache_|_cache/,description:"General Cache"}}}async init(){return console.log("[SmartDataCleaner] Initializing..."),this.isStorageSupported()?(this.startMonitoring(),await this.checkAndCleanup(),console.log("[SmartDataCleaner] Initialized successfully"),!0):(console.warn("[SmartDataCleaner] Storage not supported, skipping initialization"),!1)}isStorageSupported(){try{return"undefined"!==typeof Storage&&null!==localStorage}catch(e){return!1}}startMonitoring(){this.monitoringInterval&&clearInterval(this.monitoringInterval),this.monitoringInterval=setInterval(async()=>{await this.checkAndCleanup()},this.cleanupInterval)}stopMonitoring(){this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=null)}async checkAndCleanup(){if(!this.isCleaning)try{const e=await this.getStorageUsage();console.log("[SmartDataCleaner] Storage usage: ".concat((100*e.percentage).toFixed(1),"%")),e.percentage>=this.quotaThreshold&&(console.warn("[SmartDataCleaner] Storage quota exceeded threshold (".concat(100*this.quotaThreshold,"%), starting cleanup...")),await this.performCleanup())}catch(e){console.error("[SmartDataCleaner] Error during cleanup check:",e)}}async getStorageUsage(){try{let e=0;const t=Object.keys(localStorage);for(const a of t){const t=localStorage.getItem(a);t&&(e+=a.length+t.length)}const r=5242880,o=e/r;return{used:e,quota:r,percentage:Math.min(o,1),keys:t.length}}catch(e){return console.error("[SmartDataCleaner] Error calculating storage usage:",e),{used:0,quota:0,percentage:0,keys:0}}}async performCleanup(){if(!this.isCleaning){this.isCleaning=!0,console.log("[SmartDataCleaner] Starting cleanup process...");try{const e=await this.getStorageUsage();let t=0,r=0;const o=Object.entries(this.cleanupStrategies).sort((e,t)=>{let[,r]=e,[,o]=t;return r.priority-o.priority});for(const[n,i]of o){const e=await this.cleanupByStrategy(i);t+=e.count,r+=e.freedSpace,console.log("[SmartDataCleaner] ".concat(i.description,": cleaned ").concat(e.count," items, freed ").concat((e.freedSpace/1024).toFixed(1),"KB"));if((await this.getStorageUsage()).percentage<.7*this.quotaThreshold){console.log("[SmartDataCleaner] Cleanup target reached, stopping early");break}}const a=await this.getStorageUsage(),s=e.used-a.used;console.log("[SmartDataCleaner] Cleanup completed: ".concat(t," items cleaned, ").concat((s/1024).toFixed(1),"KB freed")),console.log("[SmartDataCleaner] Storage usage: ".concat((100*e.percentage).toFixed(1),"% \u2192 ").concat((100*a.percentage).toFixed(1),"%")),this.dispatchCleanupEvent({cleanedCount:t,freedSpace:s,initialUsage:e.percentage,finalUsage:a.percentage})}catch(e){console.error("[SmartDataCleaner] Error during cleanup:",e)}finally{this.isCleaning=!1}}}async cleanupByStrategy(e){let t=0,r=0;try{const o=Object.keys(localStorage);for(const a of o)if(e.pattern.test(a)){const e=localStorage.getItem(a);e&&(r+=a.length+e.length,localStorage.removeItem(a),t++)}}catch(o){console.error("[SmartDataCleaner] Error cleaning ".concat(e.description,":"),o)}return{count:t,freedSpace:r}}async manualCleanup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(console.log("[SmartDataCleaner] Manual cleanup requested for:",e),this.isCleaning)console.warn("[SmartDataCleaner] Cleanup already in progress");else{this.isCleaning=!0;try{let t=0,r=0;for(const o of e)if(this.cleanupStrategies[o]){const e=await this.cleanupByStrategy(this.cleanupStrategies[o]);t+=e.count,r+=e.freedSpace}return console.log("[SmartDataCleaner] Manual cleanup completed: ".concat(t," items, ").concat((r/1024).toFixed(1),"KB freed")),{success:!0,cleanedCount:t,freedSpace:r}}catch(t){return console.error("[SmartDataCleaner] Manual cleanup failed:",t),{success:!1,error:t.message}}finally{this.isCleaning=!1}}}async getCleanupStats(){const e=await this.getStorageUsage(),t=Object.keys(localStorage),r={totalKeys:t.length,totalSize:e.used,usagePercentage:e.percentage,strategies:{}};for(const[o,a]of Object.entries(this.cleanupStrategies)){let e=0,s=0;for(const r of t)if(a.pattern.test(r)){const t=localStorage.getItem(r);t&&(e++,s+=r.length+t.length)}r.strategies[o]={count:e,size:s,description:a.description}}return r}dispatchCleanupEvent(e){const t=new CustomEvent("smartDataCleanup",{detail:(0,a.A)({timestamp:(new Date).toISOString()},e)});window.dispatchEvent(t)}destroy(){this.stopMonitoring(),this.isCleaning=!1,console.log("[SmartDataCleaner] Destroyed")}};"undefined"!==typeof window&&nm.init().catch(e=>{console.error("[SmartDataCleaner] Failed to initialize:",e)});const im=nm;function lm(){const{state:t}=Go();return(0,e.useEffect)(()=>{document.body.style.overflow="unset",document.documentElement.style.overflow="unset"},[]),(0,e.useEffect)(()=>{im.init().catch(e=>{console.warn("[App] Smart data cleaner initialization failed:",e)})},[]),t.isInitialized?(0,jt.jsx)(Gt,{children:(0,jt.jsxs)(ut,{children:[(0,jt.jsx)(qo,{}),(0,jt.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,jt.jsx)(ta,{}),(0,jt.jsxs)("main",{className:"pt-16",children:[(0,jt.jsx)(Ho,{}),(0,jt.jsx)(sm,{})]})]})]})}):(0,jt.jsx)(Ko,{})}const cm=function(){return(0,jt.jsx)(Nt,{children:(0,jt.jsx)(Bo,{children:(0,jt.jsx)(lm,{})})})};(0,r(77).qm)();t.createRoot(document.getElementById("root")).render((0,jt.jsx)(e.StrictMode,{children:(0,jt.jsx)(cm,{})}))})()})();
//# sourceMappingURL=main.2fa69c37.js.map